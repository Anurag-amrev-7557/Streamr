import{r as e,b as t}from"./react-vendor-DV0l1H4H.js";import{s as n,c as r,u as i,a}from"./components-DKzmuGdM.js";import{K as s,p as o,L as c,y as l}from"./services-O-bOU7vd.js";const u={smooth:e=>1-Math.pow(1-e,3),bounce:e=>1/2.75>e?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375,elastic:e=>Math.sin(-13*(e+1)*Math.PI)*Math.pow(2,-10*e)+1,premium:e=>.25*Math.pow(1-e,3)+3*Math.pow(1-e,2)*e*.46+3*(1-e)*Math.pow(e,2)*.45+.94*Math.pow(e,3),ultraSmooth:e=>.5*(1+Math.sin((e-.5)*Math.PI)),adaptive:(e,t=1)=>Math.pow(e,2/Math.min(Math.max(t,.5),2)),performance:e=>e*e*(3-2*e)},d=new class{constructor(){this.isScrolling=!1,this.scrollTimeout=null,this.animationFrame=null,this.lastScrollTime=0,this.scrollThrottle=4,this.activeAnimations=new Set,this.momentumEnabled=!0,this.inertiaDecay=.98,this.highRefreshRate=window.screen?.refreshRate>60||window.matchMedia("(min-resolution: 120dpi)").matches,this.handleScroll=this.handleScroll.bind(this),this.throttledScroll=this.throttledScroll.bind(this)}scrollToElement(e,t={}){const{offset:n=0,duration:r=800,easing:i="smooth",behavior:a="smooth",block:s="start",inline:o="nearest"}=t;return e?"smooth"===a&&"scrollIntoView"in e?new Promise((t=>{e.scrollIntoView({behavior:"smooth",block:s,inline:o}),setTimeout(t,r)})):this.customScrollTo(e,{offset:n,duration:r,easing:i,block:s,inline:o}):Promise.reject(Error("Element not found"))}customScrollTo(e,t={}){const{offset:r=0,duration:i=(this.highRefreshRate?400:600),easing:a=(this.highRefreshRate?"ultraSmooth":"premium"),block:s="start",inline:o="nearest",momentum:c=this.momentumEnabled}=t;return new Promise((t=>{const l=performance.now(),d=window.pageYOffset,m=window.pageXOffset,h=e.getBoundingClientRect(),f=document.documentElement.getBoundingClientRect();let g=d+h.top-f.top,p=m;g+=r,"center"===s?g-=window.innerHeight/2-h.height/2:"end"===s&&(g-=window.innerHeight-h.height),"center"===o?p+=h.left-f.left-(window.innerWidth/2-h.width/2):"end"===o&&(p+=h.left-f.left-(window.innerWidth-h.width));const b=g-d,v=p-m,w=u[a]||u.smooth,y=r=>{const s=Math.min((r-l)/i,1),o="adaptive"===a?w(s,Math.abs(b)/i):w(s),u=m+v*o,h=Math.round(100*(d+b*o))/100,f=Math.round(100*u)/100;if(window.scrollTo({left:f,top:h,behavior:"instant"}),1>s){if("undefined"!=typeof document&&"visible"!==document.visibilityState)return this.activeAnimations.delete(this.animationFrame),void(this.animationFrame=null);this.animationFrame=n(y),this.animationFrame&&this.activeAnimations.add(this.animationFrame)}else this.activeAnimations.delete(this.animationFrame),c&&this.momentumEnabled&&this.applyMomentum(e,g,p),t()};"undefined"!=typeof document&&"visible"!==document.visibilityState||(this.animationFrame=n(y),this.animationFrame&&this.activeAnimations.add(this.animationFrame))}))}applyMomentum(e,t,r){if(!this.momentumEnabled)return;const i=window.pageYOffset,a=window.pageXOffset;let s=.1*(t-i),o=.1*(r-a);const c=()=>{if(Math.abs(s)>.5||Math.abs(o)>.5){if("undefined"!=typeof document&&"visible"!==document.visibilityState)return;const e=i+s,t=a+o;window.scrollTo({left:t,top:e,behavior:"instant"}),s*=this.inertiaDecay,o*=this.inertiaDecay,n(c)}};n(c)}scrollToTop(e={}){const{duration:t=600,easing:r="smooth",offset:i=0}=e;return new Promise((e=>{const a=performance.now(),s=window.pageYOffset,o=i-s,c=u[r]||u.smooth,l=r=>{const i=Math.min((r-a)/t,1),u=c(i),d=s+o*u;if(window.scrollTo(0,d),1>i){if("undefined"!=typeof document&&"visible"!==document.visibilityState)return this.activeAnimations.delete(this.animationFrame),void(this.animationFrame=null);this.animationFrame=n(l),this.animationFrame&&this.activeAnimations.add(this.animationFrame)}else this.activeAnimations.delete(this.animationFrame),e()};"undefined"!=typeof document&&"visible"!==document.visibilityState||(this.animationFrame=n(l),this.animationFrame&&this.activeAnimations.add(this.animationFrame))}))}scrollToBottom(e={}){const{duration:t=600,easing:r="smooth",offset:i=0}=e;return new Promise((e=>{const a=performance.now(),s=window.pageYOffset,o=document.documentElement.scrollHeight-window.innerHeight+i-s,c=u[r]||u.smooth,l=r=>{const i=Math.min((r-a)/t,1),u=c(i),d=s+o*u;if(window.scrollTo(0,d),1>i){if("undefined"!=typeof document&&"visible"!==document.visibilityState)return this.activeAnimations.delete(this.animationFrame),void(this.animationFrame=null);const e=performance.now();e-this._lastAnimateRender<this._minFrameMs?(this.animationFrame=n(l),this.animationFrame&&this.activeAnimations.add(this.animationFrame)):(this._lastAnimateRender=e,this.animationFrame=n(l),this.animationFrame&&this.activeAnimations.add(this.animationFrame))}else this.activeAnimations.delete(this.animationFrame),e()};"undefined"!=typeof document&&"visible"!==document.visibilityState||(this._lastAnimateRender=performance.now(),this.animationFrame=n(l),this.animationFrame&&this.activeAnimations.add(this.animationFrame))}))}throttledScroll(e){const t=Date.now();t-this.lastScrollTime<this.scrollThrottle||(this.lastScrollTime=t,n(e))}handleScroll(e,t={}){const{onStart:n,onEnd:r}=t;let i=!1,a=null,s=window.pageYOffset,o=0,c=0,l=0;const u=()=>{const t=Date.now(),u=window.pageYOffset,d=t-l;d>0&&(c=(u-s)/d,o=u>s?1:-1),s=u,l=t,i||(i=!0,n?.()),e({scrollTop:u,scrollDirection:o,scrollVelocity:c,isScrolling:i}),a&&clearTimeout(a),a=setTimeout((()=>{i=!1,r?.()}),150)};return window.addEventListener("scroll",u,{passive:!0}),()=>{window.removeEventListener("scroll",u),a&&clearTimeout(a)}}cancelScroll(){this.animationFrame&&(r(this.animationFrame),this.activeAnimations.delete(this.animationFrame),this.animationFrame=null)}cancelAllAnimations(){this.activeAnimations.forEach((e=>{r(e)})),this.activeAnimations.clear(),this.animationFrame=null}getScrollPosition(){return{x:window.pageXOffset,y:window.pageYOffset,maxY:document.documentElement.scrollHeight-window.innerHeight}}isInViewport(e,t={}){const{threshold:n=0}=t,r=e.getBoundingClientRect(),i=window.innerHeight,a=window.innerWidth;return(Math.min(r.bottom,i)-Math.max(r.top,0))*(Math.min(r.right,a)-Math.max(r.left,0))/(r.height*r.width)>=n}createScrollObserver(e,t={}){const{threshold:n=.1,rootMargin:r="0px",root:i=null}=t;return new IntersectionObserver((t=>{t.forEach((t=>{e(t)}))}),{threshold:n,rootMargin:r,root:i})}cleanup(){this.cancelAllAnimations(),this.scrollTimeout&&(clearTimeout(this.scrollTimeout),this.scrollTimeout=null),this.isScrolling=!1,this.lastScrollTime=0}},m=(e,t)=>d.createScrollObserver(e,t),h=(t={})=>{const{throttle:n=4,enableMomentum:r=!0,enableIntersectionObserver:i=!0,scrollOffset:a=0}=t,[s,o]=e.useState({scrollTop:0,scrollDirection:0,scrollVelocity:0,isScrolling:!1,scrollProgress:0,scrollAcceleration:0,scrollMomentum:0}),[c,l]=e.useState({isInViewport:!1,intersectionRatio:0}),u=e.useRef(null),h=e.useRef(null),f=e.useRef(null),g=e.useRef(0),p=e.useRef(0),b=e.useRef({frameCount:0,lastFrameTime:0,fps:60}),v=e.useCallback((e=>{const{scrollTop:t,scrollDirection:n,scrollVelocity:r,isScrolling:i}=e,a=document.documentElement.scrollHeight-window.innerHeight,s=a>0?t/a*100:0,c=r-p.current;p.current=r;const l=Math.abs(r)>.1?.9*r:0,u=performance.now();b.current.frameCount++,1e3>u-b.current.lastFrameTime||(b.current.fps=b.current.frameCount,b.current.frameCount=0,b.current.lastFrameTime=u),o({scrollTop:t,scrollDirection:n,scrollVelocity:r,isScrolling:i,scrollProgress:Math.min(Math.max(s,0),100),scrollAcceleration:c,scrollMomentum:l}),g.current=t}),[]),w=e.useCallback((e=>{l({isInViewport:e.isIntersecting,intersectionRatio:e.intersectionRatio})}),[]);e.useEffect((()=>(f.current&&f.current(),f.current=((e,t)=>d.handleScroll(e,t))(v,{throttle:n,momentum:r,onStart:()=>o((e=>({...e,isScrolling:!0}))),onEnd:()=>o((e=>({...e,isScrolling:!1})))}),()=>{f.current&&f.current()})),[v,n,r]),e.useEffect((()=>{if(i&&u.current)return h.current=m(w,{threshold:[0,.25,.5,.75,1],rootMargin:"0px"}),h.current.observe(u.current),()=>{h.current&&h.current.disconnect()}}),[w,i]);const y=e.useCallback(((e,t={})=>((e,t)=>d.scrollToElement(e,t))("string"==typeof e?document.querySelector(e):e,{offset:a,...t})),[a]),S=e.useCallback(((e={})=>(e=>d.scrollToTop(e))({offset:a,...e})),[a]),C=e.useCallback(((e={})=>(e=>d.scrollToBottom(e))({offset:a,...e})),[a]),k=e.useCallback((()=>{d.cancelScroll()}),[]),E=e.useCallback((()=>d.getScrollPosition()),[]),M=e.useCallback(((e,t={})=>((e,t)=>d.isInViewport(e,t))(e,t)),[]),F=e.useCallback((()=>({fps:b.current.fps,frameCount:b.current.frameCount,isHighPerformance:b.current.fps>=120,scrollQuality:60>b.current.fps?"choppy":"smooth"})),[]);return{scrollState:s,viewportState:c,scrollRef:u,scrollTo:y,scrollToTop:S,scrollToBottom:C,cancelScroll:k,getScrollPosition:E,isInViewport:M,getPerformanceMetrics:F,smoothScroll:d}},f=(t={})=>{const{threshold:n=.1,rootMargin:r="0px",triggerOnce:i=!1}=t,[a,s]=e.useState(!1),[o,c]=e.useState(!1),l=e.useRef(null),u=e.useRef(null);return e.useEffect((()=>{if(l.current)return u.current=m((e=>{e.isIntersecting?(s(!0),i&&!o&&c(!0)):i||s(!1)}),{threshold:n,rootMargin:r}),u.current.observe(l.current),()=>{u.current&&u.current.disconnect()}}),[n,r,i,o]),{elementRef:l,isVisible:a,hasTriggered:o}};function g(){const t="undefined"!=typeof window,[n,r]=e.useState((()=>{if(!t)return!0;try{return!(!window.matchMedia||!window.matchMedia("(prefers-reduced-motion: reduce)").matches)}catch(e){return!1}}));return e.useEffect((()=>{if(!t||!window.matchMedia)return;const e=window.matchMedia("(prefers-reduced-motion: reduce)"),n=e=>r(!!e.matches);return e.addEventListener?e.addEventListener("change",n):e.addListener&&e.addListener(n),r(!!e.matches),()=>{try{e.removeEventListener?e.removeEventListener("change",n):e.removeListener&&e.removeListener(n)}catch(t){}}}),[t]),n}const p=()=>{const t=e.useRef(!1),n=e.useRef(!1),r=e.useCallback((()=>{if(!n.current)try{return s.getCacheStats().totalEntries>0?(n.current=!0,!0):(n.current=!0,!1)}catch(e){return!1}}),[]),i=e.useCallback((e=>s.isSectionCached(e)),[]),a=e.useCallback((e=>s.getCachedSection(e)),[]),o=e.useCallback(((e,t)=>{s.setCachedSection(e,t)}),[]),c=e.useCallback((()=>s.getCacheStats()),[]),l=e.useCallback((()=>{s.clearPersistentCache(),n.current=!1}),[]),u=e.useCallback((()=>["featured","trending"].every((e=>i(e)))),[i]);return e.useEffect((()=>{if(!t.current)return r(),t.current=!0,()=>{try{s.savePersistentCache()}catch(e){}}}),[r]),{isSectionCached:i,getCachedSection:a,setCachedSection:o,getCacheStats:c,clearCache:l,shouldSkipInitialLoading:u,isInitialized:t.current}},b=36e5,v=100,w=10,y=(t={})=>{const{ttl:n=b,maxSize:r=v,maxMemoryMB:i=w}=t,a=e.useRef(new Map),s=e.useRef([]),[o,c]=e.useState({hits:0,misses:0,evictions:0,totalEntries:0}),l=e.useCallback((e=>{try{return 2*JSON.stringify(e).length}catch{return 0}}),[]),u=e.useCallback((()=>{let e=0;return a.current.forEach((({value:t})=>{e+=l(t)})),e/1048576}),[l]),d=e.useCallback((()=>{if(0===s.current.length)return;const e=s.current.shift();a.current.delete(e),c((e=>({...e,evictions:e.evictions+1,totalEntries:e.totalEntries-1})))}),[]),m=e.useCallback((()=>{const e=Date.now(),t=[];a.current.forEach(((r,i)=>{e-r.timestamp>n&&t.push(i)})),t.forEach((e=>{a.current.delete(e);const t=s.current.indexOf(e);t>-1&&s.current.splice(t,1)})),t.length>0&&c((e=>({...e,totalEntries:e.totalEntries-t.length})))}),[n]),h=e.useCallback((e=>{const t=s.current.indexOf(e);t>-1&&s.current.splice(t,1),s.current.push(e)}),[]),f=e.useCallback((e=>{const t=a.current.get(e);return t?Date.now()-t.timestamp>n?(a.current.delete(e),c((e=>({...e,misses:e.misses+1,totalEntries:e.totalEntries-1}))),null):(h(e),c((e=>({...e,hits:e.hits+1}))),t.value):(c((e=>({...e,misses:e.misses+1}))),null)}),[n,h]),g=e.useCallback(((e,t)=>{for(;a.current.size>=r;)d();for(;u()>=i&&s.current.length>0;)d();a.current.set(e,{value:t,timestamp:Date.now()}),h(e),s.current.includes(e)||c((e=>({...e,totalEntries:e.totalEntries+1})))}),[r,i,d,u,h]),p=e.useCallback((()=>{a.current.clear(),s.current.length=0,c({hits:0,misses:0,evictions:0,totalEntries:0})}),[]),y=e.useCallback((()=>{const e=o.hits+o.misses>0?(o.hits/(o.hits+o.misses)*100).toFixed(2):"0.00";return{...o,hitRate:e+"%",memoryUsageMB:u().toFixed(2)}}),[o,u]);return e.useEffect((()=>{const e=setInterval((()=>{m()}),3e5);return()=>clearInterval(e)}),[m]),{get:f,set:g,clear:p,getStats:y,cleanExpired:m}},S=3,C=1e3,k=1e4,E=10,M=(t={})=>{const{retryAttempts:n=S,retryDelay:r=C,timeout:i=k,rateLimit:a=E}=t,s=e.useRef(new Map),o=e.useRef([]),[c,l]=e.useState({total:0,successful:0,failed:0,deduplicated:0,rateLimited:0}),u=e.useCallback((()=>{const e=Date.now()-1e3;return o.current=o.current.filter((t=>t>e)),o.current.length>=a}),[a]),d=e.useCallback((()=>{o.current.push(Date.now())}),[]),m=e.useCallback((async()=>{if(!u())return;const e=o.current[0],t=1e3-(Date.now()-e);t>0&&await new Promise((e=>setTimeout(e,t)))}),[u]),h=e.useCallback((async e=>Promise.race([e(),new Promise(((e,t)=>setTimeout((()=>t(Error("Request timeout"))),i)))])),[i]),f=e.useCallback((async(e,t=0)=>{try{return await h(e)}catch(i){if(n>t){const n=r*Math.pow(2,t);return await new Promise((e=>setTimeout(e,n))),f(e,t+1)}throw i}}),[n,r,h]),g=e.useCallback((async(e,t)=>{if(s.current.has(e))return l((e=>({...e,deduplicated:e.deduplicated+1}))),s.current.get(e);u()&&(l((e=>({...e,rateLimited:e.rateLimited+1}))),await m());const n=(async()=>{try{d(),l((e=>({...e,total:e.total+1})));const e=await f(t);return l((e=>({...e,successful:e.successful+1}))),e}catch(n){throw l((e=>({...e,failed:e.failed+1}))),n}finally{s.current.delete(e)}})();return s.current.set(e,n),n}),[u,m,d,f]),p=e.useCallback((async e=>(await Promise.allSettled(e.map((({key:e,requestFn:t})=>g(e,t))))).map(((t,n)=>({key:e[n].key,success:"fulfilled"===t.status,data:"fulfilled"===t.status?t.value:null,error:"rejected"===t.status?t.reason:null})))),[g]),b=e.useCallback((()=>{const e=c.total>0?(c.successful/c.total*100).toFixed(2):"0.00";return{...c,successRate:e+"%",deduplicationRate:c.total>0?(c.deduplicated/(c.total+c.deduplicated)*100).toFixed(2)+"%":"0.00%"}}),[c]),v=e.useCallback((()=>{s.current.clear()}),[]);return{optimizedFetch:g,batchFetch:p,getStats:b,clearPending:v}},F=50,T=(n={})=>{const{batchDelay:r=F}=n,i=e.useRef([]),a=e.useRef(null),s=e.useCallback((()=>{0!==i.current.length&&(t.unstable_batchedUpdates((()=>{i.current.forEach((e=>{try{e()}catch(t){}}))})),i.current=[])}),[]);return{queueUpdate:e.useCallback((e=>{i.current.push(e),a.current&&clearTimeout(a.current),a.current=setTimeout((()=>{s()}),r)}),[r,s]),flushUpdates:e.useCallback((()=>{a.current&&clearTimeout(a.current),s()}),[s])}},x=2147483647;class A{static instance=null;static getInstance(){return A.instance||(A.instance=new A),A.instance}constructor(){if(A.instance)return A.instance;this.portals=new Map,this.stack=[],this.baseZIndex=x,this.nextZIndex=x,this.debugMode=!1,this.mutationObservers=new Map,A.instance=this}createPortal(e,n={}){const{zIndex:r=this.getNextZIndex(),accessibility:i=!0,stacking:a=!0,cleanup:s=!0,debug:o=this.debugMode}=n;if("undefined"==typeof window)return{container:null,portal:null,cleanup:()=>{}};let c=document.getElementById(e);return c?(c.style.zIndex=r.toString(),i&&c.setAttribute("aria-hidden","false")):(c=document.createElement("div"),c.id=e,c.className="portal-container "+e,Object.assign(c.style,{position:"fixed",inset:"0",zIndex:r.toString(),pointerEvents:"none",contain:"layout style paint",isolation:"isolate"}),i&&(c.setAttribute("role","dialog"),c.setAttribute("aria-modal","true"),c.setAttribute("tabindex","-1"),c.setAttribute("aria-hidden","false")),document.body.appendChild(c)),this.portals.set(e,{container:c,zIndex:r,options:n,createdAt:Date.now(),isActive:!0}),a&&this.addToStack(e,r),{container:c,portal:e=>t.createPortal(e,c),cleanup:()=>{this.removePortal(e,s)},zIndex:r,id:e}}removePortal(e,t=!0){const n=this.portals.get(e);if(!n)return;const{container:r}=n,i=this.mutationObservers.get(e);if(i&&(i.disconnect(),this.mutationObservers.delete(e)),t&&r?.parentNode)try{if(0===r.childElementCount)r.remove(),this.debugMode;else{const t=new MutationObserver((()=>{if(0===r.childElementCount){t.disconnect(),this.mutationObservers.delete(e);try{r.remove(),this.debugMode}catch(n){}}}));t.observe(r,{childList:!0}),this.mutationObservers.set(e,t),setTimeout((()=>{if(this.mutationObservers.has(e)&&(t.disconnect(),this.mutationObservers.delete(e),r.parentNode&&0===r.childElementCount))try{r.remove()}catch(n){}}),1e3)}}catch(a){}this.portals.delete(e),this.removeFromStack(e),n.isActive=!1}addToStack(e,t){this.stack.push({id:e,zIndex:t}),this.stack.sort(((e,t)=>t.zIndex-e.zIndex))}removeFromStack(e){this.stack=this.stack.filter((t=>t.id!==e))}getNextZIndex(){return++this.nextZIndex}getStackInfo(){return{activePortals:Array.from(this.portals.entries()).map((([e,t])=>({id:e,zIndex:t.zIndex,isActive:t.isActive,createdAt:t.createdAt}))),stack:[...this.stack]}}focusPortal(e){const t=this.portals.get(e);t?.container&&t.container.focus()}cleanupAll(){this.mutationObservers.forEach((e=>e.disconnect())),this.mutationObservers.clear(),Array.from(this.portals.keys()).forEach((e=>this.removePortal(e,!0))),this.portals.clear(),this.stack=[]}}A.getInstance();const R=(n,r={})=>{const i=e.useRef(null),a=e.useRef(!0),s=e.useRef(null),c=e.useRef(null),l=e.useRef(null),u=e.useRef(!1),{zIndex:d,accessibility:m=!0,stacking:h=!0,cleanup:f=!0,debug:g=!1,priority:p="normal",group:b="default",animationType:v="modal",analytics:w=!0,statePersistence:y=!1,theme:S=null,onFocus:C=null,onBlur:k=null,onEscape:E=null}=r;e.useMemo((()=>{if("undefined"==typeof window||u.current)return;const e=o.createPortal(n,{zIndex:d,accessibility:m,stacking:h,cleanup:f,debug:g,priority:p,group:b,onFocus:C,onBlur:k,onEscape:E});l.current=e.container,i.current=e.cleanup,u.current=!0}),[]),e.useEffect((()=>{if(a.current=!0,"undefined"!=typeof window){if(!l.current&&!u.current){const e=o.createPortal(n,{zIndex:d,accessibility:m,stacking:h,cleanup:f,debug:g,priority:p,group:b,onFocus:C,onBlur:k,onEscape:E});if(!a.current)return;l.current=e.container,i.current=e.cleanup,u.current=!0}if(w&&o.analyticsService&&(s.current=o.analyticsService,s.current.trackPortalCreated(n,{type:v,priority:p,group:b,theme:S})),y&&o.stateService&&(c.current=o.stateService,c.current.loadPortalState(n)),m&&o.accessibilityService){const e=o.setupPortalAccessibility(n,{role:"dialog",ariaLabel:"Portal "+n,modal:!0});if("function"==typeof e){const t=i.current;i.current=()=>{try{e()}catch(n){}"function"==typeof t&&t()}}}return()=>{if(a.current=!1,s.current)try{s.current.trackPortalDestroyed(n,"component_unmount")}catch(e){}if(y&&c.current)try{c.current.savePortalState(n,{isOpen:!1,destroyedAt:Date.now()})}catch(e){}if(i.current)try{i.current()}catch(e){}finally{i.current=null}s.current=null,c.current=null,l.current=null,u.current=!1}}}),[n]);const M=e.useCallback((e=>{const r=l.current;if(!r||!a.current)return null;if(s.current)try{s.current.trackPortalEvent(n,"content_created",{hasContent:!!e,contentType:typeof e})}catch(i){}return t.createPortal(e,r)}),[n]),F=e.useCallback((()=>{const e=l.current;if(e&&(e.focus(),s.current))try{s.current.trackUserInteraction("focusEvents",n,{element:"portal-container"})}catch(t){}}),[n]),T=e.useCallback((e=>{c.current&&c.current.savePortalState(n,e)}),[n]),x=e.useCallback((()=>c.current?c.current.loadPortalState(n):null),[n]),A=e.useCallback(((e,t={})=>{if(s.current)try{s.current.trackUserInteraction(e,n,t)}catch(r){}}),[n]),R=e.useCallback((e=>{if(o.animationService)try{o.coordinateAnimations([n],e)}catch(t){}}),[n]),P=e.useCallback((()=>o.getStackInfo()),[]),I=e.useCallback((()=>o.getPerformanceMetrics()),[]);return{container:l.current,createPortal:M,focusPortal:F,savePortalState:T,loadPortalState:x,trackInteraction:A,coordinateAnimation:R,getPortalInfo:P,getPerformanceMetrics:I,isReady:"undefined"!=typeof window&&!!l.current,zIndex:l.current?.style?.zIndex,id:n,analytics:s.current,state:c.current}},P={netflix:"#E50914",prime:"#00A8E1",hulu:"#1CE783",hbo:"#221f1f",disney:"#113CCF",apple:"#000000",popular:"#fbbf24",top_rated:"#60a5fa",trending:"#f472b6",upcoming:"#f87171",paramount:"#0055A4",peacock:"#FFC72C",starz:"#231F20",discovery:"#00AEEF",crunchyroll:"#F47521",criterion:"#B6A179"},I={netflix:"linear-gradient(90deg, #E50914 0%, #B0060F 100%)",prime:"linear-gradient(90deg, #00A8E1 0%, #005377 100%)",hulu:"linear-gradient(90deg, #1CE783 0%, #0B5C2E 100%)",hbo:"linear-gradient(90deg, #221f1f 0%, #6e6e6e 100%)",disney:"linear-gradient(90deg, #113CCF 0%, #0a1a3c 100%)",apple:"linear-gradient(90deg, #000000 0%, #434343 100%)",popular:"linear-gradient(90deg, #fbbf24 0%, #f59e42 100%)",top_rated:"linear-gradient(90deg, #60a5fa 0%, #2563eb 100%)",trending:"linear-gradient(90deg, #f472b6 0%, #be185d 100%)",upcoming:"linear-gradient(90deg, #f87171 0%, #b91c1c 100%)",paramount:"linear-gradient(90deg, #0055A4 0%, #00B4D8 100%)",peacock:"linear-gradient(90deg, #FFC72C 0%, #FFD700 100%)",starz:"linear-gradient(90deg, #231F20 0%, #434343 100%)",discovery:"linear-gradient(90deg, #00AEEF 0%, #005377 100%)",crunchyroll:"linear-gradient(90deg, #F47521 0%, #FFB347 100%)",criterion:"linear-gradient(90deg, #B6A179 0%, #E5D3B3 100%)"},O=(t,i={})=>{const[a,s]=e.useState({}),[o,c]=e.useState(!1),[l,u]=e.useState(null),[d,m]=e.useState(0),h=e.useRef(null),f=e.useRef(null);return e.useEffect((()=>{u(t)}),[t]),e.useEffect((()=>{let e;return c(!0),s({}),m(0),performance.now(),f.current=n((function t(r){e||(e=r);const i=Math.min((r-e)/500,1);if(m(i),1>i){if("undefined"!=typeof document&&"visible"!==document.visibilityState)return void(f.current=null);f.current=n(t)}})),t&&P[t]&&s((e=>({...e,[t]:P[t]}))),h.current&&clearTimeout(h.current),h.current=setTimeout((()=>{c(!1),m(1)}),500),()=>{h.current&&clearTimeout(h.current),f.current&&r(f.current)}}),[t]),{getIconColor:e.useCallback(((e,{gradient:n=!1,animated:r=!1}={})=>e===t&&P[e]?n&&I[e]?I[e]:r&&1>d?P[e]+Math.floor(255*d).toString(16).padStart(2,"0"):P[e]:n&&I[e]?I[e]:a[e]||"currentColor"),[t,a,d]),getIconShadow:e.useCallback(((e,{animated:n=!1}={})=>{if(e===t&&P[e]){if(n&&1>d){const t=Math.floor(85*d).toString(16).padStart(2,"0");return`0 2px 8px 0 ${P[e]}${t}`}return`0 0 0 0 ${r=P[e]}00, 0 2px 8px 0 ${r}55, 0 0 16px 2px ${r}33`}var r;return"none"}),[t,d]),isTransitioning:o,getRubberBandTransition:e.useCallback((()=>({type:"spring",stiffness:i.stiffness||500,damping:i.damping||22,mass:i.mass||.9,duration:i.duration||.55,restDelta:.001,restSpeed:.001,ease:[.25,.46,.45,.94]})),[i.stiffness,i.damping,i.mass,i.duration]),getBackgroundTransition:e.useCallback((()=>({type:"spring",stiffness:i.bgStiffness||320,damping:i.bgDamping||28,mass:i.bgMass||1.1,duration:i.bgDuration||.42,restDelta:.001,restSpeed:.001,ease:[.25,.46,.45,.94]})),[i.bgStiffness,i.bgDamping,i.bgMass,i.bgDuration]),getRubberBandVariants:e.useCallback((()=>({initial:{scale:1,scaleX:1,scaleY:1,opacity:.8,filter:"brightness(0.95)",boxShadow:"none"},animate:{scale:[1,1.22,.98,1],scaleX:[1,1.08,.98,1],scaleY:[1,.7,1.05,1],opacity:[.8,1,1,1],filter:["brightness(0.95)","brightness(1.15) drop-shadow(0 2px 8px #fff2)","brightness(1.05)","brightness(1)"],boxShadow:["none","0 2px 8px #fff2","0 4px 16px #fff4","none"],transition:{scale:{duration:.55,times:[0,.4,.7,1],ease:[.25,.46,.45,.94]},scaleX:{duration:.55,times:[0,.4,.7,1],ease:[.25,.46,.45,.94]},scaleY:{duration:.55,times:[0,.4,.7,1],ease:[.25,.46,.45,.94]},opacity:{duration:.3,times:[0,.4,1]},filter:{duration:.55,times:[0,.4,.7,1]},boxShadow:{duration:.55,times:[0,.4,.7,1]}}},exit:{scale:1,scaleX:1,scaleY:1,opacity:.8,filter:"brightness(0.95)",boxShadow:"none"}})),[]),gradients:I,colors:P,lastCategory:l,transitionProgress:d}},D=()=>{const{continueWatching:t}=i(),{watchlist:n}=a(),[r,s]=e.useState(null),[o,l]=e.useState(!0),[u,d]=e.useState(null),m=e.useMemo((()=>t&&Array.isArray(t)?t.reduce(((e,t)=>(e["movie"===t.type?"movie_"+t.id:`tv_${t.id}_${t.season}_${t.episode}`]=t,e)),{}):{}),[t]);e.useEffect((()=>{if(t&&n){l(!0);try{const e=c.getComprehensiveStats({viewingProgress:m,watchlist:n});s(e)}catch(e){s(null),d(e)}finally{l(!1)}}}),[m,n]);const h=e.useMemo((()=>r?{...r,achievements:c.getAchievementBadgesWithProgress(r),achievementStats:c.getAchievementStats(c.getAchievementBadgesWithProgress(r))}:null),[r]),f=e.useCallback((()=>h?[{label:"Watch Time",value:h.watchTime.formatted,icon:"ClockIcon"},{label:"Completed",value:h.content.completed,icon:"CheckCircleIcon"},{label:"Watchlist",value:h.reviews.written,icon:"StarIcon"},{label:"Streak",value:h.preferences.viewingStreak,icon:"FireIcon"},{label:"Rating",value:h.reviews.averageRating.toFixed(1),icon:"StarIcon"}]:[]),[h]),g=e.useCallback((()=>h&&h.achievements||[]),[h]),p=e.useCallback((()=>h&&h.achievementStats||null),[h]),b=e.useCallback((()=>h?.achievements?c.getRecentlyUnlocked(h.achievements,5):[]),[h]),v=e.useCallback((()=>h?.achievements?c.getNextAchievements(h.achievements,3):[]),[h]),w=e.useCallback((e=>h?.achievements?h.achievements.filter((t=>t.category===e)):[]),[h]),y=e.useCallback((e=>h?.achievements?h.achievements.filter((t=>t.rarity===e)):[]),[h]);return{analytics:h,isLoading:o,error:u,getQuickStats:f,getProgressStats:()=>h?{inProgress:h.content.inProgress,completionRate:h.completionRate,averageRating:h.reviews.averageRating}:null,getAchievements:g,getAchievementStats:p,getRecentlyUnlocked:b,getNextAchievements:v,getAchievementsByCategory:w,getAchievementsByRarity:y,getWatchTimeBreakdown:()=>h?{movies:h.watchTime.movies,tv:h.watchTime.tv,total:h.watchTime.total,formatted:h.watchTime.formatted}:null,getGenreInsights:()=>h?{favoriteGenres:h.preferences.favoriteGenres,genreCount:h.preferences.favoriteGenres.length}:null,viewingProgress:m,watchlist:n,analyticsService:c}},B=(t,n,r={})=>{const{autoStart:a=!0,updateInterval:s=1e4,urlCheckInterval:o=5e3,minProgressChange:c=1,enableLocalStorageCheck:u=!0,enableUrlMonitoring:d=!0,enablePostMessage:m=!0}=r,{startWatchingMovie:h,startWatchingEpisode:f,updateProgress:g}=i(),p=e.useRef(0),b=e.useRef(0),v=e.useRef(!1),w=e.useRef(null),y=e.useRef(null),S=e.useRef(null),C=e.useRef(`progress-${t?.id}-${Date.now()}`),k=e.useCallback((()=>{t&&n?.current&&!v.current&&(v.current=!0,"movie"===t.type?h(t):"tv"===t.type&&t.season&&t.episode&&f(t,t.season,t.episode),m&&(S.current=C.current,l.addListener(S.current,M)),d&&(w.current=l.startUrlMonitoring(n.current,F,o)),u&&setTimeout((()=>{const e=l.checkLocalStorageForProgress();e&&M(e)}),2e3),y.current=setInterval((()=>{n.current&&l.requestProgressFromIframe(n.current)}),s))}),[t,n,h,f,m,d,u,s,o]),E=e.useCallback((()=>{v.current&&(v.current=!1,S.current&&(l.removeListener(S.current),S.current=null),w.current&&(l.stopUrlMonitoring(w.current),w.current=null),y.current&&(clearInterval(y.current),y.current=null))}),[]),M=e.useCallback((e=>{if(!e||!t)return;const{progress:n,currentTime:r,duration:i}=e;Math.abs(n-p.current)<c||(p.current=n,b.current=i||0,"movie"===t.type?g(t.id,"movie",null,null,n):"tv"===t.type&&g(t.id,"tv",t.season,t.episode,n))}),[t,g,c]),F=e.useCallback((e=>{if(!e||!t)return;const{progress:n,timestamp:r}=e;Math.abs(n-p.current)<c||(p.current=n,"movie"===t.type?g(t.id,"movie",null,null,n):"tv"===t.type&&g(t.id,"tv",t.season,t.episode,n))}),[t,g,c]),T=e.useCallback((()=>({progress:p.current,duration:b.current,isTracking:v.current})),[]),x=e.useCallback(((e,n=0)=>{t&&(p.current=Math.max(0,Math.min(100,e)),b.current=n,"movie"===t.type?g(t.id,"movie",null,null,p.current):"tv"===t.type&&g(t.id,"tv",t.season,t.episode,p.current))}),[t,g]),A=e.useCallback((()=>v.current),[]);return e.useEffect((()=>{if(a&&t&&n?.current){const e=setTimeout((()=>{k()}),1e3);return()=>clearTimeout(e)}}),[t,n,a,k]),e.useEffect((()=>()=>{E()}),[E]),{startTracking:k,stopTracking:E,getCurrentProgress:T,setProgress:x,isTracking:A(),progress:p.current,duration:b.current}};export{D as a,B as b,g as c,p as d,h as e,f,y as g,M as h,T as i,O as j,R as u};
