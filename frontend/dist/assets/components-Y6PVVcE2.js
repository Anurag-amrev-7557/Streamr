const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["/assets/services-H6xH4ufj.js","/assets/realtime-vendor-BdkvcogO.js","/assets/vendor-BZ_TBasQ.js","/assets/react-vendor-CEpGHdZS.js","/assets/vendor-B_l4pjL9.css","/assets/utils-vendor-CSskXGvD.js","/assets/pages-C-U6PHgK.js","/assets/hooks-D5O4AvRI.js","/assets/animation-vendor-CorsN15j.js"])))=>i.map(i=>d[i]);
import{r as e,j as t,R as s,c as a,S as r,a as i,b as n,F as o,d as l,e as c,f as d,g as u,u as h,h as m,L as p,i as x,k as g,l as f,m as w,n as b,o as v,p as y,q as j,s as N,t as k,v as C,w as S,x as _,y as L,z as T,A as M,B as E,C as I,V as D,D as R,E as z,G as W,H as A,I as O,J as P,K as F,M as B,N as $,O as H,P as V,Q as U,T as Y,U as q,W as G,X as J,Y as X,Z as K}from"./react-vendor-CEpGHdZS.js";import{m as Q,A as Z,u as ee,a as te,b as se}from"./animation-vendor-CorsN15j.js";import{u as ae,a as re,b as ie,c as ne,d as oe}from"./hooks-D5O4AvRI.js";import{X as le,Y as ce,Z as de,_ as ue,$ as he,a0 as me,a1 as pe,a2 as xe}from"./vendor-BZ_TBasQ.js";import{u as ge,s as fe,a as we,b as be,d as ve,g as ye,c as je,e as Ne,D as ke,f as Ce,p as Se,h as _e,i as Le,j as Te,n as Me,k as Ee,l as Ie,m as De,o as Re,q as ze,r as We,t as Ae,v as Oe,w as Pe,x as Fe,y as Be,z as $e,A as He,B as Ve,C as Ue,E as Ye,F as qe,G as Ge,H as Je,I as Xe,J as Ke}from"./services-H6xH4ufj.js";import{l as Qe}from"./utils-vendor-CSskXGvD.js";const Ze={},et=function(e,t,s){let a=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map((e=>Promise.resolve(e).then((e=>({status:"fulfilled",value:e})),(e=>({status:"rejected",reason:e}))))))};const r=document.getElementsByTagName("link"),i=document.querySelector("meta[property=csp-nonce]"),n=i?.nonce||i?.getAttribute("nonce");a=e(t.map((e=>{if(e=function(e,t){return new URL(e,t).href}(e,s),e in Ze)return;Ze[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(s)for(let s=r.length-1;s>=0;s--){const a=r[s];if(a.href===e&&(!t||"stylesheet"===a.rel))return}else if(document.querySelector(`link[href="${e}"]${a}`))return;const i=document.createElement("link");return i.rel=t?"stylesheet":"modulepreload",t||(i.as="script"),i.crossOrigin="",i.href=e,n&&i.setAttribute("nonce",n),document.head.appendChild(i),t?new Promise(((t,s)=>{i.addEventListener("load",t),i.addEventListener("error",(()=>s(Error("Unable to preload CSS for "+e))))})):void 0})))}function r(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return a.then((t=>{for(const e of t||[])"rejected"===e.status&&r(e.reason);return e().catch(r)}))},tt={mode:"deployed",local:"http://localhost:3001/api",deployed:"https://streamr-jjj9.onrender.com/api",localSocket:"http://localhost:3001",deployedSocket:"https://streamr-jjj9.onrender.com",apiVersion:"v1",env:"production"},st=()=>"https://streamr-jjj9.onrender.com/api",at=()=>tt[tt.mode+"Socket"],rt=()=>tt[tt.mode].replace(/\/api\/?$/,""),it=e=>("local"===e||"deployed"===e)&&(tt.mode=e,!0),nt=()=>tt.mode,ot=(e="")=>{const t=tt.apiVersion;let s="https://streamr-jjj9.onrender.com/api";return s.endsWith("/"+t)||e.startsWith(t)||(s=`${s.replace(/\/$/,"")}/${t}`),`${s}${e.startsWith("/")?"":"/"}${e}`},lt={initial:!1,featured:!1,trending:!1,popular:!1,topRated:!1,upcoming:!1,action:!1,comedy:!1,drama:!1,horror:!1,sciFi:!1,documentary:!1,family:!1,animation:!1,awardWinning:!1,latest:!1,popularTV:!1,topRatedTV:!1,airingToday:!1,nowPlaying:!1},ct={LOW:"low",NORMAL:"normal",HIGH:"high",CRITICAL:"critical"},dt=e.createContext(null),ut=({children:s,defaultTimeout:a=3e4})=>{const[r,i]=e.useState(lt),[n,o]=e.useState({}),[l,c]=e.useState([]),[d,u]=e.useState(!1),[h,m]=e.useState(""),[p,x]=e.useState(0),[g,f]=e.useState("minimalist"),w=e.useRef(null),b=e.useRef([]);e.useEffect((()=>{b.current=l}),[l]);const v=e.useCallback((e=>`${e}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`),[]),y=e.useCallback(((e,t)=>{const s=e/t;return.5>s?"excellent":.8>s?"good":"slow"}),[]),j=e.useCallback((e=>"string"==typeof e&&""!==e.trim()),[]),N=e.useCallback(((e={})=>{const{clearHistory:t=!1,preserveSpecificStates:s=[],resetToInitial:a=!0}=e;a&&(i((e=>{const t={...lt};return s.forEach((s=>{void 0!==e[s]&&(t[s]=e[s])})),t})),o((e=>{const t={};return s.forEach((s=>{void 0!==e[s]&&(t[s]=e[s])})),t}))),t&&(c([]),b.current=[])}),[]),k=e.useCallback(((e,t,s={})=>{if(!j(e))return;const{priority:r=ct.NORMAL,timeout:n=a,metadata:l={}}=s,d=Date.now(),u=v(e);if(i((s=>({...s,[e]:t}))),o((s=>({...s,[e]:t?{startTime:d,operationId:u,priority:r,timeout:n,metadata:l}:null}))),t){const t={key:e,startTime:d,operationId:u,priority:r,metadata:l,status:"started"};c((e=>[...e,t])),b.current=[...b.current,t]}else c((t=>t.map((t=>t.key!==e||t.endTime?t:{...t,endTime:d,duration:d-t.startTime,status:"completed",performance:{duration:d-t.startTime,isTimeout:d-t.startTime>n,efficiency:y(d-t.startTime,n)}}))));if(t&&n>3e4){const e=setTimeout((()=>{i((e=>e))}),n);return()=>clearTimeout(e)}}),[a,j,v,y]),C=e.useCallback(((e,t={})=>{if(!e||"object"!=typeof e)return;const s=Date.now(),{operationId:r=`batch_${s}_${Math.random().toString(36).substr(2,9)}`,priority:n=ct.NORMAL,metadata:l={},timeout:d=a}=t,u=Object.entries(e).reduce(((e,[t,s])=>(j(t)&&"boolean"==typeof s&&(e[t]=s),e)),{});if(0===Object.keys(u).length)return;i((e=>({...e,...u}))),o((e=>({...e,...Object.entries(u).reduce(((e,[t,a])=>({...e,[t]:a?{startTime:s,operationId:r,priority:n,timeout:d,metadata:{...l,batchSize:Object.keys(u).length,batchOperation:!0,individualKey:t}}:null})),{})})));const h=Object.entries(u).map((([e,t])=>({key:e,startTime:t?s:null,endTime:t?null:s,operationId:r,priority:n,metadata:{...l,batchSize:Object.keys(u).length,batchOperation:!0,individualKey:e},status:t?"started":"completed",duration:t?null:0})));c((e=>[...e,...h]))}),[a,j]),S=e.useCallback(((e="",t=0,s="minimalist")=>{u(!0),m(e),x(Math.min(100,Math.max(0,t))),f(s)}),[]),_=e.useCallback((()=>{u(!1),m(""),x(0),f("minimalist")}),[]),L=e.useCallback((e=>{x(Math.min(100,Math.max(0,e)))}),[]),T=e.useCallback((e=>{m(e)}),[]);e.useEffect((()=>{const e=(()=>{const e=Object.keys(n).length;return 0===e?5e3:e>10?500:1e3})();return w.current=setInterval((()=>{const e=Date.now(),t=[];Object.entries(n).forEach((([s,r])=>{r?.startTime&&e-r.startTime>a&&t.push({key:s,duration:e-r.startTime,operationId:r.operationId,priority:r.priority})})),t.length>0&&t.forEach((({key:t,duration:s,operationId:r,priority:i})=>{try{k(t,!1),c((o=>[...o,{key:t,startTime:n[t]?.startTime||e,endTime:e,operationId:r||"timeout",priority:i||ct.NORMAL,metadata:{timeoutDuration:a,actualDuration:s,recoveryAttempted:!0},status:"timeout",duration:s}]))}catch(o){}}))}),e),()=>{w.current&&clearInterval(w.current)}}),[n,a,k]);const M=e.useMemo((()=>Object.values(r).some(Boolean)),[r]),E=e.useCallback(((e,t={})=>{const{includeActive:s=!0,averageLastN:a=null,minDuration:i=0,maxDuration:o=1/0}=t,l=b.current.filter((t=>t.key===e));if(0===l.length)return 0;const c=s&&r[e]&&n[e]?.startTime?Date.now()-n[e].startTime:0,d=l.filter((e=>e.endTime&&e.duration>=i&&e.duration<=o)).map((e=>e.duration));if(a&&a>0){const e=d.slice(-a);if(0===e.length)return c;const t=e.reduce(((e,t)=>e+t),0)/e.length;return s?Math.max(t,c):t}const u=l[l.length-1];return u?.duration||c}),[r,n]),I={loadingStates:r,setLoadingState:k,setBatchLoadingStates:C,resetLoadingStates:N,isAnyLoading:M,getLoadingDuration:E,loadingHistory:l,setLoading:k,clearLoading:e.useCallback(((e,t={})=>{k(e,!1,t)}),[k]),getLoadingStats:e.useCallback((e=>{const t=b.current.filter((t=>t.key===e)),s=t.length,a=t.filter((e=>"completed"===e.status)).length,i=t.filter((e=>"timeout"===e.status)).length,n=s>0?t.reduce(((e,t)=>e+(t.duration||0)),0)/s:0,o=s>0?a/s*100:0;return{totalLoads:s,successfulLoads:a,failedLoads:i,timeoutLoads:i,averageDuration:Math.round(n),successRate:Math.round(100*o)/100,lastLoadTime:t.length>0?t[t.length-1].startTime:null,isCurrentlyLoading:r[e]||!1}}),[r]),setLoadingForKeys:e.useCallback(((e,t=!0,s={})=>{const a={};e.forEach((e=>{j(e)&&(a[e]=t)})),C(a,s)}),[C,j]),getLoadingKeys:e.useCallback((()=>Object.keys(r).filter((e=>r[e]))),[r]),getLoadingCount:e.useCallback((()=>Object.values(r).filter(Boolean).length),[r]),getPerformanceMetrics:e.useCallback((()=>{const e=b.current.filter((e=>e.duration&&e.duration>0)).map((e=>e.duration));if(0===e.length)return null;const t=[...e].sort(((e,t)=>e-t)),s=t[Math.floor(t.length/2)],a=t[Math.floor(.95*t.length)]||t[t.length-1],r=t[Math.floor(.99*t.length)]||t[t.length-1],i=e.reduce(((e,t)=>e+t),0);return{totalRequests:e.length,averageDuration:Math.round(i/e.length),medianDuration:Math.round(s),p95Duration:Math.round(a),p99Duration:Math.round(r),minDuration:Math.round(Math.min(...e)),maxDuration:Math.round(Math.max(...e))}}),[]),fullPageLoader:d,fullPageLoaderText:h,fullPageLoaderProgress:p,fullPageLoaderVariant:g,showFullPageLoader:S,hideFullPageLoader:_,updateFullPageLoaderProgress:L,updateFullPageLoaderText:T};return t.jsx(dt.Provider,{value:I,children:s})},ht=()=>{const t=e.useContext(dt);if(!t)throw Error("useLoading must be used within a LoadingProvider. Wrap your component tree with <LoadingProvider>.");return t},mt=(e,t=0)=>{if(null==e||""===e)return t;const s=parseFloat(e);return isNaN(s)?t:0>s?0:s>10?10:Math.round(10*s)/10},pt=(e,t=0)=>mt(e,t).toFixed(1),xt=e.createContext(null),gt=()=>{const t=e.useContext(xt);if(!t)throw Error("useUndo must be used within an UndoProvider");return t},ft=()=>e.useContext(xt),wt=({children:s})=>{const[a,r]=e.useState({continueWatching:[],watchlist:[]}),[i,n]=e.useState(new Map),[o,l]=e.useState([]),[c,d]=e.useState([]),u=e.useRef(a),h=e.useRef(i);e.useEffect((()=>{u.current=a}),[a]),e.useEffect((()=>{h.current=i}),[i]);const m=e.useCallback(((e,t)=>{if(!t)return"unknown";const s=(t.id??t._id??"unknown")+"";if("continueWatching"===e){const e=(t.type??"unknown")+"",a=(t.season??"movie")+"",r=(t.episode??"movie")+"";return`${encodeURIComponent(s)}-${encodeURIComponent(e)}-${encodeURIComponent(a)}-${encodeURIComponent(r)}`}return encodeURIComponent(s)}),[]);e.useEffect((()=>{const e=()=>{const e=Date.now(),t=[];h.current.forEach(((s,a)=>{s.expiresAt>e||t.push(a)})),t.length>0&&(r((e=>{const s={...e};return t.forEach((e=>{const[t,a]=e.split("|");"continueWatching"===t?s.continueWatching=s.continueWatching.filter((e=>m("continueWatching",e)!==a)):"watchlist"===t&&(s.watchlist=s.watchlist.filter((e=>m("watchlist",e)!==a)))})),s})),t.forEach((e=>{h.current.delete(e)})),n(new Map(h.current)))},t=setInterval(e,1e3),s=()=>{"visible"===document.visibilityState&&e()};return document.addEventListener("visibilitychange",s,{passive:!0}),window.addEventListener("focus",e,{passive:!0}),()=>{clearInterval(t),document.removeEventListener("visibilitychange",s),window.removeEventListener("focus",e);try{h.current.forEach((e=>{e?.timeoutId&&clearTimeout(e.timeoutId)}))}catch(a){}}}),[m]);const p=e.useCallback(((e,t,s=5e3)=>{const a=Date.now(),i=a+s,o=m(e,t),c=`${e}|${o}`;return r((s=>{const r=(s[e]||[]).filter((t=>m(e,t)!==o));return{...s,[e]:[...r,{...t,deletedAt:a,expiresAt:i}]}})),l((s=>[...s,{type:"delete",section:e,item:t,timestamp:a}])),d([]),n((t=>{const a=new Map(t),l=a.get(c);return l?.timeoutId&&clearTimeout(l.timeoutId),a.set(c,{expiresAt:i,timeoutId:setTimeout((()=>{r((t=>({...t,[e]:t[e].filter((t=>m(e,t)!==o))}))),n((e=>{const t=new Map(e);return t.delete(c),t}))}),s)}),a})),o}),[m]),x=e.useCallback(((e,t)=>{const s=m(e,t),a=`${e}|${s}`,i=h.current.get(a);return i?.timeoutId&&clearTimeout(i.timeoutId),r((t=>({...t,[e]:t[e].filter((t=>m(e,t)!==s))}))),n((e=>{const t=new Map(e);return t.delete(a),t})),l((s=>[...s,{type:"undo",section:e,item:t,timestamp:Date.now()}])),d([]),t}),[m]),g=e.useCallback((()=>{if(0===c.length)return;const e=c[c.length-1];"delete"===e.type&&(p(e.section,e.item),d((e=>e.slice(0,-1))))}),[c,p]),f=e.useCallback((()=>{if(0===o.length)return;const e=o[o.length-1];"delete"===e.type?(x(e.section,e.item),d((t=>[...t,e]))):"undo"===e.type&&(p(e.section,e.item),d((t=>[...t,e]))),l((e=>e.slice(0,-1)))}),[o,x,p]),w=e.useCallback(((e,t)=>{const s=m(e,t);return"continueWatching"===e?a.continueWatching.some((e=>m("continueWatching",e)===s)):a.watchlist.some((e=>m("watchlist",e)===s))}),[a,m]),b=e.useCallback((e=>a[e]||[]),[a]),v=e.useCallback((e=>{const t=[];h.current.forEach(((s,a)=>{a.startsWith(e+"|")&&t.push(a)})),t.forEach((e=>{const t=h.current.get(e);t?.timeoutId&&clearTimeout(t.timeoutId)})),n((e=>{const s=new Map(e);return t.forEach((e=>s.delete(e))),s})),r((t=>({...t,[e]:[]})))}),[]),y=e.useCallback(((e,t)=>{const s=m(e,t);let r;return r="continueWatching"===e?a.continueWatching.find((e=>m("continueWatching",e)===s)):a.watchlist.find((e=>m("watchlist",e)===s)),r?Math.max(0,Math.ceil((r.expiresAt-Date.now())/1e3)):0}),[a,m]),j=e.useCallback(((e,t)=>{const s=m(e,t);let r;return r="continueWatching"===e?a.continueWatching.find((e=>m("continueWatching",e)===s)):a.watchlist.find((e=>m("watchlist",e)===s)),r?{remainingMs:Math.max(0,r.expiresAt-Date.now()),totalMs:Math.max(0,r.expiresAt-(r.deletedAt||Date.now()))}:{remainingMs:0,totalMs:0}}),[a,m]),N={deletedItems:a,addDeletedItem:p,undoDelete:x,isItemDeleted:w,getDeletedItems:b,clearDeletedItems:v,getRemainingTime:y,getCountdown:j,history:o,redoStack:c,undoLast:f,redoDelete:g};return t.jsx(xt.Provider,{value:N,children:s})},bt={28:"Action",12:"Adventure",16:"Animation",35:"Comedy",80:"Crime",99:"Documentary",18:"Drama",10751:"Family",14:"Fantasy",36:"History",27:"Horror",10402:"Music",9648:"Mystery",10749:"Romance",878:"Science Fiction",10770:"TV Movie",53:"Thriller",10752:"War",37:"Western",10759:"Action & Adventure",10762:"Kids",10763:"News",10764:"Reality",10765:"Sci-Fi & Fantasy",10766:"Soap",10767:"Talk",10768:"War & Politics"},vt=e.createContext(),yt=e=>e?Array.isArray(e)&&e.length>0&&"object"==typeof e[0]&&e[0].name?e:Array.isArray(e)&&e.length>0&&"number"==typeof e[0]?e.map((e=>({id:e,name:bt[e]||`Unknown Genre (${e})`}))).filter(Boolean):Array.isArray(e)&&e.length>0&&"string"==typeof e[0]?e.map(((e,t)=>({id:t+1,name:e}))):[]:[],jt=()=>{const t=e.useContext(vt);if(!t)throw Error("useWatchlist must be used within a WatchlistProvider");return t},Nt=({children:s})=>{const[a,r]=e.useState((()=>{try{const e=localStorage.getItem("watchlist");return e?JSON.parse(e).map((e=>({...e,genres:yt(e.genres||e.genre_ids||[])}))):[]}catch(e){return[]}})),[i,n]=e.useState(!1),[o,l]=e.useState(null),[c,d]=e.useState(!1),[u,h]=e.useState(null),m=e.useRef(new Map),p=3e4,x="watchlistRecentlyRemoved",g=e.useRef(new Map),f="watchlistRecentlyAdded",w=e.useRef(!1),b=e.useRef(new Set),v=e.useRef(null),y=ft(),j=e.useCallback((async(e=!1)=>{try{const o=localStorage.getItem("accessToken");if(!o)return void(e||n(!0));try{if(!(await fetch("https://streamr-jjj9.onrender.com/api/user/profile",{method:"GET",headers:{Authorization:"Bearer "+o}})).ok)return localStorage.removeItem("accessToken"),void(e||n(!0))}catch(t){return void(e||n(!0))}d(!0),h(null);const c=await ge.getWatchlist();if(c.success&&c.data.watchlist){const t=c.data.watchlist.map((e=>({...e,genres:yt(e.genres||[])})));if(0===t.length&&a.length>0){try{await ge.syncWatchlist(a),l((new Date).toISOString())}catch(s){}return d(!1),void(e||n(!0))}w.current=!0,r(t),l((new Date).toISOString());try{localStorage.setItem("watchlist",JSON.stringify(t))}catch(i){}}else if(c.success&&c.data.watchlist&&0===c.data.watchlist.length){if(0===a.length)return d(!1),void(e||n(!0));try{await ge.syncWatchlist(a),l((new Date).toISOString())}catch(s){}}}catch(i){i.message&&(i.message.includes("401")||i.message.includes("Unauthorized"))&&localStorage.removeItem("accessToken"),h(i.message)}finally{d(!1),e||n(!0)}}),[a]);e.useEffect((()=>{j()}),[j]),e.useEffect((()=>{if(!i||w.current)return void(w.current=!1);if(0===a.length&&!v.current)return;let e=!0;const t=setTimeout((async()=>{if(e)try{if(!localStorage.getItem("accessToken"))return;const e=Date.now(),t=Array.from(b.current).some((t=>{const s=parseInt(t.split("_").pop());return 2e3>e-s}));if(b.current.size>0&&t)return;d(!0),h(null),await ge.syncWatchlist(a),l((new Date).toISOString()),Array.from(b.current).filter((t=>{const s=parseInt(t.split("_").pop());return e-s>2e3})).forEach((e=>b.current.delete(e)))}catch(t){h(t.message)}finally{e&&d(!1)}}),1500);return()=>{e=!1,clearTimeout(t)}}),[a,i]),e.useEffect((()=>{if(i)try{localStorage.setItem("watchlist",JSON.stringify(a)),v.current=(new Date).toISOString()}catch(e){}}),[a,i]),e.useEffect((()=>{try{const e={};m.current.forEach(((t,s)=>{e[s]=t})),localStorage.setItem(x,JSON.stringify(e))}catch(e){}}),[a]),e.useEffect((()=>{try{const e={};g.current.forEach(((t,s)=>{e[s]=t})),localStorage.setItem(f,JSON.stringify(e))}catch(e){}}),[a]),e.useEffect((()=>{try{const e=localStorage.getItem(x);if(e){const t=JSON.parse(e);Object.keys(t).forEach((e=>{const s=t[e];6e4>Date.now()-s&&m.current.set(e,s)}))}}catch(e){}}),[]),e.useEffect((()=>{try{const e=localStorage.getItem(f);if(e){const t=JSON.parse(e);Object.keys(t).forEach((e=>{const s=t[e];6e4>Date.now()-s&&g.current.set(e,s)}))}}catch(e){}}),[]),e.useEffect((()=>{const e=setInterval((()=>{const e=Date.now();let t=!1;if(m.current.forEach(((s,a)=>{e-s>6e4&&(m.current.delete(a),t=!0)})),g.current.forEach(((s,a)=>{e-s>6e4&&(g.current.delete(a),t=!0)})),t)try{const e={};m.current.forEach(((t,s)=>{e[s]=t})),localStorage.setItem(x,JSON.stringify(e));const t={};g.current.forEach(((e,s)=>{t[s]=e})),localStorage.setItem(f,JSON.stringify(t))}catch(s){}}),p);return()=>clearInterval(e)}),[]),e.useEffect((()=>{let e=null,t=null;const s=t=>{if("accessToken"===t.key){if(!localStorage.getItem("accessToken"))return r([]),void n(!0);e=setTimeout((()=>{j()}),100)}};window.addEventListener("storage",s);const a=()=>{if(!localStorage.getItem("accessToken"))return r([]),void n(!0);t=setTimeout((()=>{j()}),100)};return window.addEventListener("auth-changed",a),()=>{e&&clearTimeout(e),t&&clearTimeout(t),window.removeEventListener("storage",s),window.removeEventListener("auth-changed",a)}}),[j]),e.useEffect((()=>{const e=setInterval((async()=>{if(localStorage.getItem("accessToken")&&i&&!c)try{const s=await ge.getWatchlist();if(s.success&&s.data.watchlist){const i=s.data.watchlist.map((e=>({...e,genres:yt(e.genres||[])})));if(0===i.length&&a.length>0){try{await ge.syncWatchlist(a),l((new Date).toISOString())}catch(e){}return}if(JSON.stringify(a)!==JSON.stringify(i)){const e=i.filter((e=>{const t=m.current.get(e.id+"");return!t||Date.now()-t>=p})),s=[];g.current.forEach(((t,r)=>{if(Date.now()-t<p&&!e.some((e=>e.id+""==r+""))){const e=a.find((e=>e.id+""==r+""));e&&s.push(e)}}));const n=[...s,...e.filter((e=>!s.some((t=>t.id===e.id))))];w.current=!0,r(n),l((new Date).toISOString());try{localStorage.setItem("watchlist",JSON.stringify(i))}catch(t){}}}}catch(t){}}),3e4);return()=>clearInterval(e)}),[a,i,c]);const N=e.useCallback((async e=>{const t=`remove_${e}_${Date.now()}`;b.current.add(t);const s=a.find((t=>t.id===e));r((t=>{const s=t.filter((t=>t.id!==e));try{m.current.set(e+"",Date.now());const t={};m.current.forEach(((e,s)=>{t[s]=e})),localStorage.setItem(x,JSON.stringify(t))}catch(a){}return s})),y&&s&&y.addDeletedItem("watchlist",s);try{if(localStorage.getItem("accessToken")){const t=a.filter((t=>t.id!==e));await ge.syncWatchlist(t),l((new Date).toISOString())}}catch(i){h(i.message)}finally{setTimeout((()=>{b.current.delete(t)}),100)}}),[a,y]),k=e.useCallback((async e=>{if(a.some((t=>t.id===e.id)))return;const t=`restore_${e.id}_${Date.now()}`;b.current.add(t),r((t=>[e,...t]));try{if(localStorage.getItem("accessToken")){const t=[e,...a];await ge.syncWatchlist(t),l((new Date).toISOString())}}catch(s){h(s.message)}finally{setTimeout((()=>{b.current.delete(t)}),100)}}),[a]),C=e.useCallback((async(e=!1)=>{try{if(!localStorage.getItem("accessToken"))throw Error("No authentication token found");return!e&&b.current.size>0?{success:!1,error:"Pending changes detected"}:(d(!0),h(null),await ge.syncWatchlist(a),l((new Date).toISOString()),b.current.clear(),{success:!0})}catch(t){return h(t.message),{success:!1,error:t.message}}finally{d(!1)}}),[a]),S=e.useCallback((async()=>await C(!0)),[C]),_=e.useCallback((async()=>await j(!0)),[j]),L=e.useCallback((()=>{}),[o,c,i]),T=e.useCallback((async()=>{try{const t=localStorage.getItem("watchlist");if(t){const s=JSON.parse(t);if(s.length>0){const t=s.map((e=>({...e,genres:yt(e.genres||e.genre_ids||[])})));r(t);try{localStorage.getItem("accessToken")&&(await ge.syncWatchlist(t),l((new Date).toISOString()))}catch(e){}return{success:!0,data:t,message:"Watchlist restored from localStorage"}}}return{success:!1,error:"No saved watchlist found in localStorage"}}catch(t){return{success:!1,error:t.message}}}),[]),M=e.useCallback((()=>{}),[a,i,c,o,v]),E=e.useCallback((async()=>{try{if(!localStorage.getItem("accessToken"))throw Error("No authentication token found");d(!0),h(null);const s=await ge.getWatchlist();if(s.success&&s.data.watchlist){const i=s.data.watchlist.map((e=>({...e,genres:yt(e.genres||[])})));if(0===i.length&&a.length>0){try{await ge.syncWatchlist(a),l((new Date).toISOString())}catch(e){}return{success:!0,data:a,message:"Backend was empty, preserved local data"}}w.current=!0,r(i),l((new Date).toISOString());try{localStorage.setItem("watchlist",JSON.stringify(i))}catch(t){}return{success:!0,data:i}}return{success:!1,error:"Invalid response format"}}catch(t){return h(t.message),{success:!1,error:t.message}}finally{d(!1)}}),[]),I={watchlist:a,isInitialized:i,isSyncing:c,syncError:u,lastBackendSync:o,addToWatchlist:async e=>{if(!(e=>0>=["id","title"].filter((t=>!e[t])).length&&!!(e.poster_path||e.poster||e.backdrop_path||e.backdrop))(e))return;const t=`add_${e.id}_${Date.now()}`;b.current.add(t);const s={id:e.id,title:e.title||e.name||e.original_title||e.original_name||("tv"===e.media_type?"Unknown Series":"Unknown Movie"),poster_path:e.poster_path||e.poster,backdrop_path:e.backdrop_path||e.backdrop,overview:e.overview||"",type:e.media_type||e.type||"movie",year:e.release_date?new Date(e.release_date).getFullYear():e.first_air_date?new Date(e.first_air_date).getFullYear():e.year||"N/A",rating:mt(e.vote_average||e.rating,0),genres:yt(e.genre_ids||e.genres),release_date:e.release_date||e.first_air_date,duration:e.runtime?`${Math.floor(e.runtime/60)}h ${e.runtime%60}m`:e.episode_run_time?`${Math.floor(e.episode_run_time[0]/60)}h ${e.episode_run_time[0]%60}m`:e.duration||"N/A",director:e.director,cast:e.cast||[],addedAt:(new Date).toISOString()};r((a=>{if(a.some((t=>t.id===e.id)))return b.current.delete(t),a;const r=[s,...a];try{g.current.set(s.id+"",Date.now());const e={};g.current.forEach(((t,s)=>{e[s]=t})),localStorage.setItem(f,JSON.stringify(e))}catch(i){}return r}));try{if(localStorage.getItem("accessToken")){const e=[s,...a];await ge.syncWatchlist(e),l((new Date).toISOString())}}catch(i){h(i.message)}finally{setTimeout((()=>{b.current.delete(t)}),100)}},removeFromWatchlist:N,restoreToWatchlist:k,clearWatchlist:async()=>{const e="clear_"+Date.now();b.current.add(e),r([]);try{localStorage.setItem("watchlist",JSON.stringify([]))}catch(t){}try{localStorage.getItem("accessToken")&&(await ge.syncWatchlist([]),l((new Date).toISOString()))}catch(t){h(t.message)}finally{setTimeout((()=>{b.current.delete(e)}),100)}},isInWatchlist:e=>a.some((t=>t.id===e)),syncWithBackend:C,loadFromBackend:j,forceSync:S,forceLoad:_,debugPendingChanges:L,refreshFromBackend:E,restoreFromLocalStorage:T,logWatchlistState:M};return t.jsx(vt.Provider,{value:I,children:s})},kt=e.createContext(null),Ct=()=>{const t=e.useContext(kt);if(!t)throw Error("useSocket must be used within a SocketProvider");return t},St=({children:s})=>{const a=e.useRef(!1),r=e.useRef(null),i=e.useRef(!0),[n,o]=e.useState(fe.socket?.connected||!1),[l,c]=e.useState(null),[d,u]=e.useState(0),[h,m]=e.useState((()=>!1)),[p,x]=e.useState(fe.socket?.id||null);e.useEffect((()=>{const e=()=>{o(!0),x(fe.socket?.id||null),c(null)},t=e=>{o(!1),x(null)},s=e=>{c(e)},a=e=>{u(e)};return fe.addListener("connect",e),fe.addListener("disconnect",t),fe.addListener("error",s),fe.addListener("reconnect_attempt",a),o(fe.socket?.connected||!1),x(fe.socket?.id||null),()=>{fe.removeListener("connect",e),fe.removeListener("disconnect",t),fe.removeListener("error",s),fe.removeListener("reconnect_attempt",a)}}),[h]),e.useEffect((()=>(i.current=!0,()=>{i.current=!1})),[]),e.useEffect((()=>(!a.current&&i.current&&(fe.connect(),a.current=!0),()=>{r.current&&clearTimeout(r.current),r.current=setTimeout((()=>{a.current&&i.current&&(fe.disconnect(),a.current=!1)}),100)})),[h]),e.useEffect((()=>()=>{r.current&&(clearTimeout(r.current),r.current=null)}),[]);const g=e.useCallback(((e,t)=>(fe.addListener(e,t),()=>fe.removeListener(e,t))),[]),f=e.useCallback((()=>{fe.disconnect(),setTimeout((()=>{fe.connect()}),200)}),[h]),w=e.useCallback((()=>m((e=>!e))),[]),b=e.useMemo((()=>({socket:fe.socket,addListener:g,isConnected:n,lastError:l,reconnectAttempts:d,socketId:p,debug:h,setDebug:w,reconnect:f,emitDiscussionCreate:fe.emitDiscussionCreate.bind(fe),emitReplyCreate:fe.emitReplyCreate.bind(fe),emitDiscussionLike:fe.emitDiscussionLike.bind(fe),emitReplyLike:fe.emitReplyLike.bind(fe)})),[g,n,l,d,p,h,w,f]);return t.jsx(kt.Provider,{value:b,children:s})},_t={28:"Action",12:"Adventure",16:"Animation",35:"Comedy",80:"Crime",99:"Documentary",18:"Drama",10751:"Family",14:"Fantasy",36:"History",27:"Horror",10402:"Music",9648:"Mystery",10749:"Romance",878:"Science Fiction",10770:"TV Movie",53:"Thriller",10752:"War",37:"Western",10759:"Action & Adventure",10762:"Kids",10763:"News",10764:"Reality",10765:"Sci-Fi & Fantasy",10766:"Soap",10767:"Talk",10768:"War & Politics"},Lt=e.createContext(),Tt=e=>e?Array.isArray(e)&&e.length>0&&"object"==typeof e[0]&&e[0].name?e:Array.isArray(e)&&e.length>0&&"number"==typeof e[0]?e.map((e=>({id:e,name:_t[e]||`Unknown Genre (${e})`}))).filter(Boolean):Array.isArray(e)&&e.length>0&&"string"==typeof e[0]?e.map(((e,t)=>({id:t+1,name:e}))):[]:[],Mt=({children:a})=>{const{socket:r}=Ct(),[i,n]=e.useState((()=>{try{const e=localStorage.getItem("wishlist");return e?JSON.parse(e).map((e=>({...e,genres:Tt(e.genres||e.genre_ids||[])}))):[]}catch(e){return[]}})),[o,l]=e.useState(!1),[c,d]=e.useState(null),[u,h]=e.useState(!1),[m,p]=e.useState(null),x=e.useRef(!1),g=e.useRef(new Set),f=e.useRef(null),w=e.useRef(0),b=e.useRef(new Map),v=3e4,y="wishlistRecentlyRemoved",j=e.useCallback((()=>{try{const e=localStorage.getItem(y);if(!e)return new Map;const t=JSON.parse(e);if(t&&"object"==typeof t)return new Map(Object.entries(t).map((([e,t])=>[+e,+t])))}catch(e){}return new Map}),[]),N=e.useCallback((()=>{try{const e={};b.current.forEach(((t,s)=>{e[s]=t})),localStorage.setItem(y,JSON.stringify(e))}catch(e){}}),[]);e.useEffect((()=>{b.current=j();const e=Date.now();let t=!1;Array.from(b.current.entries()).forEach((([s,a])=>{v>e-a||(b.current.delete(s),t=!0)})),t&&N()}),[j,N]);const k=e.useCallback((()=>Date.now()<w.current),[]),C=e.useCallback(((e=5e3)=>{w.current=Date.now()+e}),[]),S=ft(),_=e.useCallback(((e,t)=>{const s=new Map(e.map((e=>[+e.id,e]))),a=new Map(t.map((e=>[+e.id,e]))),r=[];return s.forEach(((e,t)=>{r.push(e)})),a.forEach(((e,t)=>{if(!s.has(t)){const s=Array.from(g.current).some((e=>e.startsWith(`remove_${+t}_`))),a=b.current.get(+t),i=a&&Date.now()-a<v;s||i||r.push(e)}})),r}),[]),L=s.useCallback((async e=>{try{if(!localStorage.getItem("accessToken"))return{success:!1,error:"Not authenticated"};const s=await ge.getWishlist(),a=Array.isArray(s?.data?.wishlist)?s.data.wishlist:[],r=new Set(a.map((e=>e.id))),i=new Set(e.map((e=>e.id)));for(const n of e)if(!r.has(n.id))try{await ge.addToWishlist(n)}catch(t){}for(const e of a)if(!i.has(e.id))try{await ge.removeFromWishlist(e.id)}catch(t){}return{success:!0}}catch(s){return{success:!1,error:s.message}}}),[]),T=s.useCallback((async()=>{try{if(g.current.size>0||k())return void l(!0);const s=localStorage.getItem("accessToken");if(!s)return void l(!0);try{if(!(await fetch("https://streamr-jjj9.onrender.com/api/user/profile",{method:"GET",headers:{Authorization:"Bearer "+s}})).ok)return localStorage.removeItem("accessToken"),void l(!0)}catch(e){return void l(!0)}h(!0),p(null);const a=await ge.getWishlist();if(a.success&&a.data.wishlist){const e=a.data.wishlist.map((e=>({...e,id:+e.id,genres:Tt(e.genres||[])}))),s=3e4,r=e.filter((e=>{const t=b.current.get(+e.id);return!(t&&Date.now()-t<s)}));if(0===r.length&&i.length>0){try{await L(i),d((new Date).toISOString())}catch(t){}return h(!1),void l(!0)}x.current=!0,n((e=>{const t=_(e,r);if((async()=>{try{JSON.stringify(t)!==JSON.stringify(r)&&await L(t)}catch(e){}})(),JSON.stringify(e)===JSON.stringify(t))return e;try{localStorage.setItem("wishlist",JSON.stringify(t))}catch(s){}return t})),d((new Date).toISOString())}else if(a.success&&a.data.wishlist&&0===a.data.wishlist.length)if(0===i.length);else try{await L(i),d((new Date).toISOString())}catch(t){}}catch(s){s.message&&(s.message.includes("401")||s.message.includes("Unauthorized"))&&localStorage.removeItem("accessToken"),p(s.message)}finally{h(!1),l(!0)}}),[i]);e.useEffect((()=>{T()}),[T]),e.useEffect((()=>{if(!r)return;const e=e=>{try{if(g.current.size>0||k())return;const t=(Array.isArray(e?.wishlist)?e.wishlist:[]).map((e=>({...e,id:+e.id,genres:Tt(e.genres||[])})));t.forEach((e=>{!b.current.get(+e.id)||Date.now()})),x.current=!0,n((e=>{const s=_(e,t);if(JSON.stringify(e)===JSON.stringify(s))return e;try{localStorage.setItem("wishlist",JSON.stringify(s))}catch{}return s})),d((new Date).toISOString())}catch(t){}};return r.on("wishlist:updated",e),()=>{r.off("wishlist:updated",e)}}),[r,_,k]),e.useEffect((()=>{if(o&&!x.current)try{localStorage.setItem("wishlist",JSON.stringify(i))}catch(e){}}),[i,o]),e.useEffect((()=>{let e=null,t=null;const s=t=>{"accessToken"===t.key&&(e=setTimeout((()=>{T()}),100))},a=()=>{t=setTimeout((()=>{T()}),100)};return window.addEventListener("storage",s),window.addEventListener("auth-changed",a),()=>{e&&clearTimeout(e),t&&clearTimeout(t),window.removeEventListener("storage",s),window.removeEventListener("auth-changed",a)}}),[T]),e.useEffect((()=>{const e=setInterval((async()=>{if(localStorage.getItem("accessToken")&&o&&!u)try{if(g.current.size>0||k())return;const t=await ge.getWishlist();if(t.success&&t.data.wishlist){const s=t.data.wishlist.map((e=>({...e,id:+e.id,genres:Tt(e.genres||[])}))).filter((e=>{const t=b.current.get(+e.id);return!t||Date.now(),!(t&&Date.now()-t<v)}));if(0===s.length&&i.length>0){try{await L(i),d((new Date).toISOString())}catch(e){}return}JSON.stringify(i)!==JSON.stringify(s)&&(x.current=!0,n((e=>{const t=_(e,s);if(JSON.stringify(e)===JSON.stringify(t))return e;try{localStorage.setItem("wishlist",JSON.stringify(t))}catch(a){}return t})),d((new Date).toISOString()))}}catch(t){}}),3e4);return()=>clearInterval(e)}),[i,o,u]),e.useEffect((()=>{if(!o||x.current)return;let e=!0;const t=setTimeout((async()=>{if(e)try{if(!localStorage.getItem("accessToken"))return;if(g.current.size>0||k())return;h(!0),p(null);const e=await L(i);e.success?d((new Date).toISOString()):e.error&&p(e.error)}catch(t){p(t.message)}finally{e&&h(!1)}}),2e3);return()=>{e=!1,clearTimeout(t)}}),[i,o]);const M=e.useCallback((async e=>{if(!e||!e.id)return!1;if(i.some((t=>t.id===e.id)))return!1;try{const a=`add_${e.id}_${Date.now()}`;g.current.add(a),f.current=Date.now();const r={...e,id:+e.id,title:e.title||e.name||e.original_title||e.original_name||("tv"===e.media_type?"Unknown Series":"Unknown Movie"),genres:Tt(e.genres||e.genre_ids||[]),addedAt:(new Date).toISOString()},o=[...i.map((e=>({...e,id:+e.id}))),r];n(o);try{localStorage.setItem("wishlist",JSON.stringify(o))}catch(t){}if(C(5e3),S&&S.addAction({type:"ADD_TO_WISHLIST",data:{movie:r},undo:()=>E(r.id),redo:()=>M(r)}),localStorage.getItem("accessToken"))try{await ge.addToWishlist(r),g.current.delete(a),d((new Date).toISOString()),0===g.current.size&&(w.current=Date.now())}catch(s){}const l=Date.now();return Array.from(g.current).forEach((e=>{const t=parseInt(e.split("_").pop());!Number.isNaN(t)&&l-t>1e4&&g.current.delete(e)})),!0}catch(s){return!1}}),[i,S]),E=e.useCallback((async e=>{const t=+e,s=i.find((e=>+e.id===t));if(!s)return!1;try{const o=`remove_${e}_${Date.now()}`;g.current.add(o),f.current=Date.now();const l=i.filter((e=>+e.id!==t)).map((e=>({...e,id:+e.id})));n(l);try{localStorage.setItem("wishlist",JSON.stringify(l))}catch(a){}if(C(3e3),b.current.set(t,Date.now()),N(),N(),S&&S.addAction({type:"REMOVE_FROM_WISHLIST",data:{movie:s},undo:()=>M(s),redo:()=>E(e)}),localStorage.getItem("accessToken"))try{await ge.removeFromWishlist(t),g.current.delete(o),d((new Date).toISOString()),0===g.current.size&&(w.current=Date.now()),b.current.delete(t),N()}catch(r){}const c=Date.now();return Array.from(g.current).forEach((e=>{const t=parseInt(e.split("_").pop());!Number.isNaN(t)&&c-t>1e4&&g.current.delete(e)})),setTimeout((()=>{const e=b.current.get(t);e&&Date.now()-e>=v&&(b.current.delete(t),N())}),31e3),!0}catch(r){return!1}}),[i,S]),I=e.useCallback((e=>i.some((t=>t.id===e))),[i]),D=e.useCallback((async()=>{if(0===i.length)return!0;try{const s=[...i];n([]);try{localStorage.setItem("wishlist",JSON.stringify([]))}catch(e){}if(S&&S.addAction({type:"CLEAR_WISHLIST",data:{wishlist:s},undo:()=>n(s),redo:()=>n([])}),localStorage.getItem("accessToken"))try{await ge.clearWishlist()}catch(t){}return!0}catch(t){return!1}}),[i,S]),R=e.useCallback((async e=>{if(!i.find((t=>t.id===e)))return!1;try{return await E(e),!0}catch(t){return!1}}),[i,E]),z=e.useCallback((()=>{const e=i.length,t=i.filter((e=>"tv"!==e.media_type)).length,s=i.filter((e=>"tv"===e.media_type)).length,a={};return i.forEach((e=>{e.genres&&e.genres.forEach((e=>{a[e.name]=(a[e.name]||0)+1}))})),{total:e,movies:t,tvShows:s,topGenres:Object.entries(a).sort((([,e],[,t])=>t-e)).slice(0,5),lastUpdated:c}}),[i,c]),W=e.useCallback((e=>{if(!e||""===e.trim())return i;const t=e.toLowerCase().trim();return i.filter((e=>e.title?.toLowerCase().includes(t)||e.original_title?.toLowerCase().includes(t)||e.overview?.toLowerCase().includes(t)||e.genres?.some((e=>e.name.toLowerCase().includes(t)))))}),[i]),A=e.useCallback(((e={})=>{let t=[...i];return e.mediaType&&(t=t.filter((t=>t.media_type===e.mediaType))),e.genre&&(t=t.filter((t=>t.genres?.some((t=>t.name===e.genre))))),e.minRating&&(t=t.filter((t=>(t.vote_average||0)>=e.minRating))),e.year&&(t=t.filter((t=>new Date(t.release_date||t.first_air_date).getFullYear()===e.year))),e.sortBy&&t.sort(((t,s)=>{switch(e.sortBy){case"title":return(t.title||"").localeCompare(s.title||"");case"rating":return(s.vote_average||0)-(t.vote_average||0);case"date":return new Date(s.release_date||s.first_air_date)-new Date(t.release_date||s.first_air_date);case"added":return new Date(s.addedAt||0)-new Date(t.addedAt||0);default:return 0}})),t}),[i]),O=e.useCallback((async()=>{try{if(!localStorage.getItem("accessToken"))return!1;h(!0),p(null);const e=await L(i);return e.success?(d((new Date).toISOString()),!0):(p(e.error||"Unknown error"),!1)}catch(e){return p(e.message),!1}finally{h(!1)}}),[i]),P={wishlist:i,isInitialized:o,lastBackendSync:c,isSyncing:u,syncError:m,addToWishlist:M,removeFromWishlist:E,clearWishlist:D,moveToWatchlist:R,syncWithBackend:O,loadFromBackend:T,isInWishlist:I,getWishlistStats:z,searchWishlist:W,filterWishlist:A,totalItems:i.length,isEmpty:0===i.length};return t.jsx(Lt.Provider,{value:P,children:a})},Et=e.createContext(null),It=e=>{window.dispatchEvent(new CustomEvent("auth-changed",{detail:{action:e}})),window.dispatchEvent(new Event("account-reload"))},Dt=({children:s})=>{const[r,i]=e.useState(null),[n,o]=e.useState(!0),[l,c]=e.useState(null),[d,u]=e.useState(Date.now()),[h,m]=e.useState(!1);e.useState(null);const[p,x]=e.useState(!1),g=e.useRef(null),f=e.useRef(null),w=e.useRef([]),b=e.useRef(!0),v=e.useRef(null),y=e.useCallback((()=>{b.current&&(u(Date.now()),x(!1))}),[]);e.useEffect((()=>{if(r)return f.current=setInterval((()=>{if(!b.current)return;const e=1728e5-(Date.now()-d);e>36e5||p||x(!0),h||e>0||!v.current||v.current()}),6e4),()=>{f.current&&(clearInterval(f.current),f.current=null)}}),[r,d,h,p]),e.useEffect((()=>{const e=[];return["mousedown","mousemove","keypress","scroll","touchstart"].forEach((t=>{const s=()=>y();window.addEventListener(t,s),e.push({event:t,listener:s})})),w.current=e,()=>{e.forEach((({event:e,listener:t})=>{window.removeEventListener(e,t)})),w.current=[]}}),[y]);const j=e.useCallback((async()=>{try{const e=await we.refreshToken();if(!e.success)throw Error("Token refresh failed");const{accessToken:t}=e.data||e;if(!t)return!1;localStorage.setItem("accessToken",t);const s=await be.getProfile();return!!s.data&&(b.current&&(i(s.data),u(Date.now()),x(!1)),!0)}catch(e){return(e.message.includes("401")||e.message.includes("Unauthorized")||e.message.includes("No refresh token provided"))&&(localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),b.current&&(i(null),x(!1))),!1}}),[]);e.useEffect((()=>{if(!r)return;let e=null;const t=async()=>{b.current&&(e&&(clearTimeout(e),e=null),e=setTimeout((async()=>{b.current&&(await j()&&b.current?t():b.current&&(e=setTimeout(t,3e4)))}),78e4),g.current=e)};return t(),()=>{g.current&&(clearTimeout(g.current),g.current=null)}}),[r,j]),e.useEffect((()=>((async()=>{try{if(!localStorage.getItem("accessToken")){const e=document.cookie.length>0,t=localStorage.getItem("refreshToken");return e||t?void(!(await j())&&b.current&&(o(!1),i(null))):(o(!1),void i(null))}try{const e=await be.getProfile();if(!b.current)return;if(!e.data)throw Error("No user data found");i(e.data)}catch(e){if(!b.current)return;!(await j())&&b.current&&(localStorage.removeItem("accessToken"),i(null))}}catch(t){b.current&&(localStorage.removeItem("accessToken"),i(null))}finally{b.current&&o(!1)}})(),()=>{b.current=!1})),[j]);const N=e.useCallback((async(e,t,s=!1)=>{try{if(o(!0),c(null),m(s),!t&&"object"==typeof e){const{user:t,accessToken:s}=e;return s&&localStorage.setItem("accessToken",s),It("login"),i(t),u(Date.now()),x(!1),t&&!t.location&&await ve(i,!0),o(!1),{success:!0}}const r=await we.login({email:e,password:t});if(!r.success)throw Error(r.message||"Login failed");const{user:n,accessToken:l}=r.data;if(!l)throw Error("No access token received from login");localStorage.setItem("accessToken",l),It("login");let d=null;try{const e=await be.getProfile();e?.data?(d=e.data,i(e.data)):(d=n,i(n))}catch(a){d=n,i(n)}return d&&!d.location&&await ve(i,!0),u(Date.now()),x(!1),o(!1),{success:!0}}catch(r){const e=r.response?.data?.message||r.message||"Failed to login";return c(e),o(!1),{success:!1,error:e}}}),[]),k=e.useCallback((async()=>{try{await we.logout()}catch(e){}finally{g.current&&(clearTimeout(g.current),g.current=null),f.current&&(clearInterval(f.current),f.current=null),i(null),m(!1),localStorage.removeItem("accessToken"),It("logout")}}),[]);e.useEffect((()=>{v.current=k}),[k]),e.useEffect((()=>()=>{b.current=!1,g.current&&(clearTimeout(g.current),g.current=null),f.current&&(clearInterval(f.current),f.current=null),w.current.forEach((({event:e,listener:t})=>{window.removeEventListener(e,t)})),w.current=[]}),[]);const C={user:r,loading:n,error:l,rememberMe:h,sessionWarning:p,login:N,signup:async e=>{try{c(null);const t=await we.signup(e),{accessToken:s,user:a}=t.data;if(!s)throw Error("No access token received from signup");return localStorage.setItem("accessToken",s),It("login"),i(a),u(Date.now()),await ve(i,!0),{success:!0}}catch(t){const e=t.response?.data?.message||"Failed to create account";return c(e),{success:!1,error:e}}},logout:k,forgotPassword:async e=>{try{return c(null),await we.forgotPassword(e),{success:!0}}catch(t){const e=t.response?.data?.message||"Failed to send reset email";return c(e),{success:!1,error:e}}},resetPassword:async(e,t)=>{try{return c(null),await we.resetPassword(e,t),{success:!0}}catch(s){const e=s.response?.data?.message||"Failed to reset password";return c(e),{success:!1,error:e}}},verifyEmail:async e=>{try{return{success:!0,data:(await we.verifyEmail(e)).data}}catch(t){throw t}},updateActivity:y,reloadUser:async()=>{try{const e=await be.getProfile();if(!e.data)throw Error("No user data found");i(e.data)}catch(e){}},switchBackendMode:it,getCurrentBackendMode:nt,detectAndUpdateLocation:async()=>{if(!r)return a.error("Please log in to update your location"),{success:!1,error:"User not logged in"};const e=await ve(i,!0);if(e.success){const t=e.details?`Location updated: ${e.location}\n📍 ${e.details.city||""}, ${e.details.state||""}${e.details.country&&e.details.country!==e.details.state?", "+e.details.country:""}`:"Location updated: "+e.location;a.success(t,{duration:5e3,icon:"📍"})}return e}};return t.jsx(Et.Provider,{value:C,children:s})},Rt=()=>{const t=e.useContext(Et);if(!t)throw Error("useAuth must be used within an AuthProvider");return t},zt=(e,t,s=null,a=null)=>e&&t?"movie"===t?"movie_"+e:"tv"===t&&s&&a?`tv_${e}_${s}_${a}`:null:null,Wt=e.createContext(),At=()=>{const t=e.useContext(Wt);if(!t)throw Error("useViewingProgress must be used within a ViewingProgressProvider");return t},Ot=({children:s})=>{const[a,r]=e.useState({}),[i,n]=e.useState([]),[o,l]=e.useState(!1),c=e.useRef(null),d=e.useRef(null),u=e.useRef(a),h=e.useRef(null);e.useEffect((()=>{u.current=a}),[a]);const m=ft(),p=e.useCallback((async()=>{try{const t=localStorage.getItem("accessToken");if(!t)return;try{if(!(await fetch("https://streamr-jjj9.onrender.com/api/user/profile",{method:"GET",headers:{Authorization:"Bearer "+t},signal:AbortSignal.timeout(5e3)})).ok)return void localStorage.removeItem("accessToken")}catch(e){return void("TimeoutError"===e.name||e.name)}const s=await ge.getViewingProgress();s?.success&&s.data?.viewingProgress&&(r(s.data.viewingProgress),h.current=JSON.stringify(s.data.viewingProgress))}catch(t){(t.message?.includes("401")||t.message?.includes("Unauthorized"))&&localStorage.removeItem("accessToken")}}),[]);e.useEffect((()=>{p().finally((()=>{(()=>{try{const e=localStorage.getItem("viewingProgress");if(e){const t=JSON.parse(e);r(t);const s=Object.entries(t).map((([e,t])=>("tv"===t.type&&(!t.title||t.title),{id:t.id,title:t.title||t.name||t.original_title||t.original_name||("tv"===t.type?"Unknown Series":"Unknown Movie"),type:t.type,poster_path:t.poster_path,backdrop_path:t.backdrop_path,lastWatched:t.lastWatched,season:t.season,episode:t.episode,episodeTitle:t.episodeTitle,progress:t.progress||0}))).sort(((e,t)=>new Date(t.lastWatched)-new Date(e.lastWatched))),a=[],i=new Map,o=()=>{const e=new Date,t=new Date(e.getTime()-6048e5);s.forEach((e=>{const s=new Date(e.lastWatched);e.progress>=95&&t>s||("tv"===e.type?i.has(e.id)&&new Date(e.lastWatched)<=new Date(i.get(e.id).lastWatched)||i.set(e.id,e):a.push(e))})),i.forEach((e=>{a.push(e)}));const r=a.sort(((t,s)=>{const a=new Date(t.lastWatched),r=new Date(s.lastWatched),i=new Date(e.getTime()-864e5),n=a>i,o=r>i;if(n&&!o)return-1;if(!n&&o)return 1;const l=t.progress||0,c=s.progress||0,d=l>=70&&95>l,u=c>=70&&95>c;return d&&!u?-1:!d&&u?1:r-a}));n(r)};window.requestIdleCallback?window.requestIdleCallback(o):setTimeout(o,0)}}catch(e){}})(),l(!0)}))}),[p]),e.useEffect((()=>{let e=null;const t=t=>{if("accessToken"===t.key){if(!localStorage.getItem("accessToken"))return r({}),n([]),void l(!0);e=setTimeout((()=>{p()}),100)}};window.addEventListener("storage",t);const s=()=>{if(!localStorage.getItem("accessToken"))return r({}),n([]),void l(!0);e=setTimeout((()=>{p()}),100)};return window.addEventListener("auth-changed",s),()=>{e&&clearTimeout(e),window.removeEventListener("storage",t),window.removeEventListener("auth-changed",s)}}),[p]);let x=null;try{x=Ct()}catch(M){}e.useEffect((()=>{if(x&&x.addListener){const e=x.addListener("viewingProgress:updated",(e=>{if(e.userId&&e.viewingProgress){const t=JSON.stringify(u.current),s=JSON.stringify(e.viewingProgress);if(t!==s){r(e.viewingProgress);try{localStorage.setItem("viewingProgress",s)}catch(M){}}}}));return()=>{e&&e()}}{let e=3e4;const t=12e4,s=async()=>{try{if(document.hidden||!o)return;if(!localStorage.getItem("accessToken"))return;const t=await ge.getViewingProgress();if(t?.success&&t.data?.viewingProgress){const s=t.data.viewingProgress,a=JSON.stringify(s);if(h.current!==a){h.current=a,r(s);try{localStorage.setItem("viewingProgress",a)}catch(M){}}e=3e4}}catch(M){e=Math.min(t,Math.max(3e4,1.5*e))}finally{d.current&&clearInterval(d.current),d.current=setInterval(s,e)}},a=()=>{document.hidden?d.current&&(clearInterval(d.current),d.current=null):s()};return document.addEventListener("visibilitychange",a),document.hidden||s(),()=>{d.current&&(clearInterval(d.current),d.current=null),document.removeEventListener("visibilitychange",a)}}}),[o,x]),e.useEffect((()=>{if(o)return c.current&&clearTimeout(c.current),c.current=setTimeout((async()=>{try{const t=JSON.stringify(u.current);try{localStorage.setItem("viewingProgress",t)}catch(M){}const s=localStorage.getItem("accessToken");if(Object.keys(u.current).length>0&&s)try{await ge.syncViewingProgress(u.current)}catch(e){}}catch(M){}}),2e3),()=>{c.current&&(clearTimeout(c.current),c.current=null)}}),[a,o]);const g=e.useCallback((e=>{if(!e)return null;if(e.startsWith("/"))return e;if(e.startsWith("http")){const t=e.match(/\/t\/p\/[^\/]+\/(.+)$/);return t?"/"+t[1]:null}return e&&!e.startsWith("/")?"/"+e:null}),[]),f=e.useCallback((e=>{if(!e?.id)return;const t="movie_"+e.id,s=(new Date).toISOString(),a={id:e.id,title:e.title||e.name||e.original_title||e.original_name||"Unknown Movie",type:"movie",poster_path:g(e.poster_path||e.poster),backdrop_path:g(e.backdrop_path||e.backdrop),lastWatched:s,progress:0};r((e=>({...e,[t]:a}))),n((t=>{const s=t.filter((t=>!(t.id===e.id&&"movie"===t.type)));return[a,...s]}))}),[g]),w=e.useCallback(((e,t,s,a=null)=>{if(!e?.id||!t||!s)return;const i=zt(e.id,"tv",t,s);if(!i)return;const o=(new Date).toISOString(),l=e.poster_path||e.poster,c=e.backdrop_path||e.backdrop,d=g(l),u=g(c),h={id:e.id,title:e.name||e.title||e.original_name||e.original_title||"Unknown Series",type:"tv",poster_path:d,backdrop_path:u,lastWatched:o,season:t,episode:s,episodeTitle:a?.name||"Episode "+s,progress:0};r((e=>({...e,[i]:h}))),n((t=>{const s=t.filter((t=>!(t.id===e.id&&"tv"===t.type)));return[h,...s]}))}),[g]),b=e.useCallback(((e,t,s=null,a=null,i=0)=>{const l=zt(e,t,s,a);l&&(r((e=>{const t=e[l];if(!t)return e;const s={...t,progress:Math.max(t.progress,i),lastWatched:(new Date).toISOString()};return{...e,[l]:s}})),n((r=>r.map((r=>{if(r.id===e&&r.type===t){if("tv"===t&&r.season===s&&r.episode===a)return{...r,progress:Math.max(r.progress||0,i),lastWatched:(new Date).toISOString()};if("movie"===t)return{...r,progress:Math.max(r.progress||0,i),lastWatched:(new Date).toISOString()}}return r})).sort(((e,t)=>new Date(t.lastWatched)-new Date(e.lastWatched))))),localStorage.getItem("accessToken")&&o&&setTimeout((async()=>{try{await ge.syncViewingProgress(u.current)}catch(M){}}),500))}),[o]),v=e.useCallback(((e,t,s=null,a=null)=>{let o=null;"movie"===t?o=i.find((t=>t.id===e&&"movie"===t.type)):"tv"===t&&(o=i.find((t=>t.id===e&&"tv"===t.type)));let l=null;if("movie"===t){const t=e+"_movie_movie_movie";l=localStorage.getItem("continue_watching_image_"+t)}else if("tv"===t){const t=`${e}_tv_${s||"unknown"}_${a||"unknown"}`;l=localStorage.getItem("continue_watching_image_"+t)}if("movie"===t){const t="movie_"+e;r((e=>{const s={...e};return delete s[t],s})),n((t=>t.filter((t=>!(t.id===e&&"movie"===t.type)))));const s=e+"_movie_movie_movie";localStorage.removeItem("continue_watching_image_"+s)}else if("tv"===t){r((t=>{const s={...t};return Object.keys(s).forEach((t=>{t.startsWith(`tv_${e}_`)&&delete s[t]})),s})),n((t=>t.filter((t=>!(t.id===e&&"tv"===t.type)))));const t=`${e}_tv_${s||"unknown"}_${a||"unknown"}`;localStorage.removeItem("continue_watching_image_"+t)}if(m&&o){const e=l?{...o,thumbnailUrl:l}:o;m.addDeletedItem("continueWatching",e)}}),[i,m]);e.useCallback((()=>{r({}),n([])}),[]);const y=e.useCallback((()=>{r({}),n([]),Object.keys(localStorage).forEach((e=>{e.startsWith("continue_watching_image_")&&localStorage.removeItem(e)}))}),[]),j=e.useCallback((e=>{if("movie"===e.type){const t="movie_"+e.id,s={id:e.id,title:e.title||"Unknown Movie",type:e.type,poster_path:e.poster_path,backdrop_path:e.backdrop_path,lastWatched:e.lastWatched||(new Date).toISOString(),progress:e.progress||0};r((e=>({...e,[t]:s}))),n((t=>{const a=t.filter((t=>!(t.id===e.id&&"movie"===t.type)));return[s,...a]}))}else if("tv"===e.type){const t=`tv_${e.id}_${e.season}_${e.episode}`,s={id:e.id,title:e.title||e.name||e.original_title||e.original_name||"Unknown Series",type:e.type,poster_path:e.poster_path,backdrop_path:e.backdrop_path,lastWatched:e.lastWatched||(new Date).toISOString(),season:e.season,episode:e.episode,episodeTitle:e.episodeTitle,progress:e.progress||0};r((e=>({...e,[t]:s}))),n((t=>{const a=t.filter((t=>!(t.id===e.id&&"tv"===t.type)));return[s,...a]}))}}),[]);e.useCallback((()=>i),[i]);const N=e.useCallback((()=>i.length>0),[i]),k=e.useCallback((()=>{try{const e=localStorage.getItem("viewingProgress");if(e){const t=JSON.parse(e);r(t);const s=new Date((new Date).getTime()-6048e5),a=Object.entries(t).map((([e,t])=>("tv"===t.type&&(!t.title||t.title),{id:t.id,title:t.title||t.name||t.original_title||t.original_name||("tv"===t.type?"Unknown Series":"Unknown Movie"),type:t.type,poster_path:t.poster_path,backdrop_path:t.backdrop_path,lastWatched:t.lastWatched,season:t.season,episode:t.episode,episodeTitle:t.episodeTitle,progress:t.progress||0}))).filter((e=>{const t=new Date(e.lastWatched);return!(e.progress>=95&&s>t)})).sort(((e,t)=>new Date(t.lastWatched)-new Date(e.lastWatched))),i=[],o=new Map,l=()=>{a.forEach((e=>{"tv"===e.type?o.has(e.id)&&new Date(e.lastWatched)<=new Date(o.get(e.id).lastWatched)||o.set(e.id,e):i.push(e)})),o.forEach((e=>{i.push(e)}));const e=new Date((new Date).getTime()-864e5),t=i.sort(((t,s)=>{const a=new Date(t.lastWatched),r=new Date(s.lastWatched),i=a>e,n=r>e;if(i&&!n)return-1;if(!i&&n)return 1;const o=t.progress||0,l=s.progress||0,c=o>=70&&95>o,d=l>=70&&95>l;return c&&!d?-1:!c&&d?1:r-a}));n(t)};window.requestIdleCallback?window.requestIdleCallback(l):setTimeout(l,0)}}catch(M){}}),[]),C=e.useCallback(((e,t,s=null,a=null)=>{b(e,t,s,a,100),setTimeout((()=>{v(e,t,s,a)}),1e3)}),[b,v]),S=e.useCallback((()=>{i.filter((e=>"movie"===e.type)).forEach((e=>{const t="movie_"+e.id;r((e=>{const s={...e};return delete s[t],s}));const s=e.id+"_movie_movie_movie";localStorage.removeItem("continue_watching_image_"+s)})),n((e=>e.filter((e=>"movie"!==e.type))))}),[i]),_=e.useCallback((()=>{i.filter((e=>"tv"===e.type)).forEach((e=>{r((t=>{const s={...t};return Object.keys(s).forEach((t=>{t.startsWith(`tv_${e.id}_`)&&delete s[t]})),s}));const t=`${e.id}_tv_${e.season||"unknown"}_${e.episode||"unknown"}`;localStorage.removeItem("continue_watching_image_"+t)})),n((e=>e.filter((e=>"tv"!==e.type))))}),[i]);e.useCallback(((e,t=50)=>{f(e),setTimeout((()=>{b(e.id,"movie",null,null,t)}),100)}),[f,b]);const L=e.useCallback((async()=>{try{if(!localStorage.getItem("accessToken"))throw Error("No authentication token found");const e=await ge.getViewingProgress();if(e?.success&&e.data?.viewingProgress){const t=e.data.viewingProgress;r(t),h.current=JSON.stringify(t);try{localStorage.setItem("viewingProgress",JSON.stringify(t))}catch(M){}return{success:!0,data:t}}return{success:!1,error:"Invalid response format"}}catch(M){return{success:!1,error:M.message}}}),[]),T=e.useMemo((()=>({viewingProgress:a,continueWatching:i,startWatchingMovie:f,startWatchingEpisode:w,updateProgress:b,removeFromContinueWatching:v,restoreToContinueWatching:j,clearAllContinueWatching:y,clearMoviesFromContinueWatching:S,clearTVShowsFromContinueWatching:_,markAsWatched:C,hasContinueWatching:N,refreshFromStorage:k,refreshFromBackend:L,isInitialized:o})),[a,i,f,w,b,v,j,y,S,_,C,N,k,L,o]);return t.jsx(Wt.Provider,{value:T,children:s})},Pt=(e,t="w500")=>e?e.startsWith("https://image.tmdb.org/")||e.startsWith("http")?e:`https://image.tmdb.org/t/p/${t}${e.startsWith("/")?e:"/"+e}`:null,Ft=(e,t="w500",s="Image",a="")=>({src:Pt(e,t),alt:s,className:a,crossOrigin:"anonymous",loading:"lazy"}),Bt=(e,t="w500")=>{const s=e.poster_path||e.poster;return Ft(s,t,e.title||e.name||"Movie poster","movie-poster")},$t=(e,t="w780")=>{const s=e.backdrop_path||e.backdrop;return Ft(s,t,(e.title||e.name)+" backdrop","backdrop-image")},Ht=({section:s,item:a,onUndo:r,onDismiss:i})=>{const{getCountdown:n,undoDelete:o}=gt(),[l,c]=e.useState(!1),d=e.useRef(5e3),u=e.useRef(""),h=e.useRef(null),m=e.useRef(null),p=e.useRef(!0),x=e.useRef(null),g=e.useRef(null),[f,w]=e.useState({name:"",durationMs:0}),b=e.useMemo((()=>{if("undefined"!=typeof window&&window.matchMedia)try{return window.matchMedia("(prefers-reduced-motion: reduce)").matches}catch(e){return!1}return!1}),[]);e.useEffect((()=>{x.current=i,g.current=r}),[i,r]),e.useEffect((()=>(p.current=!0,()=>{p.current=!1})),[]);const v=e.useMemo((()=>"undo_progress_"+`${s}-${a?.id||"x"}-${a?.deletedAt||"0"}`.replace(/[^a-zA-Z0-9_-]/g,"_")),[s,a?.id,a?.deletedAt]);e.useEffect((()=>{const{remainingMs:e}=n(s,a)||{},t=Math.max(0,e||0);if(d.current=t,u.current=v,!h.current||h.current.getAttribute("data-undo-progress")!==v){h.current&&h.current.parentNode&&h.current.parentNode.removeChild(h.current);const e=document.createElement("style");e.setAttribute("data-undo-progress",v),e.textContent=`@keyframes ${v} { 0% { transform: scaleX(1) } 100% { transform: scaleX(0) } }`,document.head.appendChild(e),h.current=e}return w({name:v,durationMs:t}),m.current&&clearTimeout(m.current),t>0&&!b?m.current=setTimeout((()=>{p.current&&x.current?.("down")}),t+50):t>0||setTimeout((()=>{p.current&&x.current?.("down")}),0),()=>{m.current&&(clearTimeout(m.current),m.current=null)}}),[s,a,n,v,b]);const y=e.useMemo((()=>"continueWatching"===s?"Removed from Continue Watching":"Removed from Watchlist"),[s]),j=e.useMemo((()=>{if(a?.thumbnailUrl)return a.thumbnailUrl;const e=a?.poster_path||a?.backdrop_path||null;return e?Pt(e,"w154"):null}),[a?.thumbnailUrl,a?.poster_path,a?.backdrop_path]),N=e.useCallback((async()=>{m.current&&(clearTimeout(m.current),m.current=null);try{const e=o(s,a),t=await Promise.resolve(e);g.current?.(t)}catch(e){}finally{x.current?.("right")}}),[s,a,o]),k=e.useCallback((()=>{m.current&&(clearTimeout(m.current),m.current=null),x.current?.("down")}),[]);return t.jsx(Q.div,{role:"status","aria-live":"polite",className:"pointer-events-auto",children:t.jsxs(Q.div,{drag:"x",dragConstraints:{left:0,right:0},dragElastic:.2,dragTransition:{bounceStiffness:600,bounceDamping:20},onDragStart:()=>{c(!0)},onDragEnd:(e,t)=>{c(!1),35>t.offset.x?t.offset.x>-35||x.current?.("left"):N()},className:"relative mx-auto max-w-7xl bg-white/90 dark:bg-black/75 backdrop-blur-xl border border-black/10 dark:border-white/10 rounded-2xl shadow-xl px-3.5 py-3 md:px-4 md:py-3.5 text-sm md:text-[13px] text-black dark:text-white cursor-grab active:cursor-grabbing",tabIndex:0,onKeyDown:e=>{"Enter"===e.key||" "===e.key||"Spacebar"===e.key||"Space"===e.code?(e.preventDefault(),N()):"Escape"===e.key&&(e.preventDefault(),k())},children:[t.jsx("div",{className:"absolute left-2 md:left-2.5 top-[0.3px] md:top-[0.3px] right-2 md:right-2.5 h-[2px] bg-black/10 dark:bg-white/10 overflow-hidden rounded-full","aria-hidden":"true",children:t.jsx("div",{style:{transformOrigin:"left",animationName:f.name,animationDuration:(b?0:f.durationMs)+"ms",animationTimingFunction:"linear",animationFillMode:"forwards",animationIterationCount:1,animationDirection:"normal",animationDelay:"0ms",animationPlayState:l||b?"paused":"running",willChange:"transform"},className:"h-full bg-black/70 dark:bg-white/80 rounded-full"})}),t.jsxs("div",{className:"flex items-center gap-3 md:gap-3.5 min-w-0 relative",children:[t.jsx("div",{className:"absolute -left-1 top-1/2 -translate-y-1/2 w-1 h-8 bg-gradient-to-r from-transparent to-black/20 dark:to-white/20 rounded-r-full opacity-60"}),t.jsx("div",{className:"absolute -right-1 top-1/2 -translate-y-1/2 w-1 h-8 bg-gradient-to-l from-transparent to-black/20 dark:to-white/20 rounded-l-full opacity-60"}),t.jsx("div",{className:"shrink-0 rounded-md overflow-hidden bg-black/10 dark:bg-white/10 w-12 h-12 md:w-10 md:h-10",children:j?t.jsx("img",{src:j,alt:(a?.title||a?.name||"Thumbnail")+" poster",className:"w-full h-full object-cover",loading:"lazy",decoding:"async"}):t.jsx("div",{className:"w-full h-full flex items-center justify-center text-[10px] md:text-[9px] opacity-60",children:"No image"})}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsx("p",{className:"font-medium leading-5 truncate opacity-90",children:y}),t.jsx("p",{className:"text-xs opacity-70 truncate",children:a.title||a.name||"Untitled"})]}),t.jsxs("div",{className:"flex items-center gap-1.5 md:gap-2 shrink-0",children:[t.jsx(Q.button,{whileHover:{scale:1.03},whileTap:{scale:.97},onClick:N,className:"px-3 md:px-3.5 h-9 md:h-8 min-w-[64px] md:min-w-[56px] rounded-lg border border-black/20 dark:border-white/20 bg-black/5 dark:bg-white/10 hover:bg-black/10 dark:hover:bg-white/15 transition-colors text-[13px] md:text-xs font-semibold tracking-wide",children:"Undo"}),t.jsx("button",{onClick:k,"aria-label":"Dismiss notification",className:"hidden md:flex p-2 md:p-1.5 rounded-lg hover:bg-black/5 dark:hover:bg-white/10 transition-colors",children:t.jsxs("svg",{className:"w-4 h-4 opacity-70",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]})]})})},Vt={exit:e=>{const t=e&&e.direction||"down";return"left"===t?{opacity:0,x:-64,scale:.96}:"right"===t?{opacity:0,x:64,scale:.96}:{opacity:0,y:100,scale:.96,transition:{duration:.3,ease:"easeInOut"}}}},Ut=()=>{const{deletedItems:s,undoDelete:a}=gt(),{restoreToContinueWatching:r}=At(),{restoreToWatchlist:i}=jt(),[n,o]=e.useState([]),l=e.useRef(new Map),c=e.useRef(!0),d=e.useMemo((()=>{const e=[],t=(e,t)=>{if(!e)return null;const s=`${t}-${e.id||e.tmdb_id||"x"}-${e.deletedAt||"0"}`;return{...e,section:t,__key:s}};if(s?.continueWatching?.length){const a=t(s.continueWatching.reduce(((e,t)=>e?(t.deletedAt||0)>(e.deletedAt||0)?t:e:t),null),"continueWatching");a&&e.push(a)}if(s?.watchlist?.length){const a=t(s.watchlist.reduce(((e,t)=>e?(t.deletedAt||0)>(e.deletedAt||0)?t:e:t),null),"watchlist");a&&e.push(a)}return e}),[s]);e.useEffect((()=>{o((e=>{const t=new Map(e.map((e=>[e.__key||`${e.section}-${e.deletedAt||"0"}`,e])));d.forEach((e=>{const s=t.get(e.__key);s?t.set(e.__key,{...e,__isExiting:s.__isExiting,__exitDirection:s.__exitDirection}):t.set(e.__key,e)}));const s=[];d.forEach((e=>{const a=t.get(e.__key);a&&s.push(a),t.delete(e.__key)}));for(const a of t.values())s.push(a);return s}))}),[d]);const u=e.useCallback((e=>{const t=l.current.get(e);t&&(clearTimeout(t),l.current.delete(e)),o((t=>t.filter((t=>t.__key!==e))))}),[]),h=e.useCallback((async(e,t)=>{const s=t.__key,n=l.current.get(s);n&&(clearTimeout(n),l.current.delete(s));try{const s=a(e,t),n=await Promise.resolve(s);"continueWatching"===e?r(n):"watchlist"===e&&i(n)}catch(o){}finally{u(s)}}),[a,r,i,u]),m=e.useCallback(((e,t,s="down")=>{const a=t.__key;o((e=>e.map((e=>e.__key===a?{...e,__exitDirection:s,__isExiting:!0}:e))));const r=setTimeout((()=>{c.current&&(o((e=>e.filter((e=>e.__key!==a)))),l.current.delete(a))}),300);l.current.set(a,r)}),[]);return e.useEffect((()=>(c.current=!0,()=>{c.current=!1;for(const e of l.current.values())clearTimeout(e);l.current.clear()})),[]),0===n.length?null:t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"fixed left-1/2 -translate-x-1/2 z-50 flex flex-col gap-2 items-stretch w-[calc(100%-1rem)] pointer-events-none md:hidden",style:{bottom:"calc(env(safe-area-inset-bottom, 0px) + 76px)"},children:t.jsx(Z,{children:n.map(((e,s)=>t.jsx(Q.div,{initial:{opacity:0,y:16},animate:{opacity:1,y:0},variants:Vt,exit:"exit",custom:{direction:e.__exitDirection},transition:{duration:.28,ease:"easeInOut"},className:"pointer-events-auto",children:t.jsx(Ht,{section:e.section,item:e,onUndo:()=>h(e.section,e),onDismiss:t=>m(e.section,e,t)})},`${e.section}-${e.deletedAt||"0"}`)))})}),t.jsx("div",{className:"fixed bottom-4 right-4 z-50 hidden md:flex md:flex-col md:gap-3 md:items-end pointer-events-none",children:t.jsx(Z,{children:n.map(((e,s)=>t.jsx(Q.div,{initial:{opacity:0,y:16},animate:{opacity:1,y:0},variants:Vt,exit:"exit",custom:{direction:e.__exitDirection},transition:{duration:.28,ease:"easeInOut"},className:"pointer-events-auto",children:t.jsx(Ht,{section:e.section,item:e,onUndo:()=>h(e.section,e),onDismiss:t=>m(e.section,e,t)})},`${e.section}-${e.deletedAt||"0"}`)))})})]})};let Yt=1;const qt=new Map;function Gt(e,t={}){if("undefined"==typeof window||"undefined"==typeof performance)return null;const s=1e3/(t.targetFps||25);if("undefined"!=typeof document&&"visible"!==document.visibilityState)return null;const a=Yt++;let r=null,i=null,n=!1;const o=t=>{if(!n)try{e(t)}catch(s){}finally{n=!0,qt.delete(a)}},l=()=>{if("undefined"!=typeof document&&"visible"!==document.visibilityState)return n=!0,void qt.delete(a);try{i=requestAnimationFrame((e=>o(e)))}catch(e){r=setTimeout((()=>o(performance.now())),Math.max(0,s))}};if(t.immediate)l();else{const e=Math.max(0,t.delay||s);r=setTimeout(l,e)}return qt.set(a,{timeoutId:r,rafId:i}),a}function Jt(e){if(!e)return;const t=qt.get(e);if(t){try{t.rafId&&cancelAnimationFrame(t.rafId),t.timeoutId&&clearTimeout(t.timeoutId)}catch(s){}qt.delete(e)}}const Xt=e=>({width:e,height:e,position:"relative"}),Kt={initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.18,ease:[.2,.8,.2,1]}},Qt=({size:e=48,visible:s=!0,overlay:a=!0,animation:r=Kt})=>{const i="number"==typeof e?e+"px":e;return t.jsx(Z,{children:s&&t.jsxs(Q.div,{...r,className:(a?"absolute inset-0 bg-black/40":"relative")+" flex items-center justify-center z-20",children:[t.jsx("div",{className:"loader-spinner",style:Xt(i)}),t.jsx("style",{children:`\n            .loader-spinner { --size: 18px; --first-block-clr: rgba(255,255,255, 0.9); --second-block-clr: rgba(255,255,255, 0.9); --clr: #111; width: ${i}; height: ${i}; position: relative; }\n            .loader-spinner::after,.loader-spinner::before { box-sizing: border-box; position: absolute; content: ""; width: 18px; height: 20px; top: 50%; animation: up 2.4s cubic-bezier(0,0,0.24,1.21) infinite; left: 50%; background: var(--first-block-clr); backdrop-filter: blur(8px); }\n            .loader-spinner::after { background: var(--second-block-clr); top: calc(50% - var(--size)); left: calc(50% - var(--size)); animation: down 2.4s cubic-bezier(0,0,0.24,1.21) infinite; backdrop-filter: blur(8px); }\n            @keyframes down { 0%,100% { transform: none; } 25% { transform: translateX(80%);} 50% { transform: translateX(80%) translateY(80%);} 75% { transform: translateY(80%);} }\n            @keyframes up { 0%,100% { transform: none; } 25% { transform: translateX(-90%);} 50% { transform: translateX(-90%) translateY(-90%);} 75% { transform: translateY(-90%);} }\n          `})]})})},Zt={duration:.35,ease:[.25,.46,.45,.94]},es={duration:0},ts=e.memo((({children:s,rootMargin:a="400px",placeholderHeight:r=300})=>{const[i,n]=e.useState(!1),[o,l]=e.useState(!1),c=e.useRef(null),d=ae(),u=(()=>{if("undefined"==typeof window)return!1;try{const e=window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches,t=navigator&&(navigator.connection||null),s=!(!t||"boolean"!=typeof t.saveData)&&t.saveData,a=t&&t.effectiveType?t.effectiveType:null;return!!(e||s||a&&["slow-2g","2g"].includes(a))}catch(e){return!1}})()||d;return e.useEffect((()=>{if(!c.current||i)return;let e;try{e=new IntersectionObserver((t=>{const s=t[0];s&&(s.isIntersecting||s.intersectionRatio>0)&&(n(!0),e&&"function"==typeof e.disconnect&&e.disconnect(),requestAnimationFrame((()=>{requestAnimationFrame((()=>{l(!0)}))})))}),{root:null,rootMargin:a,threshold:.01}),e.observe(c.current)}catch(t){n(!0),l(!0)}return()=>{if(e)try{e.disconnect()}catch(t){}}}),[a,i]),t.jsx("div",{ref:c,style:{minHeight:r},children:i?u?t.jsx("div",{style:{contain:"layout style paint"},children:s}):t.jsx(Q.div,{style:{contain:"layout style paint",backfaceVisibility:"hidden",WebkitBackfaceVisibility:"hidden",perspective:1e3},initial:{opacity:0,y:20},animate:o?{opacity:1,y:0}:{opacity:0,y:20},transition:u?{duration:0}:{...Zt,duration:.5},children:s}):t.jsx("div",{style:{height:r},"aria-hidden":"true"})})}));class ss extends s.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t}),this.props.onError&&this.props.onError(e,t)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:t.jsx("div",{className:"flex items-center justify-center min-h-screen bg-[#121417]",children:t.jsxs("div",{className:"text-center text-white",children:[t.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Something went wrong"}),t.jsx("p",{className:"text-lg mb-6",children:"We're sorry, but something unexpected happened."}),t.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Refresh Page"}),!1]})}):this.props.children}}const as=e.memo((({size:s="default",color:a="white",showProgress:r=!1,progress:i=0,text:n,className:o="",variant:l="default",speed:c=1,glass:d=!1,ariaLabel:u="Loading...",animate:h=!0,onComplete:m})=>{const p=e.useRef(i),[x,g]=e.useState(i),f=e.useRef(null);e.useEffect((()=>{if(!r)return;const e=p.current,t=Math.max(0,Math.min(100,i)),s=performance.now(),a=r=>{const i=Math.min((r-s)/300,1);g(e+(t-e)*(1-Math.pow(1-i,3))),1>i?f.current=requestAnimationFrame(a):(p.current=t,t>=100&&m&&m())};return f.current=requestAnimationFrame(a),()=>{f.current&&cancelAnimationFrame(f.current)}}),[i,r,m]);const w=e.useMemo((()=>({tiny:"w-4 h-4",small:"w-6 h-6",default:"w-12 h-12",large:"w-16 h-16",xlarge:"w-24 h-24","2xl":"w-32 h-32"})),[]),b=e.useMemo((()=>({white:"border-white",blue:"border-blue-500",purple:"border-purple-500",green:"border-green-500",red:"border-red-500",yellow:"border-yellow-500",pink:"border-pink-500",indigo:"border-indigo-500",rainbow:""})),[]),v=e.useCallback((e=>"rainbow"===a?"":`${b[a]}/${e}`),[a,b]),y=e.useMemo((()=>2/c+"s"),[c]),j=e.useMemo((()=>"conic-gradient(from 0deg, #60a5fa, #a78bfa, #f472b6, #facc15, #4ade80, #60a5fa)"),[]),N=e.useCallback((()=>{const e={white:"rgba(255,255,255,0.45)",blue:"#818cf8aa",purple:"#a78bfa99",green:"#6ee7b7aa",red:"#f87171aa",yellow:"#fde68aaa",pink:"#f9a8d4aa",indigo:"#818cf8aa"};return t.jsxs("div",{className:"flex items-center justify-center gap-2 relative","aria-label":"Loading",role:"status",style:{animation:h?`dotsBreath ${2/c}s ease-in-out infinite`:"none"},children:[[...[,,,]].map(((s,r)=>t.jsx("div",{className:`w-2 h-2 rounded-full ${b[a]} shadow-md relative`,style:{animation:h?`dotBounce 0.7s cubic-bezier(0.68,-0.55,0.27,1.55) ${.18*r}s infinite both, dotGlow 1.2s ${.18*r}s infinite alternate`:"none",filter:"brightness(1.1) drop-shadow(0 0 2px rgba(255,255,255,0.18))",boxShadow:"0 0 8px 2px "+(e[a]||e.white)},children:t.jsx("div",{className:"absolute inset-0 rounded-full pointer-events-none",style:{background:"radial-gradient(circle,rgba(255,255,255,0.18) 40%,transparent 80%)",filter:"blur(0.5px)"}})},r))),t.jsx("style",{children:`\n          @keyframes dotBounce {\n            0%, 80%, 100% { transform: translateY(0) scale(1); opacity: 0.7; }\n            40% { transform: translateY(-8px) scale(1.18); opacity: 1; }\n          }\n          @keyframes dotGlow {\n            0%, 100% { box-shadow: 0 0 8px 2px ${e[a]||e.white}; }\n            50% { box-shadow: 0 0 16px 4px ${e[a]||e.white}; }\n          }\n          @keyframes dotsBreath {\n            0%, 100% { transform: scale(1);}\n            50% { transform: scale(1.04);}\n          }\n        `})]})}),[a,b,h,c]);return t.jsxs("div",{className:`relative ${w[s]} ${o} ${d?"backdrop-blur-md":""}`,role:"progressbar","aria-label":u,"aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":r?Math.round(x):void 0,"aria-live":"polite","aria-busy":"true",children:[t.jsx("span",{className:"sr-only",children:u}),t.jsx(Z,{mode:"wait",children:t.jsxs(Q.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.3},children:["default"===l&&t.jsxs(t.Fragment,{children:[d&&t.jsx("div",{className:"absolute inset-0 rounded-full bg-white/6 border border-white/10 shadow-lg z-0"}),t.jsx("div",{className:"absolute inset-0 rounded-full pointer-events-none",style:{boxShadow:"0 0 32px 8px var(--tw-shadow-color, rgba(0,0,0,0.12)), 0 0 64px 16px var(--tw-shadow-color, rgba(0,0,0,0.10))",background:"radial-gradient(circle, rgba(255,255,255,0.10) 60%, transparent 100%)",zIndex:1}}),t.jsx("div",{className:"absolute inset-0 rounded-full border-2 "+("rainbow"!==a?v(10):""),style:{background:"rainbow"===a?j:"conic-gradient(from 0deg, rgba(255,255,255,0.08) 0%, var(--tw-shadow-color, rgba(0,0,0,0.04)) 100%)",animation:`spin ${y} linear infinite`,zIndex:2}}),t.jsx("div",{className:`absolute inset-0 rounded-full border-4 ${"rainbow"!==a?"border-t-"+b[a]:""} border-r-transparent border-b-transparent border-l-transparent shadow-[0_0_16px_4px_rgba(0,0,0,0.10)]`,style:{background:"rainbow"===a?j:"linear-gradient(120deg, rgba(255,255,255,0.10) 0%, transparent 100%)",animation:`spin ${1.2/c}s cubic-bezier(0.4,0,0.2,1) infinite`,zIndex:3}}),t.jsx("div",{className:"absolute inset-2 rounded-full border-2 border-dashed "+("rainbow"!==a?v(7):""),style:{background:"radial-gradient(circle, rgba(255,255,255,0.06) 60%, transparent 100%)",animation:`spin ${3.2/c}s linear infinite reverse`,zIndex:4}}),t.jsx("div",{className:"absolute inset-[32%] rounded-full shadow-[0_0_12px_3px_rgba(0,0,0,0.13)]",style:{background:"rainbow"===a?"linear-gradient(135deg, #fff8, #fff2), "+j:`linear-gradient(135deg, rgba(255,255,255,0.18) 0%, var(--tw-shadow-color, rgba(0,0,0,0.10)) 100%), var(--${a}-500, #fff)`,animation:`pulse ${1.6/c}s ease-in-out infinite`,zIndex:5}}),t.jsx("div",{className:"absolute inset-0 rounded-full blur-lg pointer-events-none",style:{background:"rainbow"===a?"radial-gradient(circle, #fff8 60%, transparent 100%)":"radial-gradient(circle, var(--tw-shadow-color, rgba(255,255,255,0.12)) 60%, transparent 100%)",animation:`glowPulse ${2.2/c}s ease-in-out infinite`,opacity:.7,zIndex:6}}),t.jsx("div",{className:"absolute left-1/2 top-0 w-2 h-2 -translate-x-1/2 rounded-full shadow-md",style:{background:"rainbow"===a?"linear-gradient(120deg, #f472b6 60%, #60a5fa 100%)":`linear-gradient(120deg, var(--${a}-500, #fff) 60%, #fff 100%)`,boxShadow:"rainbow"===a?"0 0 8px 2px #f472b6, 0 0 2px 1px #60a5fa":`0 0 8px 2px var(--${a}-500, #fff), 0 0 2px 1px #fff`,transformOrigin:"50% 100%",animation:`orbit ${1.2/c}s linear infinite`,zIndex:7}}),t.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{zIndex:8,animation:"sparkle 2.8s linear infinite",background:"radial-gradient(circle at 70% 30%, rgba(255,255,255,0.12) 0.5px, transparent 1.5px), \n                       radial-gradient(circle at 20% 80%, rgba(255,255,255,0.10) 0.7px, transparent 1.7px)",backgroundSize:"100% 100%",backgroundRepeat:"no-repeat"}}),t.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",children:[...[,,,]].map(((e,s)=>t.jsx("div",{className:"absolute w-1.5 h-1.5 rounded-full",style:{top:"50%",left:"50%",background:"rainbow"===a?j:`var(--${a}-500, #fff)`,opacity:.7,filter:"blur(1.5px)",transform:`rotate(${120*s}deg) translateX(22px) translateY(-50%)`,animation:`orbit ${1.8+.5*s/c}s linear infinite ${.2*s}s`}},s)))}),t.jsx("style",{children:"\n        @keyframes glowPulse {\n          0%, 100% { opacity: 0.7; }\n          50% { opacity: 1; }\n        }\n        @keyframes orbit {\n          0% { transform: rotate(0deg) translateY(-44%) scale(1); }\n          80% { transform: rotate(288deg) translateY(-44%) scale(1.15);}\n          100% { transform: rotate(360deg) translateY(-44%) scale(1);}\n        }\n        @keyframes sparkle {\n          0% { opacity: 0.7; filter: blur(0.5px);}\n          50% { opacity: 1; filter: blur(1.2px);}\n          100% { opacity: 0.7; filter: blur(0.5px);}\n        }\n        @keyframes pulse {\n          0%, 100% { transform: scale(1); opacity: 0.8; }\n          50% { transform: scale(1.12); opacity: 1; }\n        }\n        @keyframes spin {\n          100% { transform: rotate(360deg);}\n        }\n        @keyframes shimmerText {\n          0% { background-position: -200% 0; }\n          100% { background-position: 200% 0; }\n        }\n      "})]}),"circular"===l&&t.jsx("div",{className:"relative w-full h-full",children:t.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 100 100",children:[t.jsx("circle",{className:"stroke-current",strokeWidth:"8",strokeLinecap:"round",fill:"none",cx:"50",cy:"50",r:"40",style:{stroke:`rgb(var(--${a}-500))`,opacity:.2}}),t.jsx("circle",{className:"stroke-current",strokeWidth:"8",strokeLinecap:"round",fill:"none",cx:"50",cy:"50",r:"40",style:{stroke:`rgb(var(--${a}-500))`,strokeDasharray:2.51*(i||0)+" 251.2",transform:"rotate(-90deg)",transformOrigin:"50% 50%",transition:"stroke-dasharray 0.3s ease"}})]})}),"dots"===l&&N()]},l)}),r&&t.jsx(Q.div,{className:"absolute inset-0 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:t.jsxs("span",{className:"text-xs font-medium text-white/60",children:[Math.round(x),"%"]})}),n&&t.jsx(Q.div,{className:"absolute -bottom-6 left-1/2 transform -translate-x-1/2 whitespace-nowrap",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{delay:.3},children:t.jsx("span",{className:"text-xs font-medium text-white/60 bg-gradient-to-r from-white via-blue-200 to-white bg-[length:200%_100%] bg-clip-text text-transparent animate-shimmer-text",style:{animation:h?`shimmerText ${2/c}s linear infinite`:"none"},children:n})}),t.jsx("style",{children:"\n        .animate-shimmer-text {\n          background-size: 200% 100%;\n          background-repeat: no-repeat;\n          -webkit-background-clip: text;\n          -webkit-text-fill-color: transparent;\n        }\n      "})]})}),((e,t)=>e.size===t.size&&e.color===t.color&&e.variant===t.variant&&e.showProgress===t.showProgress&&e.text===t.text&&e.className===t.className&&e.speed===t.speed&&e.glass===t.glass&&e.animate===t.animate&&1>Math.abs((e.progress||0)-(t.progress||0)))),rs=e.memo((({text:s="Loading your cinematic experience...",showProgress:a=!0,progress:r=0,tips:i=["Tip: Add movies to your watchlist for quick access later.","Did you know? You can filter by genre and year.","Pro: Hover a card for instant details.","Explore: Try the 'View All' mode for endless scrolling.","Fun Fact: Our posters are fetched in real-time from TMDB.","Hint: Use keyboard arrows to navigate carousels."],showTips:n=!0,tipInterval:o=3e3,variant:l="minimalist",onComplete:c,enableEscapeKey:d=!1,onEscape:u})=>{const[h,m]=e.useState(0),p=e.useRef(0),x=e.useRef(null),[g,f]=e.useState(i&&Array.isArray(i)&&i.length>0?Math.floor(Math.random()*i.length):0),[w,b]=e.useState(!1),v=e.useRef(null),y=e.useRef(!0),j=e.useRef(null);e.useEffect((()=>{if(!a)return;const e=p.current,t=Math.max(0,Math.min(100,r)),s=performance.now(),i=a=>{const r=Math.min((a-s)/500,1);m(e+(t-e)*(1-Math.pow(1-r,2))),1>r?x.current=requestAnimationFrame(i):(p.current=t,t>=100&&c&&setTimeout((()=>c()),300))};return x.current=requestAnimationFrame(i),()=>{x.current&&cancelAnimationFrame(x.current)}}),[r,a,c]);const N=e.useCallback((()=>{y.current&&i&&Array.isArray(i)&&i.length>0&&(b(!0),setTimeout((()=>{f((e=>(e+1)%i.length)),b(!1)}),300))}),[i]);e.useEffect((()=>{if(n&&i&&Array.isArray(i)&&i.length>=2)return v.current&&(clearInterval(v.current),v.current=null),v.current=setInterval(N,o),()=>{v.current&&(clearInterval(v.current),v.current=null)}}),[n,i,o,N]),e.useEffect((()=>{if(!d)return;const e=e=>{"Escape"===e.key&&u&&(e.preventDefault(),u())};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)}),[d,u]),e.useEffect((()=>()=>{y.current=!1,v.current&&(clearInterval(v.current),v.current=null),x.current&&(cancelAnimationFrame(x.current),x.current=null)}),[]),e.useEffect((()=>{j.current&&j.current.focus()}),[]),e.useEffect((()=>(document.documentElement.classList.add("page-loader-active"),document.body.classList.add("page-loader-active"),()=>{document.documentElement.classList.remove("page-loader-active"),document.body.classList.remove("page-loader-active")})),[]);const k=e.useMemo((()=>i),[i]);return t.jsx("div",{ref:j,tabIndex:-1,"aria-live":"polite",className:"fixed inset-0 flex items-center justify-center bg-[#121417] z-[9999] overflow-hidden page-loader-container",role:"dialog","aria-modal":"true",style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:9999,backgroundColor:"#121417",pointerEvents:"auto",overflow:"hidden",width:"100vw",height:"100vh",minHeight:"100vh",maxHeight:"100vh",margin:0,padding:0,touchAction:"none",userSelect:"none",WebkitOverflowScrolling:"auto"},children:"minimalist"===l?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-[#121417] via-[#1a1d24] to-[#121417] opacity-80"}),t.jsx("div",{className:"absolute inset-0 opacity-5",children:t.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_50%_50%,rgba(255,255,255,0.1)_1px,transparent_1px)] bg-[length:20px_20px]"})}),t.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center gap-8 px-6 m-0",children:[t.jsxs("div",{className:"flex flex-col items-center gap-4",children:[t.jsxs("div",{className:"relative",children:[t.jsxs("div",{className:"w-16 h-16 border-2 border-white/10 rounded-full relative",children:[t.jsx("div",{className:"absolute inset-0 border-2 border-transparent border-t-white/60 rounded-full animate-spin"}),t.jsx("div",{className:"absolute inset-0 border-2 border-transparent border-t-white/30 rounded-full animate-spin",style:{animationDuration:"2s",animationDirection:"reverse"}})]}),t.jsxs("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:[t.jsx("div",{className:"spinner"}),t.jsx("style",{children:'\n                    .spinner { --size: 10px; --first-block-clr: rgba(255,255,255, 0.8); --second-block-clr: rgba(255,255,255, 0.8); --clr: #111; width: 28px; height: 28px; position: relative; }\n                    .spinner::after,.spinner::before { box-sizing: border-box; position: absolute; content: ""; width: 10px; height: 12px; top: 50%; animation: up 2.4s cubic-bezier(0,0,0.24,1.21) infinite; left: 50%; background: var(--first-block-clr); }\n                    .spinner::after { background: var(--second-block-clr); top: calc(50% - var(--size)); left: calc(50% - var(--size)); animation: down 2.4s cubic-bezier(0,0,0.24,1.21) infinite; }\n                    @keyframes down { 0%,100% { transform: none; } 25% { transform: translateX(80%);} 50% { transform: translateX(80%) translateY(80%);} 75% { transform: translateY(80%);} }\n                    @keyframes up { 0%,100% { transform: none; } 25% { transform: translateX(-90%);} 50% { transform: translateX(-90%) translateY(-90%);} 75% { transform: translateY(-90%);} }\n                  '})]})]}),a&&t.jsx(Q.div,{className:"w-32 h-1 bg-white/10 rounded-full overflow-hidden",initial:{opacity:0,scaleX:.8},animate:{opacity:1,scaleX:1},transition:{delay:.3},children:t.jsx(Q.div,{className:"h-full bg-white/60 rounded-full",initial:{width:"0%"},animate:{width:Math.max(0,Math.min(100,h))+"%"},transition:{duration:.5,ease:"easeOut"}})})]}),t.jsxs(Q.div,{className:"text-center space-y-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},children:[t.jsx("h2",{className:"text-white/90 text-lg font-medium tracking-wide",children:s}),t.jsx("div",{className:"flex items-center justify-center gap-1",children:[...[,,,]].map(((e,s)=>t.jsx(Q.div,{className:"w-1.5 h-1.5 bg-white/40 rounded-full",animate:{opacity:[.4,1,.4],scale:[1,1.2,1]},transition:{duration:1.4,repeat:1/0,delay:.2*s}},s)))})]}),n&&k&&Array.isArray(k)&&k.length>0&&t.jsx(Q.div,{className:"text-center max-w-md m-0",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:t.jsx(Q.div,{className:"text-white/40 text-sm font-medium transition-opacity duration-500",animate:{opacity:w?0:1},children:t.jsxs("span",{className:"inline-flex items-center gap-2",children:[t.jsxs("svg",{className:"w-4 h-4 text-white/30",fill:"none",stroke:"currentColor",strokeWidth:1.5,viewBox:"0 0 24 24","aria-hidden":"true",children:[t.jsx("circle",{cx:"12",cy:"12",r:"10"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8v4m0 4h.01"})]}),k[g]]})})})]}),t.jsx("div",{className:"absolute top-8 right-8 w-16 h-16 border border-white/5 rounded-full opacity-30"}),t.jsx("div",{className:"absolute bottom-8 left-8 w-12 h-12 border border-white/5 rounded-full opacity-20"})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"absolute inset-0 bg-[url('/noise.png')] opacity-20 mix-blend-overlay pointer-events-none"}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent via-[#121417]/50 to-transparent pointer-events-none"}),t.jsx("div",{className:"absolute inset-0 pointer-events-none",children:t.jsxs("svg",{width:"100%",height:"100%",className:"w-full h-full",style:{filter:"blur(32px)"},children:[t.jsxs("defs",{children:[t.jsxs("radialGradient",{id:"aurora1",cx:"60%",cy:"30%",r:"60%",children:[t.jsx("stop",{offset:"0%",stopColor:"#6ee7b7",stopOpacity:"0.18"}),t.jsx("stop",{offset:"100%",stopColor:"#0f0f0f",stopOpacity:"0"})]}),t.jsxs("radialGradient",{id:"aurora2",cx:"30%",cy:"70%",r:"60%",children:[t.jsx("stop",{offset:"0%",stopColor:"#818cf8",stopOpacity:"0.14"}),t.jsx("stop",{offset:"100%",stopColor:"#0f0f0f",stopOpacity:"0"})]})]}),t.jsx("circle",{cx:"60%",cy:"30%",r:"320",fill:"url(#aurora1)"}),t.jsx("circle",{cx:"30%",cy:"70%",r:"260",fill:"url(#aurora2)"})]})}),t.jsxs("div",{className:"flex flex-col items-center gap-6 relative z-10 m-0",children:[t.jsxs("div",{className:"relative",children:[t.jsx(as,{size:"large"}),t.jsx("div",{className:"absolute inset-0 animate-[spin_3s_linear_infinite]",children:[...[,,,,,]].map(((e,s)=>t.jsx("div",{className:"absolute w-3 h-3 rounded-full backdrop-blur-sm",style:{top:"50%",left:"50%",background:s%2==0?"rgba(129,140,248,0.25)":"rgba(110,231,183,0.22)",boxShadow:s%2==0?"0 0 8px 2px #818cf8aa":"0 0 8px 2px #6ee7b7aa",transform:`rotate(${72*s}deg) translateX(44px) translateY(-50%)`}},s)))}),t.jsxs("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:[t.jsx("div",{className:"spinner"}),t.jsx("style",{children:'\n                  .spinner { --size: 18px; --first-block-clr: rgba(255,255,255, 0.8); --second-block-clr: rgba(255,255,255, 0.8); --clr: #111; width: 48px; height: 48px; position: relative; }\n                  .spinner::after,.spinner::before { box-sizing: border-box; position: absolute; content: ""; width: 18px; height: 20px; top: 50%; animation: up 2.4s cubic-bezier(0,0,0.24,1.21) infinite; left: 50%; background: var(--first-block-clr); backdrop-filter: blur(10px); }\n                  .spinner::after { background: var(--second-block-clr); top: calc(50% - var(--size)); left: calc(50% - var(--size)); animation: down 2.4s cubic-bezier(0,0,0.24,1.21) infinite; backdrop-filter: blur(10px); }\n                  @keyframes down { 0%,100% { transform: none; } 25% { transform: translateX(80%);} 50% { transform: translateX(80%) translateY(80%);} 75% { transform: translateY(80%);} }\n                  @keyframes up { 0%,100% { transform: none; } 25% { transform: translateX(-90%);} 50% { transform: translateX(-90%) translateY(-90%);} 75% { transform: translateY(-90%);} }\n                '})]}),a&&t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 bottom-[-18px] w-24 h-2 bg-white/10 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-[#818cf8] to-[#6ee7b7] transition-all duration-500",style:{width:Math.max(0,Math.min(100,r||0))+"%"}})})]}),t.jsx("div",{className:"text-white/70 text-base font-semibold tracking-wide animate-[pulse_2s_ease-in-out_infinite] text-center px-4",children:s}),n&&k&&Array.isArray(k)&&k.length>0&&t.jsx("div",{className:"text-xs text-white/40 font-medium text-center max-w-xs mt-2 transition-opacity duration-500 animate-fade-in m-0",children:t.jsxs("span",{className:"inline-flex items-center gap-1",children:[t.jsxs("svg",{className:"w-4 h-4 text-white/30",fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24","aria-hidden":"true",children:[t.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeOpacity:"0.3"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8v4m0 4h.01"})]}),k[g]]})})]})]})})}),((e,t)=>e.text===t.text&&e.variant===t.variant&&e.showProgress===t.showProgress&&e.showTips===t.showTips&&e.tipInterval===t.tipInterval&&e.enableEscapeKey===t.enableEscapeKey&&2>Math.abs((e.progress||0)-(t.progress||0))&&JSON.stringify(e.tips)===JSON.stringify(t.tips))),is=e.memo((({text:s="Loading content...",showProgress:a=!1,progress:r=0,tips:i=null,showTips:n=!1,className:o="",onComplete:l})=>{const[c,d]=e.useState(0),[u,h]=e.useState(!1),m=e.useRef(null),[p,x]=e.useState(0),g=e.useRef(0),f=e.useRef(null);e.useEffect((()=>{if(!a)return;const e=g.current,t=Math.max(0,Math.min(100,r)),s=performance.now(),i=a=>{const r=Math.min((a-s)/400,1);x(e+(t-e)*(1-Math.pow(1-r,2))),1>r?f.current=requestAnimationFrame(i):(g.current=t,t>=100&&l&&setTimeout((()=>l()),200))};return f.current=requestAnimationFrame(i),()=>{f.current&&cancelAnimationFrame(f.current)}}),[r,a,l]);const w=e.useCallback((()=>{i&&Array.isArray(i)&&i.length>0&&(h(!0),setTimeout((()=>{d((e=>(e+1)%i.length)),h(!1)}),300))}),[i]);return e.useEffect((()=>{if(n&&i&&Array.isArray(i)&&i.length>1)return m.current&&clearInterval(m.current),m.current=setInterval(w,3500),()=>{m.current&&(clearInterval(m.current),m.current=null)}}),[n,i,w]),t.jsxs(Q.div,{className:"flex items-center justify-center py-16 sm:py-20 relative min-h-[220px] "+o,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[t.jsxs("div",{className:"absolute inset-0 pointer-events-none z-0",children:[t.jsx("div",{className:"w-full h-full bg-gradient-to-r from-transparent via-[#121417]/40 to-transparent animate-section-shimmer"}),t.jsx("style",{children:"\n          @keyframes section-shimmer {\n            0% { background-position: -200% 0; }\n            100% { background-position: 200% 0; }\n          }\n          .animate-section-shimmer {\n            background-size: 200% 100%;\n            animation: section-shimmer 2.8s linear infinite;\n          }\n        "})]}),t.jsxs(Q.div,{className:"flex flex-col items-center gap-5 relative z-10",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1},children:[t.jsx(as,{size:"large",text:null,showProgress:!1,variant:"default"}),t.jsx(Q.div,{className:"text-white/80 text-lg font-semibold tracking-wide text-center px-4 drop-shadow-lg",animate:{opacity:[.7,1,.7]},transition:{duration:2,repeat:1/0},children:s}),a&&t.jsx(Q.div,{className:"w-40 h-2 bg-white/10 rounded-full overflow-hidden mt-2 shadow-inner",initial:{opacity:0,scaleX:.8},animate:{opacity:1,scaleX:1},transition:{delay:.2},children:t.jsx(Q.div,{className:"h-full bg-gradient-to-r from-[#818cf8] to-[#6ee7b7] rounded-full",initial:{width:"0%"},animate:{width:Math.max(0,Math.min(100,p))+"%"},transition:{duration:.4,ease:"easeOut"}})}),n&&i&&Array.isArray(i)&&i.length>0&&t.jsx(Q.div,{className:"text-xs text-white/50 font-medium text-center max-w-xs mt-3",initial:{opacity:0},animate:{opacity:u?0:1},transition:{duration:.3},children:t.jsxs("span",{className:"inline-flex items-center gap-1",children:[t.jsxs("svg",{className:"w-4 h-4 text-white/30",fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24","aria-hidden":"true",children:[t.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeOpacity:"0.3"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8v4m0 4h.01"})]}),i[c]]})})]})]})}),((e,t)=>e.text===t.text&&e.showProgress===t.showProgress&&e.showTips===t.showTips&&e.className===t.className&&2>Math.abs((e.progress||0)-(t.progress||0))&&JSON.stringify(e.tips)===JSON.stringify(t.tips))),ns=e.memo((({count:e=1,animate:s=!0,stagger:a=.05})=>t.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[Array.from({length:e}).map(((e,r)=>t.jsx(Q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:r*a,duration:.4},children:t.jsxs("div",{className:"relative overflow-hidden",children:[t.jsx(Q.div,{className:"aspect-[2/3] bg-white/5 rounded-lg relative overflow-hidden",animate:s?{backgroundPosition:["200% 0","-200% 0"]}:{},transition:s?{duration:2,repeat:1/0,ease:"linear"}:{},style:{background:"linear-gradient(90deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.1) 50%, rgba(255,255,255,0.05) 100%)",backgroundSize:"200% 100%"},children:s&&t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent animate-shimmer"})}),t.jsx(Q.div,{className:"h-4 bg-white/5 rounded mt-2 w-3/4 relative overflow-hidden",animate:s?{opacity:[.5,1,.5]}:{},transition:s?{duration:1.5,repeat:1/0}:{},children:s&&t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent animate-shimmer"})}),t.jsx(Q.div,{className:"h-3 bg-white/5 rounded mt-1 w-1/2 relative overflow-hidden",animate:s?{opacity:[.5,1,.5]}:{},transition:s?{duration:1.5,repeat:1/0,delay:.2}:{},children:s&&t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent animate-shimmer"})})]})},r))),t.jsx("style",{children:"\n        @keyframes shimmer {\n          0% { transform: translateX(-100%); }\n          100% { transform: translateX(100%); }\n        }\n        .animate-shimmer {\n          animation: shimmer 2s infinite;\n        }\n      "})]})),((e,t)=>e.count===t.count&&e.animate===t.animate&&e.stagger===t.stagger));as.propTypes={size:le.oneOf(["tiny","small","default","large","xlarge","2xl"]),color:le.oneOf(["white","blue","purple","green","red","yellow","pink","indigo","rainbow"]),showProgress:le.bool,progress:le.number,text:le.string,className:le.string,variant:le.oneOf(["default","circular","dots","pulse","bars"]),speed:le.number,glass:le.bool,ariaLabel:le.string,animate:le.bool,onComplete:le.func},rs.propTypes={text:le.string,showProgress:le.bool,progress:le.number,tips:le.arrayOf(le.string),showTips:le.bool,tipInterval:le.number,variant:le.oneOf(["minimalist","classic"]),onComplete:le.func,enableEscapeKey:le.bool,onEscape:le.func},is.propTypes={text:le.string,showProgress:le.bool,progress:le.number,tips:le.arrayOf(le.string),showTips:le.bool,className:le.string,onComplete:le.func},ns.propTypes={count:le.number,animate:le.bool,stagger:le.number},function(){try{if("undefined"==typeof window||document.getElementById("loader-keyframes"))return;const e=document.createElement("style");e.id="loader-keyframes",e.textContent="\n    /* Reset styles for page loader to prevent extra space */\n    .page-loader-container {\n      margin: 0 !important;\n      padding: 0 !important;\n      box-sizing: border-box !important;\n      overflow: hidden !important;\n      position: fixed !important;\n      top: 0 !important;\n      left: 0 !important;\n      right: 0 !important;\n      bottom: 0 !important;\n      width: 100vw !important;\n      height: 100vh !important;\n    }\n    \n    .page-loader-container * {\n      box-sizing: border-box !important;\n    }\n    \n    /* Prevent body scrolling when page loader is active */\n    body.page-loader-active {\n      overflow: hidden !important;\n      position: fixed !important;\n      width: 100% !important;\n      height: 100% !important;\n      top: 0 !important;\n      left: 0 !important;\n      right: 0 !important;\n      bottom: 0 !important;\n      touch-action: none !important;\n      -webkit-overflow-scrolling: auto !important;\n    }\n    \n    /* Prevent scrolling on html element as well */\n    html.page-loader-active {\n      overflow: hidden !important;\n      height: 100% !important;\n      touch-action: none !important;\n    }\n    /* Shimmer effect for skeleton loaders */\n    @keyframes shimmer {\n      0% {\n        transform: translateX(-100%);\n        opacity: 0.7;\n      }\n      50% {\n        opacity: 1;\n      }\n      100% {\n        transform: translateX(100%);\n        opacity: 0.7;\n      }\n    }\n\n    /* Bounce for dots or elements */\n    @keyframes bounce {\n      0%, 100% {\n        transform: translateY(0) scale(1);\n        opacity: 1;\n      }\n      50% {\n        transform: translateY(-8px) scale(1.12);\n        opacity: 0.85;\n      }\n    }\n\n    /* Pulse for loader center or text */\n    @keyframes pulse {\n      0%, 100% {\n        opacity: 0.8;\n        transform: scale(1);\n      }\n      50% {\n        opacity: 1;\n        transform: scale(1.12);\n      }\n    }\n\n    /* Orbit for rotating dots */\n    @keyframes orbit {\n      0% { transform: rotate(0deg) translateY(-44%) scale(1); }\n      80% { transform: rotate(288deg) translateY(-44%) scale(1.15);}\n      100% { transform: rotate(360deg) translateY(-44%) scale(1);}\n    }\n\n    /* Glow pulse for halo effects */\n    @keyframes glowPulse {\n      0%, 100% { opacity: 0.7; }\n      50% { opacity: 1; }\n    }\n\n    /* Sparkle for subtle background particles */\n    @keyframes sparkle {\n      0% { opacity: 0.7; filter: blur(0.5px);}\n      50% { opacity: 1; filter: blur(1.2px);}\n      100% { opacity: 0.7; filter: blur(0.5px);}\n    }\n\n    /* Loader slide-in for page loader */\n    @keyframes loaderSlideIn {\n      0% {\n        opacity: 0;\n        transform: translateY(32px) scale(0.98);\n      }\n      100% {\n        opacity: 1;\n        transform: translateY(0) scale(1);\n      }\n    }\n\n    /* Loader fade-out for page loader */\n    @keyframes loaderFadeOut {\n      0% {\n        opacity: 1;\n        transform: scale(1);\n      }\n      100% {\n        opacity: 0;\n        transform: scale(0.98);\n      }\n    }\n\n    /* Dots loader animation (for 3-dot loaders) */\n    @keyframes dotFlashing {\n      0% { opacity: 0.2; }\n      50%, 100% { opacity: 1; }\n    }\n      ",document.head.appendChild(e)}catch(e){}}();const os=Object.freeze(Object.defineProperty({__proto__:null,CardLoader:ns,Loader:as,PageLoader:rs,SectionLoader:is},Symbol.toStringTag,{value:"Module"}));class ls{constructor(){this.cleanupCallbacks=new Set,this.intervals=new Set,this.timeouts=new Set,this.eventListeners=new Map,this.isDestroyed=!1}addCleanupCallback(e){this.isDestroyed||this.cleanupCallbacks.add(e)}addInterval(e,t){if(this.isDestroyed)return null;const s=setInterval(e,t);return this.intervals.add(s),s}addTimeout(e,t){if(this.isDestroyed)return null;const s=setTimeout(e,t);return this.timeouts.add(s),s}addEventListener(e,t,s,a={}){this.isDestroyed||(e.addEventListener(t,s,a),this.eventListeners.has(e)||this.eventListeners.set(e,[]),this.eventListeners.get(e).push({event:t,handler:s,options:a}))}createDebouncedFunction(e,t){let s=null;return(...a)=>{s&&clearTimeout(s),s=this.addTimeout((()=>{e(...a)}),t)}}createThrottledFunction(e,t){let s=0;return(...a)=>{const r=Date.now();t>r-s||(s=r,e(...a))}}processItemsInBatches(e,t,s=10){return new Promise((a=>{let r=0;const i=()=>{e.slice(r,r+s).forEach(t),r+=s,r<e.length?this.addTimeout(i,0):a()};i()}))}optimizeImageLoading(e,t,s){const a=e.map((e=>new Promise(((t,s)=>{const a=new Image;a.onload=()=>t(e),a.onerror=()=>s(e),a.src=e}))));return Promise.allSettled(a)}cleanup(){this.isDestroyed=!0,this.intervals.forEach((e=>{clearInterval(e)})),this.intervals.clear(),this.timeouts.forEach((e=>{clearTimeout(e)})),this.timeouts.clear(),this.eventListeners.forEach(((e,t)=>{e.forEach((({event:e,handler:s,options:a})=>{t.removeEventListener(e,s,a)}))})),this.eventListeners.clear(),this.cleanupCallbacks.forEach((e=>{try{e()}catch(t){}})),this.cleanupCallbacks.clear()}isMounted(){return!this.isDestroyed}}const cs=()=>{const e=s.useRef(null);return s.useEffect((()=>(e.current=new ls,()=>{e.current&&e.current.cleanup()})),[]),e.current},ds=s.memo((({item:s,onClick:a,isMobile:r,onRemove:i,index:n,totalItems:o})=>{const[l,c]=e.useState(!1),[d,u]=e.useState(null),[h,m]=e.useState(!1),p=cs(),[x,g]=e.useState(!1),[f,w]=e.useState(!1),[b,v]=e.useState(!1),[y,j]=e.useState("w-80"),N=e.useRef(null),k=e.useRef(null),C=e.useRef(new Map),S=e.useRef(!0),_=e.useRef(null),L=3>n,T=L?"high":"low",M=e.useMemo((()=>r),[r]);e.useEffect((()=>(S.current=!0,()=>{S.current=!1,k.current&&clearTimeout(k.current)})),[]),e.useEffect((()=>{const e=()=>{const e=window.innerWidth;j(e>1800&&!M?"w-[420px]":M?"w-[160px] sm:w-[180px] md:w-[200px]":"w-80 xl:w-[340px]")};if(e(),p){const t=p.createDebouncedFunction(e,150);return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)}}),[M,p]);const E=e.useMemo((()=>"tv"===s.type?s.seasons?`${s.seasons} Season${s.seasons>1?"s":""}`:"TV Show":s.runtime?`${Math.floor(s.runtime/60)}h ${s.runtime%60}m`:"Movie"),[s.type,s.seasons,s.runtime]),I=e.useMemo((()=>{try{if(M){if(s.poster_path)return ye(s.poster_path,"w342");if(s.backdrop_path)return ye(s.backdrop_path,"w342")}else{if(s.backdrop_path)return ye(s.backdrop_path,"w500");if(s.poster_path)return ye(s.poster_path,"w342")}return null}catch(e){return null}}),[s.poster_path,s.backdrop_path,M]),D=e.useMemo((()=>s.lastWatched?new Date(s.lastWatched).getFullYear():s.release_date?new Date(s.release_date).getFullYear():s.first_air_date?new Date(s.first_air_date).getFullYear():(new Date).getFullYear()),[s.lastWatched,s.release_date,s.first_air_date]),R=e.useMemo((()=>"tv"===s.type&&s.season&&s.episode?`S${(s.season+"").padStart(2,"0")} E${(s.episode+"").padStart(2,"0")}`:""),[s.type,s.season,s.episode]),z=e.useMemo((()=>{const e=+s.progress||0;return Math.min(Math.max(e,0),100)}),[s.progress]);e.useMemo((()=>{const e=z;return 0===e?"Start watching":10>e?"Just started":30>e?"Early stages":70>e?e.toFixed(0)+"% complete":90>e?"Almost there":95>e?"Nearly finished":"Finish watching"}),[z]);const W=e.useCallback((async()=>{if("tv"===s.type&&s.season&&s.episode){const t=`${s.id}_${s.season}`,a=Date.now();if(C.current.has(t)){const e=C.current.get(t);if(3e5>a-e.timestamp)return void u(e.data)}if(_.current===t&&h)return;m(!0),_.current=t;try{const{getTVSeason:e}=await et((async()=>{const{getTVSeason:e}=await import("./services-H6xH4ufj.js").then((e=>e.af));return{getTVSeason:e}}),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url),r=await e(s.id,s.season);if(!S.current)return;const i=r.episodes?.length||0,n=Math.min(s.episode,i),o={watched:n,total:i,percentage:Math.round(10*(i>0?n/i*100:0))/10};C.current.set(t,{data:o,timestamp:a}),u(o)}catch(e){S.current&&u({watched:s.episode,total:s.episode,percentage:0})}finally{S.current&&m(!1)}}}),[s.id,s.season,s.episode,s.type,h]);e.useEffect((()=>{if("tv"===s.type&&s.season&&s.episode){const e=setTimeout((()=>{S.current&&W()}),L?0:100*n);return()=>clearTimeout(e)}}),[W,s.type,s.season,s.episode,L,n]);const A=e.useCallback((e=>{if(e.preventDefault(),e.stopPropagation(),!l)try{a(s)}catch(t){}}),[a,s,l]),O=e.useCallback((e=>{if(e.preventDefault(),e.stopPropagation(),!l){c(!0);try{setTimeout((()=>{S.current&&i(s)}),300)}catch(t){c(!1)}}}),[i,s,l]);e.useEffect((()=>{if(!N.current||b)return;if(L)return void v(!0);const e=new IntersectionObserver((t=>{t.forEach((t=>{t.isIntersecting&&!b&&S.current&&(v(!0),e.disconnect())}))}),{threshold:.05,rootMargin:"100px"});return e.observe(N.current),()=>{e.disconnect()}}),[b,L]),e.useEffect((()=>{if(b&&I&&!x&&!f)return function(){try{if("undefined"!=typeof window)return window.__STREAMR_CW_WARN_TS=window.__STREAMR_CW_WARN_TS||new Map,window.__STREAMR_CW_WARN_TS}catch(e){}}(),k.current=setTimeout((()=>{S.current&&!x&&((()=>{try{return}catch(e){}})(s.id,s.title),w(!0))}),8e3),()=>{k.current&&clearTimeout(k.current)}}),[b,I,x,f,s.title]);const P=e.useCallback((()=>{S.current&&(g(!0),w(!1),k.current&&clearTimeout(k.current))}),[]),F=e.useCallback((()=>{S.current&&(w(!0),g(!1),k.current&&clearTimeout(k.current))}),[]);return t.jsx("div",{ref:N,className:`group flex flex-col gap-4 rounded-lg ${y} flex-shrink-0 touch-manipulation`,"data-movie-id":s.id,"data-priority":L,style:{WebkitTapHighlightColor:"transparent",WebkitTouchCallout:"none",WebkitUserSelect:"none",userSelect:"none",touchAction:"manipulation",opacity:l?0:1,transform:l?"scale(0.8) translateY(-20px)":"scale(1) translateY(0)",transition:"all 300ms cubic-bezier(0.4, 0, 0.2, 1)",willChange:l?"opacity, transform":"auto"},children:t.jsxs("div",{className:`relative ${M?"aspect-[2/3]":"aspect-[16/10]"} rounded-lg overflow-hidden transform-gpu transition-all duration-300 hover:scale-[1.02] hover:shadow-2xl hover:shadow-black/20 w-full active:scale-[0.98] active:shadow-lg`,children:[t.jsxs("div",{className:"w-full h-full cursor-pointer touch-manipulation",onClick:A,role:"button",tabIndex:0,"aria-label":"Continue watching "+s.title,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),A(e))},style:{WebkitTapHighlightColor:"transparent",WebkitTouchCallout:"none",WebkitUserSelect:"none",userSelect:"none",touchAction:"manipulation"},children:[b&&I&&!f?t.jsxs(t.Fragment,{children:[!x&&t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-700 to-gray-900 flex items-center justify-center animate-pulse",children:t.jsxs("svg",{className:"w-12 h-12 text-gray-500 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),t.jsx("img",{src:I,alt:s.title,loading:"high"===T?"eager":"lazy",fetchpriority:T,className:`w-full h-full object-cover transition-all duration-700 ${x?"opacity-100 scale-100":"opacity-0 scale-95"} hover:scale-110`,style:{imageRendering:"auto",WebkitBackfaceVisibility:"hidden",backfaceVisibility:"hidden",transform:"translateZ(0)",WebkitFontSmoothing:"antialiased",WebkitTransform:"translate3d(0,0,0)"},draggable:!1,onError:F,onLoad:P})]}):t.jsxs("div",{className:"w-full h-full bg-gradient-to-br from-gray-700 via-gray-800 to-gray-900 flex flex-col items-center justify-center gap-3",children:[t.jsx("svg",{className:"w-16 h-16 text-gray-500",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M18 4l2 4h-3l-2-4h-2l2 4h-3l-2-4H8l2 4H7L5 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4h-4z"})}),f&&t.jsx("p",{className:"text-gray-400 text-xs",children:"Failed to load image"})]}),z>=70&&95>z&&t.jsxs(Q.div,{initial:{opacity:0,scale:.8,x:-10},animate:{opacity:1,scale:1,x:0},transition:{duration:.3,delay:.2},className:"absolute top-2 left-2 z-20 px-2.5 py-1 bg-white/5 backdrop-blur-sm rounded-full text-white text-[10px] font-semibold flex items-center gap-1.5 shadow-lg border border-white/30",children:[t.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z",stroke:"currentColor",strokeWidth:"0.5",fillRule:"evenodd",clipRule:"evenodd"})}),"Almost Done"]}),z>=95&&t.jsxs(Q.div,{initial:{opacity:0,scale:.8,x:-10},animate:{opacity:1,scale:1,x:0},transition:{duration:.3,delay:.2},className:"absolute top-2 left-2 z-20 px-2.5 py-1 bg-white/5 backdrop-blur-sm rounded-full text-white text-[10px] font-semibold flex items-center gap-1.5 shadow-lg border border-white/30",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M5 13l4 4L19 7"})}),"Complete"]}),t.jsx("div",{className:"hidden md:block absolute inset-0 bg-gradient-to-t from-black via-black/60 to-transparent opacity-100 transition-all duration-500 rounded-lg overflow-hidden",children:t.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4 transform translate-y-0 transition-transform duration-500 overflow-hidden",children:[t.jsx("h3",{className:"text-white font-medium text-lg truncate mb-1 drop-shadow-lg",children:s.title}),t.jsxs("div",{className:"flex items-center gap-2 text-white/90 text-sm drop-shadow-md flex-wrap",children:[t.jsx("span",{className:"flex items-center gap-1",children:D}),t.jsx("span",{children:"•"}),t.jsx("span",{className:"flex items-center gap-1",children:"tv"===s.type?"TV Show":"Movie"}),t.jsx("span",{children:"•"}),t.jsx("span",{className:"flex items-center gap-1",children:E}),"tv"===s.type&&s.season&&s.episode&&t.jsxs(t.Fragment,{children:[t.jsx("span",{children:"•"}),t.jsx("span",{className:"flex items-center gap-1 font-medium",children:R})]})]}),"tv"===s.type&&t.jsxs("div",{className:"mt-3",children:[t.jsxs("div",{className:"flex items-center justify-between text-white/70 text-xs mb-1.5",children:[t.jsxs("span",{className:"font-medium",children:["Season ",s.season||"N/A"]}),t.jsx("span",{className:"font-mono","aria-live":"polite","aria-atomic":"true",children:d?`${d.watched}/${d.total} eps`:h?t.jsx("span",{className:"animate-pulse",children:"Loading..."}):(s.episode||0)+" eps"})]}),t.jsxs("div",{className:"w-full bg-white/20 rounded-full h-1 relative overflow-hidden",children:[t.jsx("div",{className:"h-full rounded-full "+(d?"bg-white shadow-[0_0_8px_rgba(255,255,255,0.5)]":"bg-white/30"),style:{width:d?d.percentage+"%":"0%",transform:"translateZ(0)",willChange:"width",transition:"width 0.6s cubic-bezier(0.4, 0, 0.2, 1)"}}),h&&t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent animate-shimmer"})]})]}),"movie"===s.type&&t.jsxs("div",{className:"mt-3",children:[t.jsxs("div",{className:"flex items-center justify-between text-white/70 text-xs mb-1.5",children:[t.jsx("span",{className:"font-medium",children:"Watch Progress"}),t.jsxs("span",{className:"font-mono","aria-live":"polite","aria-atomic":"true",children:[z.toFixed(0),"%"]})]}),t.jsx("div",{className:"w-full bg-white/20 rounded-full h-1 relative overflow-hidden",children:t.jsx("div",{className:"h-full rounded-full "+(z>0?"bg-white shadow-[0_0_8px_rgba(255,255,255,0.5)]":"bg-white/30"),style:{width:Math.max(z,1)+"%",transform:"translateZ(0)",willChange:"width",transition:"width 0.6s cubic-bezier(0.4, 0, 0.2, 1)"}})})]})]})}),i&&t.jsxs(Q.button,{whileHover:{scale:1.1},whileTap:{scale:.95},"aria-label":`Remove ${s.title} from Continue Watching`,"aria-pressed":l,onClick:O,disabled:l,className:"absolute top-2 right-2 z-40 w-9 h-9 sm:w-8 sm:h-8 bg-black/70 hover:bg-red-600/90 disabled:bg-gray-600/70 rounded-full flex items-center justify-center transition-all duration-200 pointer-events-auto shadow-md shadow-black/30 group/btn",style:{WebkitTapHighlightColor:"transparent",WebkitTouchCallout:"none",WebkitUserSelect:"none",userSelect:"none",touchAction:"manipulation"},children:[l?t.jsxs("svg",{className:"w-4 h-4 text-white animate-spin",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):t.jsx("svg",{className:"w-4 h-4 text-white group-hover/btn:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),t.jsxs("span",{className:"sr-only",children:["Remove ",s.title," from Continue Watching"]})]})]}),M&&t.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-2 md:hidden z-20",style:{background:"linear-gradient(to top, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0.6) 60%, transparent 100%)",pointerEvents:"none"},children:[t.jsxs("div",{className:"flex items-center justify-between text-white/95 text-[11px] font-medium mb-1 px-1",children:[t.jsx("span",{className:"truncate",children:"tv"===s.type?"S"+(s.season||"N/A"):"Progress"}),t.jsx("span",{className:"font-mono text-[11px]",children:"tv"===s.type?d?`${d.watched}/${d.total}`:(s.episode||0)+" eps":z.toFixed(0)+"%"})]}),t.jsx("div",{className:"w-full h-0.5 rounded-full bg-white/20 overflow-hidden",children:t.jsx("div",{className:"h-full rounded-full bg-white",style:{width:"tv"===s.type?d?d.percentage+"%":"0%":Math.max(z,1)+"%",transition:"width 0.6s cubic-bezier(0.4, 0, 0.2, 1)"}})})]})]})})}),((e,t)=>e.item.id===t.item.id&&e.item.progress===t.item.progress&&e.item.season===t.item.season&&e.item.episode===t.item.episode&&e.isMobile===t.isMobile&&e.index===t.index));ds.displayName="ContinueWatchingCard",ds.propTypes={item:le.object.isRequired,onClick:le.func.isRequired,isMobile:le.bool,onRemove:le.func,index:le.number,totalItems:le.number};const us=({onMovieSelect:s,isMobile:a})=>{const{continueWatching:n,hasContinueWatching:o,removeFromContinueWatching:l,refreshFromStorage:c,clearAllContinueWatching:d,clearMoviesFromContinueWatching:u,clearTVShowsFromContinueWatching:h}=At(),m=cs(),[p,x]=e.useState(!1),[g,f]=e.useState(!1),[w,b]=e.useState(Date.now()),v=e.useRef(null);e.useRef(null),e.useRef(null),e.useRef(null);const[y,j]=e.useState((()=>{try{return"undefined"==typeof document||!document.hidden}catch(e){return!0}})),N=e.useCallback((async()=>{const e=Date.now();if(e-w>=5e3&&!g){f(!0);try{await c(),b(e)}catch(t){}finally{f(!1)}}}),[c,w,g]);e.useEffect((()=>{if(!m)return;N(),m.addEventListener(document,"visibilitychange",(()=>{const e=!document.hidden;j(e),e&&m.isMounted()&&N()})),m.addEventListener(window,"focus",(()=>{m.isMounted()&&y&&N()}));const e=y?3e4:6e4;m.addInterval((()=>{m.isMounted()&&N()}),e)}),[N,m,y]);const{memoizedContinueWatching:k,stats:C}=e.useMemo((()=>{const e=[...Array.isArray(n)?n:[]].sort(((e,t)=>{const s=e?.lastWatched?new Date(e.lastWatched).getTime():0;return(t?.lastWatched?new Date(t.lastWatched).getTime():0)-s})),t=e.reduce(((e,t)=>("movie"===t?.type&&(e.movies+=1),"tv"===t?.type&&(e.tvShows+=1),e.total+=1,e)),{movies:0,tvShows:0,total:0});return{memoizedContinueWatching:e,stats:t}}),[n]);e.useEffect((()=>{const e=v.current;if(e&&"object"==typeof e)try{"function"==typeof e.update&&e.update();const t=!!e.slides&&"number"==typeof e.slides.length;t&&("function"==typeof e.updateSlides&&e.updateSlides(),"function"==typeof e.updateProgress&&e.updateProgress(),"function"==typeof e.updateSize&&e.updateSize(),"function"==typeof e.updateSlidesClasses&&e.updateSlidesClasses());const s=Array.isArray(k)?k.length:0;t&&"number"==typeof e.activeIndex&&e.activeIndex>=s&&s>0&&"function"==typeof e.slideTo&&e.slideTo(0,0)}catch(t){}}),[k,a]);const S=e.useCallback((e=>{if(s&&e)try{const t={id:e.id,title:e.title,name:e.title,poster_path:e.poster_path,backdrop_path:e.backdrop_path,media_type:e.type,type:e.type,season:e.season,episode:e.episode,episodeTitle:e.episodeTitle,progress:e.progress,lastWatched:e.lastWatched,runtime:e.runtime,release_date:e.release_date,first_air_date:e.first_air_date};s(t)}catch(t){}}),[s]),_=e.useCallback((e=>{if(e)try{l(e.id,e.type,e.season,e.episode)}catch(t){}}),[l]),L=e.useCallback((()=>{try{d(),x(!1)}catch(e){}}),[d]),T=e.useCallback((()=>{try{u(),x(!1)}catch(e){}}),[u]),M=e.useCallback((()=>{try{h(),x(!1)}catch(e){}}),[h]);return e.useEffect((()=>{if(!p||!m)return;const e=e=>{e.target.closest(".clear-menu-container")||x(!1)},t=setTimeout((()=>{m.addEventListener(document,"mousedown",e)}),100);return()=>{clearTimeout(t)}}),[p,m]),o()?a?t.jsxs(Q.div,{className:"mt-8 px-4",initial:{opacity:0,y:40},animate:{opacity:1,y:0},transition:{duration:.6,ease:[.25,.46,.45,.94],delay:.1},children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("h2",{className:"text-xl font-semibold bg-gradient-to-r from-white via-white/90 to-white/60 bg-clip-text text-transparent",children:t.jsxs("span",{className:"inline-flex items-center gap-2",children:[t.jsx("span",{className:"flex-shrink-0 text-white",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 transition-transform duration-200 hover:scale-110",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",role:"img",children:t.jsx("path",{d:"M8 5v14l11-7z",stroke:"currentColor",strokeWidth:"0.5",fillRule:"evenodd",clipRule:"evenodd"})})}),t.jsx("span",{children:"Continue Watching"})]})}),t.jsx("span",{className:"px-2 py-0.5 text-xs font-medium bg-white/10 text-white/70 rounded-full",children:C.total})]}),t.jsxs("div",{className:"relative flex items-center gap-2 clear-menu-container",children:[t.jsxs("button",{onClick:()=>x(!p),className:"text-[11px] px-2.5 py-1 rounded-full bg-white/5 hover:bg-white/10 text-white/80 hover:text-white border border-white/10 transition-all duration-200 flex items-center gap-1 active:scale-95",children:["Clear",t.jsx(Q.svg,{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:p?180:0},transition:{duration:.2},children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t.jsx(Z,{children:p&&t.jsxs(Q.div,{initial:{opacity:0,scale:.95,y:-8},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-8},transition:{duration:.15,ease:"easeOut"},className:"absolute right-0 top-full mt-1 w-44 bg-[#1a1d24]/98 backdrop-blur-md rounded-xl shadow-2xl border border-white/20 py-1.5 z-50 clear-menu-container overflow-hidden",style:{backgroundImage:"linear-gradient(135deg, rgba(26, 29, 36, 0.98) 0%, rgba(43, 48, 54, 0.98) 100%)"},children:[t.jsxs("button",{onClick:L,disabled:0===C.total,className:"w-full px-3 py-2 text-[11px] text-left text-white/80 hover:text-white hover:bg-white/10 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-150 flex items-center gap-2 group rounded-lg",children:[t.jsx("svg",{className:"w-3.5 h-3.5 text-white/60 group-hover:text-white transition-all duration-200 group-hover:scale-110",fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16",stroke:"currentColor",strokeWidth:"0.5",fillRule:"evenodd",clipRule:"evenodd"})}),t.jsx("span",{children:"Clear All"}),t.jsxs("span",{className:"ml-auto text-[10px] font-mono opacity-60",children:["(",C.total,")"]})]}),t.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-white/10 to-transparent my-1"}),t.jsxs("button",{onClick:T,disabled:0===C.movies,className:"w-full px-3 py-2 text-[11px] text-left text-white/80 hover:text-white hover:bg-white/10 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-150 flex items-center gap-2 group rounded-lg",children:[t.jsx("svg",{className:"w-3.5 h-3.5 text-white/60 group-hover:text-white transition-all duration-200 group-hover:scale-110",fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"M18 4l2 4h-3l-2-4h-2l2 4h-3l-2-4H8l2 4H7L5 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4h-4z",stroke:"currentColor",strokeWidth:"0.5",fillRule:"evenodd",clipRule:"evenodd"})}),t.jsx("span",{children:"Clear Movies"}),t.jsxs("span",{className:"ml-auto text-[10px] font-mono opacity-60",children:["(",C.movies,")"]})]}),t.jsxs("button",{onClick:M,disabled:0===C.tvShows,className:"w-full px-3 py-2 text-[11px] text-left text-white/80 hover:text-white hover:bg-white/10 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-150 flex items-center gap-2 group rounded-lg",children:[t.jsx("svg",{className:"w-3.5 h-3.5 text-white/60 group-hover:text-white transition-all duration-200 group-hover:scale-110",fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"M21 3H3c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h5l-1 3v1h8v-1l-1-3h5c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 12H3V5h18v10z",stroke:"currentColor",strokeWidth:"0.5",fillRule:"evenodd",clipRule:"evenodd"})}),t.jsx("span",{children:"Clear TV Shows"}),t.jsxs("span",{className:"ml-auto text-[10px] font-mono opacity-60",children:["(",C.tvShows,")"]})]})]})})]})]}),t.jsx("div",{className:"flex gap-3 sm:gap-4 md:gap-6 overflow-x-auto scrollbar-hide pb-4 px-2 sm:px-4 horizontal-scroll-container",children:k.map(((e,s)=>t.jsx(Q.div,{className:"flex-shrink-0 relative group",initial:{opacity:0,y:30,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.4,ease:[.25,.46,.45,.94],delay:.3+.08*s},children:t.jsx(ds,{item:e,onClick:S,isMobile:a,onRemove:_,index:s,totalItems:k.length})},`continue-watching-${e.id}-${e.type}-${e.season||"movie"}-${e.episode||"movie"}`)))})]}):t.jsxs(Q.div,{className:"mt-8",initial:{opacity:0,y:40},animate:{opacity:1,y:0},transition:{duration:.6,ease:[.25,.46,.45,.94],delay:.1},children:[t.jsxs(Q.div,{className:"flex items-center justify-between mb-4 px-4",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,ease:[.25,.46,.45,.94],delay:.2},children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("h2",{className:"text-xl font-semibold bg-gradient-to-r from-white via-white/90 to-white/60 bg-clip-text text-transparent",children:t.jsxs("span",{className:"inline-flex items-center gap-2",children:[t.jsx("span",{className:"flex-shrink-0 text-white",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 transition-transform duration-200 hover:scale-110",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",role:"img",children:t.jsx("path",{d:"M8 5v14l11-7z",stroke:"currentColor",strokeWidth:"0.5",fillRule:"evenodd",clipRule:"evenodd"})})}),t.jsx("span",{children:"Continue Watching"})]})}),t.jsxs("span",{className:"px-2.5 py-1 text-xs font-medium bg-white/10 text-white/70 rounded-lg border border-white/5",children:[C.total," ",1===C.total?"item":"items"]})]}),t.jsxs("div",{className:"relative flex items-center gap-2 clear-menu-container",children:[g&&t.jsxs("svg",{className:"w-4 h-4 text-white/50 animate-spin mr-2",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t.jsxs("button",{onClick:()=>x(!p),className:"text-xs px-3 py-1.5 rounded-full bg-white/5 hover:bg-white/10 text-white/80 hover:text-white border border-white/10 transition-all duration-200 flex items-center gap-1.5 active:scale-95 hover:shadow-lg hover:shadow-white/5",children:["Clear",t.jsx(Q.svg,{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:p?180:0},transition:{duration:.2},children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t.jsx(Z,{children:p&&t.jsxs(Q.div,{initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},transition:{duration:.15,ease:"easeOut"},className:"absolute right-0 top-full mt-2 w-48 bg-[#1a1d24]/98 backdrop-blur-md rounded-xl shadow-2xl border border-white/20 py-2 z-50 clear-menu-container overflow-hidden",style:{backgroundImage:"linear-gradient(135deg, rgba(26, 29, 36, 0.98) 0%, rgba(43, 48, 54, 0.98) 100%)"},children:[t.jsxs("button",{onClick:L,disabled:0===C.total,className:"w-full px-4 py-2.5 text-xs text-left text-white/80 hover:text-white hover:bg-white/10 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-150 flex items-center gap-2.5 group rounded-lg",children:[t.jsx("svg",{className:"w-4 h-4 text-white/60 group-hover:text-white transition-all duration-200 group-hover:scale-110",fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16",stroke:"currentColor",strokeWidth:"0.5",fillRule:"evenodd",clipRule:"evenodd"})}),t.jsx("span",{className:"flex-1",children:"Clear All"}),t.jsxs("span",{className:"text-[10px] font-mono opacity-60",children:["(",C.total,")"]})]}),t.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-white/10 to-transparent my-1.5 mx-2"}),t.jsxs("button",{onClick:T,disabled:0===C.movies,className:"w-full px-4 py-2.5 text-xs text-left text-white/80 hover:text-white hover:bg-white/10 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-150 flex items-center gap-2.5 group rounded-lg",children:[t.jsx("svg",{className:"w-4 h-4 text-white/60 group-hover:text-white transition-all duration-200 group-hover:scale-110",fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"M18 4l2 4h-3l-2-4h-2l2 4h-3l-2-4H8l2 4H7L5 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4h-4z",stroke:"currentColor",strokeWidth:"0.5",fillRule:"evenodd",clipRule:"evenodd"})}),t.jsx("span",{className:"flex-1",children:"Clear Movies"}),t.jsxs("span",{className:"text-[10px] font-mono opacity-60",children:["(",C.movies,")"]})]}),t.jsxs("button",{onClick:M,disabled:0===C.tvShows,className:"w-full px-4 py-2.5 text-xs text-left text-white/80 hover:text-white hover:bg-white/10 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-150 flex items-center gap-2.5 group rounded-lg",children:[t.jsx("svg",{className:"w-4 h-4 text-white/60 group-hover:text-white transition-all duration-200 group-hover:scale-110",fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"M21 3H3c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h5l-1 3v1h8v-1l-1-3h5c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 12H3V5h18v10z",stroke:"currentColor",strokeWidth:"0.5",fillRule:"evenodd",clipRule:"evenodd"})}),t.jsx("span",{className:"flex-1",children:"Clear TV Shows"}),t.jsxs("span",{className:"text-[10px] font-mono opacity-60",children:["(",C.tvShows,")"]})]})]})})]})]}),t.jsxs(Q.div,{className:"relative group",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,ease:[.25,.46,.45,.94],delay:.3},children:[t.jsx("div",{className:"absolute inset-y-0 left-0 w-28 bg-gradient-to-r from-[#121417] to-transparent z-10 pointer-events-none"}),t.jsx("div",{className:"absolute inset-y-0 right-0 w-28 bg-gradient-to-l from-[#121417] to-transparent z-10 pointer-events-none"}),t.jsx(r,{modules:[ce,de,ue,he,me],spaceBetween:16,slidesPerView:"auto",speed:400,onSwiper:e=>{v.current=e},navigation:{nextEl:".continue-watching-swiper-next",prevEl:".continue-watching-swiper-prev"},mousewheel:{forceToAxis:!0,sensitivity:1,releaseOnEdges:!0},simulateTouch:!0,touchStartPreventDefault:!1,touchStartForcePreventDefault:!1,pointerEventsTarget:"container",keyboard:{enabled:!0,onlyInViewport:!0},grabCursor:!0,touchRatio:1,touchAngle:45,resistance:!0,resistanceRatio:.85,allowTouchMove:!0,allowSlideNext:!0,allowSlidePrev:!0,watchSlidesProgress:!0,freeMode:{enabled:!0,momentum:!0,momentumVelocityRatio:.75,sticky:!1},observer:!0,observeParents:!0,updateOnWindowResize:!0,className:"px-6 pb-4 overflow-hidden",children:k.map(((e,s)=>t.jsx(i,{className:"!w-auto",children:t.jsx(Q.div,{className:"relative group",initial:{opacity:0,y:30,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.4,ease:[.25,.46,.45,.94],delay:.4+.08*s},children:t.jsx(ds,{item:e,onClick:S,isMobile:a,onRemove:_,index:s,totalItems:k.length})})},`continue-watching-${e.id}-${e.type}-${e.season||"movie"}-${e.episode||"movie"}`)))}),t.jsx("div",{className:"continue-watching-swiper-prev !w-10 !h-10 !bg-white/5 hover:!bg-white/12 !rounded-full !border !border-white/10 !transition-all !duration-300 !ease-out -translate-x-16 opacity-0 group-hover:translate-x-0 group-hover:opacity-100 !absolute !left-0 !-translate-y-1/2 !top-[50%] !m-0 !z-20 flex items-center justify-center hover:shadow-xl hover:shadow-black/20",children:t.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M15 19l-7-7 7-7"})})}),t.jsx("div",{className:"continue-watching-swiper-next !w-10 !h-10 !bg-white/5 hover:!bg-white/12 !rounded-full !border !border-white/10 !transition-all !duration-300 !ease-out translate-x-16 opacity-0 group-hover:translate-x-0 group-hover:opacity-100 !absolute !right-0 !-translate-y-1/2 !top-[50%] !m-0 !z-20 flex items-center justify-center hover:shadow-xl hover:shadow-black/20",children:t.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M9 5l7 7-7 7"})})})]})]}):null};us.propTypes={onMovieSelect:le.func,isMobile:le.bool};const hs=!1,ms=new Map,ps=new Set,xs=()=>{ms.size>100&&ms.clear(),ps.forEach((e=>{e&&"function"==typeof e&&e()})),ps.clear(),window.gc&&window.gc()},gs={User:()=>t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})}),Film:()=>t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M18 4l2 4h-3l-2-4h-2l2 4h-3l-2-4H8l2 4H7L5 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4h-4z"})}),Camera:()=>t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:[t.jsx("path",{d:"M12 12m-3.2 0a3.2 3.2 0 1 1 6.4 0a3.2 3.2 0 1 1 -6.4 0"}),t.jsx("path",{d:"M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"})]}),Globe:()=>t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.94-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"})}),Calendar:()=>t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"})}),Location:()=>t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})}),Star:()=>t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})}),ExternalLink:()=>t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"})}),Loading:()=>t.jsxs("svg",{className:"animate-spin h-8 w-8",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),Error:()=>t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})})},fs=e.memo((({person:s,onClose:a,onMovieSelect:r,onSeriesSelect:i})=>{const[n,o]=e.useState(null),[l,c]=e.useState(!0),[d,u]=e.useState(null),[h,m]=e.useState("overview"),[p,x]=e.useTransition(),g=e.useRef(null),f=e.useRef(null),w=e.useRef(null),b=e.useRef(new Set),v=e.useRef(0),{createPortal:y}=re("cast-details-overlay",{group:"overlays",priority:"high",stacking:!0,accessibility:!0}),j=e.useMemo((()=>s?.id),[s?.id]),N=e.useMemo((()=>s?.name),[s?.name]);e.useEffect((()=>{})),e.useEffect((()=>()=>{f.current&&clearTimeout(f.current),w.current&&clearInterval(w.current),b.current.forEach((e=>clearTimeout(e))),b.current.clear(),ps.forEach((e=>{e&&"function"==typeof e&&e()})),ps.clear(),xs()}),[]),e.useEffect((()=>(w.current=setInterval((()=>{xs()}),3e4),()=>{w.current&&clearInterval(w.current)})),[]);const k={hidden:{opacity:0},visible:{opacity:1,transition:{duration:.3}},exit:{opacity:0,transition:{duration:.2}}},C={hidden:{opacity:0,y:50,scale:.95},visible:{opacity:1,y:0,scale:1,transition:{duration:.4,ease:[.25,.46,.45,.94]}},exit:{opacity:0,y:50,scale:.95,transition:{duration:.3}}},S={initial:{scale:1,filter:"brightness(1)"},hover:{scale:1.05,filter:"brightness(1.1)",transition:{type:"spring",stiffness:400,damping:25,duration:.2}},tap:{scale:.98,filter:"brightness(1)",transition:{type:"spring",stiffness:500,damping:30,duration:.1}}},_=e.useCallback((async()=>{if(!j&&!N)return u("Invalid person data - missing ID and name"),void c(!1);f.current&&clearTimeout(f.current);try{c(!0),u(null);let t=j;if(!t&&N)try{const e=await je(N,1);e?.results?.length>0&&(t=e.results[0].id)}catch(e){}if(!t)throw Error("Could not find person ID");x((()=>{Ne(t).then((e=>{o(e)})).catch((e=>{u(e.message||"Failed to load person details")})).finally((()=>{c(!1)}))}))}catch(t){u(t.message||"Failed to load person details"),c(!1)}}),[j,N]);e.useEffect((()=>{_()}),[_]);const L=e.useCallback((e=>{"Escape"===e.key&&a()}),[a]),T=e.useCallback((e=>{e.target.classList.contains("cast-details-backdrop")&&a()}),[a]);e.useCallback((e=>{let t=0;return(...s)=>{const a=Date.now();100>a-t||(t=a,e.apply(void 0,s))}})((e=>{v.current=e.target.scrollTop})),[]),e.useEffect((()=>(document.addEventListener("keydown",L),()=>document.removeEventListener("keydown",L))),[L]),e.useEffect((()=>(document.addEventListener("mousedown",T),()=>document.removeEventListener("mousedown",T))),[T]);const M=e.useCallback((e=>{if(!e)return"Unknown";try{return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch{return e}}),[]),E=e.useCallback(((e,t)=>{if(!e)return null;const s=new Date(e),a=t?new Date(t):new Date,r=a.getFullYear()-s.getFullYear(),i=a.getMonth()-s.getMonth();return 0>i||0===i&&a.getDate()<s.getDate()?r-1:r}),[]);e.useCallback((e=>{e.target.style.opacity="1";const t=e.target.parentElement?.querySelector(".animate-spin");t&&(t.style.display="none")}),[]),e.useCallback((e=>{e.target.src="/placeholder-avatar.png",e.target.onerror=null}),[]);const I=e.useCallback((e=>{let t;return(...s)=>{clearTimeout(t),t=setTimeout((()=>e.apply(void 0,s)),150)}})((e=>{"tv"===e.media_type?i?.(e):r?.(e),a()})),[r,i,a]),D=e.useCallback((()=>{const e=document.querySelector(".cast-details-content .overflow-y-auto");if(e){const t=scheduleRaf((()=>{e.scrollTo({top:0,behavior:"smooth"})}));ps.add((()=>cancelRaf(t)))}}),[]);return l?y(t.jsx(Z,{children:t.jsx(Q.div,{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[1000000004] flex items-center justify-center cast-details-backdrop",variants:k,initial:"hidden",animate:"visible",exit:"exit",children:t.jsx(Q.div,{className:"bg-gradient-to-br from-[#1a1a1a] to-[#2a2a2a] rounded-2xl sm:rounded-3xl p-6 sm:p-8 md:p-12 max-w-md w-full mx-2 sm:mx-4 cast-details-content relative border border-white/10 shadow-2xl",style:{pointerEvents:"auto"},variants:C,children:t.jsxs("div",{className:"flex flex-col items-center space-y-4 sm:space-y-6",children:[t.jsxs("div",{className:"relative",children:[t.jsx(gs.Loading,{}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent animate-pulse"})]}),t.jsxs("div",{className:"text-center space-y-2",children:[t.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-white",children:"Loading Details"}),t.jsxs("p",{className:"text-white/60 text-xs sm:text-sm",children:["Fetching information for ",s?.name||"actor","..."]})]}),t.jsx("div",{className:"w-full bg-white/10 rounded-full h-1 overflow-hidden",children:t.jsx(Q.div,{className:"h-full bg-gradient-to-r from-primary to-primary/60",initial:{width:"0%"},animate:{width:"100%"},transition:{duration:2,ease:"easeInOut"}})})]})})})})):d?y(t.jsx(Z,{children:t.jsx(Q.div,{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[1000000004] flex items-center justify-center cast-details-backdrop",variants:k,initial:"hidden",animate:"visible",exit:"exit",children:t.jsx(Q.div,{className:"bg-gradient-to-br from-[#1a1a1a] to-[#2a2a2a] rounded-3xl p-12 max-w-md w-full mx-4 cast-details-content relative border border-red-500/20 shadow-2xl",style:{pointerEvents:"auto"},variants:C,children:t.jsxs("div",{className:"flex flex-col items-center space-y-4 sm:space-y-6",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-br from-red-500/20 to-red-600/20 rounded-full flex items-center justify-center border border-red-500/30",children:t.jsx(gs.Error,{})}),t.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 sm:w-6 sm:h-6 bg-red-500 rounded-full flex items-center justify-center",children:t.jsx("span",{className:"text-white text-xs font-bold",children:"!"})})]}),t.jsxs("div",{className:"text-center space-y-2 sm:space-y-3",children:[t.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-white",children:"Oops! Something went wrong"}),t.jsx("p",{className:"text-white/60 text-xs sm:text-sm max-w-xs",children:d})]}),t.jsxs("div",{className:"bg-white/5 rounded-xl p-4 w-full space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between text-xs",children:[t.jsx("span",{className:"text-white/40",children:"Person ID:"}),t.jsx("span",{className:"text-white/80 font-mono",children:s?.id||"Missing"})]}),t.jsxs("div",{className:"flex items-center justify-between text-xs",children:[t.jsx("span",{className:"text-white/40",children:"Person Name:"}),t.jsx("span",{className:"text-white/80",children:s?.name||"Missing"})]})]}),t.jsxs(Q.button,{onClick:a,className:"absolute top-4 right-4 z-10 p-2 rounded-full text-white group overflow-hidden bg-[rgb(255,255,255,0.03)] backdrop-blur-[0.5px] border-l-[1px] border-r-[1px] border-white/30 hover:bg-white/10 transform-gpu will-change-transform",variants:S,initial:"initial",whileHover:"hover",whileTap:"tap",children:[t.jsx(Q.svg,{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",viewBox:"0 0 24 24",fill:"currentColor",whileHover:{rotate:90,scale:1.1,transition:{type:"spring",stiffness:400,damping:25}},children:t.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})}),t.jsx(Q.span,{className:"absolute right-full mr-2 top-1/2 -translate-y-1/2 px-2 py-1 bg-[#1a1a1a] rounded text-sm whitespace-nowrap",initial:{opacity:0,x:10},whileHover:{opacity:1,x:0},transition:{duration:.2},children:"Close"})]})]})})})})):!n&&s?.name?y(t.jsx(Z,{children:t.jsx(Q.div,{ref:g,className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[1000000004] overflow-y-auto cast-details-backdrop",variants:k,initial:"hidden",animate:"visible",exit:"exit",children:t.jsx("div",{className:"min-h-screen flex items-start justify-center p-4",children:t.jsxs(Q.div,{className:"bg-[#1a1a1a] rounded-2xl max-w-2xl w-full max-h-[95vh] overflow-hidden shadow-2xl cast-details-content relative",style:{pointerEvents:"auto"},variants:C,initial:"hidden",animate:"visible",exit:"exit",children:[t.jsxs(Q.div,{className:"relative h-64 overflow-hidden rounded-t-2xl",children:[s.image&&t.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:`url(${s.image})`,filter:"blur(20px) brightness(0.3)"}}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#1a1a1a] via-transparent to-transparent"}),t.jsxs(Q.button,{onClick:a,className:"absolute top-4 right-4 z-10 p-2 rounded-full text-white group overflow-hidden bg-[rgb(255,255,255,0.03)] backdrop-blur-[0.5px] border-l-[1px] border-r-[1px] border-white/30 hover:bg-white/10 transform-gpu will-change-transform",variants:S,initial:"initial",whileHover:"hover",whileTap:"tap",children:[t.jsx(Q.svg,{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",viewBox:"0 0 24 24",fill:"currentColor",whileHover:{rotate:90,scale:1.1,transition:{type:"spring",stiffness:400,damping:25}},children:t.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})}),t.jsx(Q.span,{className:"absolute right-full mr-2 top-1/2 -translate-y-1/2 px-2 py-1 bg-[#1a1a1a] rounded text-sm whitespace-nowrap",initial:{opacity:0,x:10},whileHover:{opacity:1,x:0},transition:{duration:.2},children:"Close"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-6 text-white",children:t.jsxs("div",{className:"flex items-end space-x-6",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("img",{src:s.image||"/placeholder-avatar.png",alt:s.name,className:"w-24 h-24 rounded-full object-cover border-4 border-white/20 shadow-lg",onError:e=>{e.target.src="/placeholder-avatar.png"}})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h1",{className:"text-2xl md:text-4xl font-bold mb-2",children:s.name}),s.character&&t.jsxs("p",{className:"text-white/80 text-sm md:text-base",children:["as ",s.character]})]})]})})]}),t.jsx("div",{className:"p-6",children:t.jsxs("div",{className:"text-center text-white/60",children:[t.jsxs("p",{children:["Detailed information for ",s.name," is not available."]}),t.jsx("p",{className:"text-sm mt-2",children:"This might be due to missing person ID or API limitations."})]})})]})})})})):n?y(t.jsx(Z,{children:t.jsx(Q.div,{ref:g,className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[1000000004] overflow-y-auto cast-details-backdrop",variants:k,initial:"hidden",animate:"visible",exit:"exit",children:t.jsx("div",{className:"min-h-screen flex items-start justify-center p-2 sm:p-4",children:t.jsxs(Q.div,{className:"bg-[#1a1a1a] rounded-2xl sm:rounded-3xl max-w-6xl w-full max-h-[98vh] sm:max-h-[95vh] overflow-hidden shadow-2xl cast-details-content relative",style:{pointerEvents:"auto"},variants:C,initial:"hidden",animate:"visible",exit:"exit",children:[t.jsxs(Q.div,{className:"relative h-64 sm:h-72 md:h-96 overflow-hidden",children:[n.profile_path&&t.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:`url(${n.profile_path})`,filter:"blur(30px) brightness(0.2)"}}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#0a0a0a] via-transparent to-transparent"}),t.jsxs(Q.button,{onClick:a,className:"absolute top-4 right-4 z-10 p-2 rounded-full text-white group overflow-hidden bg-[rgb(255,255,255,0.03)] backdrop-blur-[0.5px] border-l-[1px] border-r-[1px] border-white/30 hover:bg-white/10 transform-gpu will-change-transform",variants:S,initial:"initial",whileHover:"hover",whileTap:"tap",children:[t.jsx(Q.svg,{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",viewBox:"0 0 24 24",fill:"currentColor",whileHover:{rotate:90,scale:1.1,transition:{type:"spring",stiffness:400,damping:25}},children:t.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})}),t.jsx(Q.span,{className:"absolute right-full mr-2 top-1/2 -translate-y-1/2 px-2 py-1 bg-[#1a1a1a] rounded text-sm whitespace-nowrap",initial:{opacity:0,x:10},whileHover:{opacity:1,x:0},transition:{duration:.2},children:"Close"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4 sm:p-6 md:p-8 text-white",children:t.jsxs("div",{className:"flex items-end space-x-4 sm:space-x-6 md:space-x-8",children:[t.jsx("div",{className:"flex-shrink-0 relative",children:t.jsxs("div",{className:"relative",children:[t.jsx("img",{src:n.profile_path||"/placeholder-avatar.png",alt:n.name,className:"w-24 h-28 sm:w-28 sm:h-28 md:w-28 md:h-32 lg:w-40 lg:h-40 rounded-2xl sm:rounded-3xl object-cover border-2 border-white/10 shadow-2xl",onError:e=>{e.target.src="/placeholder-avatar.png",e.target.onerror=null},onLoad:e=>{e.target.style.opacity="1"},style:{opacity:0,transition:"opacity 0.3s ease-in-out"}}),t.jsx("div",{className:"absolute inset-0 rounded-2xl sm:rounded-3xl bg-gradient-to-t from-black/30 to-transparent"})]})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl lg:text-5xl font-light mb-2 sm:mb-4 text-white tracking-tight",children:n.name}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3 md:gap-4 text-white/80 text-xs sm:text-sm md:text-base",children:[n.known_for_department&&t.jsxs("span",{className:"inline-flex items-center px-2 sm:px-3 md:px-4 py-1.5 sm:py-2 bg-white/5 backdrop-blur-sm rounded-full border border-white/10 text-white/90 font-medium text-xs sm:text-sm",children:[t.jsx(gs.User,{}),t.jsx("span",{className:"ml-1 sm:ml-2",children:"Acting"})]}),n.birthday&&t.jsxs("span",{className:"inline-flex items-center px-2 sm:px-3 md:px-4 py-1.5 sm:py-2 bg-white/5 backdrop-blur-sm rounded-full border border-white/10 text-white/90 text-xs sm:text-sm",children:[t.jsx(gs.Calendar,{}),t.jsxs("span",{className:"ml-1 sm:ml-2",children:[M(n.birthday),!n.deathday&&t.jsxs("span",{className:"text-white/60 ml-1",children:["(",E(n.birthday),")"]})]})]}),n.place_of_birth&&t.jsxs("span",{className:"inline-flex items-center px-2 sm:px-3 md:px-4 py-1.5 sm:py-2 bg-white/5 backdrop-blur-sm rounded-full border border-white/10 text-white/90 text-xs sm:text-sm",children:[t.jsx(gs.Location,{}),t.jsx("span",{className:"ml-1 sm:ml-2",children:n.place_of_birth})]})]})]})]})})]}),t.jsxs("div",{className:"flex flex-col lg:flex-row h-[calc(98vh-16rem)] sm:h-[calc(95vh-16rem)] md:h-[calc(95vh-20rem)]",children:[t.jsx("div",{className:"flex-shrink-0 border-b border-white/5 lg:border-b-0 lg:border-r lg:w-72 bg-[#0a0a0a]",children:t.jsx("div",{className:"flex lg:flex-col overflow-x-auto lg:overflow-x-visible scrollbar-hide",children:[{id:"overview",label:"Overview",icon:gs.User},{id:"filmography",label:"Filmography",icon:gs.Film},{id:"photos",label:"Photos",icon:gs.Camera},{id:"social",label:"Social",icon:gs.Globe}].map((e=>t.jsxs(Q.button,{onClick:()=>m(e.id),className:"flex items-center space-x-2 sm:space-x-3 md:space-x-4 px-4 sm:px-6 md:px-8 py-4 sm:py-3 md:py-4 text-left whitespace-nowrap transition-all duration-300 relative touch-manipulation "+(h===e.id?"lg:bg-white/5 text-white":"text-white/50 hover:text-white/80 hover:bg-white/5"),whileHover:{y:-2,x:0},whileTap:{scale:.95},children:[t.jsx("div",{className:"p-1.5 sm:p-2 rounded-lg sm:rounded-xl "+(h===e.id?"bg-white/10":"bg-white/5"),children:t.jsx(e.icon,{})}),t.jsx("span",{className:"font-medium text-sm sm:text-base md:text-lg",children:e.label}),h===e.id&&t.jsx(Q.div,{className:"absolute bottom-0 left-0 right-0 h-0.5 lg:h-full lg:w-1 lg:right-0 lg:left-auto bg-white/40 shadow-sm",initial:{scaleX:0,scaleY:0},animate:{scaleX:1,scaleY:1},transition:{type:"spring",stiffness:500,damping:30}})]},e.id)))})}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6 md:p-8 pb-16 scrollbar-thin scrollbar-thumb-white/20 scrollbar-track-transparent relative group",style:{scrollbarWidth:"thin",scrollbarColor:"rgba(255,255,255,0.2) transparent"},children:[t.jsxs(Z,{mode:"wait",children:["overview"===h&&t.jsxs(Q.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"space-y-4 sm:space-y-6",children:[n.biography&&t.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[t.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-4",children:[t.jsx("div",{className:"p-2 sm:p-3 bg-white/5 rounded-xl sm:rounded-2xl",children:t.jsx(gs.User,{})}),t.jsx("h2",{className:"text-xl sm:text-2xl font-light text-white",children:"Biography"})]}),t.jsx("p",{className:"text-white/70 leading-relaxed whitespace-pre-line text-base sm:text-lg max-w-4xl",children:n.biography})]}),t.jsxs("div",{className:"space-y-6 sm:space-y-8",children:[t.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[t.jsx("h3",{className:"text-lg sm:text-xl font-light text-white/90",children:"Personal Information"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4",children:[n.birthday&&t.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-4 p-3 sm:p-4 bg-white/5 rounded-xl sm:rounded-2xl border border-white/5",children:[t.jsx(gs.Calendar,{}),t.jsxs("div",{children:[t.jsx("span",{className:"font-medium text-white/90 text-sm sm:text-base",children:"Birthday"}),t.jsx("div",{className:"text-white/70 text-sm sm:text-base",children:M(n.birthday)})]})]}),n.deathday&&t.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-4 p-3 sm:p-4 bg-white/5 rounded-xl sm:rounded-2xl border border-white/5",children:[t.jsx(gs.Calendar,{}),t.jsxs("div",{children:[t.jsx("span",{className:"font-medium text-white/90 text-sm sm:text-base",children:"Death Date"}),t.jsx("div",{className:"text-white/70 text-sm sm:text-base",children:M(n.deathday)})]})]}),n.place_of_birth&&t.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-4 p-3 sm:p-4 bg-white/5 rounded-xl sm:rounded-2xl border border-white/5",children:[t.jsx(gs.Location,{}),t.jsxs("div",{children:[t.jsx("span",{className:"font-medium text-white/90 text-sm sm:text-base",children:"Place of Birth"}),t.jsx("div",{className:"text-white/70 text-sm sm:text-base",children:n.place_of_birth})]})]}),n.known_for_department&&t.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-4 p-3 sm:p-4 bg-white/5 rounded-xl sm:rounded-2xl border border-white/5",children:[t.jsx(gs.Star,{}),t.jsxs("div",{children:[t.jsx("span",{className:"font-medium text-white/90 text-sm sm:text-base",children:"Known For"}),t.jsx("div",{className:"text-white/70 text-sm sm:text-base",children:n.known_for_department})]})]}),n.homepage&&t.jsxs("div",{className:"flex items-center space-x-4 p-4 bg-white/5 rounded-2xl border border-white/5",children:[t.jsx(gs.Globe,{}),t.jsxs("div",{children:[t.jsx("span",{className:"font-medium text-white/90",children:"Website"}),t.jsxs("a",{href:n.homepage,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline flex items-center space-x-2 mt-1",children:[t.jsx("span",{children:"Visit Website"}),t.jsx(gs.ExternalLink,{})]})]})]})]})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsx("h3",{className:"text-xl font-light text-white/90",children:"Statistics"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"text-center p-6 bg-white/5 rounded-2xl border border-white/5",children:[t.jsx("div",{className:"text-2xl font-light text-white mb-2",children:n.popularity?.toFixed(1)||"N/A"}),t.jsx("div",{className:"text-white/60 text-sm",children:"Popularity"})]}),t.jsxs("div",{className:"text-center p-6 bg-white/5 rounded-2xl border border-white/5",children:[t.jsx("div",{className:"text-2xl font-light text-white mb-2",children:(n.combined_credits?.cast?.length||0)+(n.combined_credits?.crew?.length||0)}),t.jsx("div",{className:"text-white/60 text-sm",children:"Total Credits"})]}),t.jsxs("div",{className:"text-center p-6 bg-white/5 rounded-2xl border border-white/5",children:[t.jsx("div",{className:"text-2xl font-light text-white mb-2",children:n.combined_credits?.cast?.length||0}),t.jsx("div",{className:"text-white/60 text-sm",children:"Acting"})]}),t.jsxs("div",{className:"text-center p-6 bg-white/5 rounded-2xl border border-white/5",children:[t.jsx("div",{className:"text-2xl font-light text-white mb-2",children:n.combined_credits?.crew?.length||0}),t.jsx("div",{className:"text-white/60 text-sm",children:"Crew"})]})]})]})]})]},"overview"),"filmography"===h&&t.jsx(Q.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"space-y-4 sm:space-y-6",children:t.jsxs("div",{className:"space-y-6 sm:space-y-8",children:[t.jsx("h2",{className:"text-2xl sm:text-3xl font-light text-white",children:"Filmography"}),n.combined_credits?.cast?.length>0&&t.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h3",{className:"text-lg sm:text-xl font-light text-white/90",children:"Acting Credits"}),t.jsxs("span",{className:"text-white/60 text-xs sm:text-sm",children:[n.combined_credits.cast.length," credits"]})]}),t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-8 3xl:grid-cols-10 gap-4",children:n.combined_credits.cast.slice(0,20).map(((e,s)=>t.jsx(Q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"group cursor-pointer transform relative touch-manipulation select-none",onClick:()=>I(e),whileHover:{scale:1.02,transition:{type:"tween",duration:.2}},transition:{type:"tween",duration:.2,delay:.05*s},children:t.jsxs(Q.div,{className:"aspect-[2/3] rounded-lg overflow-hidden bg-gray-800 relative w-full",children:[t.jsx("div",{className:"absolute top-2 left-2 z-10",children:t.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium "+("tv"===e.media_type?"bg-blue-500/80 text-white":"bg-orange-500/80 text-white"),children:"tv"===e.media_type?"TV":"Movie"})}),e.vote_average&&t.jsx("div",{className:"absolute top-2 right-2 z-10",children:t.jsxs("span",{className:"bg-black/60 text-white px-2 py-1 rounded text-xs font-medium flex items-center gap-1",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 text-yellow-400",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})}),e.vote_average.toFixed(1)]})}),t.jsx("img",{src:e.poster_path||"/placeholder-poster.png",alt:e.title,className:"w-full h-full object-cover",onError:e=>{e.target.src="/placeholder-poster.png"}}),t.jsx(Q.div,{initial:{opacity:0},whileHover:{opacity:1},transition:{duration:.1},className:"absolute inset-0 bg-gradient-to-t from-black/80 to-transparent flex items-end p-3",children:t.jsxs(Q.div,{className:"text-white",children:[t.jsx("h4",{className:"font-medium text-sm truncate",children:e.title}),t.jsxs("p",{className:"text-xs text-gray-300 flex items-center gap-1",children:[e.release_date?.split("-")[0]||"N/A"," •",e.character&&t.jsxs("span",{className:"truncate",children:["as ",e.character]})]})]})})]})},`${e.id}-${e.credit_id}`)))})]}),n.combined_credits?.crew?.length>0&&t.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h3",{className:"text-lg sm:text-xl font-light text-white/90",children:"Crew Credits"}),t.jsxs("span",{className:"text-white/60 text-xs sm:text-sm",children:[n.combined_credits.crew.length," credits"]})]}),t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-8 3xl:grid-cols-10 gap-4",children:n.combined_credits.crew.slice(0,20).map(((e,s)=>t.jsx(Q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"group cursor-pointer transform relative touch-manipulation select-none",onClick:()=>I(e),whileHover:{scale:1.02,transition:{type:"tween",duration:.2}},transition:{type:"tween",duration:.2,delay:.05*s},children:t.jsxs(Q.div,{className:"aspect-[2/3] rounded-lg overflow-hidden bg-gray-800 relative w-full",children:[t.jsx("div",{className:"absolute top-2 left-2 z-10",children:t.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium "+("tv"===e.media_type?"bg-blue-500/80 text-white":"bg-orange-500/80 text-white"),children:"tv"===e.media_type?"TV":"Movie"})}),t.jsx("div",{className:"absolute bottom-2 left-2 right-2",children:t.jsx("span",{className:"bg-black/60 text-white px-2 py-1 rounded text-xs font-medium block text-center",children:e.job})}),t.jsx("img",{src:e.poster_path||"/placeholder-poster.png",alt:e.title,className:"w-full h-full object-cover",onError:e=>{e.target.src="/placeholder-poster.png"}}),t.jsx(Q.div,{initial:{opacity:0},whileHover:{opacity:1},transition:{duration:.1},className:"absolute inset-0 bg-gradient-to-t from-black/80 to-transparent flex items-end p-3",children:t.jsxs(Q.div,{className:"text-white",children:[t.jsx("h4",{className:"font-medium text-sm truncate",children:e.title}),t.jsxs("p",{className:"text-xs text-gray-300 flex items-center gap-1",children:[e.release_date?.split("-")[0]||"N/A"," •",e.job&&t.jsx("span",{className:"truncate",children:e.job})]})]})})]})},`${e.id}-${e.credit_id}`)))})]})]})},"filmography"),"photos"===h&&t.jsxs(Q.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"space-y-4 sm:space-y-6",children:[t.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-white",children:"Photo Gallery"}),n.images?.profiles&&n.images.profiles.length>0?t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-8 3xl:grid-cols-10 gap-4",children:n.images.profiles.map(((e,s)=>t.jsx(Q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*s},className:"group cursor-pointer transform relative touch-manipulation select-none",onClick:()=>{window.open(e.file_path,"_blank")},whileHover:{scale:1.02,transition:{type:"tween",duration:.2}},children:t.jsxs(Q.div,{className:"aspect-[2/3] rounded-lg overflow-hidden bg-gray-800 relative w-full",children:[t.jsx("div",{className:"absolute inset-0 bg-gray-800 flex items-center justify-center",children:t.jsx("div",{className:"w-6 h-6 border-2 border-gray-600 border-t-white rounded-full animate-spin"})}),t.jsx("img",{src:e.file_path,alt:`${n.name} photo ${s+1}`,className:"w-full h-full object-cover relative z-10",onError:e=>{e.target.src="/placeholder-avatar.png",e.target.onerror=null},onLoad:e=>{e.target.style.opacity="1";const t=e.target.parentElement?.querySelector(".animate-spin");t&&(t.style.display="none")},style:{opacity:0,transition:"opacity 0.3s ease-in-out"}}),t.jsx(Q.div,{initial:{opacity:0},whileHover:{opacity:1},transition:{duration:.1},className:"absolute inset-0 bg-gradient-to-t from-black/80 to-transparent flex items-end p-3",children:t.jsxs(Q.div,{className:"text-white",children:[t.jsxs("h4",{className:"font-medium text-sm truncate",children:["Photo ",s+1]}),t.jsx("p",{className:"text-xs text-gray-300",children:"Click to view"})]})})]})},s)))}):t.jsxs(Q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center py-16 sm:py-20",children:[t.jsx("div",{className:"w-20 h-20 sm:w-24 sm:h-24 bg-gradient-to-br from-white/5 to-white/10 rounded-full flex items-center justify-center mx-auto mb-6 border border-white/10",children:t.jsx("svg",{className:"w-10 h-10 sm:w-12 sm:h-12 text-white/30",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("h3",{className:"text-lg sm:text-xl font-medium text-white/80",children:"No Photos Available"}),t.jsxs("p",{className:"text-white/50 text-sm sm:text-base max-w-md mx-auto",children:["We couldn't find any photos for ",n.name,". This might be due to privacy settings or limited public images."]}),t.jsx("div",{className:"flex items-center justify-center space-x-4 pt-4",children:t.jsxs("div",{className:"flex items-center space-x-2 text-white/40 text-xs",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{children:"Check back later"})]})})]})]})]},"photos"),"social"===h&&t.jsxs(Q.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"space-y-4 sm:space-y-6",children:[t.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-white",children:"Social Media & Links"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6",children:t.jsxs("div",{children:[t.jsx("h3",{className:"text-base sm:text-lg font-semibold text-white mb-3",children:"External Links"}),t.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[n.imdb_id&&t.jsxs("a",{href:"https://www.imdb.com/name/"+n.imdb_id,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-3 p-3 bg-white/5 rounded-lg hover:bg-white/10 transition-colors touch-manipulation",children:[t.jsx("div",{className:"w-8 h-8 bg-yellow-500 rounded flex items-center justify-center",children:t.jsx("span",{className:"text-black font-bold text-xs",children:"IMDb"})}),t.jsx("span",{className:"text-white",children:"View on IMDb"})]}),n.facebook_id&&t.jsxs("a",{href:"https://www.facebook.com/"+n.facebook_id,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-3 p-3 bg-white/5 rounded-lg hover:bg-white/10 transition-colors touch-manipulation",children:[t.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})})}),t.jsx("span",{className:"text-white",children:"Facebook"})]}),n.instagram_id&&t.jsxs("a",{href:"https://www.instagram.com/"+n.instagram_id,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-3 p-3 bg-white/5 rounded-lg hover:bg-white/10 transition-colors touch-manipulation",children:[t.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-500 to-pink-500 rounded flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"})})}),t.jsx("span",{className:"text-white",children:"Instagram"})]}),n.twitter_id&&t.jsxs("a",{href:"https://twitter.com/"+n.twitter_id,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-3 p-3 bg-white/5 rounded-lg hover:bg-white/10 transition-colors touch-manipulation",children:[t.jsx("div",{className:"w-8 h-8 bg-black rounded flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})})}),t.jsx("span",{className:"text-white",children:"X"})]})]})]})})]},"social")]}),t.jsx("div",{className:"h-8"}),t.jsx(Q.button,{onClick:D,className:"fixed bottom-4 right-4 sm:bottom-8 sm:right-8 p-2 sm:p-3 bg-white/10 backdrop-blur-md rounded-full text-white hover:bg-white/20 transition-all duration-200 border border-white/20 hover:border-white/40 z-20 touch-manipulation shadow-lg",whileHover:{scale:1.1},whileTap:{scale:.9},children:t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 10l7-7m0 0l7 7m-7-7v18"})})}),hs]})]})]})})})}),document.body):null})),ws=Object.freeze(Object.defineProperty({__proto__:null,default:fs},Symbol.toStringTag,{value:"Module"})),bs=({rating:s=0,size:a="default",showIcon:r=!0,className:i="",position:n="top-left",showShadow:o=!1,colorTheme:l="dark",tooltipText:c="",customColor:d="",isLoading:u=!1,hideWhenZero:h=!1,tooltipPosition:m="top",onClick:p=null,format:x="decimal",maxRating:g=10,interactive:f=!1,showLabel:w=!1,ariaLabel:b=null})=>{const[v,y]=e.useState(!1),j=ee(),N=e.useMemo((()=>{let e=0;try{if("number"!=typeof s||isNaN(s)){if("string"==typeof s){const t=parseFloat(s);isNaN(t)||(e=Math.max(0,Math.min(g,t)))}}else e=Math.max(0,Math.min(g,s))}catch(t){e=0}return e}),[s,g]),k=e.useMemo((()=>{if(u)return"...";switch(x){case"percentage":return Math.round(N/g*100)+"%";case"stars":return(N/2).toFixed(1)+"/5";default:return N.toFixed(1)}}),[N,x,g,u]);if(!u&&h&&0===N)return null;const C=["ultra-small","extra-small","small","default","large","xl"].includes(a)?a:"default",S={"ultra-small":"h-4 sm:h-5 px-1.5 sm:px-2 text-xs","extra-small":"h-4.5 sm:h-5.5 px-1.5 sm:px-2.5 text-xs",small:"h-5 sm:h-6 px-2 sm:px-2.5 text-xs",default:"h-6 sm:h-7 px-2.5 sm:px-3.5 text-xs sm:text-sm",large:"h-7 sm:h-8 px-3 sm:px-4.5 text-sm sm:text-base",xl:"h-8 sm:h-9 px-3.5 sm:px-5.5 text-sm sm:text-lg"},_=["top-left","top-right","bottom-left","bottom-right"].includes(n)?n:"top-left",L={"top-left":"top-1 sm:top-2 -left-1 sm:-left-1","top-right":"top-2 sm:top-3 right-2 sm:right-3","bottom-left":"bottom-2 sm:bottom-3 left-0 sm:left-0","bottom-right":"bottom-2 sm:bottom-3 right-2 sm:right-3"},T={hidden:{opacity:0,scale:.95},visible:{opacity:1,scale:1,transition:j?{duration:0}:{duration:.3,ease:[.25,.46,.45,.94]}},hover:{scale:j?1:1.02,transition:j?{duration:0}:{duration:.2}},loading:{opacity:[.5,1],transition:j?{duration:0}:{duration:1,repeat:1/0,repeatType:"reverse"}}},M=e.useCallback((e=>{if(f||p)try{e.stopPropagation(),p?.(N)}catch(t){}}),[p,f,N]),E=e.useCallback((e=>{(f||p)&&("Enter"!==e.key&&" "!==e.key||(e.preventDefault(),M(e)))}),[M,f,p]),I=e.useMemo((()=>{if(b)return b;let e="Rating: ";switch(x){case"percentage":e+=Math.round(N/g*100)+" percent";break;case"stars":e+=(N/2).toFixed(1)+" out of 5 stars";break;default:e+=`${N.toFixed(1)} out of ${g}`}return u&&(e="Loading rating..."),e}),[b,N,x,g,u]),{badgeStyle:D,sizeClass:R,positionClass:z,tooltipClass:W}=e.useMemo((()=>{return{badgeStyle:d?"":"colored"===l?8.5>(e=N)?7.5>e?6.5>e?5.5>e?"bg-red-500 text-white":"bg-orange-500 text-white":"bg-yellow-500 text-white":"bg-green-500 text-white":"bg-green-600 text-white":(e=>8.5>e?7.5>e?6.5>e?5.5>e?"bg-black/50 text-white":"bg-black/60 text-white":"bg-black/70 text-white":"bg-black/80 text-white":"bg-black/90 text-white")(N),sizeClass:S[C],positionClass:L[_],tooltipClass:"top"===m?"-top-8 left-1/2 -translate-x-1/2":"top-full left-1/2 -translate-x-1/2 mt-2"};var e}),[N,l,C,_,d,m]),A=e.useMemo((()=>{if(!d)return null;let e={backgroundColor:d};const t=(e=>{if(!e)return null;try{let t=e.trim();if("#"===t[0]&&(t=t.slice(1)),3===t.length&&(t=t.split("").map((e=>e+e)).join("")),6!==t.length)return null;const s=parseInt(t.slice(0,2),16),a=[s,parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)].map((e=>e/255)).map((e=>e>.03928?Math.pow((e+.055)/1.055,2.4):e/12.92));return.2126*a[0]+.7152*a[1]+.0722*a[2]}catch(t){return null}})(d);return e.color=null!==t&&t>.5?"black":"white",e}),[d]),O=e.useMemo((()=>{switch(C){case"ultra-small":return"w-2 h-2";case"extra-small":return"w-2.5 h-2.5";case"small":return"w-3 h-3";case"large":return"w-4 h-4";case"xl":return"w-4.5 h-4.5";default:return"w-3.5 h-3.5"}}),[C]);return t.jsx(Z,{children:t.jsxs(Q.div,{className:`group absolute ${z} z-30 ${R} ${i} ${f||p?"cursor-pointer focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 focus:ring-offset-transparent":""}`,variants:T,initial:"hidden",animate:u?"loading":"visible",whileHover:f||p?"hover":void 0,role:f||p?"button":"status","aria-label":I,"aria-live":f||p?void 0:"polite",onClick:M,onKeyDown:E,onFocus:()=>y(!0),onBlur:()=>y(!1),tabIndex:f||p?0:-1,children:[c&&t.jsx(Q.div,{className:`absolute invisible group-hover:visible opacity-0 group-hover:opacity-100 \n              ${v?"!visible !opacity-100":""}\n              transition-opacity duration-200 ${W} bg-black/90 text-white text-xs \n              rounded px-2 py-1 whitespace-nowrap z-50 pointer-events-none`,initial:j?{}:{opacity:0,y:"top"===m?10:-10},animate:j?{}:{opacity:1,y:0},role:"tooltip",children:c}),t.jsxs("div",{style:A||void 0,className:`relative w-auto h-full rounded-md ${D||""} overflow-hidden \n          ${o?"shadow-lg":""} flex items-center justify-center px-2 sm:px-1 \n          min-w-max transition-all duration-200 ${u?"cursor-wait":""} \n          ${v?"ring-2 ring-white ring-offset-2 ring-offset-transparent":""}`,children:[w&&!u&&t.jsx("span",{className:"text-current opacity-80 text-xs mr-1 flex-shrink-0",children:"Rating:"}),r&&!u&&t.jsx(Q.svg,{xmlns:"http://www.w3.org/2000/svg",className:O+" text-current flex-shrink-0",viewBox:"0 0 24 24",fill:"currentColor",variants:j?{}:{hidden:{opacity:0,scale:.8},visible:{opacity:1,scale:1}},"aria-hidden":"true",children:t.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})}),t.jsx(Q.span,{className:"font-semibold sm:font-bold text-current leading-none tracking-tight flex-shrink-0 ml-0.5",layout:!j,children:k})]})]})})};bs.propTypes={rating:le.oneOfType([le.number,le.string]),size:le.oneOf(["ultra-small","extra-small","small","default","large","xl"]),showIcon:le.bool,className:le.string,position:le.oneOf(["top-left","top-right","bottom-left","bottom-right"]),showShadow:le.bool,colorTheme:le.oneOf(["dark","colored"]),tooltipText:le.string,customColor:le.string,isLoading:le.bool,tooltipPosition:le.oneOf(["top","bottom"]),onClick:le.func,format:le.oneOf(["decimal","percentage","stars"]),maxRating:le.number,interactive:le.bool,showLabel:le.bool,ariaLabel:le.string};const vs=s.memo(bs),ys=new class{constructor(){this.isMonitoring=!1,this.intervalId=null,this.memoryHistory=[],this.maxHistorySize=20,this.threshold=500,this.criticalThreshold=800,this.cleanupCallbacks=new Set,this.lastCleanup=0,this.cleanupCooldown=6e4,this.monitoringInterval=45e3,this.registeredComponents=new Set}start(){this.isMonitoring||(this.isMonitoring=!0,this.intervalId=setInterval((()=>{this.checkMemory()}),this.monitoringInterval))}stop(){this.isMonitoring&&(this.isMonitoring=!1,this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null))}checkMemory(){if(!performance.memory)return;const e=performance.memory.usedJSHeapSize/1024/1024,t=Date.now();if(this.memoryHistory.push({memoryMB:e,timestamp:t}),this.memoryHistory.length>this.maxHistorySize&&this.memoryHistory.shift(),this.memoryHistory.length>=3){const e=this.memoryHistory.slice(-3),t=e[0].memoryMB;e[e.length-1].memoryMB-t>300&&this.performCleanup()}e>this.criticalThreshold?this.performEmergencyCleanup():e>this.threshold&&this.performCleanup()}performCleanup(){const e=Date.now();e-this.lastCleanup<this.cleanupCooldown||(this.lastCleanup=e,this.cleanupCallbacks.forEach((e=>{try{e()}catch(t){}})),this.memoryHistory=[],window.gc&&window.gc())}performEmergencyCleanup(){this.clearAllCaches(),this.cleanupCallbacks.forEach((e=>{try{e()}catch(t){}})),this.memoryHistory=[],window.gc&&window.gc(),this.clearBrowserCaches()}clearAllCaches(){["movieDetailsCache","imageCache","tempCache","movieCache"].forEach((e=>{window[e]&&delete window[e]}));try{Object.keys(localStorage).forEach((e=>{(e.includes("movie")||e.includes("cache")||e.includes("temp"))&&localStorage.removeItem(e)}))}catch(e){}try{sessionStorage.clear()}catch(e){}}clearBrowserCaches(){"caches"in window&&caches.keys().then((e=>{e.forEach((e=>{(e.includes("image")||e.includes("movie"))&&caches.delete(e)}))}))}registerCleanupCallback(e,t="unknown"){return this.cleanupCallbacks.add(e),this.registeredComponents.add(t),()=>{this.cleanupCallbacks.delete(e),this.registeredComponents.delete(t)}}getStats(){if(0===this.memoryHistory.length)return null;const e=this.memoryHistory[this.memoryHistory.length-1],t=Math.min(...this.memoryHistory.map((e=>e.memoryMB))),s=Math.max(...this.memoryHistory.map((e=>e.memoryMB))),a=this.memoryHistory.reduce(((e,t)=>e+t.memoryMB),0)/this.memoryHistory.length;return{current:e.memoryMB,min:t,max:s,average:a,trend:s-t,registeredComponents:Array.from(this.registeredComponents)}}isMemoryUsageAcceptable(){return!performance.memory||performance.memory.usedJSHeapSize/1024/1024<this.threshold}getCurrentMemoryUsage(){return performance.memory?performance.memory.usedJSHeapSize/1024/1024:0}registerComponent(e){this.registeredComponents.add(e)}unregisterComponent(e){this.registeredComponents.delete(e)}},js=s.lazy((()=>et((()=>Promise.resolve().then((()=>dr))),void 0,import.meta.url)));s.lazy((()=>et((()=>Promise.resolve().then((()=>pr))),void 0,import.meta.url)));const Ns=s.lazy((()=>et((()=>Promise.resolve().then((()=>jr))),void 0,import.meta.url))),ks=s.lazy((()=>et((()=>Promise.resolve().then((()=>hr))),void 0,import.meta.url)));if("undefined"!=typeof document){const e="movie-details-overlay-slider-styles";if(!document.getElementById(e)){const t=document.createElement("style");t.id=e,t.textContent="\n  .slider::-webkit-slider-thumb {\n    appearance: none;\n    height: 18px;\n    width: 18px;\n    border-radius: 50%;\n    background: #ffffff;\n    cursor: pointer;\n    border: 2px solid rgba(255, 255, 255, 0.2);\n    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);\n    transition: all 0.2s ease;\n  }\n  \n  .slider::-webkit-slider-thumb:hover {\n    background: #ffffff;\n    border-color: rgba(255, 255, 255, 0.4);\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);\n    transform: scale(1.1);\n  }\n  \n  .slider::-webkit-slider-track {\n    height: 6px;\n    border-radius: 3px;\n    background: rgba(255, 255, 255, 0.1);\n    border: none;\n  }\n  \n  .slider::-moz-range-thumb {\n    height: 18px;\n    width: 18px;\n    border-radius: 50%;\n    background: #ffffff;\n    cursor: pointer;\n    border: 2px solid rgba(255, 255, 255, 0.2);\n    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);\n    transition: all 0.2s ease;\n  }\n  \n  .slider::-moz-range-thumb:hover {\n    background: #ffffff;\n    border-color: rgba(255, 255, 255, 0.4);\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);\n    transform: scale(1.1);\n  }\n  \n  .slider::-moz-range-track {\n    height: 6px;\n    border-radius: 3px;\n    background: rgba(255, 255, 255, 0.1);\n    border: none;\n  }\n\n  /* Custom scrollbar styling for editor panel */\n  .share-editor-scroll::-webkit-scrollbar {\n    width: 6px;\n  }\n  \n  .share-editor-scroll::-webkit-scrollbar-track {\n    background: rgba(255, 255, 255, 0.05);\n    border-radius: 3px;\n  }\n  \n  .share-editor-scroll::-webkit-scrollbar-thumb {\n    background: rgba(255, 255, 255, 0.2);\n    border-radius: 3px;\n    transition: background 0.2s ease;\n  }\n  \n  .share-editor-scroll::-webkit-scrollbar-thumb:hover {\n    background: rgba(255, 255, 255, 0.3);\n  }\n  \n  .share-editor-scroll::-moz-scrollbar {\n    width: 6px;\n  }\n  .share-editor-scroll::-moz-scrollbar-track {\n    background: rgba(255, 255, 255, 0.05);\n    border-radius: 3px;\n  }\n  \n  .share-editor-scroll::-moz-scrollbar-thumb {\n    background: rgba(255, 255, 255, 0.2);\n    border-radius: 3px;\n    transition: background 0.2s ease;\n  }\n  \n  .share-editor-scroll::-moz-scrollbar-thumb:hover {\n    background: rgba(255, 255, 255, 0.3);\n  }\n",document.head.appendChild(t)}}let Cs=null,Ss=0;const _s=()=>(()=>{const e=Date.now();if(Cs&&6e4>e-Ss)return Cs;if("undefined"==typeof window||"undefined"==typeof navigator)return{isHighPerformance:!1,cores:2,dpr:1,width:0,memory:0};try{const t=navigator.hardwareConcurrency||2,s=window.devicePixelRatio||1,a=window.innerWidth,r=navigator.deviceMemory||4;return Cs={isHighPerformance:t>=4||s>1.5||a>=1280||r>=8,cores:t,dpr:s,width:a,memory:r},Ss=e,Cs}catch(t){return{isHighPerformance:!1,cores:2,dpr:1,width:0,memory:0}}})().isHighPerformance,Ls=()=>{if("undefined"==typeof window||"undefined"==typeof document)return!1;const e=document.createElement("div");return e.style.webkitBackdropFilter="blur(1px)",e.style.backdropFilter="blur(1px)",!(!e.style.webkitBackdropFilter&&!e.style.backdropFilter)},Ts=()=>!("undefined"==typeof window||!window.matchMedia)&&window.matchMedia("(prefers-reduced-motion: reduce)").matches,Ms=e=>e&&"string"==typeof e?e.includes("NaN")||e.includes("undefined")||e.includes("null")?"brightness(1)":e:"brightness(1)",Es=s.memo((({options:e,value:a,onChange:r,placeholder:i="Select option",className:n=""})=>{const[o,l]=s.useState(!1),c=s.useRef(null);s.useEffect((()=>{const e=e=>{c.current&&!c.current.contains(e.target)&&l(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]);const d=e.find((e=>e.value===a))||e[0];return t.jsxs("div",{ref:c,className:"relative "+n,children:[t.jsxs("button",{onClick:()=>l(!o),className:"flex items-center justify-between w-full px-3 py-1.5 text-sm text-white bg-transparent border-b border-white/15 hover:border-white/30 focus:outline-none focus:border-primary/80 transition-all duration-200 min-w-[120px]",children:[t.jsx("span",{className:"truncate",children:d?.label||i}),t.jsx(Q.svg,{className:"w-4 h-4 text-white/60 ml-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:o?180:0},transition:{duration:.2},children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t.jsx(Z,{children:o&&t.jsx(Q.div,{initial:{opacity:0,y:Ts()?0:-10,scale:Ts()?1:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:Ts()?0:-10,scale:Ts()?1:.95},transition:{duration:Ts()?.01:.2,ease:"easeOut"},className:`absolute top-full left-0 right-0 mt-1 bg-[#1a1a1a]/95 ${Ls()&&_s()?"backdrop-blur-md":""} border border-white/10 rounded-lg shadow-xl z-50 overflow-hidden`,children:t.jsx("div",{className:"max-h-48 overflow-y-auto",children:e.map(((s,i)=>t.jsx("button",{onClick:()=>{r(s.value),l(!1)},className:`w-full px-3 py-2 text-sm text-left hover:bg-white/10 transition-colors duration-150 ${s.value===a?"bg-primary/20 text-primary":"text-white/80"} ${0===i?"rounded-t-lg":""} ${i===e.length-1?"rounded-b-lg":""}`,children:s.label},s.value)))})})})]})})),Is=new Map,Ds=()=>"undefined"!=typeof window&&window.innerWidth>1024?{maxSize:1,duration:6e4,cleanupInterval:2e4,realTimeInterval:12e4}:{maxSize:2,duration:18e4,cleanupInterval:45e3,realTimeInterval:6e4},Rs=async(e,t)=>{if("undefined"!=typeof window&&"Worker"in window)try{Rs._worker||(Rs._worker=new Worker(new URL("/assets/shareWorker-CYMmiXYD.js",import.meta.url)),Rs._promises=new Map,Rs._worker.onmessage=e=>{const{id:t,blob:s,error:a}=e.data||{},r=Rs._promises.get(t);r&&(s?r.resolve(s):r.reject(a||"Worker error"),Rs._promises.delete(t))});const s=`share-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,a=Rs._worker;return await new Promise(((r,i)=>{Rs._promises.set(s,{resolve:r,reject:i});try{a.postMessage({id:s,details:e,config:t})}catch(n){Rs._promises.delete(s),i(n)}setTimeout((()=>{Rs._promises.has(s)&&(Rs._promises.delete(s),i("Worker timeout"))}),8e3)}))}catch(s){}if("function"==typeof createShareCardBlob)return await createShareCardBlob(e,t);throw Error("Share generation function not available")},zs=(e,t,s=8e3)=>new Promise(((a,r)=>{let i=!1;const n=async()=>{try{const s=await Rs(e,t);i||(i=!0,a(s))}catch(s){i||(i=!0,r(s))}};try{if("undefined"!=typeof window&&"requestIdleCallback"in window){const e=window.requestIdleCallback((async()=>n()),{timeout:s});setTimeout((()=>{try{window.cancelIdleCallback&&window.cancelIdleCallback(e)}catch(t){}}),s+50)}else setTimeout(n,50)}catch(l){n()}const o=setTimeout((()=>{i||(i=!0,r("Share generation timeout")),clearTimeout(o)}),s+100)})),Ws=new Map,As=e.lazy((()=>et((()=>import("./react-vendor-CEpGHdZS.js").then((e=>e.aj))),__vite__mapDeps([3,2,1,4]),import.meta.url)),{suspense:!0});let Os=!1,Ps=null;const Fs=()=>(Os||Ps||(Ps=Promise.all([et((()=>import("./react-vendor-CEpGHdZS.js").then((e=>e.aj))),__vite__mapDeps([3,2,1,4]),import.meta.url).catch((()=>null)),new Promise((e=>{if(window.YT&&window.YT.Player)return Os=!0,void e();const t=document.createElement("script");t.src="https://www.youtube.com/iframe_api",t.async=!0,t.onload=()=>{Os=!0,e()},t.onerror=()=>{e()},document.body.appendChild(t)}))]).catch((()=>null))),Ps);"undefined"!=typeof window&&("requestIdleCallback"in window?requestIdleCallback((()=>Fs()),{timeout:2e3}):setTimeout((()=>Fs()),100));const Bs=s.memo((function({person:s,onClick:a,small:r=!1}){const[i,n]=e.useState(!1),[o,l]=e.useState(!1),c=e.useRef(null),d=e.useCallback((()=>{n(!0),l(!1)}),[]),u=e.useCallback((e=>{l(!0),n(!1),e.target&&(e.target.onload=null,e.target.onerror=null)}),[]);e.useEffect((()=>{const e=c.current;return()=>{e&&(e.onload=null,e.onerror=null),c.current=null}}),[]);const h=r?"w-11 h-11 mx-0 mb-0":"w-24 h-24 mx-auto mb-3";return t.jsxs("div",{className:"text-center group cursor-pointer",onClick:()=>a&&a(s),children:[t.jsxs("div",{className:"relative "+h,children:[t.jsx("div",{className:"rounded-full overflow-hidden w-full h-full transition-all duration-300 "+(_s()?"transform group-hover:scale-110 will-change-transform shadow-lg":"shadow-sm"),children:s.image&&!o?t.jsxs(t.Fragment,{children:[!i&&t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/5 to-transparent"}),t.jsx("img",{ref:c,src:s.image,alt:s.name,className:`object-cover ${_s()?"will-change-transform":""} ${i?"opacity-100":"opacity-0"} w-full h-full`,width:r?44:96,height:r?44:96,loading:"lazy",decoding:"async",fetchpriority:"low",style:{backfaceVisibility:"hidden",contain:"layout style paint",imageRendering:"auto"},onLoad:d,onError:u})]}):t.jsx("div",{className:"w-full h-full bg-gradient-to-br from-white/5 to-transparent flex items-center justify-center",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-white/30",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})})})}),t.jsx("div",{className:"absolute inset-0 rounded-full ring-2 ring-white/10 ring-inset opacity-50 group-hover:opacity-100 transition-opacity duration-300"})]}),r?t.jsx("div",{className:"mt-1 text-xs text-white truncate w-full",children:s.name}):t.jsxs(t.Fragment,{children:[t.jsx("h4",{className:"text-white font-medium text-sm truncate transition-colors group-hover:text-white",children:s.name}),t.jsx("p",{className:"text-white/60 text-xs truncate",children:s.character})]})]})}));s.memo((function({similar:s,onClick:a,isMobile:r}){const[i,n]=e.useState(!1),[o,l]=e.useState(!1),c=e.useRef(null),d=e.useMemo((()=>({backfaceVisibility:"hidden",contain:"layout style paint",imageRendering:"auto"})),[]);e.useEffect((()=>{}),[s]);const u=s.title||s.name||"Untitled";let h="N/A";s.year?h=s.year:s.first_air_date?h=new Date(s.first_air_date).getFullYear():s.release_date&&(h=new Date(s.release_date).getFullYear());const m=e.useCallback((()=>{n(!0),l(!1)}),[s?.poster_path,u]),p=e.useCallback((e=>{if(e.target&&s?.poster_path&&!e.target.dataset.fallbackTried){e.target.dataset.fallbackTried="true";const t=Pt(s.poster_path,"w500");return e.target.crossOrigin=null,void(e.target.src=t)}l(!0),n(!1),e.target&&(e.target.onload=null,e.target.onerror=null)}),[s?.poster_path,s?.title,s?.name]);return e.useEffect((()=>{const e=c.current;return()=>{e&&(e.onload=null,e.onerror=null),c.current=null}}),[]),t.jsx("div",{className:"group cursor-pointer",onClick:()=>a(s),children:t.jsxs("div",{className:"aspect-[2/3] rounded-lg overflow-hidden bg-gray-800 relative shadow-lg",children:[s.poster_path&&!o?t.jsxs(t.Fragment,{children:[!i&&t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-700 to-gray-800 rounded-t-2xl"}),t.jsx("img",{ref:c,src:ye(s.poster_path,"w500"),alt:u,className:`w-full h-full object-cover transition-all duration-300 ${_s()?"group-hover:scale-105 will-change-transform transform-gpu":""} ${i?"opacity-100":"opacity-0"}`,style:d,width:500,height:500,loading:"lazy",sizes:"(max-width: 640px) 50vw, (max-width: 1024px) 33vw, (max-width: 1280px) 25vw, 20vw",fetchpriority:"low",decoding:"async",crossOrigin:"anonymous",onLoad:m,onError:p})]}):t.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:t.jsx("svg",{className:"w-12 h-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),!r&&t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/90 via-black/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col justify-end p-3",children:t.jsxs("div",{className:"transform transition-transform duration-300 group-hover:-translate-y-2",children:[t.jsx("h4",{className:"font-semibold text-white text-base truncate",children:u}),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-white/70 mt-1",children:[t.jsx("span",{children:h}),t.jsx("span",{className:"w-1 h-1 rounded-full bg-white/50"}),t.jsxs("span",{className:"flex items-center gap-0.5",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 text-yellow-400",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})}),s.vote_average?.toFixed?s.vote_average.toFixed(1):"number"==typeof s.vote_average?s.vote_average:"N/A"]})]})]})}),t.jsx("div",{className:"absolute top-2 right-2 w-8 h-8 bg-black/50 rounded-full flex items-center justify-center transform transition-all duration-300 scale-0 group-hover:scale-100 opacity-0 group-hover:opacity-100",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-white",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M8 5v14l11-7z"})})})]})})}));const $s=({items:e=[],onClick:s,width:a="100%",itemHeight:r=92})=>e&&0!==e.length?t.jsx(u,{height:Math.min(e.length*r,400),itemCount:e.length,itemSize:r,width:a,children:({index:a,style:r})=>{const i=e[a];return t.jsx("div",{style:r,className:"p-2",children:t.jsx(Q.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.28,delay:Math.min(.02*a,.6),ease:[.2,.8,.2,1]},children:t.jsx(Bs,{person:i,onClick:s,small:!0})})})}}):null,Hs=s.memo((({movie:a,onClose:r,onMovieSelect:i,onGenreClick:u})=>{const h=e.useMemo((()=>({priority:"high",group:"movie-overlays",accessibility:!0,stacking:!0,debug:!1,animationType:"modal",analytics:!0,statePersistence:!0,theme:"movie-details",onFocus:e=>{},onBlur:e=>{},onEscape:e=>{r&&r()}})),[r]),{container:m,createPortal:p,focusPortal:x,isReady:g,zIndex:f,id:w,savePortalState:b,loadPortalState:v,trackInteraction:y,coordinateAnimation:j}=re("movie-details-portal",h),N=e.useMemo((()=>_s()),[]);e.useMemo((()=>Ls()),[]);const k=e.useMemo((()=>Ts()),[]),[C,S]=e.useState(!1),_=e.useRef(null),L=e.useRef(null),T=e.useRef(null),M=e.useRef({}),[E,I]=e.useState({visible:!1,person:null,x:0,y:0,placement:"top"});e.useEffect((()=>()=>{_.current&&clearTimeout(_.current),L.current&&clearTimeout(L.current)}),[]);const D=e.useCallback(((e,t)=>{try{const s=e.getBoundingClientRect(),a=s.left+s.width/2,r=s.top,i="top";s.left,s.top,s.width,s.height,window.scrollX||window.pageXOffset,window.scrollY||window.pageYOffset,document.documentElement.clientWidth,document.documentElement.clientHeight,I({visible:!0,person:t,x:Math.round(a),y:Math.round(r),placement:i})}catch(s){I({visible:!0,person:t,x:window.innerWidth/2,y:window.innerHeight/2,placement:"top"})}}),[]),R=e.useCallback((()=>{I((e=>({...e,visible:!1})))}),[]),z=e.useCallback(((e,t)=>{L.current&&(clearTimeout(L.current),L.current=null);const s=e.currentTarget||e.target;_.current&&clearTimeout(_.current),_.current=setTimeout((()=>D(s,t)),480)}),[D]),W=e.useCallback((()=>{_.current&&(clearTimeout(_.current),_.current=null),L.current&&clearTimeout(L.current),L.current=setTimeout((()=>R()),120)}),[R]),A=e.useCallback((()=>{L.current&&(clearTimeout(L.current),L.current=null)}),[]),O=e.useCallback((()=>{L.current&&clearTimeout(L.current),L.current=setTimeout((()=>R()),80)}),[R]),P=e.useCallback((()=>{const e=E;if(!e.person)return null;const s=e.person||{},a=s.image||(s.profile_path?Pt(s.profile_path,"w185"):null),r=s.name||s.original_name||"Unknown",i=s.character||s.role||"",o=s.known_for_department||s.department||"",l={position:"fixed",left:e.x-90+"px",top:e.y-90+"px",transform:"translate(-50%, calc(-100% - 8px))",zIndex:"number"==typeof f?f+2e3:2147483647,pointerEvents:"auto"};return n.createPortal(t.jsx(Z,{children:e.visible&&t.jsxs(Q.div,{id:"cast-tooltip-"+(e.person?.id||"unknown"),ref:T,initial:{opacity:0,y:"top"===e.placement?6:-6,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:"top"===e.placement?6:-6,scale:.98},transition:{duration:k?.02:.18,ease:"easeOut"},onMouseEnter:A,onMouseLeave:O,role:"tooltip","aria-hidden":!e.visible,className:"max-w-xs w-[220px] bg-transparent text-white rounded-full shadow-xl overflow-hidden p-3 flex gap-3 items-center border border-white/10 "+(Ls()&&N?"backdrop-blur-md bg-white/5":""),style:l,children:[a?t.jsx("img",{src:a,alt:r,className:"w-12 h-12 rounded-full object-cover flex-shrink-0",width:48,height:48,loading:"lazy"}):t.jsx("div",{className:"w-12 h-12 rounded-full bg-white/6 flex items-center justify-center flex-shrink-0",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-white/40",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"text-sm font-semibold leading-tight truncate",children:r}),i&&t.jsx("div",{className:"text-xs text-white/60 mt-1 truncate",children:i}),o&&t.jsx("div",{className:"text-xs text-white/50 mt-2",children:o})]})]},"cast-tooltip-"+(e.person?.id||"unknown"))}),"undefined"!=typeof document&&document.body?document.body:document.createElement("div"))}),[N,k,E,A,O]),{addToWatchlist:F,removeFromWatchlist:B,isInWatchlist:$}=jt(),{startWatchingMovie:H,startWatchingEpisode:V,viewingProgress:U}=At(),Y=e.useRef(new Map),q=e.useRef(null);e.useCallback(((e,t)=>new Promise(((s,a)=>{Y.current.has(e)||Y.current.set(e,{fn:t,resolvers:[],rejectors:[]});const r=Y.current.get(e);r.resolvers.push(s),r.rejectors.push(a),q.current&&clearTimeout(q.current),q.current=setTimeout((async()=>{const e=Array.from(Y.current.entries());Y.current.clear();for(const[s,{fn:a,resolvers:r,rejectors:i}]of e)try{const e=await a();r.forEach((t=>t(e)))}catch(t){i.forEach((e=>e(t)))}}),50)}))),[]);const[G,J]=e.useState(null),[X,K]=e.useState(0);e.useEffect((()=>{if(v){const e=v();e&&J(e)}}),[v]);const ee=e.useCallback(((e,t={})=>{K((e=>e+1)),y&&y(e,{movieId:a?.id,movieTitle:a?.title,...t}),b&&b({movieId:a?.id,interactionCount:X+1,lastInteraction:e,timestamp:Date.now(),scrollPosition:window.scrollY})}),[y,b,a?.id,a?.title,X]);e.useCallback((()=>{ee("close_button_clicked",{method:"close_button"}),r&&r()}),[ee,r]),e.useEffect((()=>{j&&a&&j("modal")}),[j,a]),e.useEffect((()=>(Be.current=!0,()=>{Be.current=!1,Pe.current&&(clearTimeout(Pe.current),Pe.current=null),Fe.current&&(clearInterval(Fe.current),Fe.current=null),He.current&&(clearTimeout(He.current),He.current=null)})),[]),e.useEffect((()=>{!a&&Be.current&&S(!1)}),[a]),e.useEffect((()=>{if(!a)return;const e=setTimeout((()=>{Be.current&&a&&S(!0)}),50);return()=>{clearTimeout(e),Be.current&&S(!1)}}),[a]),e.useEffect((()=>{if(!a)return;const e=new ResizeObserver((e=>{e.forEach((e=>{if(e.target===ot.current){const{width:t,height:s}=e.contentRect;t>0&&s>0&&!C&&setTimeout((()=>{Be.current&&S(!0)}),100)}}))}));return ot.current&&e.observe(ot.current),()=>{e.disconnect()}}),[a,C]);const[te,se]=e.useState(null),[ae,ie]=e.useState(null),[ne,oe]=e.useState(null),[le,ce]=e.useState([]),[de,ue]=e.useState(1),[he,me]=e.useState(!0),[pe,xe]=e.useState(!0),[ge,fe]=e.useState(null),[we,be]=e.useState(!1),[ve,je]=e.useState(Os);e.useRef(null);const Ne=e.useRef(null),ze=e.useRef(null),We=e.useRef(null),Ae=e.useRef(null),Oe=e.useRef(null),Pe=e.useRef(null),Fe=e.useRef(null),Be=e.useRef(!0),$e=e.useRef(0),He=e.useRef(null),Ve=e.useRef(null),Ue=e.useRef(null),Ye=e.useRef(null),[qe,Ge]=e.useState({cast:!0,similar:!0,trailer:!1,similarMore:!1}),Je=e.useCallback(((e,t)=>{Ge((s=>s[e]===t?s:{...s,[e]:t}))}),[]),Xe=qe.trailer,Ke=qe.similarMore,Qe=e=>Je("cast",e),Ze=e=>Je("similar",e),et=e=>Je("trailer",e),tt=e=>Je("similarMore",e),[st,at]=e.useState(!1),[rt,it]=e.useState(0),nt=e.useRef(null),ot=e.useRef(null),[lt,ct]=e.useState({showShareSheet:!1,shareImageUrl:null,isGeneratingShare:!1,isShareEditing:!1,sharePanelExpanded:!1,showShareEditor:!1,isImageReady:!1}),dt=e.useCallback((e=>{ct((t=>{const s={...t,...e};return JSON.stringify(t)===JSON.stringify(s)?t:s}))}),[]),{showShareSheet:ut,shareImageUrl:ht,isGeneratingShare:mt,isShareEditing:pt,sharePanelExpanded:xt,showShareEditor:gt,isImageReady:ft}=lt,wt=e=>dt({showShareSheet:e}),bt=e=>dt({shareImageUrl:e}),vt=e=>dt({isGeneratingShare:e}),yt=e=>dt({isShareEditing:e}),Nt=e=>dt({sharePanelExpanded:e}),kt=e=>dt({showShareEditor:e}),Ct=e=>dt({isImageReady:e});e.useEffect((()=>()=>{if(ht)try{URL.revokeObjectURL(ht),bt(null)}catch(e){}if(Mt.current)try{URL.revokeObjectURL(Mt.current),Mt.current=null}catch(e){}}),[ht]),e.useEffect((()=>()=>{if(Be.current=!1,Pe.current&&(clearTimeout(Pe.current),Pe.current=null),Fe.current&&(clearInterval(Fe.current),Fe.current=null),He.current&&(clearTimeout(He.current),He.current=null),Tt.current&&(clearTimeout(Tt.current),Tt.current=null),Et.current){try{Jt(Et.current)}catch(e){}Et.current=null}It.current&&(It.current.abort(),It.current=null)}),[]),e.useEffect((()=>{Be.current&&Fs().then((()=>{Be.current&&je(!0)})).catch((()=>{}))}),[]);const[St,_t]=e.useState({theme:"dark",layout:"portrait",imageSource:"auto",backgroundMode:"image",solidColorStart:"#0f1114",solidColorEnd:"#1a1d24",textColor:"#FFFFFF",titleSize:72,overviewLines:2,showRating:!0,showYear:!0,showRuntime:!0,titleAlign:"center",metaAlign:"center",spacingScale:1,posterFrameOpacity:.07,posterFrameRadius:28,posterCornerRadius:24,posterShadowStrength:.25,backgroundImageOpacity:.45,showGenres:!0,maxGenres:5,showBranding:!0}),Lt=e.useMemo((()=>"landscape"===St?.layout?{width:1020,height:576}:{width:520,height:780}),[St?.layout]),Tt=e.useRef(null),Mt=e.useRef(null),Et=e.useRef(null),It=e.useRef(null);e.useEffect((()=>()=>{ce([]),ie(null),oe(null),bt(null),wt(!1),Ct(!1),vt(!1),be(!1),Ss(!1),Ps(!1),Bs(!1),ws(null)}),[]),e.useEffect((()=>()=>{Pe.current&&(clearTimeout(Pe.current),Pe.current=null),Fe.current&&(clearInterval(Fe.current),Fe.current=null),He.current&&(clearTimeout(He.current),He.current=null),Tt.current&&(clearTimeout(Tt.current),Tt.current=null),Be.current=!1}),[]),e.useEffect((()=>{if(a?.id){if(a.poster_path||a.poster||a.backdrop||a.backdrop_path||a.overview||a.title||a.name){se((e=>e&&e.id===a.id?e:a));try{Ka(!1)}catch(e){}}else{se(null);try{Ka(!0)}catch(e){}}ie(null),oe(null),ce([]),ue(1),me(!0),fe(null),ha(new Set),ot.current&&(ot.current.scrollTop=0)}}),[a?.id]);const Dt=e.useMemo((()=>({hidden:{opacity:0,scale:.97,y:20},visible:{opacity:1,scale:1,y:0,transition:{duration:.32,ease:[.22,1,.36,1],staggerChildren:.045,when:"beforeChildren",type:"tween"}},exit:{opacity:0,scale:.97,y:16,transition:{duration:.14,ease:"easeIn"}}})),[]),Rt=e.useMemo((()=>({hidden:{y:8,opacity:0,scale:.985},visible:{y:0,opacity:1,scale:1,transition:{type:"spring",stiffness:160,damping:20,mass:.6}},exit:{y:-6,opacity:0,scale:.985,transition:{duration:.12,ease:"easeIn"}}})),[]);e.useEffect((()=>{const e=()=>{if(!Be.current)return;const e=ze.current||document.body,t=e?e.querySelectorAll("img"):document.querySelectorAll("img"),s=window.innerWidth>1024;t.forEach((e=>{e.loading||(e.loading="lazy"),s&&(e.style.imageRendering="optimizeSpeed",e.style.imageRendering="-webkit-optimize-contrast",e.style.willChange="auto",e.style.transform="translateZ(0)",e.style.backfaceVisibility="hidden",e.style.transition="none",e.style.filter="none")}))};let t=null;return t="undefined"!=typeof window&&window.requestIdleCallback?window.requestIdleCallback((()=>{try{e()}catch(t){}}),{timeout:1e3}):window.setTimeout((()=>{try{e()}catch(t){}}),400),()=>{if("undefined"!=typeof window&&window.cancelIdleCallback&&t)try{window.cancelIdleCallback(t)}catch(e){}if(t)try{clearTimeout(t)}catch(e){}}}),[]),e.useEffect((()=>{if(ut&&xt)return Tt.current&&(clearTimeout(Tt.current),Tt.current=null),Tt.current=setTimeout((()=>{let e=null;const t=()=>{(async()=>{try{if(!Be.current)return;vt(!0);const e=await zs(te,St);if(!Be.current)return;if(vt(!1),e){const t=URL.createObjectURL(e);Mt.current&&URL.revokeObjectURL(Mt.current),Mt.current=t,bt(t)}}catch(e){Be.current&&vt(!1)}})()};e="undefined"!=typeof window&&window.requestIdleCallback?window.requestIdleCallback(t,{timeout:2e3}):window.setTimeout(t,50),Tt.current=e}),500),()=>{if(Tt.current){try{"undefined"!=typeof window&&window.cancelIdleCallback&&window.cancelIdleCallback(Tt.current)}catch(e){}try{clearTimeout(Tt.current)}catch(e){}Tt.current=null}}}),[St,ut,xt]);const zt=e.useCallback((()=>{if(xt){kt(!1);const e=setTimeout((()=>{Be.current&&(Nt(!1),yt(!1))}),220);Pe.current&&clearTimeout(Pe.current),Pe.current=e}else{Nt(!0),yt(!0);const e=setTimeout((()=>{Be.current&&kt(!0)}),120);Pe.current&&clearTimeout(Pe.current),Pe.current=e}}),[xt]),[Wt,Ot]=e.useState(20),[Ft,Bt]=e.useState(20),[$t,Ht]=e.useState("");e.useCallback((()=>Ot((e=>e+20))),[]),e.useCallback((()=>Bt((e=>e+20))),[]);const[Vt,Ut]=e.useState(1),[Yt,qt]=e.useState({cast:20,similar:20,increment:20});e.useEffect((()=>{qt({cast:20,similar:20,increment:20})}),[]),e.useCallback((()=>{Ot((e=>e+Yt.increment))}),[Yt.increment]),e.useCallback((()=>{Bt((e=>e+Yt.increment))}),[Yt.increment]);const Xt=e.useMemo((()=>({hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.005,delayChildren:.01,type:"spring",stiffness:200,damping:25}}})),[]),Kt=e.useMemo((()=>({hidden:{opacity:0,y:4,scale:.98,filter:"blur(0px)"},visible:{opacity:1,y:0,scale:1,filter:"blur(0px)",transition:{type:"spring",stiffness:200,damping:20,duration:.15,ease:"easeOut"}}})),[]),Qt=e.useMemo((()=>({hidden:{opacity:0},visible:{opacity:1,transition:{duration:.1,ease:"easeOut"}}})),[]),Zt=e.useCallback((e=>{if(Ts())return{hidden:{opacity:0},visible:{opacity:1,transition:{duration:.08}},exit:{opacity:0,transition:{duration:.06}}};if(_s())return e;const t={...e};return t.visible&&t.visible.transition&&(t.visible={...t.visible,transition:{...t.visible.transition||{},duration:.18}}),t.exit&&t.exit.transition&&(t.exit={...t.exit,transition:{...t.exit.transition||{},duration:.12}}),t}),[]);e.useCallback((()=>({container:Dt,item:Rt})),[Dt,Rt]);const es=e.useMemo((()=>({initial:{scale:1,filter:Ms("brightness(1)")},hover:{scale:1.005,filter:Ms("brightness(1.01)"),transition:{type:"spring",stiffness:200,damping:15,duration:.06}},tap:{scale:.998,filter:Ms("brightness(1)"),transition:{type:"spring",stiffness:300,damping:20,duration:.03}}})),[]),ts=e.useMemo((()=>({hidden:{opacity:0,x:2,filter:"blur(0px)"},visible:{opacity:1,x:0,filter:"blur(0px)",transition:{type:"spring",stiffness:300,damping:25,duration:.1,ease:"easeOut"}}})),[]),ss=e.useMemo((()=>({initial:{opacity:0,scale:1.002,filter:"blur(0px)"},loaded:{opacity:1,scale:1,filter:"blur(0px)",transition:{type:"spring",stiffness:200,damping:20,duration:.2,ease:"easeOut"}}})),[]),is=e.useMemo((()=>({initial:{scale:1,filter:Ms("brightness(1)")},hover:{scale:1.004,filter:Ms("brightness(1.005)"),transition:{type:"spring",stiffness:200,damping:20,duration:.06}},tap:{scale:.999,filter:Ms("brightness(1)"),transition:{type:"spring",stiffness:250,damping:25,duration:.03}}})),[]),os=e.useMemo((()=>({hidden:{opacity:0,y:6,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{type:"spring",stiffness:200,damping:20,duration:.2,ease:"easeOut"}},exit:{opacity:0,y:-6,scale:.98,transition:{type:"spring",stiffness:300,damping:25,duration:.15,ease:"easeIn"}}})),[]),ls=e.useMemo((()=>({hidden:{opacity:0,y:8,filter:"blur(0px)"},visible:{opacity:1,y:0,filter:"blur(0px)",transition:{type:"spring",stiffness:200,damping:20,duration:.2,ease:"easeOut"}},exit:{opacity:0,y:-8,filter:"blur(0px)",transition:{type:"spring",stiffness:250,damping:25,duration:.15,ease:"easeIn"}}})),[]);e.useMemo((()=>({initial:{opacity:0,y:4,filter:"blur(0px)"},animate:{opacity:1,y:0,filter:"blur(0px)"},transition:{type:"spring",stiffness:200,damping:15,duration:.15,ease:"easeOut"}})),[]),e.useMemo((()=>({initial:{y:6,opacity:0,filter:"blur(0px)"},animate:{y:0,opacity:1,filter:"blur(0px)"},transition:{type:"spring",stiffness:200,damping:15,duration:.2,ease:"easeOut"}})),[]),e.useEffect((()=>{if("undefined"==typeof window||"undefined"==typeof document)return;if(document.getElementById("movie-details-overlay-scrollbar-style"))return;const e=document.createElement("style");return e.id="movie-details-overlay-scrollbar-style",e.innerHTML="\n      .hide-scrollbar {\n        scrollbar-width: none !important;\n        -ms-overflow-style: none !important;\n      }\n      .hide-scrollbar::-webkit-scrollbar {\n        display: none !important;\n        width: 0 !important;\n        background: transparent !important;\n      }\n    ",document.head.appendChild(e),()=>{const e=document.getElementById("movie-details-overlay-scrollbar-style");try{e&&e.parentNode&&document.head.contains(e)&&e.parentNode.removeChild(e)}catch(t){try{e&&e.parentNode&&e.parentNode.removeChild(e)}catch(s){}}}}),[]),s.useMemo((()=>{if(!te)return null;const e=te.vote_average,t=te.release_date,s=te.runtime,a=te.budget,r=te.revenue;return{formattedRating:e?"number"==typeof e?e.toFixed(1):parseFloat(e).toFixed(1):"N/A",formattedReleaseDate:t?(()=>{const e=new Date(t);return isNaN(e)?"N/A":e.toLocaleDateString()})():"N/A",formattedRuntime:s?`${Math.floor(s/60)}h ${s%60}m`:"N/A",formattedBudget:a?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",notation:"compact",maximumFractionDigits:1}).format(a):"N/A",formattedRevenue:r?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",notation:"compact",maximumFractionDigits:1}).format(r):"N/A"}}),[te?.vote_average,te?.release_date,te?.runtime,te?.budget,te?.revenue]);const{isMobile:cs,isTablet:ds,isDesktop:us}=(()=>{const[e,t]=s.useState((()=>"undefined"!=typeof window&&640>=window.innerWidth)),[a,r]=s.useState((()=>"undefined"!=typeof window&&window.innerWidth>640&&1024>=window.innerWidth)),[i,n]=s.useState((()=>"undefined"!=typeof window&&window.innerWidth>1024));return s.useEffect((()=>{const e={current:null};function s(){if(e.current)try{Jt(e.current)}catch(s){}e.current=Gt((()=>{const e=window.innerWidth;t(640>=e),r(e>640&&1024>=e),n(e>1024)}))}window.addEventListener("resize",s,{passive:!0});const a=()=>{if(e.current)try{Jt(e.current)}catch(t){}e.current=Gt((()=>{setScrollY(window.scrollY||window.pageYOffset||0)}))};return window.addEventListener("scroll",a,{passive:!0}),()=>{if(e.current){try{Jt(e.current)}catch(t){}e.current=null}window.removeEventListener("resize",s),window.removeEventListener("scroll",a)}}),[]),{isMobile:e,isTablet:a,isDesktop:i}})(),hs=s.useMemo((()=>"undefined"!=typeof window&&1024>window.innerWidth?640>window.innerWidth?2:4:5),[cs,ds,us]),ms=s.useMemo((()=>hs),[hs,us,ds]);s.useMemo((()=>{if(!te?.cast||!Array.isArray(te.cast))return[];let e=te.cast;if($t&&""!==$t.trim()){const t=$t.trim().toLowerCase();e=e.filter((e=>e?.name&&e.name.toLowerCase().includes(t)||e?.character&&e.character.toLowerCase().includes(t)))}return e.slice(0,Vt*ms)}),[te?.cast,$t,Vt,ms]),s.useMemo((()=>le&&Array.isArray(le)?le.slice(0,Ft):[]),[le,Ft]);const[ps,xs]=e.useState({showStreamingPlayer:!1,showEpisodeSelector:!1,showCastDetails:!1}),[gs,ws]=e.useState(null),bs=e.useCallback(((e,t)=>{xs((s=>s[e]===t?s:{...s,[e]:t}))}),[]),vs=ps.showStreamingPlayer,Cs=ps.showCastDetails,Ss=e=>bs("showStreamingPlayer",e),Ps=e=>bs("showEpisodeSelector",e),Bs=e=>bs("showCastDetails",e),[Hs,Vs]=e.useState(null),[Us,Ys]=e.useState(ke),[qs,Gs]=e.useState([]),[Js,Xs]=e.useState(null),[Ks,Qs]=e.useState([]),[Zs,ea]=e.useState(10),[ta,sa]=e.useState(0),[aa,ra]=e.useState(!1),[ia,na]=e.useState(!1),[oa,la]=e.useState((()=>"undefined"!=typeof window&&localStorage.getItem("episodesViewMode")||"list")),[ca,da]=e.useState(!1),[ua,ha]=e.useState(new Set),ma=e.useCallback((e=>{la(e),"undefined"!=typeof window&&localStorage.setItem("episodesViewMode",e)}),[]),pa=e.useCallback((async()=>{const e=Date.now();500>e-(ta||0)||(sa(e),ea((e=>e+10)))}),[ta]);e.useEffect((()=>{if(qs.length>0&&0===Ks.length&&!aa&&!ia){const e=setTimeout((()=>{da(!0)}),500);return()=>clearTimeout(e)}da(!1)}),[qs.length,Ks.length,aa,ia]);const xa=e.useMemo((()=>Zs<Ks.length),[Zs,Ks.length]);s.useMemo((()=>{if(!te?.cast)return[];let e=te.cast;if($t&&""!==$t.trim()){const t=$t.trim().toLowerCase();e=e.filter((e=>e.name&&e.name.toLowerCase().includes(t)||e.character&&e.character.toLowerCase().includes(t)))}return e.slice(0,Vt*ms)}),[te,$t,Vt,ms]),s.useMemo((()=>le?le.slice(0,Ft):[]),[le,Ft]),e.useEffect((()=>{if(he&&!Ke&&le.length>=Ft&&a?.id){const e=a.media_type||a.type||"movie",t=de+1,s=()=>{Be.current&&Ce(a.id,e,t).then((e=>{Be.current&&e?.results?.length>0&&ce((t=>{const s=new Set(t.map((e=>e.id))),a=e.results.filter((e=>!s.has(e.id)));return[...t,...a]}))}))};window.requestIdleCallback?window.requestIdleCallback(s,{timeout:5e3}):setTimeout(s,1e3)}}),[a?.id]);const ga=e.useCallback((()=>at((e=>!e))),[]);e.useCallback((()=>{if(!ot.current)return;const e=ot.current.scrollTop;it(e)}),[]),e.useEffect((()=>{const e=ot.current;if(!e||pe)return;const t=()=>{if(e&&Be.current){const t=e.scrollTop;it(t)}};return e.addEventListener("scroll",t,{passive:!0}),()=>{e&&e.removeEventListener("scroll",t)}}),[pe]),e.useCallback((async()=>{if(Ke||!he||!a?.id)return;const e=a.media_type||a.type||"movie",t=de+1;tt(!0);try{const s=await Ce(a.id,e,t);s?.results?.length>0?(ce((e=>{const t=new Set(e.map((e=>e.id))),a=s.results.filter((e=>e&&e.id&&!t.has(e.id)));return[...e,...a]})),ue(t),me(s.page<s.total_pages)):me(!1)}catch(s){me(!1)}finally{tt(!1)}}),[Ke,he,de,a?.id,a?.type]),e.useEffect((()=>{if(pe)return;let e=null;const t=nt.current;return t&&Be.current&&(e=new IntersectionObserver((e=>{if(e[0].isIntersecting&&he&&Be.current&&!Ke&&a?.id){const e=a.media_type||a.type||"movie",t=de+1;tt(!0),Ce(a.id,e,t).then((e=>{Be.current&&(e?.results?.length>0?(ce((t=>{const s=new Set(t.map((e=>e.id))),a=e.results.filter((e=>e&&e.id&&!s.has(e.id)));return[...t,...a]})),ue(t),me(e.page<e.total_pages)):me(!1))})).catch((e=>{Be.current&&me(!1)})).finally((()=>{Be.current&&tt(!1)}))}}),{root:ot.current,threshold:1}),e.observe(t)),()=>{e&&t&&e.unobserve(t),e&&(e.disconnect(),e=null)}}),[pe,he,a?.id]);const fa=e.useCallback((e=>{try{if(w&&Se&&"function"==typeof Se.isTopPortal&&!Se.isTopPortal(w))return}catch(t){}Ne.current&&!ze.current?.contains(e.target)&&"function"==typeof r&&r()}),[r]),wa=e.useCallback((e=>{if("Escape"===e.key){try{if(w&&Se&&"function"==typeof Se.isTopPortal&&!Se.isTopPortal(w))return}catch(t){}"function"==typeof r&&r()}}),[r]);e.useEffect((()=>{const e=fa,t=wa;return document.addEventListener("mousedown",e),document.addEventListener("keydown",t),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("keydown",t)}}),[fa,wa]),s.useMemo((()=>te?.genres||[]),[te]),e.useMemo((()=>te),[te?.id,te?.title]),e.useMemo((()=>ae),[ae?.cast?.length,ae?.crew?.length]),e.useMemo((()=>ne),[ne?.results?.length]),e.useMemo((()=>le),[le?.length]);const ba=e.useMemo((()=>te?"tv"===te?.type?{id:te.id,type:"tv",season:te.season,episode:te.episode,title:te.name||te.title,name:te.name||te.title,poster_path:te.poster_path||te.poster,backdrop_path:te.backdrop_path||te.backdrop}:te:null),[te]),va=e.useMemo((()=>{if(!a||!a.id||!U)return!1;const e=a.type||a.media_type||"movie",t="movie"===e?"movie_"+a.id:"tv"===e&&a.season&&a.episode?`tv_${a.id}_${a.season}_${a.episode}`:null;if(t&&U[t])return!0;if("movie"===e){const e=U["movie_"+a.id];return!!(e&&"number"==typeof e.progress&&e.progress>0&&100>e.progress)}if("tv"===e){const e=a.season,t=a.episode;if(e&&t){const s=U[`tv_${a.id}_${e}_${t}`];if(s&&"number"==typeof s.progress&&s.progress>0&&100>s.progress)return!0}for(const[s,r]of Object.entries(U))if(s.startsWith(`tv_${a.id}_`)&&r&&"number"==typeof r.progress&&r.progress>0&&100>r.progress)return!0}return!1}),[a?.id,a?.type,a?.media_type,a?.season,a?.episode,U]),[ya,ja]=e.useState(0),Na=e.useCallback((async(e=0)=>{if(!a?.id)return;const t=a.media_type||a.type||"movie",s=window.innerWidth>1024,r=Date.now();$e.current=r,performance.now();try{if(!Be.current||$e.current!==r)return;let e,i,n,o;if(xe(!0),fe(null),s)e=await _e(a.id,t),await new Promise((e=>setTimeout(e,100))),i=await Le(a.id,t),await new Promise((e=>setTimeout(e,100))),n=await Te(a.id,t),await new Promise((e=>setTimeout(e,100))),o=await Ce(a.id,t,1);else{const[s,r,l,c]=await Promise.allSettled([_e(a.id,t),Le(a.id,t),Te(a.id,t),Ce(a.id,t,1)]);e="fulfilled"===s.status?s.value:null,i="fulfilled"===r.status?r.value:null,n="fulfilled"===l.status?l.value:null,o="fulfilled"===c.status?c.value:null}if(!e)throw Error("Movie details not found or unavailable");((e,t,s)=>{const a=`${t}_${e}`,r=Ds();if(Is.set(a,{data:s,timestamp:Date.now()}),Is.size>r.maxSize){const e=Array.from(Is.entries());e.sort(((e,t)=>e[1].timestamp-t[1].timestamp)),Is.delete(e[0][0])}const i=Date.now();for(const[n,o]of Is.entries())i-o.timestamp>r.duration&&Is.delete(n)})(a.id,t,e);const l=n?.results?.find((e=>"Trailer"===e.type&&"YouTube"===e.site))?.key;if(l&&(((e,t,s)=>{const a=`${t}_${e}`;Ws.set(a,{trailer:s,timestamp:Date.now()})})(a.id,t,l),Fs()),!Be.current||$e.current!==r)return;se(l?{...e,trailer:l}:e),ie(i||{cast:[],crew:[]}),oe(n||{results:[]}),s?(ce((o?.results||[]).slice(0,6)),me(!1)):(ce(o?.results||[]),me(!!o&&o.page<o.total_pages)),Qe(!1),Ze(!1),ja(0)}catch(i){if(1>e&&Be.current){ja(e+1);const t=setTimeout((()=>{Be.current&&$e.current===r&&Na(e+1)}),1e3);return He.current&&clearTimeout(He.current),void(He.current=t)}Be.current&&$e.current===r&&fe("Failed to load movie details. Please try again later.")}finally{Be.current&&$e.current===r&&xe(!1)}}),[a?.id,a?.media_type,a?.type]);e.useEffect((()=>{const e=ys.registerCleanupCallback((()=>{Is.clear(),Ws.clear()}),"MovieDetailsOverlay");if(Fs(),Be.current=!0,!a?.id)return;const t=a.media_type||a.type||"movie",s=((e,t)=>{const s=`${t}_${e}`,a=Is.get(s),r=Ds();return a&&Date.now()-a.timestamp<r.duration?a.data:null})(a.id,t);if(s){se(s),xe(!1);const t=setTimeout((()=>{Be.current&&Na(0)}),1e3);return()=>{t&&clearTimeout(t),e&&e()}}const r=performance.now();return Na(0).finally((()=>{const e=performance.now()-r;e>2e3&&e.toFixed(2)})),()=>{Be.current=!1,He.current&&(clearTimeout(He.current),He.current=null),e&&e()}}),[a?.id,a?.media_type,a?.type]);const ka=e.useCallback((()=>{a?.id&&(ja(0),fe(null),xe(!0),se(null),ie(null),oe(null),ce([]),performance.now(),Na(0).finally((()=>{performance.now()})))}),[a?.id,a?.media_type,a?.type]);e.useCallback((()=>{a?.id&&(ja(0),fe(null),xe(!0),Na(0))}),[a?.id,a?.media_type,a?.type]),e.useEffect((()=>()=>{if(Be.current=!1,Pe.current&&(clearTimeout(Pe.current),Pe.current=null),Fe.current&&(clearInterval(Fe.current),Fe.current=null),He.current&&(clearTimeout(He.current),He.current=null),Tt.current&&(clearTimeout(Tt.current),Tt.current=null),Et.current){try{Jt(Et.current)}catch(e){}Et.current=null}It.current&&(It.current.abort(),It.current=null)}),[]),e.useEffect((()=>{}),[]),e.useEffect((()=>{const e={overflow:document.body.style.overflow,paddingRight:document.body.style.paddingRight},t=window.innerWidth-document.documentElement.clientWidth;return document.body.style.overflow="hidden",t>0&&(document.body.style.paddingRight=t+"px"),()=>{try{Be.current&&document.body&&document.body.style&&(Object.entries(e).forEach((([e,t])=>{void 0!==document.body.style[e]&&(document.body.style[e]=t)})),document.body.offsetHeight)}catch(t){}}}),[]);const Ca=e.useCallback((()=>{if(be(!0),et(!ve),Fs().then((()=>{Be.current&&(je(!0),setTimeout((()=>{Be.current&&ve&&et(!1)}),50))})).catch((()=>{Be.current&&je(!0)})),a?.id){const e=a.media_type||a.type||"movie",t=((e,t)=>{const s=`${t}_${e}`,a=Ws.get(s);return a&&6e5>Date.now()-a.timestamp?a.trailer:null})(a.id,e);t&&te&&!te.trailer&&se((e=>e?{...e,trailer:t}:e))}setTimeout((()=>{Be.current&&Oe.current&&"function"==typeof Oe.current.focus&&Oe.current.focus()}),200),window.gtag&&window.gtag("event","trailer_open",{event_category:"MovieDetails",event_label:a?.title||a?.name||a?.id,value:a?.id})}),[a,Oe,te,ve]),Sa=e.useCallback((e=>{if(e&&(e.stopPropagation(),e.preventDefault()),be(!1),Oe.current)try{"function"==typeof Oe.current.pauseVideo&&Oe.current.pauseVideo(),"function"==typeof Oe.current.seekTo&&Oe.current.seekTo(0)}catch(t){}setTimeout((()=>{if(Be.current)try{const e=document.querySelector("[data-trailer-button]");e&&"function"==typeof e.focus&&e.focus()}catch(t){}}),200),window.gtag&&window.gtag("event","trailer_close",{event_category:"MovieDetails",event_label:a?.title||a?.name||a?.id,value:a?.id})}),[a,Oe]);e.useEffect((()=>{if(!we)return;const e=e=>{"Escape"===e.key&&Sa(e)};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)}),[we,Sa]),e.useEffect((()=>()=>{if(Oe.current)try{"function"==typeof Oe.current.pauseVideo&&Oe.current.pauseVideo(),"function"==typeof Oe.current.stopVideo&&Oe.current.stopVideo(),"function"==typeof Oe.current.destroy&&Oe.current.destroy()}catch(e){}finally{Oe.current=null}}),[]);const _a=e.useCallback((()=>{if(!a)return;if(Me(a))return void Ps(!0);const e=e=>{if(!e)return null;if("string"!=typeof e)return null;if(e.startsWith("/"))return e;const t=e.match(/\/t\/p\/[^\/]+\/(.+)$/);return t?"/"+t[1]:e},t={...a,poster_path:e(a.poster_path||a.poster),backdrop_path:e(a.backdrop_path||a.backdrop)};"movie"===(a.media_type||a.type||"movie")&&H(t);const s=Ee(a,Us);s&&(Vs(s),Ss(!0),window.gtag&&window.gtag("event","streaming_open",{event_category:"MovieDetails",event_label:a?.title||a?.name||a?.id,value:a?.id}))}),[a,Us,H]),La=e.useCallback((()=>{Ss(!1),Vs(null),window.gtag&&a&&window.gtag("event","streaming_close",{event_category:"MovieDetails",event_label:a?.title||a?.name||a?.id,value:a?.id})}),[a]),Ta=e.useCallback((e=>{Ss(!1),Vs(null),window.gtag&&a&&window.gtag("event","streaming_error",{event_category:"MovieDetails",event_label:a?.title||a?.name||a?.id,value:a?.id,error_message:e})}),[a]);e.useCallback((()=>{Ps(!1)}),[]);const Ma=e.useCallback((e=>{Ys(e.key),Vs(e.url),window.gtag&&a&&window.gtag("event","streaming_service_changed",{event_category:"MovieDetails",event_label:a?.title||a?.name||a?.id,value:a?.id,streaming_service:e.name})}),[a]),Ea=e.useCallback((e=>{ws(e),Bs(!0)}),[]),Ia=e.useCallback((()=>{Bs(!1),ws(null)}),[]),Da=e.useCallback(((e,t={})=>{if(!e||!e.id)return void(window?.showToast&&window.showToast("Invalid similar movie data provided",{type:"error"}));window.gtag&&window.gtag("event","similar_movie_click",{event_category:"MovieDetails",event_label:e.title||e.name||e.id,value:e.id,from_movie_id:a?.id,from_movie_title:a?.title||a?.name});const s={id:e.id,title:e.title||e.name||"Untitled",name:e.name||e.title||"Untitled",type:e.media_type||e.type||"movie",poster_path:e.poster_path||e.poster||null,backdrop_path:e.backdrop_path||e.backdrop||null,overview:e.overview||"",year:(r=e,r.year?r.year:r.release_date?new Date(r.release_date).getFullYear():r.first_air_date?new Date(r.first_air_date).getFullYear():"N/A"),rating:"number"==typeof e.vote_average?e.vote_average:"number"==typeof e.rating?e.rating:0,genres:(e=>Array.isArray(e.genres)?e.genres:Array.isArray(e.genre_ids)?e.genre_ids:[])(e),release_date:e.release_date||e.first_air_date||null,popularity:e.popularity,original_language:e.original_language,vote_count:e.vote_count,...t.extraFields&&"object"==typeof t.extraFields?t.extraFields:{}};var r;("tv"===s.type||e.name&&!e.title||"tv"===e.media_type)&&(s.media_type="tv",s.type="tv",!s.name&&s.title&&(s.name=s.title),!s.title&&s.name&&(s.title=s.name)),setTimeout((()=>{const e=document.getElementById("movie-details-overlay-heading");e&&"function"==typeof e.focus&&e.focus()}),350),i&&i(s)}),[i,a]),[Ra,za]=e.useState(null),[Wa,Aa]=e.useState(null),[Oa,Pa]=e.useState(!1),[Fa,Ba]=e.useState(!1),[$a,Ha]=e.useState(null),[Va,Ua]=e.useState(null),Ya=null!==Ra?Ra:$(a.id);e.useMemo((()=>Ya),[Ya]);const qa=e=>{e.stopPropagation();const t=$(a.id);if(Ya){za(!1),Ua("Removed from list");try{B(a.id)}catch(s){za(t),Aa("Failed to update watchlist."),setTimeout((()=>Aa(null)),2e3)}}else{za(!0),Ua("Added to list!");try{const e={id:a.id,title:a.title||a.name,type:a.type||a.media_type||"movie",poster_path:a.poster_path||a.poster,backdrop_path:a.backdrop_path||a.backdrop,overview:a.overview,year:a.year||a.release_date?.split("-")[0]||a.first_air_date?.split("-")[0]||"N/A",rating:a.rating||a.vote_average||0,genres:a.genres||a.genre_ids||[],runtime:a.runtime,release_date:a.release_date||a.first_air_date,addedAt:(new Date).toISOString()};F(e)}catch(s){za(t),Aa("Failed to update watchlist."),setTimeout((()=>Ua(null)),2e3)}}Ye.current&&clearTimeout(Ye.current),Ye.current=setTimeout((()=>{Be.current&&Ua(null),Ye.current=null}),2e3)},Ga=e.useCallback((e=>{e.stopPropagation();const t=!Oa;if(Pa(t),Ba(!0),Ha(t?"Liked!":"Removed from likes"),"undefined"!=typeof navigator&&"vibrate"in navigator)try{t?navigator.vibrate([30,50,30]):navigator.vibrate([50])}catch(s){}if(!cs&&"undefined"!=typeof window)try{const e=new(window.AudioContext||window.webkitAudioContext),s=e.createOscillator(),a=e.createGain();s.connect(a),a.connect(e.destination),s.frequency.setValueAtTime(t?800:600,e.currentTime),a.gain.setValueAtTime(.1,e.currentTime),a.gain.exponentialRampToValueAtTime(.01,e.currentTime+.1),s.start(e.currentTime),s.stop(e.currentTime+.1),setTimeout((()=>{try{e.close()}catch(t){}}),200)}catch(r){}window.gtag&&window.gtag("event",t?"like_movie":"unlike_movie",{event_category:"MovieDetails",event_label:a?.title||a?.name||a?.id,value:a?.id}),Ve.current&&clearTimeout(Ve.current),Ve.current=setTimeout((()=>{Be.current&&(Ba(!1),Ve.current=null)}),600),Ue.current&&clearTimeout(Ue.current),Ue.current=setTimeout((()=>{Be.current&&(Ha(null),Ue.current=null)}),2e3)}),[Oa,a,cs]);e.useEffect((()=>{za(null),Aa(null),Pa(!1),Ba(!1),Ha(null),Ua(null),Ve.current&&(clearTimeout(Ve.current),Ve.current=null),Ue.current&&(clearTimeout(Ue.current),Ue.current=null),Ye.current&&(clearTimeout(Ye.current),Ye.current=null)}),[a.id]);const Ja=e=>e?`${Math.floor(e/60)}h ${e%60}m`:"N/A",[Xa,Ka]=e.useState(!a?._skipInitialLoad),Qa=e.useCallback((async()=>{const e=$e.current;if(!a||!a.id)return void(Be.current&&$e.current===e&&(fe("Invalid movie data."),se(null),Ka(!1)));const t=a.media_type||a.type||"movie";let s;try{const r=!!(a.poster_path||a.poster||a.backdrop||a.backdrop_path||a.overview||a.title||a.name),i=te&&te.id===a.id,n=!(r||i);Be.current&&$e.current===e&&(Ka(!!n),fe(null)),s=performance.now(),window.gtag&&window.gtag("event","fetch_basic_info_start",{event_category:"MovieDetails",event_label:a.title||a.name||a.id,value:a.id});const o=await _e(a.id,t),l=performance.now()-s;if(l>2e3&&(l.toFixed(2),a.id),window.gtag&&window.gtag("event","fetch_basic_info_complete",{event_category:"MovieDetails",event_label:a.title||a.name||a.id,value:a.id,fetch_duration_ms:Math.round(l)}),!o){if(!Be.current||$e.current!==e)return;return fe("Movie not found."),se(null),window.gtag&&window.gtag("event","fetch_basic_info_not_found",{event_category:"MovieDetails",event_label:a.title||a.name||a.id,value:a.id}),void Ka(!1)}if(!Be.current||$e.current!==e)return;se(o),Ka(!1)}catch(r){if(!Be.current||$e.current!==e)return;fe("Failed to fetch basic info."),Ka(!1)}}),[a]),Za=e.useCallback((async()=>{const e=$e.current;if(!a)return;const t=a.media_type||a.type||"movie";Qe(!0),Ze(!0),at(!1),ce([]),ue(1),me(!0),ia||(Gs([]),Xs(null),Qs([]));try{const s=[Le(a.id,t),Te(a.id,t),Ce(a.id,t,1)],r=await Promise.all(s),[i,n,o]=r;Be.current&&$e.current===e&&(ie(i),oe(n),ce(o?.results||[]),me(o?.total_pages>o?.page))}catch(s){}finally{Be.current&&$e.current===e&&(Qe(!1),Ze(!1))}}),[a]),er=e.useCallback((async e=>{if(a?.id&&e&&!ia&&!ua.has(e)){na(!0),ha((t=>new Set([...t,e])));try{const t=(await Ie(a.id,e)).episodes||[];t.length,t[0],t.length>0&&Qs(t)}catch(t){}finally{na(!1)}}}),[a?.id,ia,ua]);e.useCallback((async e=>er(e)),[er]),e.useEffect((()=>{if(("tv"===a?.media_type||"tv"===a?.type||a?.id&&a?.name&&!a?.title)&&a?.id){if(ia)return;(async()=>{try{a.id;const e=await Re(a.id);if(e&&e.length>0){e.length,Gs(e);const t=e[e.length-1];Xs(t),await er(t.season_number)}else a.id,Gs([])}catch(e){Gs([])}})()}}),[a?.id,a?.media_type,a?.type,a?.name,a?.title]);const tr=e.useCallback((e=>{Xs(e),a?.id&&e?.season_number&&!ia&&(async()=>{try{const t=(await Ie(a.id,e.season_number)).episodes||[];t.length>0&&Qs(t),ha((t=>new Set([...t,e.season_number])))}catch(t){ha((t=>new Set([...t,e.season_number])))}})()}),[a?.id,ia]);e.useEffect((()=>{}),[Ks.length,ia,Js,a?.id,a?.media_type]),e.useEffect((()=>{if("tv"===a?.media_type&&a?.id&&Js?.season_number&&0===Ks.length&&!ia){const e=setTimeout((()=>{0!==Ks.length||ia||er(Js.season_number)}),1e3);return()=>clearTimeout(e)}}),[a?.id,a?.media_type,Js,Ks.length,ia,er]),e.useEffect((()=>{if(a?.id&&("tv"===a?.media_type||"tv"===a?.type||a?.name&&!a?.title)&&0===qs.length&&!ia){const e=setTimeout((()=>{0!==qs.length||ia||(async()=>{try{const e=await Re(a.id);if(e&&e.length>0&&(e.length,Gs(e),!Js)){const t=e[e.length-1];Xs(t),await er(t.season_number)}}catch(e){}})()}),2e3);return()=>clearTimeout(e)}}),[a?.id,a?.media_type,a?.type,a?.name,a?.title,qs.length,ia,Js,er]),e.useEffect((()=>{a?.id&&("tv"===a?.media_type||"tv"===a?.type||a?.name&&!a?.title)&&qs.length>0&&Js?.season_number&&0===Ks.length&&!ia&&er(Js.season_number)}),[a?.id,a?.media_type,a?.type,a?.name,a?.title,qs.length,Js,Ks.length,ia,er]),e.useEffect((()=>{if(a?.id&&("tv"===a?.media_type||"tv"===a?.type||a?.name&&!a?.title)){const e=setTimeout((()=>{qs.length>0&&Js?.season_number&&0===Ks.length&&!ia&&er(Js.season_number)}),500);return()=>clearTimeout(e)}}),[a?.id]);const sr=e.useCallback((e=>{if(!a)return;V(a,e.season_number,e.episode_number,e);const t={...a,season:e.season_number,episode:e.episode_number};se(t);const s=Ee({id:a.id,type:"tv",season:e.season_number,episode:e.episode_number});s?(Vs(s),Ss(!0)):Ps(!0)}),[a]);if(e.useCallback((()=>{if(!a?.id)return;const e=a.media_type||a.type||"movie";Qe(!0),Ze(!0),at(!1),ce([]),ue(1),me(!0),ia||(Gs([]),Xs(null),Qs([]));const t=[Le(a.id,e),Te(a.id,e),Ce(a.id,e,1)];Promise.all(t).then((e=>{if(!Be.current)return;const[t,s,a]=e;ie(t),oe(s),ce(a?.results||[]),me(a?.total_pages>a?.page)})).catch((e=>{Be.current})).finally((()=>{Be.current&&(Qe(!1),Ze(!1))}))}),[a?.id,ia]),e.useEffect((()=>{if(!a?.id||!a?.type)return;const e=async()=>{try{if(!Be.current)return;const e=await Ce(a.id,a.type,1);if(!Be.current)return;e&&Array.isArray(e.results)&&window.similarContentCache&&Be.current&&window.similarContentCache.set(`${a.id}-${a.type}`,{data:e.results,timestamp:Date.now(),prefetched:!0})}catch(e){if(!Be.current)return}};window.requestIdleCallback?requestIdleCallback(e,{timeout:500}):setTimeout(e,50)}),[a?.id,a?.type]),e.useEffect((()=>{let e=!0,t=new AbortController;return Be.current&&(se(null),ie(null),oe(null),ce([]),Ka(!0),Qe(!0),Ze(!0),fe(null),Gs([]),Xs(null),Qs([]),ra(!1),na(!1)),window.gtag&&a?.id&&window.gtag("event","movie_details_overlay_open",{event_category:"MovieDetails",event_label:a?.title||a?.name||a?.id,value:a?.id}),(async()=>{try{if(e&&a?.id&&Be.current){if(await Qa(),!e||!Be.current)return;await Za()}}catch(t){}})(),()=>{e=!1,t.abort()}}),[a?.id]),e.useEffect((()=>{if(!a?.id||!te)return;let e=null,t=!0;return e=setTimeout((()=>{t&&Be.current&&$e.current&&Be.current&&Na(0)}),18e5),()=>{t=!1,e&&(clearTimeout(e),e=null)}}),[a?.id]),e.useEffect((()=>()=>{}),[a?.id]),e.useEffect((()=>()=>{try{Pe.current&&(clearTimeout(Pe.current),Pe.current=null),Fe.current&&(clearInterval(Fe.current),Fe.current=null)}catch(e){}}),[]),s.useMemo((()=>te?.vote_average?"number"==typeof te.vote_average?te.vote_average.toFixed(1):parseFloat(te.vote_average).toFixed(1):"N/A"),[te]),s.useMemo((()=>{if(!te?.release_date)return"N/A";const e=new Date(te.release_date);return isNaN(e)?"N/A":e.toLocaleDateString()}),[te]),s.useMemo((()=>te?.runtime?`${Math.floor(te.runtime/60)}h ${te.runtime%60}m`:"N/A"),[te]),s.useMemo((()=>te?.budget?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",notation:"compact",maximumFractionDigits:1}).format(te.budget):"N/A"),[te]),s.useMemo((()=>te?.revenue?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",notation:"compact",maximumFractionDigits:1}).format(te.revenue):"N/A"),[te]),e.useEffect((()=>{if(g&&m){const e=setTimeout((()=>{x()}),100);return()=>clearTimeout(e)}}),[g,x]),e.useEffect((()=>{if(!g||!m)return;if(!(()=>{try{if(w&&Se&&"function"==typeof Se.isTopPortal)return Se.isTopPortal(w)}catch(e){}return!0})())return;We.current="undefined"!=typeof document?document.activeElement:null;try{"undefined"!=typeof document&&(Ae.current=document.body.style.overflow,document.body.style.overflow="hidden")}catch(s){}const e=e=>{if("Tab"!==e.key)return;try{if(w&&Se&&"function"==typeof Se.isTopPortal&&!Se.isTopPortal(w))return}catch(i){}const t=ze.current;if(!t)return;const s=Array.from(t.querySelectorAll('a[href], button:not([disabled]), textarea:not([disabled]), input:not([disabled]), select:not([disabled]), [tabindex]:not([tabindex="-1"])')).filter((e=>null!==e.offsetParent));if(0===s.length)return void e.preventDefault();const a=s[0],r=s[s.length-1];e.shiftKey?document.activeElement===a&&(e.preventDefault(),r.focus()):document.activeElement===r&&(e.preventDefault(),a.focus())},t=setTimeout((()=>{(()=>{try{const e=ze.current;if(!e)return;const t='a[href], button:not([disabled]), textarea:not([disabled]), input:not([disabled]), select:not([disabled]), [tabindex]:not([tabindex="-1"])',s=Array.from(e.querySelectorAll(t)).filter((e=>null!==e.offsetParent));s.length?s[0].focus():"function"==typeof e.focus&&e.focus()}catch(s){}})()}),120);return document.addEventListener("keydown",e),()=>{clearTimeout(t),document.removeEventListener("keydown",e);try{"undefined"!=typeof document&&(document.body.style.overflow=Ae.current||"",Ae.current=null)}catch(s){}try{const e=We.current;e&&"function"==typeof e.focus&&e.focus(),We.current=null}catch(s){}}}),[g,m,w]),e.useEffect((()=>{}),[g,w,f,te?.id,te?.title,te?.name]),"undefined"==typeof window||!g||!m)return null;const ar=t.jsx(Z,{children:t.jsxs(Q.div,{ref:Ne,className:"fixed inset-0 bg-black/85 flex items-center justify-center z-[999999999] p-2 sm:p-4 contain-paint transition-none sm:mt-0",variants:Zt(Dt),initial:"hidden",animate:"visible",exit:"exit",onClick:fa,tabIndex:-1,style:{zIndex:999999999,willChange:k?"auto":"opacity, transform"},children:[t.jsxs(Q.div,{ref:ze,role:"dialog","aria-modal":"true","aria-label":te?.title||te?.name||"Movie details",className:"relative w-full max-w-6xl h-auto max-h-[calc(100vh-1rem)] z-[1000000000] sm:max-h-[95vh] bg-gradient-to-br from-[#1a1d24] to-[#121417] rounded-3xl shadow-3xl overflow-hidden flex flex-col pointer-events-auto overflow-y-auto mt-2 sm:mt-6",variants:Zt(Rt),initial:"hidden",animate:"visible",exit:"exit",onClick:e=>e.stopPropagation(),tabIndex:-1,style:{zIndex:1e9,willChange:k?"auto":"transform, opacity"},children:[Xa?t.jsx(rs,{}):ge?t.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-4",children:[t.jsx("p",{className:"text-red-400 text-lg font-semibold",children:ge}),t.jsx("button",{onClick:ka,className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/80 transition-colors",children:"Retry"}),t.jsx("button",{onClick:r,className:"px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg transition-colors",children:"Close"})]}):te?t.jsxs("div",{ref:ot,className:"h-full overflow-y-auto hide-scrollbar",children:[!C&&t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-[#1a1d24] to-[#121417] z-10 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-16 h-16 bg-white/10 rounded-full mx-auto mb-4"}),t.jsx("div",{className:"h-4 bg-white/10 rounded w-32 mx-auto mb-2"}),t.jsx("div",{className:"h-3 bg-white/5 rounded w-24 mx-auto"})]})}),t.jsxs("div",{className:"relative h-[75vh] sm:h-[80vh]",children:[t.jsx("div",{className:"hidden md:block absolute top-4 left-4 z-20",children:t.jsxs("button",{onClick:async()=>{try{vt(!0);const e=await zs(te,St);if(e){const t=URL.createObjectURL(e);await new Promise(((e,s)=>{const a=new Image;a.onload=e,a.onerror=s,a.src=t})),bt(t),setTimeout((()=>Ct(!0)),150),wt(!0)}}catch(e){}finally{vt(!1)}},className:"group relative p-2 rounded-full overflow-hidden bg-[rgb(255,255,255,0.03)] backdrop-blur-[0.5px] border-l-[1px] border-r-[1px] border-white/30 text-white/80 hover:bg-white/10 transition-all duration-300 hover:scale-105 active:scale-95 flex items-center justify-center transform-gpu will-change-transform shadow-sm shadow-black/20 hover:shadow-black/30",title:"Share","aria-label":"Share",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),t.jsx("div",{className:"relative",children:mt?t.jsx("div",{className:"animate-spin",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:t.jsx("path",{d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}):t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 transition-all duration-300 group-hover:scale-110",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M12 3v12"}),t.jsx("path",{d:"M8 7l4-4 4 4"}),t.jsx("path",{d:"M5 12v5a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-5"})]})})]})}),te.backdrop&&t.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[t.jsxs(Q.div,{className:"absolute inset-0",variants:os,initial:"hidden",animate:"visible",children:[t.jsx(Q.div,{className:"absolute inset-0 bg-gradient-to-br from-[#1a1a1a] to-[#2a2a2a]",initial:{opacity:1},animate:{opacity:0},transition:{duration:.3,delay:.2}}),t.jsx(Q.img,{src:te.backdrop,alt:te.title,className:"w-full h-full object-cover",loading:"eager",decoding:"async",fetchpriority:"high","data-movie-details":"true",variants:ss,initial:"initial",animate:"loaded",onError:e=>{e.target&&(e.target.src="",e.target.srcset="")}})]}),t.jsx(Q.div,{className:"absolute inset-0 bg-gradient-to-t from-[#0f0f0f] via-[#0f0f0f]/80 to-transparent pointer-events-none",variants:os,initial:"hidden",animate:"visible"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4 sm:p-8",children:t.jsxs(Q.div,{className:"flex flex-col sm:flex-row items-start sm:items-end gap-4 sm:gap-8 relative",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1},children:[te.image&&t.jsxs(Q.div,{className:"w-32 h-48 sm:w-56 sm:h-84 flex-shrink-0 rounded-lg overflow-hidden shadow-2xl group mx-auto sm:mx-0",variants:is,initial:"initial",whileHover:"hover",whileTap:"tap",children:[t.jsx(Q.div,{className:"absolute inset-0 bg-gradient-to-br from-[#1a1a1a] to-[#2a2a2a]",initial:{opacity:1},animate:{opacity:0},transition:{duration:.3,delay:.2}}),t.jsx(Q.img,{src:te.image,alt:te.title,className:"w-full h-full object-cover",loading:"eager",decoding:"async",fetchpriority:"high","data-movie-details":"true",variants:ss,initial:"initial",animate:"loaded",onError:e=>{e.target&&(e.target.src="",e.target.srcset="")}}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-200"})]}),t.jsxs("div",{className:"flex-1 w-full sm:w-auto text-center sm:text-left",children:[t.jsx(Q.div,{className:"flex flex-col sm:flex-row items-center sm:items-center gap-2 sm:gap-3 mb-4 sm:mb-7",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.3},children:te.logo?t.jsxs(Q.div,{className:"relative",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3,delay:.4},children:[t.jsx(Q.img,{src:te.logo,alt:te.title,className:"w-[200px] sm:w-[250px] max-w-full h-auto object-contain",loading:"eager",decoding:"async",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},onError:e=>{e.target&&(e.target.style.display="none",e.target.nextSibling&&(e.target.nextSibling.style.display="block"))}}),t.jsx("h2",{className:"text-2xl sm:text-4xl font-bold text-white hidden",children:te.title})]}):t.jsx(Q.h2,{className:"text-2xl sm:text-4xl font-bold text-white",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.4},children:te.title})}),t.jsxs("div",{className:"flex flex-row items-center justify-center sm:justify-start gap-6 sm:gap-3 text-white/60 text-sm mb-4 sm:mb-6 lg:mb-0",children:["movie"===te.type&&te.release_date&&t.jsx(t.Fragment,{children:t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),t.jsx("span",{children:new Date(te.release_date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})}),t.jsx("span",{className:"hidden sm:inline",children:"•"}),"movie"===te.type&&t.jsx(t.Fragment,{children:t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{children:"movie"===te.type?te.runtime?Ja(te.runtime):"N/A":te.number_of_seasons?`${te.number_of_seasons} Season${1!==te.number_of_seasons?"s":""}`:"N/A"})]})}),"tv"===te.type&&t.jsxs(t.Fragment,{children:[te.first_air_date&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),t.jsx("span",{children:new Date(te.first_air_date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),t.jsx("span",{className:"hidden sm:inline",children:"•"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),t.jsx("span",{children:te.number_of_seasons?`${te.number_of_seasons} Season${1!==te.number_of_seasons?"s":""}`:"N/A"})]}),t.jsx("span",{className:"hidden sm:inline",children:"•"}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{className:"capitalize",children:te.status})]})]}),t.jsx("span",{className:"hidden sm:inline",children:"•"}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-yellow-400",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})}),(e=>{if("number"==typeof e)return e.toFixed(1);if("string"==typeof e){const t=parseFloat(e);return isNaN(t)?"N/A":t.toFixed(1)}return"N/A"})(te.rating)]})]}),te.genres&&t.jsx("div",{className:"flex flex-wrap justify-center sm:justify-start gap-1.5 sm:gap-2 lg:hidden mb-5",children:te.genres.map(((e,s)=>{let a="";return a=e.id&&void 0!==e.id&&null!==e.id&&""!==e.id?`genre-${e.id+""}-${s}`:e.name&&"string"==typeof e.name&&""!==e.name.trim()?`genre-name-${e.name.replace(/\s+/g,"_")}-${s}`:"genre-fallback-"+s,t.jsx("span",{onClick:()=>u&&u(e),className:"px-2.5 sm:px-3 py-0.5 sm:py-1 text-white/50 overflow-hidden bg-[rgb(255,255,255,0.03)] backdrop-blur-[0.5px] border-t-[1px] border-b-[1px] border-white/30 rounded-full text-white/60 text-xs sm:text-sm transform transition-all duration-300 hover:bg-white/10 hover:cursor-pointer will-change-transform",children:e.name},a)}))}),t.jsxs(Q.div,{className:"flex flex-col sm:flex-row items-center sm:items-end justify-between gap-4 mb-4 sm:mb-6 mt-0",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:window.innerWidth>1024?.15:.3,delay:window.innerWidth>1024?.2:.5},children:[t.jsxs(Q.div,{className:"flex flex-row items-center justify-center sm:justify-start gap-3 sm:gap-4 w-full mt-5 sm:mt-0",variants:window.innerWidth>1024?Qt:Kt,initial:"hidden",animate:"visible",children:["movie"===(a.media_type||a.type||"movie")&&t.jsx(Q.button,{onClick:_a,className:"group relative px-4 sm:px-6 py-2 sm:py-3 rounded-full flex items-center gap-2 text-base sm:text-base font-medium text-black bg-white flex-1 sm:flex-none w-full sm:w-auto justify-center min-w-0 transform-gpu will-change-transform",variants:window.innerWidth>1024?void 0:es,initial:"initial",whileHover:window.innerWidth>1024?void 0:"hover",whileTap:window.innerWidth>1024?void 0:"tap",children:t.jsxs("div",{className:"relative flex items-center gap-2 min-w-0",children:[t.jsx(Q.svg,{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 flex-shrink-0 text-black",viewBox:"0 0 24 24",fill:"currentColor",whileHover:{scale:1.1},transition:{type:"spring",stiffness:400,damping:25},children:t.jsx("path",{d:"M8 5v14l11-7z"})}),t.jsx("span",{className:"truncate whitespace-nowrap",children:va?"Resume":"Watch Now"})]})}),!De(a)&&"movie"===(a.media_type||a.type||"movie")&&t.jsx(Q.button,{onClick:_a,className:"group relative px-4 sm:px-6 py-2 sm:py-3 rounded-full flex items-center gap-2 text-base sm:text-base font-medium text-black bg-white flex-1 sm:flex-none w-full sm:w-auto justify-center min-w-0 transform-gpu will-change-transform sm:hidden",variants:es,initial:"initial",whileHover:"hover",whileTap:"tap",children:t.jsxs("div",{className:"relative flex items-center gap-2 min-w-0",children:[t.jsx(Q.svg,{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 flex-shrink-0 text-black",viewBox:"0 0 24 24",fill:"currentColor",whileHover:{scale:1.1},transition:{type:"spring",stiffness:400,damping:25},children:t.jsx("path",{d:"M8 5v14l11-7z"})}),t.jsx("span",{className:"truncate whitespace-nowrap",children:va?"Resume":"Watch Now"})]})}),t.jsxs(Q.button,{"data-trailer-button":!0,onClick:Ca,className:"group relative px-4 sm:px-6 py-2 sm:py-3 rounded-full flex items-center gap-2 text-base sm:text-base font-medium text-white/80 overflow-hidden bg-[rgb(255,255,255,0.03)] backdrop-blur-[0.5px] border-t-[1px] border-b-[1px] border-white/30 hover:bg-white/10 flex-1 sm:flex-none w-full sm:w-auto justify-center min-w-0 transform-gpu will-change-transform transition-all duration-300 hover:scale-105 active:scale-95 shadow-sm shadow-black/20",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),t.jsxs("div",{className:"relative flex items-center gap-2 min-w-0",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 flex-shrink-0 transition-all duration-300 group-hover:scale-110",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M8 5v14l11-7z"})}),t.jsx("span",{className:"truncate whitespace-nowrap",children:"Watch Trailer"})]})]}),t.jsxs(Q.button,{onClick:qa,className:"group relative px-4 sm:px-6 py-3 rounded-full flex items-center gap-2 text-base sm:text-base font-medium overflow-hidden w-full sm:w-auto justify-center min-w-0 hidden sm:flex transform-gpu will-change-transform transition-all duration-300 hover:scale-105 active:scale-95 shadow-sm shadow-black/20 hover:shadow-black/30 text-white/80 overflow-hidden bg-[rgb(255,255,255,0.03)] backdrop-blur-[0.5px] border-t-[1px] border-b-[1px] border-white/30 hover:bg-white/10",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),t.jsxs("div",{className:"relative flex items-center gap-2 min-w-0",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 flex-shrink-0 transition-all duration-300 group-hover:scale-110",viewBox:"0 0 24 24",fill:"currentColor",children:Ya?t.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"}):t.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),t.jsx("span",{className:"truncate whitespace-nowrap",children:Ya?"Remove from List":"Add to List"})]})]})]}),t.jsx(Q.div,{className:"hidden lg:block text-white/60 text-sm text-right",variants:window.innerWidth>1024?Qt:Kt,initial:"hidden",animate:"visible",children:te.cast&&te.cast.length>0&&t.jsx("div",{className:"mb-2",children:t.jsxs("div",{children:[te.genres&&t.jsx("div",{className:"hidden lg:flex flex-wrap justify-end gap-2 mb-3",children:te.genres.map(((e,s)=>t.jsx("button",{onClick:()=>u&&u(e),className:"px-2.5 py-0.5 text-white/50 bg-[rgb(255,255,255,0.03)] border-t-[1px] border-b-[1px] border-white/30 rounded-full text-xs hover:bg-white/10",children:e.name},"cast-genre-"+s)))}),te.cast.length>8?t.jsx("div",{className:"w-64 inline-block text-left",children:t.jsx($s,{items:te.cast,onClick:Ea,itemHeight:36})}):t.jsx("div",{className:"flex items-start gap-6 overflow-x-auto whitespace-nowrap py-1",style:{WebkitOverflowScrolling:"touch"},children:te.cast.map(((e,s)=>{const a=e.image||(e.profile_path?Pt(e.profile_path,"w154"):null),r=Math.min(.03*s,.6),i=e.id||s;return t.jsx(Q.button,{ref:e=>{e&&(M.current[i]=e)},type:"button",onClick:()=>Ea(e),onMouseEnter:t=>z(t,e),onMouseLeave:()=>W(),onFocus:t=>z(t,e),onBlur:()=>W(),initial:{opacity:0,y:6,scale:.98},animate:{opacity:1,y:0,scale:1},transition:{duration:.28,ease:[.2,.8,.2,1],delay:r},className:"inline-flex flex-col items-center hover:text-white hover:cursor-pointer transition-colors duration-200 text-center w-12 flex-shrink-0","aria-haspopup":"true","aria-expanded":E.visible&&E.person&&E.person.id===e.id,"aria-controls":"cast-tooltip-"+i,children:a?t.jsx("img",{src:a,alt:e.name,className:"w-12 h-12 rounded-full object-cover flex-shrink-0",loading:"lazy",width:48,height:48}):t.jsx("div",{className:"w-12 h-12 rounded-full bg-white/5 flex items-center justify-center text-white/30 flex-shrink-0",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})})})},i)}))})]})})})]}),te.overview&&""!==te.overview.trim()&&t.jsx("div",{className:"hidden lg:block mt-6",children:t.jsx("div",{className:"text-white/80 text-sm leading-relaxed",children:t.jsx("p",{className:"text-white/90 leading-relaxed",children:te.overview})})}),t.jsx(Q.div,{className:"lg:hidden mt-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:t.jsxs(Q.div,{className:"text-white/60 text-sm space-y-3",variants:Xt,initial:"hidden",animate:"visible",children:[te.overview&&""!==te.overview.trim()&&t.jsx(Q.div,{className:"mb-3",variants:Kt,children:t.jsx("p",{className:"text-white/90 text-sm leading-relaxed pl-0 text-justify text-left",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textAlign:"justify"},children:te.overview})}),te.cast&&te.cast.length>0&&t.jsxs("div",{className:"mb-2",children:[t.jsxs("span",{className:"flex items-center justify-between",children:[t.jsxs("span",{className:"flex-1 min-w-0 truncate",children:[t.jsx("span",{className:"font-medium",children:"Cast: "}),te.cast.slice(0,3).map(((e,s)=>t.jsxs("span",{onClick:()=>Ea(e),className:"hover:text-white hover:cursor-pointer transition-colors duration-200",children:[e.name,s<Math.min(2,te.cast.length-1)?", ":""]},e.id||s))),te.cast.length>3&&"..."]}),t.jsx("button",{onClick:ga,className:"ml-2 p-1 hover:bg-white/10 rounded transition-colors duration-200 flex-shrink-0",title:st?"Show less":"Show all cast",children:t.jsx("svg",{className:"w-4 h-4 text-white/60 transition-transform duration-200 "+(st?"rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),st&&te.cast.length>3&&t.jsx(Q.div,{className:"mt-1",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},children:t.jsx("span",{className:"block items-start text-left",children:te.cast.slice(3).map(((e,s)=>t.jsxs("span",{onClick:()=>Ea(e),className:"hover:text-white hover:cursor-pointer transition-colors duration-200",children:[e.name,s<te.cast.slice(3).length-1?", ":""]},e.id||s)))})})]})]})}),t.jsxs(Q.div,{className:"flex sm:hidden items-center justify-center gap-8 mt-4",variants:Xt,initial:"hidden",animate:"visible",children:[t.jsxs("button",{onClick:qa,className:"group relative w-12 h-12 rounded-full transition-all duration-300 hover:scale-105 active:scale-95 overflow-hidden flex items-center justify-center transform-gpu will-change-transform shadow-sm shadow-black/20 hover:shadow-black/30 "+(Ya?"bg-red-500/20 border-t-[1px] border-b-[1px] border-red-400/30 text-red-400":"bg-[rgb(255,255,255,0.03)] backdrop-blur-[0.5px] border-t-[1px] border-b-[1px] border-white/30 text-white/80 hover:bg-white/10"),title:Ya?"Remove from List":"Add to List",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),t.jsx("div",{className:"relative",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 transition-all duration-300 group-hover:scale-110",viewBox:"0 0 24 24",fill:"currentColor",children:Ya?t.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"}):t.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})})})]}),t.jsxs("button",{onClick:Ga,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),Ga(e))},className:`group relative w-12 h-12 rounded-full overflow-hidden backdrop-blur-[0.5px] border-t-[1px] border-b-[1px] transition-all duration-300 hover:scale-105 active:scale-95 flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-red-400/50 focus:ring-offset-2 focus:ring-offset-black/50 transform-gpu will-change-transform shadow-sm shadow-black/20 hover:shadow-black/30 ${Oa?"bg-red-500/20 border-red-400/30 text-red-400":"bg-[rgb(255,255,255,0.03)] border-white/30 text-white/80 hover:bg-white/10"} ${Fa?"animate-pulse":""}`,title:Oa?"Unlike":"Like","aria-label":Oa?"Unlike this movie":"Like this movie",role:"button",tabIndex:0,children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),Fa&&t.jsx(Q.div,{initial:{scale:0,opacity:0},animate:{scale:1.5,opacity:1},exit:{scale:2,opacity:0},transition:{duration:.6,ease:"easeOut"},className:"absolute inset-0 bg-red-500/20 rounded-full"}),Fa&&t.jsx(Q.div,{initial:{scale:0,opacity:.8},animate:{scale:2,opacity:0},transition:{duration:.8,ease:"easeOut"},className:"absolute inset-0 bg-red-400/30 rounded-full"}),t.jsx("div",{className:"relative",children:t.jsx(Q.svg,{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 transition-all duration-300 group-hover:scale-110",fill:Oa?"currentColor":"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,animate:Fa?{scale:[1,1.3,1],rotate:[0,-10,10,0]}:{},transition:{duration:.6,ease:"easeOut"},children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2 21h4V9H2v12zM22.42 10.21c-.36-.36-.86-.58-1.41-.58h-6.72l.95-4.57.02-.32c0-.41-.17-.8-.44-1.09L13.17 2 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.78 0 1.48-.45 1.82-1.13l2.01-4.03c.09-.18.17-.37.17-.57v-4.06c0-.55-.22-1.05-.58-1.41z"})})})]}),t.jsx(Z,{mode:"wait",children:$a&&t.jsx(Q.div,{initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},transition:{duration:.3,ease:"easeOut"},className:"absolute -top-20 left-2/5 transform -translate-x-1/2 bg-black/40 backdrop-blur-md text-white text-sm px-4 py-2 rounded-full border border-white/5 shadow-lg z-50 whitespace-nowrap",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-red-400",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}),t.jsx("span",{children:$a})]})},"like-feedback")}),t.jsx(Z,{mode:"wait",children:Va&&t.jsx(Q.div,{initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},transition:{duration:.3,ease:"easeOut"},className:"absolute -top-20 left-2/5 transform -translate-x-1/2 bg-black/40 backdrop-blur-md text-white text-sm px-4 py-2 rounded-full border border-white/5 shadow-lg z-50 whitespace-nowrap",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-green-400",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"})}),t.jsx("span",{children:Va})]})},"watchlist-feedback")}),t.jsxs("button",{onClick:async()=>{try{vt(!0);const e=await zs(te,St);if(e){const t=URL.createObjectURL(e);await new Promise(((e,s)=>{const a=new Image;a.onload=e,a.onerror=s,a.src=t})),bt(t),setTimeout((()=>Ct(!0)),150),wt(!0)}}catch(e){}finally{vt(!1)}},className:"group relative w-12 h-12 rounded-full overflow-hidden bg-[rgb(255,255,255,0.03)] backdrop-blur-[0.5px] border-t-[1px] border-b-[1px] border-white/30 text-white/80 hover:bg-white/10 transition-all duration-300 hover:scale-105 active:scale-95 flex items-center justify-center transform-gpu will-change-transform",title:"Share",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),t.jsx("div",{className:"relative",children:mt?t.jsx("div",{className:"animate-spin",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}):t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 transition-all duration-300 group-hover:scale-110",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"})})})]}),t.jsxs("button",{onClick:()=>{},className:"group relative w-12 h-12 rounded-full overflow-hidden bg-[rgb(255,255,255,0.03)] backdrop-blur-[0.5px] border-t-[1px] border-b-[1px] border-white/30 text-white/80 hover:bg-white/10 transition-all duration-300 hover:scale-105 active:scale-95 flex items-center justify-center transform-gpu will-change-transform shadow-sm shadow-black/20 hover:shadow-black/30",title:"Report",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),t.jsx("div",{className:"relative",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 transition-all duration-300 group-hover:scale-110",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})})]})]})]})]})})]}),t.jsx(Z,{children:ut&&ft&&t.jsx(Q.div,{className:"fixed inset-0 z-[1000000001] flex items-end md:items-center justify-center bg-black/60",onClick:()=>{wt(!1),Ct(!1)},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:[.16,1,.3,1]},children:t.jsxs(Q.div,{className:"w-full md:w-auto bg-[#121417] border border-white/10 rounded-t-2xl md:rounded-2xl p-4 md:p-6 origin-bottom md:origin-center transform-gpu",onClick:e=>e.stopPropagation(),initial:{y:cs?100:12,opacity:0,scale:1,width:cs?"100%":520},animate:{y:0,opacity:1,scale:1,width:cs?"100%":xt?1020:520},exit:{y:cs?100:14,opacity:0,scale:1,width:cs?"100%":520},transition:{type:"spring",stiffness:cs?300:360,damping:cs?34:32,mass:.85},style:{maxHeight:cs?"80vh":void 0,overflowY:cs?"auto":void 0},children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("h3",{className:"text-lg font-semibold",children:"Share"})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:zt,className:"p-2 rounded-full hover:bg-white/20 text-white transition-colors group",title:xt?"Done":"Edit","aria-label":xt?"Done":"Edit",children:xt?t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-white/80 group-hover:text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):t.jsx(o,{className:"h-5 w-5 text-white/80 group-hover:text-white"})}),t.jsx("button",{className:"p-2 rounded-full hover:bg-white/10",onClick:()=>{wt(!1),Ct(!1)},"aria-label":"Close share",title:"Close",children:t.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]})]}),t.jsxs(Q.div,{className:"mb-4 grid gap-3",animate:{gridTemplateColumns:cs?"1fr":xt?"minmax(0,1fr) 420px":"1fr"},transition:{duration:.25,ease:[.22,1,.36,1]},style:{display:"grid"},children:[t.jsxs(Q.div,{className:"rounded-xl overflow-hidden border border-white/10 bg-white/[0.03] flex items-center justify-center aspect-[3/4] relative",animate:{x:pt?-6:0},transition:{type:"spring",stiffness:380,damping:34},children:[mt&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:t.jsx("div",{className:"text-white/80 text-sm md:text-base",children:"Generating preview..."})}),t.jsx(Z,{mode:"wait",children:!mt&&ht&&t.jsx(Q.img,{src:ht,alt:"Share preview",className:"w-full h-full object-contain",width:Lt.width,height:Lt.height,loading:"lazy",decoding:"async",onLoad:()=>{Ct(!0)},onError:e=>{Ct(!1)},initial:{opacity:0,y:6,scale:1,filter:"none"},animate:{opacity:1,y:0,scale:1,filter:"none"},exit:{opacity:0,y:4,scale:1,filter:"none"},transition:{duration:cs?.2:.22,ease:[.22,1,.36,1]}},ht||"share-preview")})]}),t.jsx(Z,{children:gt&&t.jsxs(Q.div,{className:"rounded-xl border border-white/10 bg-white/[0.03] p-4 md:p-5 text-white/80 max-h-[70vh] overflow-y-auto share-editor-scroll",initial:{opacity:0,x:12},animate:{opacity:1,x:0},exit:{opacity:0,x:12},transition:{duration:.2},children:[t.jsx("div",{className:"mb-6",children:t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("h4",{className:"text-sm font-medium text-white/80",children:"Quick Presets"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{className:"px-3 py-1.5 text-xs rounded-lg bg-white/5 hover:bg-white/10 border border-white/10 transition-colors",onClick:()=>_t((e=>({...e,layout:"portrait",theme:"dark",backgroundMode:"image",imageSource:"auto",textColor:"#FFFFFF",titleSize:72,overviewLines:2,showRating:!0,titleAlign:"center",metaAlign:"center",spacingScale:1,showGenres:!0,maxGenres:5}))),children:"Default"}),t.jsx("button",{className:"px-3 py-1.5 text-xs rounded-lg bg-white/5 hover:bg-white/10 border border-white/10 transition-colors",onClick:()=>_t((e=>({...e,layout:"portrait",theme:"noir",backgroundMode:"solid",solidColorStart:"#0b0b0c",solidColorEnd:"#0b0b0c",imageSource:"poster",textColor:"#FFFFFF",titleSize:80,overviewLines:1,spacingScale:.9,titleAlign:"left",metaAlign:"left",showGenres:!1}))),children:"Poster Focus"}),t.jsx("button",{className:"px-3 py-1.5 text-xs rounded-lg bg-white/5 hover:bg-white/10 border border-white/10 transition-colors",onClick:()=>_t((e=>({...e,layout:"portrait",theme:"light",backgroundMode:"gradient",solidColorStart:"#f7f9fc",solidColorEnd:"#e9edf5",imageSource:"backdrop",textColor:"#111111",titleSize:68,overviewLines:2,spacingScale:1.1,titleAlign:"center",metaAlign:"center",showGenres:!0}))),children:"Backdrop Light"}),t.jsx("button",{className:"px-3 py-1.5 text-xs rounded-lg bg-white/5 hover:bg-white/10 border border-white/10 transition-colors",onClick:()=>_t((e=>({...e,layout:"landscape",theme:"dark",backgroundMode:"image",imageSource:"backdrop",textColor:"#FFFFFF",titleSize:60,overviewLines:3,spacingScale:.9,titleAlign:"left",metaAlign:"left",showGenres:!0,maxGenres:4}))),children:"Landscape"})]})]})}),t.jsxs("div",{className:"space-y-4 mb-6",children:[t.jsx("h4",{className:"text-sm font-medium text-white/80 border-b border-white/10 pb-2",children:"Layout & Theme"}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-white/60 mb-2",children:"Theme"}),t.jsxs("select",{value:St.theme,onChange:e=>_t((t=>({...t,theme:e.target.value}))),className:"w-full bg-black/40 text-white/90 text-xs px-3 py-2 rounded-lg border border-white/10 focus:border-white/20 focus:outline-none transition-colors",children:[t.jsx("option",{value:"dark",children:"Dark"}),t.jsx("option",{value:"noir",children:"Noir"}),t.jsx("option",{value:"twilight",children:"Twilight"}),t.jsx("option",{value:"midnight",children:"Midnight"}),t.jsx("option",{value:"light",children:"Light"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-white/60 mb-2",children:"Image Source"}),t.jsxs("select",{value:St.imageSource,onChange:e=>_t((t=>({...t,imageSource:e.target.value}))),className:"w-full bg-black/40 text-white/90 text-xs px-3 py-2 rounded-lg border border-white/10 focus:border-white/20 focus:outline-none transition-colors",children:[t.jsx("option",{value:"auto",children:"Auto"}),t.jsx("option",{value:"poster",children:"Poster"}),t.jsx("option",{value:"backdrop",children:"Backdrop"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-white/60 mb-2",children:"Background"}),t.jsxs("select",{value:St.backgroundMode,onChange:e=>_t((t=>({...t,backgroundMode:e.target.value}))),className:"w-full bg-black/40 text-white/90 text-xs px-2 rounded-lg border border-white/10 focus:border-white/20 focus:outline-none transition-colors",children:[t.jsx("option",{value:"gradient",children:"Gradient"}),t.jsx("option",{value:"solid",children:"Solid"}),t.jsx("option",{value:"image",children:"Image"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-white/60 mb-2",children:"Layout"}),t.jsxs("select",{value:St.layout,onChange:e=>_t((t=>({...t,layout:e.target.value}))),className:"w-full bg-black/40 text-white/90 text-xs px-3 py-2 rounded-lg border border-white/10 focus:border-white/20 focus:outline-none transition-colors",children:[t.jsx("option",{value:"portrait",children:"Portrait"}),t.jsx("option",{value:"landscape",children:"Landscape"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-white/60 mb-2",children:"Title Align"}),t.jsxs("select",{value:St.titleAlign,onChange:e=>_t((t=>({...t,titleAlign:e.target.value}))),className:"w-full bg-black/40 text-white/90 text-xs px-3 py-2 rounded-lg border border-white/10 focus:border-white/20 focus:outline-none transition-colors",children:[t.jsx("option",{value:"center",children:"Center"}),t.jsx("option",{value:"left",children:"Left"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-white/60 mb-2",children:"Meta Align"}),t.jsxs("select",{value:St.metaAlign,onChange:e=>_t((t=>({...t,metaAlign:e.target.value}))),className:"w-full bg-black/40 text-white/90 text-xs px-3 py-2 rounded-lg border border-white/10 focus:border-white/20 focus:outline-none transition-colors",children:[t.jsx("option",{value:"center",children:"Center"}),t.jsx("option",{value:"left",children:"Left"})]})]})]})]}),t.jsxs("div",{className:"space-y-4 mb-6",children:[t.jsx("h4",{className:"text-sm font-medium text-white/80 border-b border-white/10 pb-2",children:"Background Colors"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-white/60 mb-2",children:"Mode"}),t.jsxs("select",{value:St.backgroundMode,onChange:e=>_t((t=>({...t,backgroundMode:e.target.value}))),className:"w-full bg-black/40 text-white/90 text-xs px-3 py-2 rounded-lg border border-white/10 focus:border-white/20 focus:outline-none transition-colors",children:[t.jsx("option",{value:"gradient",children:"Gradient"}),t.jsx("option",{value:"solid",children:"Solid"}),t.jsx("option",{value:"image",children:"Image"})]})]}),"image"!==St.backgroundMode&&t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-white/60 mb-2",children:"Start Color"}),t.jsx("input",{type:"color",value:St.solidColorStart,onChange:e=>_t((t=>({...t,solidColorStart:e.target.value}))),className:"w-full h-10 rounded-lg border border-white/10 bg-transparent cursor-pointer"})]}),"gradient"===St.backgroundMode&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-white/60 mb-2",children:"End Color"}),t.jsx("input",{type:"color",value:St.solidColorEnd,onChange:e=>_t((t=>({...t,solidColorEnd:e.target.value}))),className:"w-full h-10 rounded-lg border border-white/10 bg-transparent cursor-pointer"})]})]})]}),t.jsxs("div",{className:"space-y-4 mb-6",children:[t.jsx("h4",{className:"text-sm font-medium text-white/80 border-b border-white/10 pb-2",children:"Typography"}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex items-center justify-between text-xs text-white/60 mb-2",children:[t.jsx("span",{children:"Title Size"}),t.jsxs("span",{className:"text-white/50 font-mono",children:[St.titleSize,"px"]})]}),t.jsx("input",{type:"range",min:"48",max:"96",step:"2",value:St.titleSize,onChange:e=>_t((t=>({...t,titleSize:+e.target.value}))),className:"w-full h-2 bg-white/10 rounded-lg appearance-none cursor-pointer slider"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-white/60 mb-2",children:"Text Color"}),t.jsx("input",{type:"color",value:St.textColor,onChange:e=>_t((t=>({...t,textColor:e.target.value}))),className:"w-full h-10 rounded-lg border border-white/10 bg-transparent cursor-pointer"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex items-center justify-between text-xs text-white/60 mb-2",children:[t.jsx("span",{children:"Overview Lines"}),t.jsx("span",{className:"text-white/50 font-mono",children:St.overviewLines})]}),t.jsx("input",{type:"range",min:"1",max:"4",step:"1",value:St.overviewLines,onChange:e=>_t((t=>({...t,overviewLines:+e.target.value}))),className:"w-full h-2 bg-white/10 rounded-lg appearance-none cursor-pointer slider"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex items-center justify-between text-xs text-white/60 mb-2",children:[t.jsx("span",{children:"Spacing Scale"}),t.jsxs("span",{className:"text-white/50 font-mono",children:[St.spacingScale.toFixed(2),"x"]})]}),t.jsx("input",{type:"range",min:"0.8",max:"1.4",step:"0.05",value:St.spacingScale,onChange:e=>_t((t=>({...t,spacingScale:+e.target.value}))),className:"w-full h-2 bg-white/10 rounded-lg appearance-none cursor-pointer slider"})]})]}),t.jsxs("div",{className:"space-y-4 mb-6",children:[t.jsx("h4",{className:"text-sm font-medium text-white/80 border-b border-white/10 pb-2",children:"Content Options"}),t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs("label",{className:"flex items-center justify-between text-xs text-white/60",children:[t.jsx("span",{children:"Show Year"}),t.jsx("input",{type:"checkbox",checked:St.showYear,onChange:e=>_t((t=>({...t,showYear:e.target.checked}))),className:"w-4 h-4 text-white bg-black/40 border-white/10 rounded focus:ring-white/20"})]}),t.jsxs("label",{className:"flex items-center justify-between text-xs text-white/60",children:[t.jsx("span",{children:"Show Runtime"}),t.jsx("input",{type:"checkbox",checked:St.showRuntime,onChange:e=>_t((t=>({...t,showRuntime:e.target.checked}))),className:"w-4 h-4 text-white bg-black/40 border-white/10 rounded focus:ring-white/20"})]}),t.jsxs("label",{className:"flex items-center justify-between text-xs text-white/60",children:[t.jsx("span",{children:"Show Rating"}),t.jsx("input",{type:"checkbox",checked:St.showRating,onChange:e=>_t((t=>({...t,showRating:e.target.checked}))),className:"w-4 h-4 text-white bg-black/40 border-white/10 rounded focus:ring-white/20"})]}),t.jsxs("label",{className:"flex items-center justify-between text-xs text-white/60",children:[t.jsx("span",{children:"Show Genres"}),t.jsx("input",{type:"checkbox",checked:St.showGenres,onChange:e=>_t((t=>({...t,showGenres:e.target.checked}))),className:"w-4 h-4 text-white bg-black/40 border-white/10 rounded focus:ring-white/20"})]})]}),St.showGenres&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-white/60 mb-2",children:"Max Genres"}),t.jsx("input",{type:"number",min:"0",max:"8",value:St.maxGenres,onChange:e=>_t((t=>({...t,maxGenres:Math.max(0,Math.min(8,+e.target.value))}))),className:"w-full bg-black/40 text-white/90 text-xs px-3 py-2 rounded-lg border border-white/10 focus:border-white/20 focus:outline-none transition-colors"})]})]}),t.jsxs("div",{className:"space-y-4 mb-6",children:[t.jsx("h4",{className:"text-sm font-medium text-white/80 border-b border-white/10 pb-2",children:"Visual Effects"}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex items-center justify-between text-xs text-white/60 mb-2",children:[t.jsx("span",{children:"Poster Frame Opacity"}),t.jsxs("span",{className:"text-white/50 font-mono",children:[(100*St.posterFrameOpacity).toFixed(0),"%"]})]}),t.jsx("input",{type:"range",min:"0",max:"0.2",step:"0.01",value:St.posterFrameOpacity,onChange:e=>_t((t=>({...t,posterFrameOpacity:+e.target.value}))),className:"w-full h-2 bg-white/10 rounded-lg appearance-none cursor-pointer slider"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex items-center justify-between text-xs text-white/60 mb-2",children:[t.jsx("span",{children:"Background Image Opacity"}),t.jsxs("span",{className:"text-white/50 font-mono",children:[(100*St.backgroundImageOpacity).toFixed(0),"%"]})]}),t.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:St.backgroundImageOpacity,onChange:e=>_t((t=>({...t,backgroundImageOpacity:+e.target.value}))),className:"w-full h-2 bg-white/10 rounded-lg appearance-none cursor-pointer slider"})]})]}),t.jsxs("div",{className:"flex gap-3 pt-2",children:[t.jsx("button",{className:"flex-1 px-4 py-2.5 rounded-lg bg-white text-black text-sm font-medium hover:bg-white/90 transition-colors",onClick:async()=>{try{vt(!0);const e=await Rs(te,St);if(vt(!1),e){const t=URL.createObjectURL(e);bt(t)}}catch{}},children:"Apply Changes"}),t.jsx("button",{className:"px-4 py-2.5 rounded-lg bg-white/5 text-white/80 text-sm font-medium hover:bg-white/10 border border-white/10 transition-colors",onClick:()=>_t({theme:"dark",layout:"portrait",imageSource:"auto",backgroundMode:"image",solidColorStart:"#0f1114",solidColorEnd:"#1a1d24",textColor:"#FFFFFF",titleSize:72,overviewLines:2,showRating:!0,showYear:!0,showRuntime:!0,titleAlign:"center",metaAlign:"center",spacingScale:1,posterFrameOpacity:.07,posterFrameRadius:28,posterCornerRadius:24,posterShadowStrength:.25,backgroundImageOpacity:.45,showGenres:!0,maxGenres:5,showBranding:!0}),title:"Reset to defaults",children:"Reset"})]})]},"share-editor")})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[t.jsxs("button",{onClick:async()=>{try{if(ht){const e=document.createElement("a");e.href=ht,e.download=(te?.title||"movie").replace(/\s+/g,"_")+"_share.png",document.body.appendChild(e),e.click(),document.body.removeChild(e)}else{vt(!0);const e=await Rs(te,St);if(vt(!1),e){const t=URL.createObjectURL(e);bt(t)}}}catch{}},className:"px-3 py-2 rounded-lg bg-white text-black text-sm hover:bg-white/90 flex items-center justify-center group relative",title:"Download","aria-label":"Download",children:[t.jsx(l,{className:"h-5 w-5"}),t.jsx("span",{className:"pointer-events-none absolute -top-7 opacity-0 group-hover:opacity-100 transition-opacity text-[10px] bg-black/40 border border-white/15 px-2 py-0.5 rounded text-white/90",children:"Download"})]}),t.jsxs("button",{onClick:async()=>{try{const e=await Rs(te,St);if(e&&"undefined"!=typeof navigator){const t=new File([e],(te?.title||"movie").replace(/\s+/g,"_")+"_share.png",{type:"image/png"});if(navigator.canShare&&navigator.canShare({files:[t]}))return void(await navigator.share({files:[t],title:te?.title||"Share",text:`Check out ${te?.title||a?.title}!`}))}}catch{}const e=`${window.location.origin}/movies?id=${a?.id||te?.id}`;window.open("https://wa.me/?text="+encodeURIComponent(e),"_blank")},className:"px-3 py-2 rounded-lg bg-white/10 text-white text-sm hover:bg-white/20 flex items-center justify-center group relative",title:"Share","aria-label":"Share",children:[t.jsx(c,{className:"h-5 w-5 rotate-45"}),t.jsx("span",{className:"pointer-events-none absolute -top-7 opacity-0 group-hover:opacity-100 transition-opacity text-[10px] bg-black/40 border border-white/15 px-2 py-0.5 rounded text-white/90",children:"Share"})]}),t.jsxs("button",{onClick:()=>{const e=`${window.location.origin}/movies?id=${a?.id||te?.id}`;navigator.clipboard.writeText(e)},className:"px-3 py-2 rounded-lg bg-white/10 text-white text-sm hover:bg-white/20 flex items-center justify-center group relative",title:"Copy link","aria-label":"Copy link",children:[t.jsx(d,{className:"h-5 w-5"}),t.jsx("span",{className:"pointer-events-none absolute -top-7 opacity-0 group-hover:opacity-100 transition-opacity text-[10px] bg-black/40 border border-white/15 px-2 py-0.5 rounded text-white/90",children:"Copy"})]}),t.jsxs("button",{onClick:async()=>{try{const e=await Rs(te,St);if(e&&"undefined"!=typeof navigator){const t=new File([e],(te?.title||"movie").replace(/\s+/g,"_")+"_share.png",{type:"image/png"});if(navigator.canShare&&navigator.canShare({files:[t]}))return void(await navigator.share({files:[t],title:te?.title||"Share",text:`Check out ${te?.title||a?.title}!`}))}}catch{}const e=`${window.location.origin}/movies?id=${a?.id||te?.id}`;window.open("https://twitter.com/intent/tweet?text="+encodeURIComponent(`Check out ${te?.title||a?.title}! ${e}`),"_blank")},className:"px-3 py-2 rounded-lg bg-white/10 text-white text-sm hover:bg-white/20 flex items-center justify-center group relative",title:"Twitter","aria-label":"Twitter",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1200 1227",className:"h-4 w-4 fill-current",children:t.jsx("path",{d:"M714.163 519.284L1160.89 0H1022.79L667.137 410.552L357.328 0H0L468.492 632.736L0 1226.37H138.106L516.021 785.196L842.672 1226.37H1200L714.137 519.284H714.163ZM567.489 723.062L521.15 661.94L187.97 159.039H306.493L576.292 539.494L622.631 600.616L969.689 1070.64H851.166L567.489 723.088V723.062Z"})}),t.jsx("span",{className:"pointer-events-none absolute -top-7 opacity-0 group-hover:opacity-100 transition-opacity text-[10px] bg-black/40 border border-white/15 px-2 py-0.5 rounded text-white/90",children:"Twitter"})]})]})]},"share-panel")},"share-overlay")}),t.jsxs("div",{className:"relative p-4 sm:p-8 bg-gradient-to-br from-black/60 via-black/30 to-primary/10 shadow-lg overflow-hidden transition-all duration-300",children:[t.jsx("div",{"aria-hidden":"true",className:"absolute left-1/2 -translate-x-1/2 top-0 w-1/3 h-0.5 bg-gradient-to-r from-primary/60 via-white/20 to-transparent rounded-full opacity-60"}),t.jsx("div",{"aria-hidden":"true",className:"pointer-events-none absolute -top-8 -left-8 w-32 h-32 rounded-full bg-primary/20 blur-2xl opacity-30"}),t.jsx("div",{"aria-hidden":"true",className:"pointer-events-none absolute -bottom-8 -right-8 w-24 h-24 rounded-full bg-white/10 blur-2xl opacity-20"}),t.jsx("div",{className:"space-y-8 sm:space-y-12",children:t.jsx("div",{className:"w-full space-y-8 sm:space-y-12",children:"tv"===te.type&&t.jsxs(Q.div,{variants:ls,initial:"hidden",animate:"visible",className:"relative",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[t.jsxs("h3",{className:"text-lg sm:text-xl md:text-2xl font-bold text-white flex items-center gap-2",children:[t.jsx("span",{className:"inline-flex items-center justify-center w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 rounded-full bg-primary/10 shadow-md mr-1",children:t.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 md:w-7 md-7 text-primary/80",fill:"none",stroke:"currentColor",strokeWidth:2.2,viewBox:"0 0 24 24","aria-hidden":"true",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 002 2z"})})}),t.jsx("span",{className:"tracking-tight drop-shadow-sm",children:"Episodes"})]}),qs.length>0&&t.jsxs("div",{className:"flex items-center justify-between w-full sm:w-auto gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2 order-2 sm:order-2",children:[t.jsx("span",{className:"text-white/60 text-sm",children:"Season:"}),t.jsx(Es,{options:qs.map((e=>({value:e.season_number,label:e.name||"Season "+e.season_number}))),value:Js?.season_number||"",onChange:e=>{const t=qs.find((t=>t.season_number===e));t&&tr(t)},placeholder:"Select season"})]}),t.jsxs("div",{className:"flex items-center gap-2 order-1 sm:order-1",children:[t.jsxs("button",{onClick:()=>ma("card"),className:"relative px-4 py-2 text-sm font-medium transition-all duration-200 transform-gpu will-change-transform "+("card"===oa?"text-white":"text-white/50 hover:text-white/70"),title:"Card View",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),"card"===oa&&t.jsx(Q.div,{layoutId:"episodesViewToggleUnderline",className:"absolute left-0 right-0 bottom-0 h-0.5 bg-white/70"})]}),t.jsxs("button",{onClick:()=>ma("list"),className:"relative px-4 py-2 text-sm font-medium transition-all duration-200 "+("list"===oa?"text-white":"text-white/50 hover:text-white/70"),title:"List View",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),"list"===oa&&t.jsx(Q.div,{layoutId:"episodesViewToggleUnderline",className:"absolute left-0 right-0 bottom-0 h-0.5 bg-white/70"})]})]})]})]}),(()=>{const e=aa||ia,s=qs.length>0,r=Ks.length>0,i=s&&ia&&!aa;return e?"card"===oa?t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 2xl:grid-cols-4 gap-4 lg:gap-6",children:[...[,,,,,,,,]].map(((e,s)=>t.jsxs(Q.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3,delay:.05*s},className:"group relative bg-gradient-to-br from-white/[0.08] via-white/[0.04] to-white/[0.02] rounded-2xl overflow-hidden border border-white/[0.08] shadow-lg backdrop-blur-sm",children:[t.jsx("div",{className:"aspect-square sm:aspect-video lg:aspect-video bg-gradient-to-br from-gray-800 to-gray-700 rounded-t-2xl"}),t.jsxs("div",{className:"p-4 lg:p-5 space-y-3",children:[t.jsx("div",{className:"h-4 bg-white/10 rounded"}),t.jsx("div",{className:"h-3 bg-white/10 rounded w-2/3"}),t.jsx("div",{className:"h-3 bg-white/10 rounded w-1/2"}),t.jsx("div",{className:"pt-3 border-t border-white/[0.08]",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"h-3 bg-white/10 rounded w-16"}),t.jsx("div",{className:"h-3 bg-white/10 rounded w-12"})]})})]})]},s)))}):t.jsx("div",{className:"space-y-0",children:[...[,,,,,,]].map(((e,s)=>t.jsx(Q.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3,delay:.05*s},className:"group relative "+(5>s?"border-b border-white/[0.08]":""),children:t.jsxs("div",{className:"flex items-center gap-3 sm:gap-6 p-3 sm:p-6",children:[t.jsx("div",{className:"hidden md:flex flex-shrink-0 items-center justify-center w-10 h-10",children:t.jsx("div",{className:"w-6 h-6 bg-white/10 rounded"})}),t.jsx("div",{className:"relative w-32 h-20 sm:w-32 sm:h-20 md:w-40 md:h-24 overflow-hidden rounded-lg flex-shrink-0 bg-white/10"}),t.jsx("div",{className:"flex-1 min-w-0 flex flex-col justify-between",children:t.jsxs("div",{className:"space-y-3 sm:space-y-3",children:[t.jsxs("div",{className:"space-y-1 sm:space-y-2",children:[t.jsx("div",{className:"h-4 sm:h-5 bg-white/10 rounded",style:{width:40*Math.random()+60+"%"}}),t.jsxs("div",{className:"hidden sm:block space-y-1.5",children:[t.jsx("div",{className:"h-3 bg-white/8 rounded",style:{width:"100%"}}),t.jsx("div",{className:"h-3 bg-white/8 rounded",style:{width:20*Math.random()+80+"%"}})]})]}),t.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 text-xs sm:text-sm text-white/45",children:[t.jsxs("div",{className:"hidden sm:flex items-center gap-4",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-4 h-4 bg-white/10 rounded"}),t.jsx("div",{className:"w-16 h-3 bg-white/10 rounded"})]}),t.jsx("div",{className:"w-3 h-3 bg-white/30 rounded-full"}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-4 h-4 bg-white/10 rounded"}),t.jsx("div",{className:"w-12 h-3 bg-white/10 rounded"})]})]}),t.jsxs("div",{className:"sm:hidden flex items-center gap-1 text-xs",children:[t.jsx("div",{className:"w-8 h-3 bg-white/10 rounded "}),t.jsx("div",{className:"w-2 h-2 bg-white/30 rounded-full"}),t.jsx("div",{className:"w-12 h-3 bg-white/10 rounded"}),t.jsx("div",{className:"w-2 h-2 bg-white/30 rounded-full"}),t.jsx("div",{className:"w-10 h-3 bg-white/10 rounded"})]})]})]})})]})},s)))}):i?t.jsx(Q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center text-white/40 py-8",children:t.jsxs("div",{className:"bg-gradient-to-br from-white/5 to-white/2 rounded-2xl p-6 border border-white/10",children:[t.jsx("div",{className:"flex items-center justify-center mb-4",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}),t.jsx("h3",{className:"text-lg font-semibold text-white/60 mb-2",children:"Loading Episodes"}),t.jsx("p",{className:"text-white/40 text-sm",children:"Fetching episodes for this season..."})]})}):s&&r?t.jsx(Z,{mode:"wait",initial:!1,children:"card"===oa?t.jsxs(Q.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3,ease:[.4,0,.2,1]},style:{contain:"layout"},className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 2xl:grid-cols-4 gap-4 lg:gap-6 pb-6",children:[Ks.slice(0,Zs).map(((e,s)=>t.jsxs(Q.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.4,delay:.05*s,ease:[.25,.46,.45,.94]},whileHover:{transition:{duration:.3,ease:"easeOut"}},className:"group relative bg-gradient-to-br from-white/[0.04] to-white/[0.02] rounded-xl sm:rounded-2xl overflow-hidden cursor-pointer border border-white/[0.08] hover:border-white/[0.15] transition-all duration-300 hover:bg-gradient-to-br hover:from-white/[0.06] hover:to-white/[0.03] shadow-sm hover:shadow-lg",onClick:()=>sr(e),children:[t.jsxs("div",{className:"relative aspect-video overflow-hidden",children:[e.still_path?t.jsx("img",{src:ye(e.still_path,"w500"),alt:e.name,className:"w-full h-full object-cover transition-opacity duration-300",width:500,height:281,loading:"lazy",decoding:"async",sizes:"(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 33vw",fetchpriority:"low",onError:e=>{}}):t.jsx("div",{className:"w-full h-full bg-gradient-to-br from-gray-800/60 to-gray-700/60 flex items-center justify-center",children:t.jsx("svg",{className:"w-8 h-8 sm:w-10 sm:h-10 text-white/40",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 002 2z"})})}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),t.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center",children:t.jsx("div",{className:"bg-black/60 backdrop-blur-sm rounded-full p-3 sm:p-4 border border-white/20",children:t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M8 5v14l11-7z"})})})}),t.jsx("div",{className:"absolute top-2 sm:top-3 left-2 sm:left-3 bg-black/85 backdrop-blur-md text-white text-xs font-semibold px-2 sm:px-2.5 py-1 sm:py-1.5 rounded-md sm:rounded-lg border border-white/20",children:e.episode_number}),(()=>{const s=e.season_number||Js?.season_number,r=s?`tv_${a.id}_${s}_${e.episode_number}`:null,i=r&&U&&U[r]?.progress||0;return i&&i>0?t.jsx("div",{className:"absolute left-3 right-3 bottom-1",children:t.jsx("div",{className:"w-full bg-white/20 rounded-full h-1",children:t.jsx("div",{className:"h-1 rounded-full transition-all duration-300 "+(i>0?"bg-white":"bg-white/30"),style:{width:Math.max(i,1)+"%"}})})}):null})()]}),t.jsxs("div",{className:"p-3 sm:p-4 md:p-5 space-y-2 sm:space-y-3",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx("h4",{className:"text-white font-medium text-sm leading-tight line-clamp-2 group-hover:text-white/90 transition-colors duration-200 tracking-wide",children:e.name}),e.overview&&!cs&&t.jsx("p",{className:"text-white/65 text-xs leading-relaxed line-clamp-2 sm:line-clamp-2 group-hover:text-white/75 transition-colors duration-200 max-w-full overflow-hidden",children:e.overview})]}),t.jsx("div",{className:"pt-2 sm:pt-3 border-t border-white/8",children:t.jsxs("div",{className:"flex items-center gap-2 text-white/45 text-xs font-medium",children:[e.air_date&&t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 002 2z"})}),new Date(e.air_date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]}),e.air_date&&e.runtime&&t.jsx("span",{className:"inline-block w-2 text-center text-white/30 select-none",children:"•"}),e.runtime&&t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),Ja(e.runtime)]})]})})]})]},e.id||`episode-${Js?.season_number}-${s}`))),xa&&t.jsx("div",{className:"col-span-full flex justify-center mt-6",children:t.jsx(ks,{onClick:pa,hasMore:xa,isLoading:!1,totalItems:Ks.length,displayedItems:Zs,loadingText:"Loading more episodes...",buttonText:"Load More Episodes",itemName:"episodes",variant:"primary"})})]},"episodes-card-"+Js?.season_number):t.jsxs(Q.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3,ease:[.4,0,.2,1]},style:{contain:"layout"},className:"space-y-0 pb-6",children:[Ks.slice(0,Zs).map(((e,s)=>t.jsx(Q.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.4,delay:.05*s,ease:[.25,.46,.45,.94]},className:"group relative cursor-pointer transition-all duration-300 hover:bg-white/[0.02] "+(s<Ks.length-1?"border-b border-white/[0.08]":""),onClick:()=>sr(e),children:t.jsxs("div",{className:"flex items-center gap-3 sm:gap-6 p-3 sm:p-6",children:[t.jsx("div",{className:"hidden md:flex flex-shrink-0 items-center justify-center w-10 h-10",children:t.jsx("span",{className:"text-white/60 text-base",children:e.episode_number})}),t.jsxs("div",{className:"relative w-32 h-20 sm:w-32 sm:h-20 md:w-40 md:h-24 overflow-hidden rounded-lg flex-shrink-0",children:[e.still_path?t.jsx("img",{src:ye(e.still_path,"w500"),alt:e.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300 transform-gpu will-change-transform",loading:"lazy",sizes:"(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 33vw",fetchpriority:"low",onError:e=>{}}):t.jsx("div",{className:"w-full h-full bg-gradient-to-br from-gray-800/60 to-gray-700/60 flex items-center justify-center",children:t.jsx("svg",{className:"w-8 h-8 sm:w-10 sm:h-10 text-white/40",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 002 2z"})})}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),t.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center",children:t.jsx("div",{className:"bg-black/60 backdrop-blur-sm rounded-full p-3 border border-white/20",children:t.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M8 5v14l11-7z"})})})}),(()=>{const s=e.season_number||Js?.season_number,r=s?`tv_${a.id}_${s}_${e.episode_number}`:null,i=r&&U&&U[r]?.progress||0;return i&&i>0?t.jsx("div",{className:"absolute left-0 right-0 bottom-0 p-1.5 bg-gradient-to-t from-black/70 to-transparent",children:t.jsx("div",{className:"w-full bg-white/20 rounded-full h-1",children:t.jsx("div",{className:"h-1 rounded-full transition-all duration-300 "+(i>0?"bg-white":"bg-white/30"),style:{width:Math.max(i,1)+"%"}})})}):null})()]}),t.jsx("div",{className:"flex-1 min-w-0 flex flex-col justify-between",children:t.jsxs("div",{className:"space-y-3 sm:space-y-3",children:[t.jsxs("div",{className:"space-y-1 sm:space-y-2",children:[t.jsx("h4",{className:"text-white font-medium text-sm sm:text-base leading-tight group-hover:text-white/90 transition-colors duration-200 tracking-wide",children:e.name}),e.overview&&!cs&&t.jsx("p",{className:"text-white/65 text-xs sm:text-sm leading-relaxed line-clamp-2 sm:line-clamp-2 group-hover:text-white/75 transition-colors duration-200 max-w-full",children:e.overview})]}),t.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 text-xs sm:text-sm text-white/45",children:[t.jsxs("div",{className:"hidden sm:flex items-center gap-4",children:[e.air_date?t.jsxs(t.Fragment,{children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),t.jsx("span",{children:(()=>{const t=new Date(e.air_date);return isNaN(t)?"Unknown date":t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})()})]}),t.jsx("span",{className:"inline-block w-3 text-center text-white/30 select-none",children:"•"})]}):t.jsxs(t.Fragment,{children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),t.jsx("span",{children:"No air date"})]}),t.jsx("span",{className:"inline-block w-3 text-center text-white/30 select-none",children:"•"})]}),"number"==typeof e.runtime&&e.runtime>0?t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),Ja(e.runtime)]}):t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{children:"Unknown runtime"})]})]}),t.jsxs("div",{className:"sm:hidden flex items-center gap-1 text-xs",children:[t.jsxs("span",{children:["E",e.episode_number]}),t.jsx("span",{className:"inline-block w-2 text-center text-white/30 select-none",children:"•"}),e.air_date?t.jsx("span",{children:(()=>{const t=new Date(e.air_date);return isNaN(t)?"Unknown":t.toLocaleDateString("en-US",{month:"short",day:"numeric"})})()}):t.jsx("span",{children:"No date"}),"number"==typeof e.runtime&&e.runtime>0&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"inline-block w-2 text-center text-white/30 select-none",children:"•"}),t.jsx("span",{children:Ja(e.runtime)})]})]})]})]})})]})},e.id||`episode-list-${Js?.season_number}-${s}`))),(()=>null)(),xa&&t.jsx("div",{className:"flex justify-center mt-6 pt-4 border-t border-white/10",children:t.jsx(ks,{onClick:pa,hasMore:xa,isLoading:!1,totalItems:Ks.length,displayedItems:Zs,loadingText:"Loading more episodes...",buttonText:"Load More Episodes",itemName:"episodes",variant:"minimal"})})]},"episodes-list-"+Js?.season_number)}):s&&!r&&ca?t.jsx(Q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center text-white/40 py-12 pt-0",children:t.jsxs("div",{className:"bg-gradient-to-br from-white/5 to-white/2 rounded-2xl p-8 border border-white/10",children:[t.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-white/20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 002 2z"})}),t.jsx("h3",{className:"text-lg font-semibold text-white/60 mb-2",children:"No Episodes Available"}),t.jsx("p",{className:"text-white/40 text-sm",children:"This season doesn't have any episodes yet."})]})}):null})()]})})}),t.jsxs(Q.div,{className:"pt-6 sm:pt-8 relative",variants:ls,initial:"hidden",animate:"visible",children:[t.jsx("div",{className:"absolute -top-px left-0 w-full h-[1.5px] z-10 pointer-events-none",children:t.jsx("div",{className:"w-full h-full border-t border-white/10 rounded-t-2xl"})}),t.jsx("div",{className:"absolute -top-4 left-0 w-full flex justify-center pointer-events-none z-10",children:t.jsx("span",{className:"inline-block h-1 w-32 bg-gradient-to-r from-primary/30 via-white/40 to-primary/30 rounded-full blur-sm opacity-60"})}),a&&t.jsx(e.Suspense,{fallback:t.jsx("div",{className:"py-8 flex justify-center",children:t.jsx(ns,{})}),children:t.jsx(Ns,{contentId:a?.id,contentType:a?.type||"movie",onItemClick:Da,isMobile:cs,maxItems:20,showFilters:!0,showTitle:!0,showLoadMore:!0,className:"",enableVirtualization:!0,enableLazyLoading:!0,cleanupOnUnmount:!0,enableMemoryOptimization:!0,aggressiveCleanup:!0,preloadOnMount:_s(),enableAggressivePreloading:!1,preloadThreshold:.1},`${a?.id}-${a?.type}`)}),t.jsx("div",{className:"absolute -bottom-px left-0 w-full h-[1.5px] z-10 pointer-events-none",children:t.jsx("div",{className:"w-full h-full border-b border-white/10 rounded-b-2xl"})}),t.jsx("div",{className:"absolute -bottom-4 left-0 w-full flex justify-center pointer-events-none z-10",children:t.jsx("span",{className:"inline-block h-1 w-32 bg-gradient-to-r from-primary/30 via-white/40 to-primary/30 rounded-full blur-sm opacity-60"})})]})]})]}):null,t.jsxs(Q.button,{onClick:()=>{ee("close_button_clicked",{method:"close_button"}),r()},className:`absolute top-4 right-4 z-10 p-2 rounded-full text-white group overflow-hidden bg-[rgb(255,255,255,0.03)] ${Ls()&&_s()?"backdrop-blur-[0.5px]":""} border-l-[1px] border-r-[1px] border-white/30 hover:bg-white/10 ${_s()?"transform-gpu will-change-transform":""}`,variants:es,initial:"initial",whileHover:"hover",whileTap:"tap",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),t.jsx(Q.svg,{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 relative z-10",viewBox:"0 0 24 24",fill:"currentColor",whileHover:{rotate:90,scale:1.05,transition:{type:"spring",stiffness:500,damping:30}},children:t.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})}),t.jsx(Q.span,{className:"absolute right-full mr-2 top-1/2 -translate-y-1/2 px-2 py-1 bg-[#1a1a1a] rounded text-sm whitespace-nowrap z-20",variants:ts,initial:"hidden",whileHover:"visible",children:"Close"})]})]}),t.jsx(Z,{children:we&&t.jsx(e.Suspense,{fallback:t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:t.jsx(as,{size:"large",color:"white",variant:"circular"})}),children:t.jsx(Q.div,{variants:os,initial:"hidden",animate:"visible",exit:"hidden",className:"fixed inset-0 z-[1000000001] flex items-center justify-center bg-black/95",onClick:Sa,onMouseDown:e=>e.stopPropagation(),children:t.jsxs(Q.div,{variants:ls,initial:"hidden",animate:"visible",exit:"hidden",className:"relative w-[90vw] max-w-4xl aspect-video",onClick:e=>e.stopPropagation(),style:{pointerEvents:"auto"},children:[t.jsxs(Q.button,{id:"trailer-close-btn",onClick:e=>{e.stopPropagation(),e.preventDefault(),Sa()},className:"absolute top-4 right-4 p-3 rounded-full bg-black/80 text-white group z-[1000000002] cursor-pointer border border-white/20 hover:bg-black/90 transition-colors","aria-label":"Close trailer",type:"button",style:{pointerEvents:"auto"},initial:{opacity:0},animate:{opacity:1},transition:{duration:.2},children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})}),t.jsx("span",{className:"absolute right-full mr-2 top-1/2 -translate-y-1/2 px-2 py-1 bg-black rounded text-sm whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:"Close Trailer"})]}),t.jsxs("div",{className:"relative w-full h-full rounded-lg overflow-hidden bg-black",style:{pointerEvents:"auto"},children:[Xe&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 z-10",children:t.jsx(as,{size:"large",color:"white",variant:"circular"})}),te.trailer?t.jsxs("div",{className:"w-full h-full",style:{pointerEvents:"auto"},children:[t.jsx(e.Suspense,{fallback:t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 z-10",children:t.jsx(as,{size:"large",color:"white",variant:"circular"})}),children:t.jsx(As,{videoId:te.trailer,opts:{width:"100%",height:"100%",playerVars:{autoplay:0,controls:1,modestbranding:1,rel:0,showinfo:0,iv_load_policy:3,origin:window.location.origin,enablejsapi:1,widget_referrer:window.location.origin,playsinline:1,fs:1,start:0,end:0,preload:"auto"}},onReady:e=>{Oe.current=e.target,et(!1)},onError:e=>{(e=>{if(e&&"object"==typeof e){const t=e.data||e.code||e.error;if(150===t)return!0;if(101===t)return!0;if(2===t)return!0;if(5===t)return!0}(e=>{if(!e)return!1;const t=e.toString().toLowerCase(),s=e.url||e.src||"";["err_blocked_by_client","net::err_blocked_by_client","generate_204","log_event","stats/qoe","youtubei/v1/log_event","play.google.com/log","youtube.com/generate_204"].some((e=>t.includes(e)||s.includes(e))),["youtube.com","youtu.be","googlevideo.com","google.com","play.google.com"].some((e=>s.includes(e)||t.includes(e)))})(e)})(e),et(!1)},onStateChange:e=>{},className:"w-full h-full",style:{pointerEvents:"auto",position:"relative",zIndex:1}})}),t.jsx("div",{className:"absolute bottom-4 left-4 opacity-0 hover:opacity-100 transition-opacity",children:t.jsx("a",{href:"https://www.youtube.com/watch?v="+te.trailer,target:"_blank",rel:"noopener noreferrer",className:"text-white/70 text-sm hover:text-white underline",children:"Open in YouTube"})})]}):t.jsx("div",{className:"flex items-center justify-center h-full text-white/70 text-lg",children:"No trailer available."})]})]})},"trailer-modal")})}),vs&&t.jsx(e.Suspense,{fallback:t.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/70 z-50",children:t.jsx(as,{size:"large",color:"white",variant:"circular"})}),children:t.jsx(js,{streamingUrl:Hs,title:te?.title||te?.name,isOpen:vs,onClose:La,onError:Ta,content:ba,currentService:Us,onServiceChange:Ma})}),Cs&&gs&&t.jsx(fs,{person:gs,onClose:Ia,onMovieSelect:i,onSeriesSelect:i}),"undefined"!=typeof document&&t.jsx(P,{})]})});return p(ar)}),((e,t)=>e.movie?.id===t.movie?.id&&(e.movie?.type||e.movie?.media_type)===(t.movie?.type||t.movie?.media_type)&&e.onClose===t.onClose&&e.onMovieSelect===t.onMovieSelect&&e.onGenreClick===t.onGenreClick)),Vs=Object.freeze(Object.defineProperty({__proto__:null,default:Hs},Symbol.toStringTag,{value:"Module"}));function Us({title:s="Top 10 Series in Netflix Today"}){const[a,n]=e.useState([]),[o,l]=e.useState(!0),[c,d]=e.useState(null),u="data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%22240%22%20height%3D%22340%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%3E%3Crect%20width%3D%22240%22%20height%3D%22340%22%20fill%3D%22%23303030%22/%3E%3C/text%3E%3C/svg%3E";e.useEffect((()=>{let e=!0;return l(!0),ze(1).then((t=>{if(e&&t&&t.movies){const e=t.movies.slice(0,10).map((e=>({id:e.id,title:e.title,poster_path:e.poster,tag:8>e.rating?null:"Trending"})));n(e)}l(!1)})),()=>{e=!1}}),[]);const h=e.useRef(null);e.useEffect((()=>{const e=h.current;if(!e)return;let t,s,a=!1;const r=r=>{a=!0,e.classList.add("dragging"),t=r.pageX-e.offsetLeft,s=e.scrollLeft},i=()=>{a=!1,e.classList.remove("dragging")},n=()=>{a=!1,e.classList.remove("dragging")},o=r=>{if(!a)return;r.preventDefault();const i=1.5*(r.pageX-e.offsetLeft-t);e.scrollLeft=s-i};return e.addEventListener("mousedown",r),e.addEventListener("mouseleave",i),e.addEventListener("mouseup",n),e.addEventListener("mousemove",o),()=>{e.removeEventListener("mousedown",r),e.removeEventListener("mouseleave",i),e.removeEventListener("mouseup",n),e.removeEventListener("mousemove",o)}}),[]);const m="undefined"!=typeof window&&768>window.innerWidth;return t.jsxs("section",{className:"px-6",style:{overflowY:"hidden"},children:[t.jsx("style",{children:"\n        @media (max-width: 768px) {\n          .topranked-swiper-slide.swiper-slide {\n            min-width: 310px !important;\n            max-width: 310px !important;\n            width: 310px !important;\n          }\n        }\n      "}),t.jsx("h2",{className:"text-xl font-semibold bg-gradient-to-r from-white via-white/90 to-white/60 bg-clip-text text-transparent relative mb-3",children:s}),o?m?t.jsx("div",{className:"flex flex-row gap-2 overflow-x-auto",style:{WebkitOverflowScrolling:"touch"},children:[...[,,,,,,,,,,]].map(((e,s)=>t.jsxs("div",{style:{width:310,height:280,flex:"0 0 auto",padding:0,margin:0},className:"flex flex-row items-center mr-2",children:[t.jsx("div",{style:{width:60,height:"100%",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:t.jsx("span",{style:{fontSize:200,fontWeight:800,color:"rgba(255,255,255,0.18)",lineHeight:1,WebkitTextStroke:"2px rgba(255,255,255, 0.5)",textShadow:"none",WebkitTextFillColor:"rgba(0,0,0,0.9)"},children:s+1})}),t.jsxs("div",{className:"rounded-lg overflow-hidden bg-black/20 aspect-[2/3]",style:{width:160,height:240,position:"relative",zIndex:2},children:[t.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"linear-gradient(90deg, rgba(255,255,255,0.02) 0%, rgba(255,255,255,0.06) 50%, rgba(255,255,255,0.02) 100%)"}}),t.jsx("div",{style:{position:"absolute",bottom:16,left:"50%",transform:"translateX(-50%)",width:"60%",height:"12px",borderRadius:"6px",background:"rgba(255,255,255,0.10)"}}),t.jsx("div",{style:{position:"absolute",bottom:36,left:"50%",transform:"translateX(-50%)",width:"40%",height:"10px",borderRadius:"5px",background:"rgba(255,255,255,0.07)"}})]})]},s)))}):t.jsx("div",{className:"flex flex-row gap-2 overflow-x-auto",style:{WebkitOverflowScrolling:"touch",paddingRight:"3rem",marginRight:"2rem"},children:[...[,,,,,,,,,,]].map(((e,s)=>t.jsxs("div",{style:{width:"auto",height:320,flex:"0 0 auto",padding:0,margin:0},className:"flex flex-row items-center mr-4",children:[t.jsx("div",{style:{marginRight:"-3rem",width:150,height:"100%",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:t.jsx("span",{style:{fontSize:230,fontWeight:800,color:"rgba(255,255,255,0.18)",lineHeight:1,WebkitTextStroke:"2px rgba(255,255,255, 0.5)",textShadow:"none",WebkitTextFillColor:"rgba(0,0,0,0.9)"},children:s+1})}),t.jsxs("div",{className:"rounded-lg overflow-hidden bg-black/20",style:{width:190,height:280,position:"relative",zIndex:2},children:[t.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"linear-gradient(90deg, rgba(255,255,255,0.02) 0%, rgba(255,255,255,0.06) 50%, rgba(255,255,255,0.02) 100%)"}}),t.jsx("div",{style:{position:"absolute",bottom:16,left:"50%",transform:"translateX(-50%)",width:"60%",height:"12px",borderRadius:"6px",background:"rgba(255,255,255,0.10)"}}),t.jsx("div",{style:{position:"absolute",bottom:36,left:"50%",transform:"translateX(-50%)",width:"40%",height:"10px",borderRadius:"5px",background:"rgba(255,255,255,0.07)"}})]})]},s)))}):m?t.jsx("div",{className:"flex flex-row gap-2 overflow-x-auto",style:{WebkitOverflowScrolling:"touch"},children:a.map(((e,s)=>t.jsxs("div",{style:{width:310,height:280,flex:"0 0 auto",padding:0,margin:0},className:"flex flex-row items-center mr-2",children:[t.jsx("div",{style:{width:60,height:"100%",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:t.jsx("span",{style:{fontSize:200,fontWeight:800,color:"rgba(255,255,255,0.18)",lineHeight:1,WebkitTextStroke:"2px rgba(255,255,255, 0.5)",textShadow:"none",WebkitTextFillColor:"rgba(0,0,0,0.9)"},children:s+1})}),t.jsx("div",{className:"block group cursor-pointer","aria-label":e.title,onClick:()=>d(e),children:t.jsx("div",{className:"rounded-lg overflow-hidden bg-black/20 aspect-[2/3]",style:{width:160,height:240,position:"relative",zIndex:2},children:t.jsx("img",{src:e.poster_path||u,alt:e.title,style:{width:"100%",height:"100%",objectFit:"cover",display:"block"}})})})]},e.id||s)))}):t.jsx(r,{modules:[ce,de],navigation:!0,spaceBetween:16,slidesPerView:"auto",style:{paddingRight:"3rem",marginRight:"2rem"},children:a.map(((e,s)=>t.jsx(i,{style:{width:"auto",height:320,flex:"0 0 auto",padding:0,margin:0},children:t.jsxs("div",{className:"flex flex-row items-center",style:{height:320,position:"relative",padding:0,marginRight:16},children:[t.jsx("div",{style:{marginRight:"-3rem",width:150,height:"100%",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:t.jsx("span",{style:{fontSize:230,fontWeight:800,color:"rgba(255,255,255,0.18)",lineHeight:1,WebkitTextStroke:"2px rgba(255,255,255, 0.5)",textShadow:"none",WebkitTextFillColor:"rgba(0,0,0,0.9)"},children:s+1})}),t.jsx("div",{className:"block group cursor-pointer","aria-label":e.title,onClick:()=>d(e),children:t.jsx("div",{className:"rounded-lg overflow-hidden bg-black/20",style:{width:190,height:280,position:"relative",zIndex:2},children:t.jsx("img",{src:e.poster_path||u,alt:e.title,style:{width:"100%",height:"100%",objectFit:"cover",display:"block"}})})})]})},e.id||s)))}),c&&t.jsx(Hs,{movie:{...c,type:"tv"},onClose:()=>d(null)})]})}function Ys({title:s="Top 10 Movies in Netflix Today"}){const[a,n]=e.useState([]),[o,l]=e.useState(!0),[c,d]=e.useState(null),u="data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%22240%22%20height%3D%22340%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%3E%3Crect%20width%3D%22240%22%20height%3D%22340%22%20fill%3D%22%23303030%22/%3E%3C/text%3E%3C/svg%3E";e.useEffect((()=>{let e=!0;return l(!0),async function(){try{const t=await fetch("https://streamr-jjj9.onrender.com/api/tmdb/trending?media_type=movie&time_window=day&page=1");if(!e)return;if(t.ok){const e=((await t.json()).results||[]).slice(0,10).map((e=>{let t=e.poster_path||e.poster||null;return t&&t.startsWith("/")&&(t=ye(t,"w342")),{id:e.id,title:e.title||e.name||e.original_title,poster_path:t,tag:8>e.vote_average?null:"Trending"}}));n(e)}}catch(t){}finally{e&&l(!1)}}(),()=>{e=!1}}),[]);const h=e.useRef(null);e.useEffect((()=>{const e=h.current;if(!e)return;let t,s,a=!1;const r=r=>{a=!0,e.classList.add("dragging"),t=r.pageX-e.offsetLeft,s=e.scrollLeft},i=()=>{a=!1,e.classList.remove("dragging")},n=()=>{a=!1,e.classList.remove("dragging")},o=r=>{if(!a)return;r.preventDefault();const i=1.5*(r.pageX-e.offsetLeft-t);e.scrollLeft=s-i};return e.addEventListener("mousedown",r),e.addEventListener("mouseleave",i),e.addEventListener("mouseup",n),e.addEventListener("mousemove",o),()=>{e.removeEventListener("mousedown",r),e.removeEventListener("mouseleave",i),e.removeEventListener("mouseup",n),e.removeEventListener("mousemove",o)}}),[]);const m="undefined"!=typeof window&&768>window.innerWidth;return t.jsxs("section",{className:"px-6",style:{overflowY:"hidden"},children:[t.jsx("style",{children:"\n        @media (max-width: 768px) {\n          .topranked-swiper-slide.swiper-slide {\n            min-width: 310px !important;\n            max-width: 310px !important;\n            width: 310px !important;\n          }\n        }\n      "}),t.jsx("h2",{className:"text-xl font-semibold bg-gradient-to-r from-white via-white/90 to-white/60 bg-clip-text text-transparent relative mb-3",children:s}),o?m?t.jsx("div",{className:"flex flex-row gap-2 overflow-x-auto",style:{WebkitOverflowScrolling:"touch"},children:[...[,,,,,,,,,,]].map(((e,s)=>t.jsxs("div",{style:{width:310,height:280,flex:"0 0 auto",padding:0,margin:0},className:"flex flex-row items-center mr-2",children:[t.jsx("div",{style:{width:60,height:"100%",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:t.jsx("span",{style:{fontSize:200,fontWeight:800,color:"rgba(255,255,255,0.18)",lineHeight:1,WebkitTextStroke:"2px rgba(255,255,255, 0.5)",textShadow:"none",WebkitTextFillColor:"rgba(0,0,0,0.9)"},children:s+1})}),t.jsxs("div",{className:"rounded-lg overflow-hidden bg-black/20 aspect-[2/3]",style:{width:160,height:240,position:"relative",zIndex:2},children:[t.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"linear-gradient(90deg, rgba(255,255,255,0.02) 0%, rgba(255,255,255,0.06) 50%, rgba(255,255,255,0.02) 100%)"}}),t.jsx("div",{style:{position:"absolute",bottom:16,left:"50%",transform:"translateX(-50%)",width:"60%",height:"12px",borderRadius:"6px",background:"rgba(255,255,255,0.10)"}}),t.jsx("div",{style:{position:"absolute",bottom:36,left:"50%",transform:"translateX(-50%)",width:"40%",height:"10px",borderRadius:"5px",background:"rgba(255,255,255,0.07)"}})]})]},s)))}):t.jsx("div",{className:"flex flex-row gap-2 overflow-x-auto",style:{WebkitOverflowScrolling:"touch",paddingRight:"3rem",marginRight:"2rem"},children:[...[,,,,,,,,,,]].map(((e,s)=>t.jsxs("div",{style:{width:"auto",height:320,flex:"0 0 auto",padding:0,margin:0},className:"flex flex-row items-center mr-4",children:[t.jsx("div",{style:{marginRight:"-3rem",width:150,height:"100%",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:t.jsx("span",{style:{fontSize:230,fontWeight:800,color:"rgba(255,255,255,0.18)",lineHeight:1,WebkitTextStroke:"2px rgba(255,255,255, 0.5)",textShadow:"none",WebkitTextFillColor:"rgba(0,0,0,0.9)"},children:s+1})}),t.jsxs("div",{className:"rounded-lg overflow-hidden bg-black/20",style:{width:190,height:280,position:"relative",zIndex:2},children:[t.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"linear-gradient(90deg, rgba(255,255,255,0.02) 0%, rgba(255,255,255,0.06) 50%, rgba(255,255,255,0.02) 100%)"}}),t.jsx("div",{style:{position:"absolute",bottom:16,left:"50%",transform:"translateX(-50%)",width:"60%",height:"12px",borderRadius:"6px",background:"rgba(255,255,255,0.10)"}}),t.jsx("div",{style:{position:"absolute",bottom:36,left:"50%",transform:"translateX(-50%)",width:"40%",height:"10px",borderRadius:"5px",background:"rgba(255,255,255,0.07)"}})]})]},s)))}):m?t.jsx("div",{className:"flex flex-row gap-2 overflow-x-auto",style:{WebkitOverflowScrolling:"touch"},children:a.map(((e,s)=>t.jsxs("div",{style:{width:310,height:280,flex:"0 0 auto",padding:0,margin:0},className:"flex flex-row items-center mr-2",children:[t.jsx("div",{style:{width:60,height:"100%",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:t.jsx("span",{style:{fontSize:200,fontWeight:800,color:"rgba(255,255,255,0.18)",lineHeight:1,WebkitTextStroke:"2px rgba(255,255,255, 0.5)",textShadow:"none",WebkitTextFillColor:"rgba(0,0,0,0.9)"},children:s+1})}),t.jsx("div",{className:"block group cursor-pointer","aria-label":e.title,onClick:()=>d(e),children:t.jsx("div",{className:"rounded-lg overflow-hidden bg-black/20 aspect-[2/3]",style:{width:160,height:240,position:"relative",zIndex:2},children:t.jsx("img",{src:e.poster_path||u,alt:e.title,style:{width:"100%",height:"100%",objectFit:"cover",display:"block"}})})})]},e.id||s)))}):t.jsx(r,{modules:[ce,de],navigation:!0,spaceBetween:16,slidesPerView:"auto",style:{paddingRight:"3rem",marginRight:"2rem"},children:a.map(((e,s)=>t.jsx(i,{style:{width:"auto",height:320,flex:"0 0 auto",padding:0,margin:0},children:t.jsxs("div",{className:"flex flex-row items-center",style:{height:320,position:"relative",padding:0,marginRight:16},children:[t.jsx("div",{style:{marginRight:"-3rem",width:150,height:"100%",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:t.jsx("span",{style:{fontSize:230,fontWeight:800,color:"rgba(255,255,255,0.18)",lineHeight:1,WebkitTextStroke:"2px rgba(255,255,255, 0.5)",textShadow:"none",WebkitTextFillColor:"rgba(0,0,0,0.9)"},children:s+1})}),t.jsx("div",{className:"block group cursor-pointer","aria-label":e.title,onClick:()=>d(e),children:t.jsx("div",{className:"rounded-lg overflow-hidden bg-black/20",style:{width:190,height:280,position:"relative",zIndex:2},children:t.jsx("img",{src:e.poster_path||u,alt:e.title,style:{width:"100%",height:"100%",objectFit:"cover",display:"block"}})})})]})},e.id||s)))}),c&&t.jsx(Hs,{movie:{...c,type:"movie"},onClose:()=>d(null)})]})}function qs(){const[s,a]=e.useState([]),[n,o]=e.useState(!0),[l,c]=e.useState(null),d="data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%22240%22%20height%3D%22340%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%3E%3Crect%20width%3D%22240%22%20height%3D%22340%22%20fill%3D%22%23303030%22/%3E%3C/text%3E%3C/svg%3E";e.useEffect((()=>{let e=!0;return o(!0),We({with_original_language:"ko",page:1,vote_count_gte:10,vote_average_gte:6}).then((t=>{if(e){if(t&&t.movies){const e=t.movies.slice(0,12).map((e=>({id:e.id,title:e.title||e.name,poster_path:e.poster||e.poster_path})));a(e)}o(!1)}})).catch((()=>o(!1))),()=>{e=!1}}),[]);const u="undefined"!=typeof window&&768>window.innerWidth;return t.jsxs("section",{className:"px-6",style:{overflowY:"hidden"},children:[t.jsx("style",{children:"\n        @media (max-width: 768px) {\n          .topranked-swiper-slide.swiper-slide {\n            min-width: 310px !important;\n            max-width: 310px !important;\n            width: 310px !important;\n          }\n        }\n      "}),t.jsx("div",{className:"mb-3",children:t.jsx("h2",{className:"text-xl font-semibold bg-gradient-to-r from-white via-white/90 to-white/60 bg-clip-text text-transparent relative",children:"Top Rated Korean Movies"})}),n?u?t.jsx("div",{className:"flex flex-row gap-2 overflow-x-auto",style:{WebkitOverflowScrolling:"touch"},children:[...[,,,,,,,,,,]].map(((e,s)=>t.jsxs("div",{style:{width:310,height:280,flex:"0 0 auto",padding:0,margin:0},className:"flex flex-row items-center mr-2",children:[t.jsx("div",{style:{width:60,height:"100%",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:t.jsx("span",{style:{fontSize:200,fontWeight:800,color:"rgba(255,255,255,0.18)",lineHeight:1,WebkitTextStroke:"2px rgba(255,255,255, 0.5)",textShadow:"none",WebkitTextFillColor:"rgba(0,0,0,0.9)"},children:s+1})}),t.jsxs("div",{className:"rounded-lg overflow-hidden bg-black/20 aspect-[2/3]",style:{width:160,height:240,position:"relative",zIndex:2},children:[t.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"linear-gradient(90deg, rgba(255,255,255,0.02) 0%, rgba(255,255,255,0.06) 50%, rgba(255,255,255,0.02) 100%)"}}),t.jsx("div",{style:{position:"absolute",bottom:16,left:"50%",transform:"translateX(-50%)",width:"60%",height:"12px",borderRadius:"6px",background:"rgba(255,255,255,0.10)"}}),t.jsx("div",{style:{position:"absolute",bottom:36,left:"50%",transform:"translateX(-50%)",width:"40%",height:"10px",borderRadius:"5px",background:"rgba(255,255,255,0.07)"}})]})]},s)))}):t.jsx("div",{className:"flex flex-row gap-2 overflow-x-auto",style:{WebkitOverflowScrolling:"touch",paddingRight:"3rem",marginRight:"2rem"},children:[...[,,,,,,,,,,]].map(((e,s)=>t.jsxs("div",{style:{width:"auto",height:320,flex:"0 0 auto",padding:0,margin:0},className:"flex flex-row items-center mr-4",children:[t.jsx("div",{style:{marginRight:"-3rem",width:150,height:"100%",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:t.jsx("span",{style:{fontSize:230,fontWeight:800,color:"rgba(255,255,255,0.18)",lineHeight:1,WebkitTextStroke:"2px rgba(255,255,255, 0.5)",textShadow:"none",WebkitTextFillColor:"rgba(0,0,0,0.9)"},children:s+1})}),t.jsxs("div",{className:"rounded-lg overflow-hidden bg-black/20",style:{width:190,height:280,position:"relative",zIndex:2},children:[t.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"linear-gradient(90deg, rgba(255,255,255,0.02) 0%, rgba(255,255,255,0.06) 50%, rgba(255,255,255,0.02) 100%)"}}),t.jsx("div",{style:{position:"absolute",bottom:16,left:"50%",transform:"translateX(-50%)",width:"60%",height:"12px",borderRadius:"6px",background:"rgba(255,255,255,0.10)"}}),t.jsx("div",{style:{position:"absolute",bottom:36,left:"50%",transform:"translateX(-50%)",width:"40%",height:"10px",borderRadius:"5px",background:"rgba(255,255,255,0.07)"}})]})]},s)))}):u?t.jsx("div",{className:"flex flex-row gap-2 overflow-x-auto",style:{WebkitOverflowScrolling:"touch"},children:s.map(((e,s)=>t.jsxs("div",{style:{width:310,height:280,flex:"0 0 auto",padding:0,margin:0},className:"flex flex-row items-center mr-2",children:[t.jsx("div",{style:{width:60,height:"100%",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:t.jsx("span",{style:{fontSize:200,fontWeight:800,color:"rgba(255,255,255,0.18)",lineHeight:1,WebkitTextStroke:"2px rgba(255,255,255, 0.5)",textShadow:"none",WebkitTextFillColor:"rgba(0,0,0,0.9)"},children:s+1})}),t.jsx("div",{className:"block group cursor-pointer","aria-label":e.title,onClick:()=>c(e),children:t.jsx("div",{className:"rounded-lg overflow-hidden bg-black/20 aspect-[2/3]",style:{width:160,height:240,position:"relative",zIndex:2},children:t.jsx("img",{src:e.poster_path||d,alt:e.title,style:{width:"100%",height:"100%",objectFit:"cover",display:"block"}})})})]},e.id||s)))}):t.jsx(r,{modules:[ce,de],navigation:!0,spaceBetween:16,slidesPerView:"auto",style:{paddingRight:"3rem",marginRight:"2rem"},children:s.map(((e,s)=>t.jsx(i,{style:{width:"auto",height:320,flex:"0 0 auto",padding:0,margin:0},children:t.jsxs("div",{className:"flex flex-row items-center",style:{height:320,position:"relative",padding:0,marginRight:16},children:[t.jsx("div",{style:{marginRight:"-3rem",width:150,height:"100%",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:t.jsx("span",{style:{fontSize:230,fontWeight:800,color:"rgba(255,255,255,0.18)",lineHeight:1,WebkitTextStroke:"2px rgba(255,255,255, 0.5)",textShadow:"none",WebkitTextFillColor:"rgba(0,0,0,0.9)"},children:s+1})}),t.jsx("div",{className:"block group cursor-pointer","aria-label":e.title,onClick:()=>c(e),children:t.jsx("div",{className:"rounded-lg overflow-hidden bg-black/20",style:{width:190,height:280,position:"relative",zIndex:2},children:t.jsx("img",{src:e.poster_path||d,alt:e.title,style:{width:"100%",height:"100%",objectFit:"cover",display:"block"}})})})]})},e.id||s)))}),l&&t.jsx(Hs,{movie:{...l,type:"movie"},onClose:()=>c(null)})]})}function Gs(){const[s,a]=e.useState([]),[n,o]=e.useState(!0),[l,c]=e.useState(null),d="data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%22240%22%20height%3D%22340%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%3E%3Crect%20width%3D%22240%22%20height%3D%22340%22%20fill%3D%22%23303030%22/%3E%3C/text%3E%3C/svg%3E";e.useEffect((()=>{let e=!0;return o(!0),async function(){try{let s=[];for(let t=1;3>=t;t++){const a=await Ae(t);if(!e)return;if(a&&a.movies&&a.movies.length>0){const e=a.movies.filter((e=>e.originalLanguage&&"ko"===e.originalLanguage||e.origin_country&&Array.isArray(e.origin_country)&&e.origin_country.includes("KR")||e.productionCountries&&e.productionCountries.some((e=>"KR"===e.iso31661))||e.productionCompanies&&e.productionCompanies.some((e=>"KR"===(e.originCountry||e.origin_country)))||e.networks&&e.networks.some((e=>"KR"===(e.originCountry||e.origin_country)))));e.length>0&&(s=s.concat(e))}if(s.length>=10)break}let r=s.slice(0,10).map((e=>{let t=e.poster||e.poster_path||null;return t&&t.startsWith("/")&&(t=ye(t,"w342")),{id:e.id,title:e.title||e.name,poster_path:t}}));if(6>r.length)try{const e=await fetch("https://streamr-jjj9.onrender.com/api/tmdb/discover?media_type=tv&with_original_language=ko&page=1&vote_count.gte=5");if(e.ok){const t=await e.json(),s=(t?.results||[]).map((e=>({id:e.id,title:e.name||e.original_name,poster_path:e.poster_path}))),a=new Set(r.map((e=>e.id)));for(const e of s){if(r.length>=10)break;if(!a.has(e.id)){let t=e.poster_path||null;t&&t.startsWith("/")&&(t=ye(t,"w342")),r.push({id:e.id,title:e.title,poster_path:t})}}}}catch(t){}a(r)}catch(t){}finally{e&&o(!1)}}(),()=>{e=!1}}),[]);const u="undefined"!=typeof window&&768>window.innerWidth;return t.jsxs("section",{className:"px-6",style:{overflowY:"hidden"},children:[t.jsx("style",{children:"\n        @media (max-width: 768px) {\n          .topranked-swiper-slide.swiper-slide {\n            min-width: 310px !important;\n            max-width: 310px !important;\n            width: 310px !important;\n          }\n        }\n      "}),t.jsx("div",{className:"mb-3",children:t.jsx("h2",{className:"text-xl font-semibold bg-gradient-to-r from-white via-white/90 to-white/60 bg-clip-text text-transparent relative",children:"Top Rated Korean Dramas"})}),n?u?t.jsx("div",{className:"flex flex-row gap-2 overflow-x-auto",style:{WebkitOverflowScrolling:"touch"},children:[...[,,,,,,,,,,]].map(((e,s)=>t.jsxs("div",{style:{width:310,height:280,flex:"0 0 auto",padding:0,margin:0},className:"flex flex-row items-center mr-2",children:[t.jsx("div",{style:{width:60,height:"100%",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:t.jsx("span",{style:{fontSize:200,fontWeight:800,color:"rgba(255,255,255,0.18)",lineHeight:1,WebkitTextStroke:"2px rgba(255,255,255, 0.5)",textShadow:"none",WebkitTextFillColor:"rgba(0,0,0,0.9)"},children:s+1})}),t.jsxs("div",{className:"rounded-lg overflow-hidden bg-black/20 aspect-[2/3]",style:{width:160,height:240,position:"relative",zIndex:2},children:[t.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"linear-gradient(90deg, rgba(255,255,255,0.02) 0%, rgba(255,255,255,0.06) 50%, rgba(255,255,255,0.02) 100%)"}}),t.jsx("div",{style:{position:"absolute",bottom:16,left:"50%",transform:"translateX(-50%)",width:"60%",height:"12px",borderRadius:"6px",background:"rgba(255,255,255,0.10)"}}),t.jsx("div",{style:{position:"absolute",bottom:36,left:"50%",transform:"translateX(-50%)",width:"40%",height:"10px",borderRadius:"5px",background:"rgba(255,255,255,0.07)"}})]})]},s)))}):t.jsx("div",{className:"flex flex-row gap-2 overflow-x-auto",style:{WebkitOverflowScrolling:"touch",paddingRight:"3rem",marginRight:"2rem"},children:[...[,,,,,,,,,,]].map(((e,s)=>t.jsxs("div",{style:{width:"auto",height:320,flex:"0 0 auto",padding:0,margin:0},className:"flex flex-row items-center mr-4",children:[t.jsx("div",{style:{marginRight:"-3rem",width:150,height:"100%",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:t.jsx("span",{style:{fontSize:230,fontWeight:800,color:"rgba(255,255,255,0.18)",lineHeight:1,WebkitTextStroke:"2px rgba(255,255,255, 0.5)",textShadow:"none",WebkitTextFillColor:"rgba(0,0,0,0.9)"},children:s+1})}),t.jsxs("div",{className:"rounded-lg overflow-hidden bg-black/20",style:{width:190,height:280,position:"relative",zIndex:2},children:[t.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"linear-gradient(90deg, rgba(255,255,255,0.02) 0%, rgba(255,255,255,0.06) 50%, rgba(255,255,255,0.02) 100%)"}}),t.jsx("div",{style:{position:"absolute",bottom:16,left:"50%",transform:"translateX(-50%)",width:"60%",height:"12px",borderRadius:"6px",background:"rgba(255,255,255,0.10)"}}),t.jsx("div",{style:{position:"absolute",bottom:36,left:"50%",transform:"translateX(-50%)",width:"40%",height:"10px",borderRadius:"5px",background:"rgba(255,255,255,0.07)"}})]})]},s)))}):u?t.jsx("div",{className:"flex flex-row gap-2 overflow-x-auto",style:{WebkitOverflowScrolling:"touch"},children:s.map(((e,s)=>t.jsxs("div",{style:{width:310,height:280,flex:"0 0 auto",padding:0,margin:0},className:"flex flex-row items-center mr-2",children:[t.jsx("div",{style:{width:60,height:"100%",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:t.jsx("span",{style:{fontSize:200,fontWeight:800,color:"rgba(255,255,255,0.18)",lineHeight:1,WebkitTextStroke:"2px rgba(255,255,255, 0.5)",textShadow:"none",WebkitTextFillColor:"rgba(0,0,0,0.9)"},children:s+1})}),t.jsx("div",{className:"block group cursor-pointer","aria-label":e.title,onClick:()=>c(e),children:t.jsx("div",{className:"rounded-lg overflow-hidden bg-black/20 aspect-[2/3]",style:{width:160,height:240,position:"relative",zIndex:2},children:t.jsx("img",{src:e.poster_path||d,alt:e.title,style:{width:"100%",height:"100%",objectFit:"cover",display:"block"}})})})]},e.id||s)))}):t.jsx(r,{modules:[ce,de],navigation:!0,spaceBetween:16,slidesPerView:"auto",style:{paddingRight:"3rem",marginRight:"2rem"},children:s.map(((e,s)=>t.jsx(i,{style:{width:"auto",height:320,flex:"0 0 auto",padding:0,margin:0},children:t.jsxs("div",{className:"flex flex-row items-center",style:{height:320,position:"relative",padding:0,marginRight:16},children:[t.jsx("div",{style:{marginRight:"-3rem",width:150,height:"100%",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:t.jsx("span",{style:{fontSize:230,fontWeight:800,color:"rgba(255,255,255,0.18)",lineHeight:1,WebkitTextStroke:"2px rgba(255,255,255, 0.5)",textShadow:"none",WebkitTextFillColor:"rgba(0,0,0,0.9)"},children:s+1})}),t.jsx("div",{className:"block group cursor-pointer","aria-label":e.title,onClick:()=>c(e),children:t.jsx("div",{className:"rounded-lg overflow-hidden bg-black/20",style:{width:190,height:280,position:"relative",zIndex:2},children:t.jsx("img",{src:e.poster_path||d,alt:e.title,style:{width:"100%",height:"100%",objectFit:"cover",display:"block"}})})})]})},e.id||s)))}),l&&t.jsx(Hs,{movie:{...l,type:"tv"},onClose:()=>c(null)})]})}class Js{constructor(e=100,t=3e5){this.maxSize=e,this.ttl=t,this.cache=new Map,this.accessOrder=[]}get(e){const t=this.cache.get(e);return t?Date.now()-t.timestamp>this.ttl?(this.cache.delete(e),this.accessOrder=this.accessOrder.filter((t=>t!==e)),null):(this.accessOrder=this.accessOrder.filter((t=>t!==e)),this.accessOrder.push(e),t.lastAccess=Date.now(),t.value):null}set(e,t){if(this.cache.has(e)&&(this.accessOrder=this.accessOrder.filter((t=>t!==e))),this.cache.size>=this.maxSize&&!this.cache.has(e)){const e=this.accessOrder.shift();this.cache.delete(e)}this.cache.set(e,{value:t,timestamp:Date.now(),lastAccess:Date.now()}),this.accessOrder.push(e)}has(e){if(!this.cache.has(e))return!1;const t=this.cache.get(e);return Date.now()-t.timestamp<=this.ttl||(this.cache.delete(e),this.accessOrder=this.accessOrder.filter((t=>t!==e)),!1)}clear(){this.cache.clear(),this.accessOrder=[]}size(){return this.cache.size}}const Xs="https://streamr-jjj9.onrender.com",Ks=new Js(100,3e5),Qs=new Js(50,6e5),Zs=(e,t)=>{if(!e||!t)return 0;const s=e.toLowerCase().trim(),a=t.toLowerCase().trim();if(s===a)return 1;const r=new Set(s.split(/\s+/)),i=new Set(a.split(/\s+/)),n=new Set([...r].filter((e=>i.has(e)))),o=new Set([...r,...i]),l=n.size/o.size,c=((e,t,s=.6)=>{if(!e||!t)return 0;const a=e.toLowerCase().trim(),r=t.toLowerCase().trim();if(a===r)return 1;const i=[];for(let o=0;o<=r.length;o++)i[o]=[o];for(let o=0;o<=a.length;o++)i[0][o]=o;for(let o=1;o<=r.length;o++)for(let e=1;e<=a.length;e++)r.charAt(o-1)===a.charAt(e-1)?i[o][e]=i[o-1][e-1]:i[o][e]=Math.min(i[o-1][e-1]+1,i[o][e-1]+1,i[o-1][e]+1);const n=1-i[r.length][a.length]/Math.max(a.length,r.length);return s>n?0:n})(s,a,0),d=s.includes(a)||a.includes(s)?.8:0;return Math.max(l,c,d)};function ea(t,s){e.useEffect((()=>{const e=e=>{t.current&&!t.current.contains(e.target)&&s(e)};return document.addEventListener("mousedown",e,{passive:!0}),document.addEventListener("touchstart",e,{passive:!0}),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}}),[t,s])}setInterval((()=>{const e=Date.now();for(const[t,s]of Ks.entries())e-s.timestamp>3e5&&Ks.delete(t);for(const[t,s]of Qs.entries())e-s.timestamp>6e5&&Qs.delete(t)}),3e5);const ta=s.memo((({src:s,alt:a,className:r,priority:i=!1,lazy:n=!0,aspectRatio:o="16/9",fallbackIcon:l="movie",onImageLoad:c,onImageError:d})=>{const[u,h]=e.useState(!1),[m,p]=e.useState(!0),[x,g]=e.useState(!1),[f,w]=e.useState(0),b=e.useRef(null),v=e.useCallback((()=>{if(2>f){w((e=>e+1)),p(!0);const e=setTimeout((()=>{const e=new Image;e.onload=()=>{p(!1),g(!0),h(!1)},e.onerror=v,e.src=s}),1e3*(f+1));b.current=e}else h(!0),p(!1),d?.(s,a)}),[s,a,f,2,d,p,g,h]),y=e.useCallback((()=>{p(!1),g(!0),h(!1),c?.(s,a)}),[s,a,c,p,g,h]);return e.useEffect((()=>{if(s&&i){const e=new Image;return e.onload=y,e.onerror=v,e.src=s,()=>{e.onload=null,e.onerror=null}}}),[s,i]),e.useEffect((()=>()=>{b.current&&(clearTimeout(b.current),b.current=null)}),[s]),u||!s?(()=>{const e={movie:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-white/40 mx-auto mb-2",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M18 4l2 8H4l2-8h12zM4 13v7h16v-7H4z"})}),person:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-white/40 mx-auto mb-2",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})}),default:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-white/40 mx-auto mb-2",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14z"})})};return t.jsxs("div",{className:r+" bg-gradient-to-br from-[#2b3036] to-[#1a1d21] flex items-center justify-center relative overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/5 to-transparent"}),t.jsxs("div",{className:"text-center p-4 relative z-10",children:[e[l]||e.default,t.jsx("span",{className:"text-white/60 text-sm font-medium block truncate max-w-full px-2",children:a}),f>0&&t.jsxs("span",{className:"text-white/40 text-xs block mt-1",children:["Retrying... (",f,"/",2,")"]})]})]})})():t.jsxs("div",{className:r+" relative overflow-hidden group",style:{aspectRatio:o},children:[m&&t.jsxs("div",{className:"absolute inset-0 bg-gradient-to-r from-[#2b3036] via-[#3a4046] to-[#2b3036]",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/5 to-transparent"}),t.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-white/20 border-t-white/60"})})]}),t.jsx("img",{src:s,alt:a,loading:n?"lazy":"eager",decoding:"async",className:`\n          w-full h-full object-cover transition-all duration-500 ease-out\n          ${m?"opacity-0 scale-95":"opacity-100 scale-100"}\n          ${x?"group-hover/image:scale-105":""}\n        `,onError:v,onLoad:y,style:{transform:x?"translateZ(0)":"none"}}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/90 via-black/30 to-transparent opacity-0 group-hover/image:opacity-100 transition-all duration-300 ease-out",children:t.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-3 flex items-center justify-center",children:t.jsx("div",{className:"bg-white/20 backdrop-blur-sm rounded-full p-2 transform scale-90 group-hover/image:scale-100 transition-transform duration-200",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-white",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M8 5v14l11-7z"})})})})})]})}));ta.displayName="MovieImage";const sa=e.memo((({movie:e,index:s,selectedIndex:a,onSelect:r,isInWatchlist:i,onAddToWatchlist:n,onCastSelect:o,handleSearchQuery:l,debouncedSearch:c})=>t.jsxs(Q.button,{"data-index":s,onClick:()=>{e.isSuggestion?(l(e.title),c.search(e.title)):"person"===e.type?o(e):r(e)},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"w-full p-4 flex items-start gap-4 transition-all duration-200 rounded-xl group/item focus:outline-none relative "+(s===a?"border-l-4 border-white/40 bg-gradient-to-r from-white/15 to-white/5 shadow-lg shadow-black/30":"hover:bg-white/8"),tabIndex:0,"aria-selected":s===a,role:"option",style:{zIndex:s===a?2:1},children:[s===a&&t.jsx(Q.div,{className:"absolute left-0 top-0 bottom-0 w-1.5 bg-white/80 rounded-r-lg",initial:{scaleY:0},animate:{scaleY:1},exit:{scaleY:0},transition:{duration:.18},style:{zIndex:3}}),t.jsx("div",{className:"w-20 h-28 flex-shrink-0 relative group/image overflow-hidden rounded-xl bg-white/8 border border-white/15 shadow-lg",children:e.isSuggestion?t.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-blue-500/20 to-purple-500/20",children:t.jsx("svg",{className:"w-8 h-8 text-blue-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}):t.jsx(ta,{src:e.image||e.poster_path?Pt(e.poster_path||e.image,"w185"):"",alt:"person"===e.type?e.name:e.title,className:"w-full h-full",fallbackIcon:"person"===e.type?"person":"movie"})}),t.jsxs("div",{className:"flex-1 min-w-0 relative z-10",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("h3",{className:"text-white font-semibold truncate text-base md:text-lg leading-tight",children:"person"===e.type?e.name:e.title}),t.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium flex-shrink-0 "+(e.isSuggestion?"bg-purple-500/20 text-purple-300 border border-purple-400/30":"person"===e.type?"bg-blue-500/20 text-blue-300 border border-blue-400/30":"bg-green-500/20 text-green-300 border border-green-400/30"),children:e.isSuggestion?"Suggestion":"person"===e.type?"Cast":"tv"===e.type?"TV":"Movie"})]}),t.jsx("div",{className:"flex items-center gap-2 text-white/70 text-xs md:text-sm mb-2",children:e.isSuggestion?t.jsxs(t.Fragment,{children:[t.jsx("span",{children:"Search suggestion"}),t.jsx("span",{children:"•"}),t.jsx("span",{children:"Click to search"})]}):"person"===e.type?t.jsxs(t.Fragment,{children:[t.jsx("span",{children:e.knownForDepartment}),e.popularity>0&&t.jsxs(t.Fragment,{children:[t.jsx("span",{children:"•"}),t.jsxs("span",{className:"inline-flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.286 3.967a1 1 0 00.95.69h4.178c.969 0 1.371 1.24.588 1.81l-3.286 2.46a1 1 0 00-.364 1.118l1.287 3.966c.3.922-.755 1.688-1.54 1.118l-3.385-2.46a1 1 0 00-1.175 0l-3.385 2.46c-.784.57-1.838-.196-1.54-1.118l1.287-3.966a1 1 0 00-.364-1.118l-3.385-2.46c-.783-.57-.38-1.81.588-1.81h4.178a1 1 0 00.95-.69l1.286-3.967z"})}),Math.round(e.popularity)]})]})]}):t.jsxs(t.Fragment,{children:[t.jsx("span",{children:e.year}),t.jsx("span",{children:"•"}),t.jsx("span",{children:"tv"===e.type?"TV Show":"Movie"}),e.rating>0&&t.jsxs(t.Fragment,{children:[t.jsx("span",{children:"•"}),t.jsxs("span",{className:"inline-flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.286 3.967a1 1 0 00.95.69h4.178c.969 0 1.371 1.24.588 1.81l-3.286 2.46a1 1 0 00-.364 1.118l1.287 3.966c.3.922-.755 1.688-1.54 1.118l-3.385-2.46a1 1 0 00-1.175 0l-3.385 2.46c-.784.57-1.838-.196-1.54-1.118l1.287-3.966a1 1 0 00-.364-1.118l-3.385-2.46c-.783-.57-.38-1.81.588-1.81h4.178a1 1 0 00.95-.69l1.286-3.967z"})}),pt(e.rating)]})]})]})}),e.genres&&e.genres.length>0&&t.jsx("div",{className:"mt-2 flex flex-wrap gap-2 mb-2",children:e.genres.slice(0,3).map(((e,s)=>t.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-white/10 text-white/80 border border-white/10",children:e},s)))}),"person"===e.type?e.knownFor&&e.knownFor.length>0&&t.jsxs("div",{className:"mt-2 text-xs text-white/60",children:[t.jsx("span",{className:"text-white/70 font-medium",children:"Known for: "}),e.knownFor.map(((s,a)=>t.jsxs("span",{children:[s.title," (",s.year||"N/A",")",a<e.knownFor.length-1?", ":""]},s.id)))]}):e.overview&&t.jsx("div",{className:"mt-2 text-xs text-white/60 line-clamp-2 leading-relaxed",children:e.overview})]}),t.jsxs("div",{className:"flex items-center gap-1.5 opacity-0 group-hover/item:opacity-100 transition-all duration-300 transform translate-x-2 group-hover/item:translate-x-0 flex-shrink-0",children:[t.jsx(Q.div,{onClick:t=>{t.stopPropagation(),"person"===e.type?o(e):i&&i(e.id)||n(t,e)},className:"relative w-8 h-8 rounded-full flex items-center justify-center transition-all duration-200 cursor-pointer flex-shrink-0 "+("person"===e.type?"bg-blue-500/20 text-blue-300 hover:bg-blue-500/30":i&&i(e.id)?"bg-white/20 text-white":"bg-white/10 text-white/70 hover:bg-white/15"),whileHover:{scale:1.1},whileTap:{scale:.95},children:"person"===e.type?t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),t.jsx("circle",{cx:"12",cy:"7",r:"4"})]}):i&&i(e.id)?t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}):t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})})}),t.jsx(Q.div,{onClick:t=>{t.stopPropagation(),navigator.share&&("person"===e.type?navigator.share({title:e.name,text:`Check out ${e.name} (${e.knownForDepartment})`,url:window.location.href}):navigator.share({title:e.title,text:`Check out ${e.title} (${e.year})`,url:window.location.href}))},className:"relative w-8 h-8 rounded-full bg-white/10 hover:bg-white/15 flex items-center justify-center transition-all duration-200 text-white/70 hover:text-white cursor-pointer flex-shrink-0",whileHover:{scale:1.1},whileTap:{scale:.95},children:t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t.jsx("path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"}),t.jsx("polyline",{points:"16 6 12 2 8 6"}),t.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"15"})]})})]})]},e.id)),((e,t)=>e.movie.id===t.movie.id&&e.index===t.index&&e.selectedIndex===t.selectedIndex&&e.isInWatchlist===t.isInWatchlist));sa.displayName="SearchResultItem";const aa=Object.freeze(Object.defineProperty({__proto__:null,default:({onMovieSelect:s,onCastSelect:a})=>{const r=e.useRef(!0),i=(()=>{const t="undefined"!=typeof window,[s,a]=e.useState(t?window.innerWidth:1200);return e.useEffect((()=>{if(!t)return;let e=null;const s=()=>{e||(e=requestAnimationFrame((()=>{a(window.innerWidth),e=null})))};return window.addEventListener("resize",s,{passive:!0}),()=>{window.removeEventListener("resize",s),e&&cancelAnimationFrame(e)}}),[t]),s})(),o=1450>i,l=1280>i,c=1160>i,[d,u]=e.useState(!1),f=e.useRef(null);e.useMemo((()=>{const e={movies:!0,series:!0,watchlist:!(l||c||c),manga:!c,community:!o,donate:!o&&!l};return[{key:"movies",to:"/movies",label:"Movies"},{key:"series",to:"/series",label:"Series"},{key:"watchlist",to:"/watchlist",label:"My List"},{key:"manga",to:"/manga",label:"Manga"},{key:"community",to:"/community",label:"Community"},{key:"donate",to:"/donate",label:"Support"}].filter((t=>!e[t.key]))}),[i]),e.useEffect((()=>{const e=e=>{d&&f.current&&!f.current.contains(e.target)&&u(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[d]),h();const w=m(),{user:b,logout:v}=Rt(),[y,j]=e.useState(!1),[N,k]=e.useState(!1),[C,S]=e.useState(""),[_,L]=e.useState([]),[T,M]=e.useState(!1),[E,I]=e.useState(!1),[D,R]=e.useState(!1),[z,W]=e.useState(-1),[A,O]=e.useState(!1),[P,F]=e.useState((()=>{const e=localStorage.getItem("searchHistory");return e?JSON.parse(e):[]})),[B,$]=e.useState([]),H=e.useRef(null),V=e.useRef(null),U=e.useRef(null),Y=e.useRef(null),q=e.useRef(null),G=e.useContext(vt),{addToWatchlist:J,removeFromWatchlist:X,isInWatchlist:K}=G||{},[te,se]=e.useState(!1),ae=e.useRef(null),re=e.useRef(null),[ie,ne]=e.useState(!1),oe=e.useRef(""),le=e.useRef(null),{isOpen:ce,closeMenu:de}=(()=>{const[t,s]=e.useState(!1),[a,r]=e.useTransition();return{isOpen:e.useDeferredValue(t),isPending:a,openMenu:e.useCallback((()=>{r((()=>{s(!0)}))}),[r,s]),closeMenu:e.useCallback((()=>{r((()=>{s(!1)}))}),[r,s]),toggleMenu:e.useCallback((()=>{r((()=>{s((e=>!e))}))}),[r,s])}})();e.useMemo((()=>({backdrop:{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeInOut"}},menuContainer:{initial:{opacity:0,height:0,y:-20,scale:.95},animate:{opacity:1,height:"auto",y:0,scale:1},exit:{opacity:0,height:0,y:-20,scale:.95},transition:{duration:.4,ease:[.4,0,.2,1],staggerChildren:.08}},menuItem:{hidden:{opacity:0,x:-20},visible:{opacity:1,x:0},transition:{duration:.4,ease:"easeOut"}},hamburger:{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.2}}})),[]);const ue=ee(),{handleEscapeKey:he,handleTouchStart:me}=(t=>{const s=e.useRef(t);return s.current=t,{handleClickOutside:e.useCallback((e=>{"requestIdleCallback"in window?requestIdleCallback((()=>{s.current()})):setTimeout((()=>{s.current()}),0)}),[]),handleEscapeKey:e.useCallback((e=>{"Escape"===e.key&&s.current()}),[]),handleTouchStart:e.useCallback((e=>{const t=e.touches[0],a=t.clientX,r=t.clientY,i=e=>{const t=e.touches[0],i=t.clientX-a,n=t.clientY-r;Math.abs(i)>100&&50>Math.abs(n)&&(s.current(),o())},n=()=>{o()},o=()=>{document.removeEventListener("touchmove",i),document.removeEventListener("touchend",n)};document.addEventListener("touchmove",i,{passive:!0}),document.addEventListener("touchend",n,{passive:!0})}),[])}})(de);(()=>{const t=e.useMemo((()=>navigator.vibrate&&"getBattery"in navigator?navigator.getBattery().then((e=>e.level>.2)):Promise.resolve(!0)),[]);e.useCallback((async e=>{try{await t&&navigator.vibrate&&navigator.vibrate(e)}catch(s){navigator.vibrate&&navigator.vibrate(e)}}),[t])})(),e.useCallback((e=>{"requestIdleCallback"in window?requestIdleCallback((()=>{const t=document.getElementById("mobile-menu-live-region");t&&(t.textContent=e,setTimeout((()=>{t.textContent=""}),1e3))})):setTimeout((()=>{const t=document.getElementById("mobile-menu-live-region");t&&(t.textContent=e,setTimeout((()=>{t.textContent=""}),1e3))}),0)}),[]),e.useEffect((()=>{localStorage.setItem("searchHistory",JSON.stringify(P))}),[P]),e.useEffect((()=>(r.current=!0,()=>{r.current=!1,L([]),M(!1),I(!1),W(-1),le.current&&(clearTimeout(le.current),le.current=null);try{re?.current&&(Jt(re.current),re.current=null)}catch(e){}})),[]),ea(U,e.useCallback((e=>{const t=document.querySelector("button[data-profile-btn]");!U.current||U.current.contains(e.target)||t&&t.contains(e.target)||j(!1)}),[])),ea(H,e.useCallback((()=>{I(!1),W(-1),k(!1),O(!1)}),[])),e.useEffect((()=>{r.current&&j(!1)}),[w.pathname]),e.useEffect((()=>{if(!te||!r.current)return;const e=e=>{ae.current&&!ae.current.contains(e.target)&&r.current&&se(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[te,se]),e.useEffect((()=>{if(ce&&r.current)return document.addEventListener("keydown",he,{passive:!0}),document.addEventListener("touchstart",me,{passive:!0}),()=>{document.removeEventListener("keydown",he),document.removeEventListener("touchstart",me)}}),[ce,he,me]);const pe=e.useCallback((e=>{const t={content:0,person:0};return e.forEach((e=>{"person"===e.type?t.person++:t.content++})),t}),[]),xe=e.useCallback(((e,t)=>{if(!Array.isArray(e)||!t)return e;const s=t.toLowerCase().trim();if(!s)return e;const a=s.split(/\s+/).filter(Boolean),r=(new Date).getFullYear();return e.map((e=>{const t=(e.title||e.name||"").toLowerCase(),i=(e.overview||"").toLowerCase(),n=(e.original_title||e.original_name||"").toLowerCase(),o=t===s?300:n===s?250:t.replace(/[^\w\s]/g,"")===s.replace(/[^\w\s]/g,"")?200:0,l=150*Zs(s,t),c=120*Zs(s,n),d=30*Zs(s,i),u=((e,t)=>{const s=e.toLowerCase().trim(),a=(t.title||t.name||"").toLowerCase(),r=(t.overview||"").toLowerCase(),i=(t.original_title||t.original_name||"").toLowerCase(),n={action:["fight","battle","war","combat","adventure","thriller","explosion","gun","weapon"],comedy:["funny","laugh","humor","joke","comic","hilarious","amusing"],drama:["emotional","serious","story","character","life","relationship","family"],horror:["scary","frightening","terrifying","monster","ghost","demon","blood","death"],romance:["love","romantic","couple","relationship","dating","marriage","heart"],"sci-fi":["space","future","robot","alien","technology","science","time travel"],fantasy:["magic","wizard","dragon","kingdom","medieval","supernatural","mythical"],thriller:["suspense","mystery","crime","detective","murder","investigation","tension"],documentary:["real","true","history","biography","factual","educational","informative"],anime:["japanese","animation","manga","cartoon","anime","otaku","kawaii"],superhero:["hero","superhero","marvel","dc","comics","powers","villain","save"],netflix:["netflix","original","streaming","series","show"],disney:["disney","family","kids","children","cartoon","animation","princess"],christmas:["christmas","holiday","santa","gift","winter","snow","festive"],halloween:["halloween","spooky","costume","trick","treat","pumpkin","scary"]};let o=0;const l=s.split(/\s+/);l.forEach((e=>{(a.includes(e)||r.includes(e)||i.includes(e))&&(o+=50),Object.entries(n).forEach((([t,s])=>{(e.includes(t)||t.includes(e))&&s.forEach((e=>{(a.includes(e)||r.includes(e))&&(o+=25)}))}))}));const c=t.media_type;if(("movie"===c&&(s.includes("movie")||s.includes("film"))||"tv"===c&&(s.includes("show")||s.includes("series")||s.includes("tv")))&&(o+=30),t.genre_ids&&Array.isArray(t.genre_ids)){const e={28:["action","fight","battle","war","combat"],35:["comedy","funny","laugh","humor"],18:["drama","emotional","serious","story"],27:["horror","scary","frightening","terrifying"],10749:["romance","love","romantic","couple"],878:["sci-fi","space","future","robot","alien"],14:["fantasy","magic","wizard","dragon"],53:["thriller","suspense","mystery","crime"],99:["documentary","real","true","history"]};t.genre_ids.forEach((t=>{(e[t]||[]).forEach((e=>{l.some((t=>t.includes(e)||e.includes(t)))&&(o+=20)}))}))}return Math.min(o,200)})(s,e),h=a.every((e=>t.includes(e))),m=h?80:0,p=a.reduce(((e,s,r)=>{let o=0;const l=t.indexOf(s);return-1!==l&&(o+=50,10>l&&(o+=20),5>l&&(o+=15)),i.includes(s)&&(o+=12,100>i.indexOf(s)&&(o+=8)),n.includes(s)&&(o+=15),r>0&&t.includes(a[r-1]+" "+s)&&(o+=25),e+o}),0),x=t.startsWith(s)?60:t.startsWith(a[0])?30:0,g=t.includes(s)?35:0,f=e.popularity?Math.min(15*Math.log(e.popularity+1),80):0,w=e.release_date||e.first_air_date;let b=0;if(w){const e=new Date(w).getFullYear();if(!isNaN(e)){const t=r-e;b=t>2?t>5?t>10?t>20?Math.max(0,5-Math.floor(t/10)):10:20:30:40}}const v="movie"===e.media_type?15:"tv"===e.media_type?10:0,y=e.poster_path?8:0,j=e.backdrop_path?5:0;let N=0;if(e.vote_average&&e.vote_count){const t=Math.min(e.vote_count/1e3,1);N=Math.min(2*e.vote_average*t,25)}let k=0;if(e.genre_ids&&Array.isArray(e.genre_ids)){const t=[28,12,16,35,80,99,18,10751,14,36,27,10402,9648,10749,878,10770,53,10752,37];k=e.genre_ids.reduce(((e,s)=>e+(t.includes(s)?2:0)),0)}const C="en"===e.original_language?5:0,S=e.origin_country?.includes("US")?3:0,_=o+Math.max(l,c)+d+u+m+p+x+g+f+b+v+y+j+N+k+C+S;return{...e,_relevanceScore:_,_matchDetails:{exactMatch:o>0,allWordsMatch:h,wordCount:a.length,matchedWords:a.filter((e=>t.includes(e))).length}}})).filter((e=>e._relevanceScore>0)).sort(((e,t)=>t._relevanceScore!==e._relevanceScore?t._relevanceScore-e._relevanceScore:(t.popularity||0)-(e.popularity||0)))}),[]),ge=e.useCallback((async e=>{performance.now();const t=e.trim();if(!t)return L([]),void M(!1);const s="search_"+t.toLowerCase(),a=Ks.get(s);if(a)return L(a),M(!1),void performance.now();M(!0);const r=new AbortController;let i=!0;try{if(3>t.length)return L([]),M(!1),void performance.now();const e=await Oe(t,1,{signal:r.signal,includeAdult:!0,language:"en-US"}),a=e&&Array.isArray(e.results)?e.results:[],n=Array.from(new Map(a.map((e=>[`${e.id}_${e.media_type||"unknown"}`,e]))).values()),o=((e,t,s=20)=>{const a=t.toLowerCase(),r=[],i=[],n=[];for(const o of e){if(r.length>=s)break;(o.title||o.name||"").toLowerCase()===a?r.push(o):r.length<s&&i.push(o)}if(r.length+i.length<s)for(const o of e)if(!r.includes(o)&&!i.includes(o)){if(n.length>=s-r.length-i.length)break;n.push(o)}return[...r,...i,...n].slice(0,s)})(xe(n,t),t,25);i&&(L(o),M(!1),Ks.set(s,o),performance.now())}catch(n){if("AbortError"===n.name)return;i&&(L([]),M(!1))}return()=>{i=!1,r.abort()}}),[xe,L,M]),fe=e.useMemo((()=>({search:(e=>{let t=null,s=null;return(...a)=>{s=a,t&&clearTimeout(t);const r=a[0],i=r&&r.length>=4?100:r&&r.length>=2?200:300;t=setTimeout((()=>{e(...s),t=null}),i)}})(ge),cancel:()=>{}})),[ge]),we=e.useCallback((async e=>{const t=e.trim();if(2>t.length)return[];const s="suggestions_"+t.toLowerCase(),a=Qs.get(s);if(a)return a;try{const e=[];for(const s of P){if(e.length>=5)break;const a=Zs(t,s);a>.2&&e.push({text:s,score:a})}const a=e.sort(((e,t)=>t.score-e.score)).slice(0,3).map((e=>e.text)),r=["action","comedy","drama","horror","romance","thriller","sci-fi","superhero","marvel","dc","netflix","disney","anime","documentary","christmas","halloween","war","crime","mystery","fantasy","adventure"].filter((e=>e.toLowerCase().includes(t.toLowerCase()))).slice(0,2),i=["Action Movies","Netflix Originals","Disney Movies","Marvel Movies","Horror Movies","Romantic Comedies","Documentaries","Anime Series"].filter((e=>e.toLowerCase().includes(t.toLowerCase())||t.split(/\s+/).some((t=>e.toLowerCase().includes(t))))).slice(0,2),n=[...new Set([...a,...r,...i])].slice(0,5);return Qs.set(s,n),n}catch(r){return[]}}),[P]);e.useEffect((()=>()=>{fe.cancel&&fe.cancel(),Y?.current&&clearTimeout(Y.current),q?.current&&clearTimeout(q.current)}),[fe]);const be=e.useCallback((async e=>{const t=e.target.value;if(S(t),I(!0),W(-1),!e.nativeEvent||"boolean"!=typeof e.nativeEvent.isComposing||!e.nativeEvent.isComposing){try{re?.current&&(Jt(re.current),re.current=null)}catch(s){}if(re&&(re.current=Gt((()=>{const e=document.getElementById("search-live-region");e&&(t.trim()?e.textContent="Searching for "+t:e.textContent="Search cleared. No results.")}))),Y?.current&&clearTimeout(Y.current),t.trim()){if(M(!0),t.trim().length>=2)try{const e=JSON.parse(localStorage.getItem("searchAnalytics")||"{}"),s=((e,t,s={})=>{const a=e.toLowerCase().trim();if(2>a.length)return[];const r=new Set;return t.forEach((e=>{e.toLowerCase().includes(a)&&e.toLowerCase()!==a&&r.add(e)})),Object.keys(s).forEach((e=>{e.toLowerCase().includes(a)&&e.toLowerCase()!==a&&r.add(e)})),["movies","shows","series","documentaries","anime","comedy","action","drama","horror","romance","thriller","sci-fi","fantasy","netflix","disney","marvel"].forEach((t=>{(t.startsWith(a)||a.includes(t.substring(0,3)))&&r.add(`${e} ${t}`)})),Array.from(r).slice(0,8)})(t,P,e.popularQueries||{});$(s.slice(0,5))}catch(a){}if(t.trim().length>=3){const e="search_"+t.trim().toLowerCase(),s=Ks.get(e);if(s)return L(s),void M(!1)}if(t.trim().length>=1&&4>t.trim().length)try{const e=await we(t);if(e.length>0){const t=e.map(((e,t)=>({id:"suggestion_"+t,title:e,name:e,media_type:"suggestion",isSuggestion:!0})));L(t)}}catch(a){}const e=4>t.trim().length?150:100;Y.current=setTimeout((()=>{fe.search(t)}),e)}else fe.cancel(),L([]),M(!1)}}),[fe,we,S,I,W,L,M]),ve=e.useCallback((e=>{const t=e=>{window.requestIdleCallback?window.requestIdleCallback(e,{timeout:1e3}):setTimeout(e,0)},a=e.title||e.name||"";a&&F((e=>{const s=a.toLowerCase().trim(),r=[a,...e.filter((e=>{const t=e.toLowerCase().trim();return t!==s&&!t.includes(s)&&!s.includes(t)}))].slice(0,10);return t((()=>{try{const t=Date.now(),s="searchHistory_"+t;localStorage.setItem(s,JSON.stringify(r));const a=Object.keys(localStorage).filter((e=>e.startsWith("searchHistory_")));a.length>5&&a.sort().slice(0,-5).forEach((e=>localStorage.removeItem(e)));try{const e=JSON.parse(localStorage.getItem("searchAnalytics")||"{}");e.totalSearches=(e.totalSearches||0)+1,e.lastSearchDate=(new Date).toISOString(),e.lastUpdate=t,localStorage.setItem("searchAnalytics",JSON.stringify(e))}catch(e){}localStorage.setItem("searchHistory",JSON.stringify(r))}catch(t){try{Object.keys(localStorage).filter((e=>e.startsWith("search"))).forEach((e=>localStorage.removeItem(e))),localStorage.setItem("searchHistory",JSON.stringify(r.slice(0,5)))}catch(s){}}})),r}));const r={id:e.id,title:e.title||e.name||"Unknown Title",name:e.name||e.title||"Unknown Title",type:e.media_type||e.type||"movie",poster_path:e.poster_path||e.poster||null,backdrop_path:e.backdrop_path||e.backdrop||null,overview:e.overview||"",year:(e=>{try{return e.release_date?new Date(e.release_date).getFullYear():e.first_air_date?new Date(e.first_air_date).getFullYear():"N/A"}catch(t){return"N/A"}})(e),rating:Math.round(10*(e.vote_average||0))/10,genres:(e=>{let t=[];return Array.isArray(e.genres)&&e.genres.length>0?t=e.genres.map((e=>{if("string"==typeof e)return e.trim();if(e&&"object"==typeof e)try{return(e.name||e.id||"").toString().trim()}catch(t){return(e.name||e.id||"Unknown").trim()}return""})).filter(Boolean):Array.isArray(e.genre_ids)&&(t=e.genre_ids.map((e=>{try{return e.toString()}catch(t){return(e||"")+""}})).filter(Boolean)),t})(e),runtime:e.runtime||null,release_date:e.release_date||e.first_air_date||null,vote_average:Math.round(10*(e.vote_average||0))/10,media_type:e.media_type||e.type||"movie",popularity:e.popularity||0,vote_count:e.vote_count||0,original_language:e.original_language||"en",adult:e.adult||!1,_skipInitialLoad:!0};if(("tv"===r.media_type||"tv"===r.type||e.name&&!e.title)&&(r.media_type="tv",r.type="tv"),S(""),I(!1),L([]),W(-1),k(!1),O(!1),se(!1),s){t((()=>{try{const t=JSON.parse(localStorage.getItem("movieSelectionAnalytics")||"{}");t.totalSelections=(t.totalSelections||0)+1,t.lastSelection={movieId:e.id,title:r.title,timestamp:(new Date).toISOString(),source:"search"},t.selectionsByType=t.selectionsByType||{},t.selectionsByType[r.type]=(t.selectionsByType[r.type]||0)+1,localStorage.setItem("movieSelectionAnalytics",JSON.stringify(t))}catch(t){}}));try{s({...r,_source:"direct",_skipInitialLoad:!0})}catch(i){"function"==typeof s&&s({...r,error:!0})}}t((()=>{try{const t=[()=>document.querySelector("main")?.focus?.(),()=>document.querySelector('[role="main"]')?.focus?.(),()=>document.querySelector(".layout-content-container")?.focus?.(),()=>document.activeElement?.blur?.()];for(const s of t)try{s();break}catch(e){continue}(e=>{const t=document.getElementById("search-live-region")||document.getElementById("aria-live-region");t&&(t.textContent=e,setTimeout((()=>{t.textContent=""}),1e3))})(`Selected ${r.title}. Loading movie details.`)}catch(e){}}))}),[s,F,S,I,L,W,k,F]),ye=e.useCallback((e=>{const t=document.querySelector(`[data-index="${e}"]`);if(!t)return;const s=()=>{try{if("scrollIntoView"in t)t.scrollIntoView({block:"nearest",behavior:"smooth",inline:"nearest"});else if(t.scrollIntoViewIfNeeded)t.scrollIntoViewIfNeeded(!0);else{const e=t.closest(".search-results-container")||t.parentElement;if(e&&e.scrollTo){const s=t.getBoundingClientRect(),a=e.getBoundingClientRect(),r=e.scrollTop+s.top-a.top-10;e.scrollTo({top:r,behavior:"smooth"})}}const s=document.getElementById("search-live-region");if(s){const a=t.querySelector("[data-movie-title]")?.textContent||t.textContent?.trim();s.textContent="Scrolled to "+(a||"item "+(e+1)),setTimeout((()=>{s.textContent=""}),1500)}t.classList.add("scroll-highlight"),setTimeout((()=>{t.classList.remove("scroll-highlight")}),300)}catch(s){t.focus?.()}};re?(re.current=Gt((()=>s())),re.current||setTimeout(s,16)):setTimeout(s,16)}),[]),je=e.useCallback(((e,t,s)=>{let a=e;if(0>s)return-1;if((0>e||e>s)&&(a=t>0?0:s),a+=t,0>a){a=s;const e=document.getElementById("search-live-region");e&&(e.textContent="Wrapped to end of results")}else if(a>s){a=0;const e=document.getElementById("search-live-region");e&&(e.textContent="Wrapped to beginning of results")}return 0>a||a>s?Math.max(0,Math.min(a,s)):a}),[]),Ne=e.useCallback(((e,t,s,a,r)=>{le.current&&(clearTimeout(le.current),le.current=null),oe.current=(oe.current||"")+e.toLowerCase();let i=-1;const n=0>t?0:t;for(let o=n;o<s.length;o++)if((s[o].title||s[o].name||"").toLowerCase().startsWith(oe.current||"")){i=o;break}if(-1===i)for(let o=0;n>o;o++)if((s[o].title||s[o].name||"").toLowerCase().startsWith(oe.current||"")){i=o;break}if(-1!==i){a(i),r(i);const e=document.querySelector(`[data-index="${i}"]`);e&&(e.classList.add("animate-navbar-select"),setTimeout((()=>e.classList.remove("animate-navbar-select")),300))}le.current=setTimeout((()=>{oe.current="",le.current=null}),1e3)}),[]),ke=e.useCallback((e=>{try{re?.current&&(Jt(re.current),re.current=null)}catch(t){}re&&(re.current=Gt((()=>{const t=document.querySelector(`[data-index="${e}"]`);if(!t)return;document.querySelectorAll(".animate-navbar-select").forEach((e=>e.classList.remove("animate-navbar-select"))),t.classList.add("animate-navbar-select");const s=t.querySelector("[data-movie-title]")?.textContent||t.getAttribute("aria-label")||"Item "+(e+1),a=document.getElementById("search-live-region");a&&(a.textContent="Selected: "+s,setTimeout((()=>{a.textContent=""}),300)),navigator.vibrate&&768>=window.innerWidth&&navigator.vibrate(10);const r=()=>t.classList.remove("animate-navbar-select");window.requestIdleCallback?window.requestIdleCallback(r,{timeout:350}):setTimeout(r,300)})))}),[]),Ce=e.useCallback((e=>{if(E&&0!==_.length)switch(e.key){case"ArrowDown":e.preventDefault(),W((e=>{const t=je(0>e?-1:e,1,_.length-1);return ye(t),ke(t),t}));break;case"ArrowUp":e.preventDefault(),W((e=>{const t=je(0>e?_.length:e,-1,_.length-1);return ye(t),ke(t),t}));break;case"Tab":e.shiftKey||(e.preventDefault(),W((e=>{const t=je(0>e?-1:e,1,_.length-1);return ye(t),ke(t),t})));break;case"Home":e.preventDefault(),W((()=>(ye(0),ke(0),0)));break;case"End":e.preventDefault(),W((()=>{const e=_.length-1;return ye(e),ke(e),e}));break;case"Enter":e.preventDefault(),z>=0&&_[z]?ve(_[z]):_.length>0&&ve(_[0]);break;case"Escape":e.preventDefault(),I(!1),W(-1),k(!1),ne(!1),S(""),L([]);break;case"/":(e.ctrlKey||e.metaKey)&&(e.preventDefault(),V.current?.focus());break;case"f":(e.ctrlKey||e.metaKey)&&(e.preventDefault(),ne((e=>!e)));break;case"Backspace":oe.current&&(oe.current="",le.current&&(clearTimeout(le.current),le.current=null));break;default:1===e.key.length&&/^[a-zA-Z0-9\s\-_\.]$/.test(e.key)&&Ne(e.key,z,_,W,ye)}}),[E,_,z,ve,S,L,I,k,W,ye,ke]),Se=e.useCallback((e=>{e&&"function"==typeof e.stopPropagation&&e.stopPropagation(),F([])}),[F]),_e=e.useCallback((async e=>{const t=e=>{window.requestIdleCallback?window.requestIdleCallback(e,{timeout:1e3}):setTimeout(e,0)},s=e?.trim();if(!s)return;S(s),I(!0),k(!0),M(!0),W(-1),t((()=>{try{const e=document.getElementById("search-live-region");e&&(e.textContent=`Searching for ${s} from history`)}catch(e){}}));let a=0,r=!0;const i=async()=>{try{const e=await Oe(s,1);if(!r)return;if(!e||!Array.isArray(e.results))throw Error("Invalid search results format");const a=xe(e.results,s);r&&L(a),t((()=>{try{const e=JSON.parse(localStorage.getItem("searchAnalytics")||"{}");e.historySearches=(e.historySearches||0)+1,e.lastHistorySearch=(new Date).toISOString(),e.popularHistoryQueries=e.popularHistoryQueries||{},e.popularHistoryQueries[s]=(e.popularHistoryQueries[s]||0)+1,localStorage.setItem("searchAnalytics",JSON.stringify(e))}catch(e){}})),t((()=>{try{const e=document.getElementById("search-live-region");if(e){const t=a.length;e.textContent=`Found ${t} result${1!==t?"s":""} for ${s}`}}catch(e){}}))}catch(e){if(2>a&&("NetworkError"===e.name||e.message.includes("network")||e.message.includes("fetch")))return a++,await new Promise((e=>setTimeout(e,1e3*a))),i();r&&L([]),t((()=>{if(r)try{const e=document.getElementById("search-live-region");e&&(e.textContent=`Search failed for ${s}. Please try again.`)}catch(e){}})),(new Date).toISOString(),e.message||(()=>{try{return e.toString()}catch(t){return"Unknown error"}})()}finally{r&&M(!1),t((()=>{if(r)try{const t=[()=>V.current?.focus?.(),()=>document.querySelector('input[type="search"]')?.focus?.(),()=>document.querySelector(".search-input")?.focus?.()];for(const s of t)try{s();break}catch(e){continue}}catch(e){}}))}};return i(),()=>{r=!1}}),[xe,S,I,k,M,L,W,V,F]),Le=e.useCallback((async(e,t)=>{const s=e=>{window.requestIdleCallback?window.requestIdleCallback(e,{timeout:1e3}):setTimeout(e,0)};try{if(e&&"function"==typeof e.stopPropagation&&(e.stopPropagation(),e.preventDefault?.()),!t||"object"!=typeof t)return void(Error("Invalid movie object: must be a non-null object").context={movie:t,type:typeof t});if(!t.id||"number"!=typeof t.id&&"string"!=typeof t.id)return void(Error("Invalid movie ID: must be a number or string").context={movieId:t.id,movieIdType:typeof t.id});if(K&&K(t.id))return s((()=>{try{const e=JSON.parse(localStorage.getItem("watchlistAnalytics")||"{}");e.duplicateAttempts=(e.duplicateAttempts||0)+1,e.lastDuplicateAttempt=(new Date).toISOString(),localStorage.setItem("watchlistAnalytics",JSON.stringify(e))}catch(e){}})),void s((()=>{try{const e=document.getElementById("watchlist-live-region")||document.getElementById("aria-live-region");if(e){const s=t.title||t.name||"This movie";e.textContent=s+" is already in your watchlist",setTimeout((()=>{e.textContent=""}),2e3)}}catch(e){}}));let r=[];Array.isArray(t.genres)?r=t.genres.map((e=>"string"==typeof e?e.trim():e&&"object"==typeof e&&e.name?e.name.trim():null)).filter(Boolean).filter(((e,t,s)=>s.indexOf(e)===t)):Array.isArray(t.genre_ids)&&(r=t.genre_ids.filter((e=>null!=e&&!isNaN(e))).map((e=>{try{return e.toString()}catch(t){return(e||"")+""}})));const i=(t.title||t.name||t.original_title||t.original_name||"Untitled").trim(),n=t.poster_path||t.poster||"",o=t.backdrop_path||t.backdrop||"",l=e=>!!e&&(e.startsWith("/")||e.startsWith("http")||e.startsWith("data:")),c=t.release_date||t.first_air_date||null;let d="N/A",u=!1;if(c)try{const e=new Date(c);isNaN(e.getTime())||(d=e.getFullYear(),u=!0,(new Date).getFullYear())}catch(a){}let h=0;if("number"!=typeof t.vote_average||isNaN(t.vote_average)){if("string"==typeof t.vote_average){const e=parseFloat(t.vote_average);isNaN(e)||(h=Math.max(0,Math.min(10,e)))}}else h=Math.max(0,Math.min(10,t.vote_average));const m={id:t.id,title:i,type:t.media_type||t.type||"movie",poster_path:l(n)?n:"",backdrop_path:l(o)?o:"",overview:(t.overview||"").trim(),year:d,rating:Math.round(10*h)/10,genres:r,release_date:u?c:null,addedAt:(new Date).toISOString(),originalLanguage:t.original_language||t.language||null,popularity:"number"==typeof t.popularity?t.popularity:null,voteCount:"number"==typeof t.vote_count?t.vote_count:null,adult:"boolean"==typeof t.adult&&t.adult,source:"navbar-search",timestamp:Date.now()},p=performance.now();if(!J)return;await Promise.resolve(J(m));const x=performance.now()-p;s((()=>{try{const e=JSON.parse(localStorage.getItem("watchlistAnalytics")||"{}");e.totalAdditions=(e.totalAdditions||0)+1,e.lastAddition=(new Date).toISOString(),e.averageAddTime=e.averageAddTime||0,e.averageAddTime=(e.averageAddTime+x)/2,e.byType=e.byType||{},e.byType[m.type]=(e.byType[m.type]||0)+1,localStorage.setItem("watchlistAnalytics",JSON.stringify(e))}catch(e){}})),s((()=>{try{const e=document.getElementById("watchlist-live-region")||document.getElementById("aria-live-region");e&&(e.textContent=`Added ${i} to your watchlist`,setTimeout((()=>{e.textContent=""}),3e3))}catch(e){}})),s((()=>{try{navigator.vibrate&&768>=window.innerWidth&&navigator.vibrate([50,25,50]);const t=e?.target?.closest("button");t&&(t.classList.add("watchlist-added"),setTimeout((()=>t.classList.remove("watchlist-added")),1e3))}catch(t){}}))}catch(r){(new Date).toISOString(),r.message||(()=>{try{return r.toString()}catch(e){return"Unknown error"}})()}}),[J,K,F]),Te=e.useCallback((e=>{S(""),I(!1),L([]),W(-1),k(!1),O(!1),se(!1),a&&a(e)}),[a,S,I,L,W,k]);return t.jsxs("header",{className:"relative z-[70] flex items-center justify-between whitespace-nowrap border-b border-solid border-b-[#2b3036] px-2 pl-4 py-3 bg-gradient-to-b from-[#23272F]/90 via-[#181A20]/80 to-[#181A20]/70 backdrop-blur-[10px] shadow-xl shadow-black/10 transition-all duration-500",children:[t.jsxs("div",{className:"flex items-center gap-4 sm:gap-6 md:gap-8 flex-shrink-0",children:[t.jsx("div",{className:"flex items-center gap-2 sm:gap-4 text-white",children:t.jsxs(p,{to:"/",className:"flex items-center gap-2 group",children:[t.jsxs("div",{className:"relative",children:[t.jsx(Q.div,{className:"absolute inset-0 rounded-lg bg-gradient-to-br from-white/20 via-white/10 to-white/5 opacity-0 group-hover:opacity-100 transition-opacity duration-300 blur-md",...ue?{}:{animate:{scale:[1,1.1,1],rotate:[0,5,-5,0]},transition:{duration:4,repeat:1/0,ease:"easeInOut",delay:.5}}}),t.jsxs("div",{className:"relative w-8 h-8 rounded-lg bg-gradient-to-br from-white/30 via-white/10 to-white/5 flex items-center justify-center transform transition-all duration-300 group-hover:scale-110 group-hover:rotate-3 group-hover:shadow-[0_0_16px_4px_rgba(255,255,255,0.18)] shadow-lg shadow-black/20",children:[t.jsx(Q.svg,{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-white transform transition-transform duration-300 group-hover:scale-110",...ue?{}:{animate:{scale:[1,1.05,1],rotate:[0,2,-2,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut",delay:1}},children:t.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 4H42V17.3333V30.6667H24V44H6V30.6667V17.3333H24V4Z",fill:"currentColor"})}),t.jsxs(Q.div,{className:"absolute inset-0 pointer-events-none",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.5},children:[t.jsx(Q.div,{className:"absolute top-0 right-0 w-1 h-1 bg-white/40 rounded-full",animate:{x:[0,4,0],y:[0,-4,0],opacity:[.4,.8,.4],scale:[1,1.5,1]},transition:{duration:2.5,repeat:1/0,ease:"easeInOut",delay:.8}}),t.jsx(Q.div,{className:"absolute bottom-0 left-0 w-0.5 h-0.5 bg-white/30 rounded-full",animate:{x:[0,-3,0],y:[0,3,0],opacity:[.3,.6,.3],scale:[1,1.8,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut",delay:1.2}})]})]}),t.jsx(Q.div,{className:"absolute inset-0 rounded-lg border border-white/20 opacity-0 group-hover:opacity-100",...ue?{}:{animate:{scale:[1,1.2,1],opacity:[0,.5,0]},transition:{duration:2,repeat:1/0,ease:"easeInOut",delay:.3}}})]}),t.jsx(Q.span,{className:"text-xl font-bold bg-gradient-to-r from-white to-white/80 bg-clip-text text-transparent tracking-tight group-hover:from-white group-hover:to-white/90 transition-all duration-300",animate:{backgroundPosition:["0% 50%","100% 50%","0% 50%"]},transition:{duration:4,repeat:1/0,ease:"easeInOut",delay:.5},style:{backgroundSize:"200% 200%"},children:"Streamr"}),t.jsxs(Q.div,{className:"absolute left-0 top-0 pointer-events-none",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:1},children:[t.jsx(Q.div,{className:"absolute -top-2 left-8 w-1 h-1 bg-white/30 rounded-full",animate:{y:[0,-8,0],opacity:[.3,.8,.3],scale:[1,1.5,1]},transition:{duration:3,repeat:1/0,ease:"easeInOut",delay:1.5}}),t.jsx(Q.div,{className:"absolute -top-1 left-12 w-0.5 h-0.5 bg-white/20 rounded-full",animate:{y:[0,-6,0],opacity:[.2,.6,.2],scale:[1,1.8,1]},transition:{duration:2.5,repeat:1/0,ease:"easeInOut",delay:2}})]})]})}),t.jsxs("div",{className:"hidden sm:flex items-center gap-4 md:gap-6 lg:gap-8 ml-2",children:[t.jsxs(p,{to:"/movies",className:`relative ${"/movies"===w.pathname?"text-white":"text-white/80 hover:text-white"} transition-all duration-300 group`,onMouseEnter:()=>{try{const e=navigator.connection||navigator.mozConnection||navigator.webkitConnection,t=e&&(e.saveData||!1),s=e&&e.effectiveType;if(t||s&&/(^2g$|^slow-2g$|^3g$)/i.test(s))return}catch(e){}et((()=>import("./pages-C-U6PHgK.js").then((e=>e.M))),__vite__mapDeps([6,3,2,1,4,0,5,7,8]),import.meta.url)},children:[t.jsxs("span",{className:"relative z-10 flex items-center gap-1.5",children:[t.jsxs("div",{className:`relative w-5 h-5 sm:w-6 sm:h-6 rounded-lg ${"/movies"===w.pathname?"bg-white/10":"bg-white/5 group-hover:bg-white/10"} flex items-center justify-center transition-all duration-300 shadow-sm shadow-black/10`,children:[t.jsx(Q.div,{className:`absolute inset-0 rounded-lg ${"/movies"===w.pathname?"bg-white/20":"bg-white/10"} opacity-0 group-hover:opacity-100 transition-opacity duration-300 blur-sm`,animate:{scale:[1,1.1,1],opacity:"/movies"===w.pathname?[.2,.4,.2]:[0,.2,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut",delay:.2}}),t.jsx(Q.svg,{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 sm:h-3.5 sm:w-3.5 transform transition-transform duration-300 group-hover:scale-110 relative z-10",viewBox:"0 0 24 24",fill:"/movies"===w.pathname?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",animate:{scale:[1,1.05,1],rotate:"/movies"===w.pathname?[0,2,-2,0]:[0,0,0,0]},transition:{duration:2.5,repeat:1/0,ease:"easeInOut",delay:.5},children:"/movies"===w.pathname?t.jsxs(t.Fragment,{children:[t.jsx("path",{d:"M18 4l2 4h-3l-2-4h-2l2 4h-3l-2-4H8l2 4H7L5 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4h-4z"}),t.jsx("path",{d:"M8 12h8v2H8z"}),")"]}):t.jsxs(t.Fragment,{children:[t.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),t.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),t.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),t.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),t.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),t.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),t.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"}),t.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),")"]})}),"/movies"===w.pathname&&t.jsxs(Q.div,{className:"absolute inset-0 pointer-events-none",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[t.jsx(Q.div,{className:"absolute top-0 right-0 w-0.5 h-0.5 bg-white/40 rounded-full",animate:{x:[0,2,0],y:[0,-2,0],opacity:[.4,.8,.4],scale:[1,1.5,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut",delay:.8}}),t.jsx(Q.div,{className:"absolute bottom-0 left-0 w-0.5 h-0.5 bg-white/30 rounded-full",animate:{x:[0,-2,0],y:[0,2,0],opacity:[.3,.6,.3],scale:[1,1.8,1]},transition:{duration:2.5,repeat:1/0,ease:"easeInOut",delay:1.2}})]})]}),t.jsx("span",{className:"font-medium tracking-wide text-sm sm:text-base",children:"Movies"})]}),t.jsx("span",{className:"absolute -bottom-1 left-0 h-0.5 bg-gradient-to-r from-white/90 via-white/60 to-white/30 transition-all duration-500 "+("/movies"===w.pathname?"w-full":"w-0 group-hover:w-full")})]}),t.jsxs(p,{to:"/series",className:`relative ${"/series"===w.pathname?"text-white":"text-white/80 hover:text-white"} transition-all duration-300 group`,onMouseEnter:()=>{try{const e=navigator.connection||navigator.mozConnection||navigator.webkitConnection,t=e&&(e.saveData||!1),s=e&&e.effectiveType;if(t||s&&/(^2g$|^slow-2g$|^3g$)/i.test(s))return}catch(e){}et((()=>import("./pages-C-U6PHgK.js").then((e=>e.S))),__vite__mapDeps([6,3,2,1,4,0,5,7,8]),import.meta.url)},children:[t.jsxs("span",{className:"relative z-10 flex items-center gap-1.5",children:[t.jsxs("div",{className:`relative w-5 h-5 sm:w-6 sm:h-6 rounded-lg ${"/series"===w.pathname?"bg-white/10":"bg-white/5 group-hover:bg-white/10"} flex items-center justify-center transition-all duration-300 shadow-sm shadow-black/10`,children:[t.jsx(Q.div,{className:`absolute inset-0 rounded-lg ${"/series"===w.pathname?"bg-white/20":"bg-white/10"} opacity-0 group-hover:opacity-100 transition-opacity duration-300 blur-sm`,animate:{scale:[1,1.1,1],opacity:"/series"===w.pathname?[.2,.4,.2]:[0,.2,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut",delay:.3}}),t.jsxs(Q.svg,{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 sm:h-3.5 sm:w-3.5 transform transition-transform duration-300 group-hover:scale-110 relative z-10",viewBox:"0 0 24 24",fill:"/series"===w.pathname?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",animate:{scale:[1,1.05,1],rotate:"/series"===w.pathname?[0,2,-2,0]:[0,0,0,0]},transition:{duration:2.5,repeat:1/0,ease:"easeInOut",delay:.6},children:[t.jsx("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2",ry:"2"}),t.jsx("line",{x1:"8",y1:"21",x2:"16",y2:"21"}),t.jsx("line",{x1:"12",y1:"17",x2:"12",y2:"21"})]}),"/series"===w.pathname&&t.jsxs(Q.div,{className:"absolute inset-0 pointer-events-none",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[t.jsx(Q.div,{className:"absolute top-0 right-0 w-0.5 h-0.5 bg-white/40 rounded-full",animate:{x:[0,2,0],y:[0,-2,0],opacity:[.4,.8,.4],scale:[1,1.5,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut",delay:.9}}),t.jsx(Q.div,{className:"absolute bottom-0 left-0 w-0.5 h-0.5 bg-white/30 rounded-full",animate:{x:[0,-2,0],y:[0,2,0],opacity:[.3,.6,.3],scale:[1,1.8,1]},transition:{duration:2.5,repeat:1/0,ease:"easeInOut",delay:1.3}})]})]}),t.jsx("span",{className:"font-medium tracking-wide text-sm sm:text-base",children:"Series"})]}),t.jsx("span",{className:"absolute -bottom-1 left-0 h-0.5 bg-gradient-to-r from-white/90 via-white/60 to-white/30 transition-all duration-500 "+("/series"===w.pathname?"w-full":"w-0 group-hover:w-full")})]}),t.jsxs(p,{to:"/watchlist",className:`relative ${"/watchlist"===w.pathname?"text-white":"text-white/80 hover:text-white"} transition-all duration-300 group`,children:[t.jsxs("span",{className:"relative z-10 flex items-center gap-1.5",children:[t.jsxs("div",{className:`relative w-5 h-5 sm:w-6 sm:h-6 rounded-lg ${"/watchlist"===w.pathname?"bg-white/10":"bg-white/5 group-hover:bg-white/10"} flex items-center justify-center transition-all duration-300 shadow-sm shadow-black/10`,children:[t.jsx(Q.div,{className:`absolute inset-0 rounded-lg ${"/watchlist"===w.pathname?"bg-white/20":"bg-white/10"} opacity-0 group-hover:opacity-100 transition-opacity duration-300 blur-sm`,animate:{scale:[1,1.1,1],opacity:"/watchlist"===w.pathname?[.2,.4,.2]:[0,.2,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut",delay:.5}}),t.jsx(Q.svg,{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 sm:h-3.5 sm:w-3.5 transform transition-transform duration-300 group-hover:scale-110 relative z-10",viewBox:"0 0 24 24",fill:"/watchlist"===w.pathname?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",animate:{scale:[1,1.05,1],rotate:"/watchlist"===w.pathname?[0,2,-2,0]:[0,0,0,0]},transition:{duration:2.5,repeat:1/0,ease:"easeInOut",delay:.8},children:t.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"/watchlist"===w.pathname&&t.jsxs(Q.div,{className:"absolute inset-0 pointer-events-none",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[t.jsx(Q.div,{className:"absolute top-0 right-0 w-0.5 h-0.5 bg-white/40 rounded-full",animate:{x:[0,2,0],y:[0,-2,0],opacity:[.4,.8,.4],scale:[1,1.5,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut",delay:1.1}}),t.jsx(Q.div,{className:"absolute bottom-0 left-0 w-0.5 h-0.5 bg-white/30 rounded-full",animate:{x:[0,-2,0],y:[0,2,0],opacity:[.3,.6,.3],scale:[1,1.8,1]},transition:{duration:2.5,repeat:1/0,ease:"easeInOut",delay:1.5}})]})]}),t.jsx("span",{className:"font-medium tracking-wide text-sm sm:text-base",children:"My List"})]}),t.jsx("span",{className:"absolute -bottom-1 left-0 h-0.5 bg-gradient-to-r from-white/90 via-white/60 to-white/30 transition-all duration-500 "+("/watchlist"===w.pathname?"w-full":"w-0 group-hover:w-full")})]}),t.jsxs(p,{to:"/manga",className:`relative ${"/manga"===w.pathname?"text-white":"text-white/80 hover:text-white"} transition-all duration-300 group`,onMouseEnter:()=>{try{const e=navigator.connection||navigator.mozConnection||navigator.webkitConnection,t=e&&(e.saveData||!1),s=e&&e.effectiveType;if(t||s&&/(^2g$|^slow-2g$|^3g$)/i.test(s))return}catch(e){}et((()=>import("./pages-C-U6PHgK.js").then((e=>e.c))),__vite__mapDeps([6,3,2,1,4,0,5,7,8]),import.meta.url)},children:[t.jsxs("span",{className:"relative z-10 flex items-center gap-1.5",children:[t.jsxs("div",{className:`relative w-5 h-5 sm:w-6 sm:h-6 rounded-lg ${"/manga"===w.pathname?"bg-white/10":"bg-white/5 group-hover:bg-white/10"} flex items-center justify-center transition-all duration-300 shadow-sm shadow-black/10`,children:[t.jsx(Q.div,{className:`absolute inset-0 rounded-lg ${"/movies"===w.pathname?"bg-white/20":"bg-white/10"} opacity-0 group-hover:opacity-100 transition-opacity duration-300 blur-sm`,animate:{scale:[1,1.1,1],opacity:"/movies"===w.pathname?[.2,.4,.2]:[0,.2,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut",delay:.2}}),"/manga"===w.pathname?t.jsx(x,{className:"h-3 w-3 sm:h-3.5 sm:w-3.5 text-white group-hover:text-white transition-colors duration-300 relative z-10"}):t.jsx(g,{className:"h-3 w-3 sm:h-3.5 sm:w-3.5 text-white/80 group-hover:text-white transition-colors duration-300 relative z-10"}),"/manga"===w.pathname&&t.jsxs(Q.div,{className:"absolute inset-0 pointer-events-none",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[t.jsx(Q.div,{className:"absolute top-0 right-0 w-0.5 h-0.5 bg-white/40 rounded-full",animate:{x:[0,2,0],y:[0,-2,0],opacity:[.4,.8,.4],scale:[1,1.5,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut",delay:.8}}),t.jsx(Q.div,{className:"absolute bottom-0 left-0 w-0.5 h-0.5 bg-white/30 rounded-full",animate:{x:[0,-2,0],y:[0,2,0],opacity:[.3,.6,.3],scale:[1,1.8,1]},transition:{duration:2.5,repeat:1/0,ease:"easeInOut",delay:1.2}})]})]}),t.jsx("span",{className:"font-medium tracking-wide text-sm sm:text-base",children:"Manga"})]}),t.jsx("span",{className:"absolute -bottom-1 left-0 h-0.5 bg-gradient-to-r from-white/90 via-white/60 to-white/30 transition-all duration-500 "+("/manga"===w.pathname?"w-full":"w-0 group-hover:w-full")})]}),t.jsxs(p,{to:"/community",className:`relative ${"/community"===w.pathname?"text-white":"text-white/80 hover:text-white"} transition-all duration-300 group`,onMouseEnter:()=>{try{const e=navigator.connection||navigator.mozConnection||navigator.webkitConnection,t=e&&(e.saveData||!1),s=e&&e.effectiveType;if(t||s&&/(^2g$|^slow-2g$|^3g$)/i.test(s))return}catch(e){}et((()=>import("./pages-C-U6PHgK.js").then((e=>e.C))),__vite__mapDeps([6,3,2,1,4,0,5,7,8]),import.meta.url)},children:[t.jsxs("span",{className:"relative z-10 flex items-center gap-1.5",children:[t.jsxs("div",{className:`relative w-5 h-5 sm:w-6 sm:h-6 rounded-lg ${"/community"===w.pathname?"bg-white/10":"bg-white/5 group-hover:bg-white/10"} flex items-center justify-center transition-all duration-300 shadow-sm shadow-black/10`,children:[t.jsx(Q.div,{className:`absolute inset-0 rounded-lg ${"/community"===w.pathname?"bg-white/20":"bg-white/10"} opacity-0 group-hover:opacity-100 transition-opacity duration-300 blur-sm`,animate:{scale:[1,1.1,1],opacity:"/community"===w.pathname?[.2,.4,.2]:[0,.2,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut",delay:.4}}),t.jsx(Q.svg,{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 sm:h-3.5 sm:w-3.5 transform transition-transform duration-300 group-hover:scale-110 relative z-10",viewBox:"0 0 24 24",fill:"/community"===w.pathname?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",animate:{scale:[1,1.05,1],rotate:"/community"===w.pathname?[0,2,-2,0]:[0,0,0,0]},transition:{duration:2.5,repeat:1/0,ease:"easeInOut",delay:.7},children:t.jsx("path",{d:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10z"})}),"/community"===w.pathname&&t.jsxs(Q.div,{className:"absolute inset-0 pointer-events-none",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[t.jsx(Q.div,{className:"absolute top-0 right-0 w-0.5 h-0.5 bg-white/40 rounded-full",animate:{x:[0,2,0],y:[0,-2,0],opacity:[.4,.8,.4],scale:[1,1.5,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut",delay:1}}),t.jsx(Q.div,{className:"absolute bottom-0 left-0 w-0.5 h-0.5 bg-white/30 rounded-full",animate:{x:[0,-2,0],y:[0,2,0],opacity:[.3,.6,.3],scale:[1,1.8,1]},transition:{duration:2.5,repeat:1/0,ease:"easeInOut",delay:1.4}})]})]}),t.jsx("span",{className:"font-medium tracking-wide text-sm sm:text-base",children:"Community"})]}),t.jsx("span",{className:"absolute -bottom-1 left-0 h-0.5 bg-gradient-to-r from-white/90 via-white/60 to-white/30 transition-all duration-500 "+("/community"===w.pathname?"w-full":"w-0 group-hover:w-full")})]}),t.jsxs(p,{to:"/donate",className:`relative ${"/donate"===w.pathname?"text-white":"text-white/80 hover:text-white"} transition-all duration-300 group`,children:[t.jsxs("span",{className:"relative z-10 flex items-center gap-1.5",children:[t.jsx("div",{className:`relative w-5 h-5 sm:w-6 sm:h-6 rounded-lg ${"/donate"===w.pathname?"bg-white/10":"bg-white/5 group-hover:bg-white/10"} flex items-center justify-center transition-all duration-300 shadow-sm shadow-black/10`,children:t.jsx("svg",{className:"h-3 w-3 sm:h-3.5 sm:w-3.5 transform transition-transform duration-300 group-hover:scale-110 relative z-10",viewBox:"0 0 24 24",fill:"/donate"===w.pathname?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:t.jsx("path",{d:"M12.001 4.529c2.349-2.532 6.213-2.532 8.562 0 2.348 2.531 2.348 6.635 0 9.166l-7.07 7.622a2.1 2.1 0 01-3 0l-7.07-7.622c-2.348-2.531-2.348-6.635 0-9.166 2.349-2.532 6.213-2.532 8.562 0l1.016 1.095 1-1.095z"})})}),t.jsx("span",{className:"font-medium tracking-wide text-sm sm:text-base",children:"Support"})]}),t.jsx("span",{className:"absolute -bottom-1 left-0 h-0.5 bg-gradient-to-r from-white/90 via-white/60 to-white/30 transition-all duration-500 "+("/donate"===w.pathname?"w-full":"w-0 group-hover:w-full")})]})]})]}),t.jsxs("div",{className:"hidden sm:flex flex-1 justify-end items-center gap-2 sm:gap-3 md:gap-4 mr-2",children:[t.jsxs("button",{type:"button","aria-label":"Open search",onClick:()=>{O(!0),I(!0),k(!0),setTimeout((()=>V.current?.focus?.()),0)},className:"group relative inline-flex items-center justify-center w-11 h-11 rounded-full bg-[#2b3036] hover:bg-[#323840] border border-white/10 text-white/80 hover:text-white transition-colors overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 rounded-full bg-white/90 opacity-0 group-hover:opacity-100 transition-all duration-300 ease-out transform scale-0 group-hover:scale-100 origin-center"}),t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 256 256",fill:"currentColor",className:"relative z-10 transition-all duration-200 group-hover:scale-110 group-hover:text-black",children:t.jsx("path",{d:"M229.66,218.34l-50.07-50.06a88.11,88.11,0,1,0-11.31,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z"})})]}),n.createPortal(t.jsx(Z,{children:A&&t.jsx(Q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.25,ease:"easeInOut"},className:"fixed inset-0 z-[50] hidden sm:block bg-black/40 backdrop-blur-sm",onClick:()=>{O(!1),I(!1),k(!1)}})}),document.body),A&&n.createPortal(t.jsxs("div",{ref:H,className:"fixed top-[140px] left-1/2 transform -translate-x-1/2 w-[90vw] sm:w-[80vw] md:w-[60vw] lg:w-[50vw] xl:w-[40vw] max-w-[1100px] z-[60] transition-all duration-300 ease-out group",children:[t.jsx(Q.div,{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-white/8 via-white/15 to-white/8 opacity-0 group-hover:opacity-100 transition-opacity duration-300 blur-md",animate:{scale:[1,1.02,1],opacity:N?[.15,.25,.15]:[0,.12,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut",delay:.2}}),t.jsx("label",{className:"flex flex-col !h-12",children:t.jsxs("div",{className:"flex w-full flex-1 items-stretch rounded-full h-full relative overflow-hidden bg-[#1a1d21]/95 backdrop-blur-2xl border border-white/20",children:[t.jsxs("div",{className:"text-[#a1abb5] flex border-none items-center justify-center pl-4 pr-2 rounded-l-full border-r-0 relative transition-colors duration-300",children:[t.jsx(Q.svg,{xmlns:"http://www.w3.org/2000/svg",width:"20px",height:"20px",fill:"currentColor",viewBox:"0 0 256 256",className:"group-hover:text-white/90 transition-colors duration-300",animate:{scale:[1,1.05,1],rotate:N?[0,2,-2,0]:[0,0,0,0]},transition:{duration:2.5,repeat:1/0,ease:"easeInOut",delay:.5},children:t.jsx("path",{d:"M229.66,218.34l-50.07-50.06a88.11,88.11,0,1,0-11.31,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z"})}),t.jsxs(Q.div,{className:"absolute inset-0 pointer-events-none",initial:{opacity:0},animate:{opacity:N?1:0},transition:{duration:.5},children:[t.jsx(Q.div,{className:"absolute top-0 right-0 w-1 h-1 bg-white/30 rounded-full",animate:{x:[0,3,0],y:[0,-3,0],opacity:[.3,.6,.3],scale:[1,1.5,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut",delay:.8}}),t.jsx(Q.div,{className:"absolute bottom-0 left-0 w-0.5 h-0.5 bg-white/20 rounded-full",animate:{x:[0,-2,0],y:[0,2,0],opacity:[.2,.5,.2],scale:[1,1.8,1]},transition:{duration:2.5,repeat:1/0,ease:"easeInOut",delay:1.2}})]})]}),t.jsx("input",{ref:V,id:"global-search",name:"global-search",value:C,onChange:be,onKeyDown:Ce,onFocus:()=>{k(!0),I(!0)},placeholder:"Search movies, TV shows, cast...",className:"form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl rounded-r-full text-white focus:outline-0 focus:ring-0 border-none bg-transparent focus:border-none h-full placeholder:text-[#a1abb5] placeholder:group-hover:text-white/60 placeholder:focus:text-white/60 px-4 rounded-l-none border-l-0 pl-3 pr-10 text-base font-normal leading-normal relative z-10 transition-all duration-300"}),C&&t.jsx(Q.button,{initial:{opacity:0,scale:.8,x:10},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.8,x:10},onClick:()=>{S(""),L([]),I(!1),V.current?.focus()},className:"absolute right-3 top-0 bottom-0 my-auto w-7 h-7 rounded-full bg-white/15 hover:bg-white/25 flex items-center justify-center transition-all duration-300 z-20 group/clear border border-white/20 hover:border-white/30 shadow-sm hover:shadow-md",whileHover:{scale:1.15,rotate:90,transition:{duration:.2}},whileTap:{scale:.9,transition:{duration:.1}},title:"Clear search",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 text-white/70 group-hover/clear:text-white/90 transition-all duration-200",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:t.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})}),t.jsx(Q.div,{className:"absolute inset-0 rounded-full opacity-0",animate:{scale:[1,1.02,1],opacity:N?[0,.4,0]:[0,0,0]},transition:{duration:2,repeat:1/0,ease:"easeInOut",delay:.3}}),t.jsx("div",{className:"absolute inset-0 rounded-full border border-white/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})}),t.jsx(Z,{children:E&&t.jsxs(Q.div,{initial:{opacity:0,y:-8,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.98},transition:{type:"spring",stiffness:200,damping:25,duration:.2},className:"absolute top-full left-0 right-0 mt-3 text-white/90 bg-[#1a1d21]/95 backdrop-blur-2xl border border-white/20 rounded-2xl z-50 shadow-2xl shadow-black/50 overflow-hidden",style:{maxHeight:"calc(100vh - 200px)",minHeight:"200px"},children:[t.jsx("div",{id:"search-live-region","aria-live":"polite",className:"sr-only"}),t.jsxs("div",{className:"sticky top-0 p-4 border-b border-white/15 flex items-center justify-between bg-[#1a1d21]/95 backdrop-blur-sm z-10",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-white/80",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),t.jsx("h3",{className:"text-white font-semibold",children:"Search Results"})]}),t.jsxs("div",{className:"flex items-center gap-2 text-sm text-white/60",children:[t.jsx("span",{children:T?"Searching...":(()=>{const e=pe(_),t=[e.content>0?e.content+" content":"",e.person>0?e.person+" cast":""].filter(Boolean);return`${_.length} results (${t.join(", ")})`})()}),t.jsx("span",{children:"•"}),t.jsx("span",{children:"Press Enter to select"})]})]}),!C&&P.length>0&&t.jsxs("div",{className:"sticky top-14 p-4 border-b border-white/15 bg-[#1a1d21]/90 z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("h4",{className:"text-white/90 font-medium",children:"Recent Searches"}),t.jsx("button",{onClick:e=>Se(e),className:"text-white/50 hover:text-white/70 text-xs transition-colors",children:"Clear"})]}),t.jsx("div",{className:"flex flex-wrap gap-2",children:P.map(((e,s)=>t.jsxs("button",{onClick:()=>_e(e),className:"relative px-3 py-1.5 bg-white/90 rounded-full text-black text-xs transition-all duration-200 ease-out flex items-center gap-2 border border-white/20 group overflow-hidden hover:scale-105",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e]},s)))})]}),!C&&0===P.length&&t.jsxs("div",{className:"py-8 text-center",children:[t.jsx(Q.div,{className:"w-16 h-16 mx-auto mb-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:"easeOut"},children:t.jsx("div",{className:"w-full h-full bg-white/5 rounded-full border border-white/10 flex items-center justify-center",children:t.jsx("svg",{className:"w-8 h-8 text-white/60",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})}),t.jsx(Q.h3,{className:"text-white/80 mb-3 text-lg font-medium",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.4,ease:"easeOut"},children:"Start searching"}),t.jsx(Q.div,{className:"text-white/50 text-sm max-w-xs mx-auto leading-relaxed",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.4,ease:"easeOut"},children:"Find movies, TV shows, and cast members"})]}),t.jsx("div",{className:"overflow-y-auto overflow-x-hidden max-h-[60vh] scrollbar-thin scrollbar-thumb-white/20 scrollbar-track-transparent",children:T?t.jsx("div",{className:"divide-y divide-white/10",role:"listbox",children:[...[,,,]].map(((e,s)=>t.jsxs(Q.div,{className:"w-full p-4 flex items-start gap-4 transition-all duration-200 rounded-xl relative",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:[t.jsx("div",{className:"w-20 h-28 flex-shrink-0 relative overflow-hidden rounded-xl bg-white/8 border border-white/15 shadow-lg",children:t.jsx("div",{className:"w-full h-full bg-gradient-to-br from-white/10 via-white/5 to-white/10"})}),t.jsx("div",{className:"flex-1 min-w-0 relative z-10",children:t.jsxs("div",{className:"flex items-start justify-between gap-4",children:[t.jsxs("div",{className:"flex flex-col flex-1 items-start gap-2.5",children:[t.jsx("div",{className:"h-6 w-3/4 rounded bg-white/10"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"h-4 w-8 rounded bg-white/10"}),t.jsx("div",{className:"h-4 w-1 rounded-full bg-white/10"}),t.jsx("div",{className:"h-4 w-16 rounded bg-white/10"}),t.jsx("div",{className:"h-4 w-1 rounded-full bg-white/10"}),t.jsx("div",{className:"h-4 w-12 rounded bg-white/10 flex items-center gap-1",children:t.jsx("div",{className:"w-3 h-3 rounded bg-yellow-400/30"})})]}),t.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[t.jsx("div",{className:"h-6 w-16 rounded-full bg-white/10"}),t.jsx("div",{className:"h-6 w-20 rounded-full bg-white/10"}),t.jsx("div",{className:"h-6 w-14 rounded-full bg-white/10"})]}),t.jsxs("div",{className:"mt-3 space-y-2",children:[t.jsx("div",{className:"h-4 w-full rounded bg-white/10"}),t.jsx("div",{className:"h-4 w-2/3 rounded bg-white/10"})]})]}),t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/10"}),t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/10"})]})]})})]},s)))}):C.trim()?t.jsxs(t.Fragment,{children:[B.length>0&&C.trim().length>=2&&t.jsxs("div",{className:"px-4 py-2 border-b border-white/10",children:[t.jsx("div",{className:"text-xs text-white/60 mb-2",children:"Suggestions:"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:B.slice(0,4).map(((e,s)=>t.jsx("button",{onClick:()=>{S(e),$([]),V.current?.focus()},className:"px-3 py-1 text-sm bg-white/10 hover:bg-white/20 rounded-full transition-colors duration-200 text-white/80 hover:text-white",children:e},s)))})]}),_.length>0?t.jsx("div",{className:"divide-y divide-white/10",role:"listbox",children:_.map(((e,s)=>t.jsx(sa,{movie:e,index:s,selectedIndex:z,onSelect:ve,isInWatchlist:K,onAddToWatchlist:Le,onCastSelect:Te,handleSearchQuery:S,debouncedSearch:fe},e.id)))}):t.jsxs(Q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:"easeOut"},className:"text-center py-16",children:[t.jsx(Q.div,{className:"w-16 h-16 mx-auto mb-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.4,ease:"easeOut"},children:t.jsx("div",{className:"w-full h-full bg-white/5 rounded-full border border-white/10 flex items-center justify-center",children:t.jsx("svg",{className:"w-8 h-8 text-white/50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M9.172 16.172a4 4 0 015.656 0M9 12h6m-6-4h6m2 5.291A7.962 7.962 0 0112 15c-2.34 0-4.47-.881-6.08-2.33"})})})}),t.jsx(Q.h3,{className:"text-white/80 mb-3 text-lg font-medium",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.4,ease:"easeOut"},children:"No results found"}),t.jsx(Q.div,{className:"text-white/50 mb-6 text-sm max-w-sm mx-auto",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3,duration:.4,ease:"easeOut"},children:"Try different keywords or check your spelling"}),t.jsx(Q.div,{className:"max-w-md mx-auto space-y-3",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4,duration:.4,ease:"easeOut"},children:t.jsxs("div",{className:"flex items-center justify-center gap-6 text-xs text-white/40",children:[t.jsx("span",{children:"• Try synonyms"}),t.jsx("span",{children:"• Check spelling"}),t.jsx("span",{children:"• Use keywords"})]})}),3>C.length&&t.jsx(Q.div,{className:"mt-6 text-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5,duration:.4,ease:"easeOut"},children:t.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-2 bg-white/5 rounded-lg border border-white/10",children:[t.jsx("svg",{className:"w-4 h-4 text-white/40",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{className:"text-white/50 text-xs",children:"Use at least 3 characters"})]})})]})]}):null})]})})]}),document.body),t.jsx("div",{className:"flex items-center gap-2 sm:gap-3 md:gap-4",children:t.jsxs(Q.div,{layout:!0,className:"relative",children:[t.jsx(Z,{mode:"wait",children:b?t.jsx(Q.button,{layout:!0,initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},transition:{type:"spring",stiffness:200,damping:20},onClick:()=>j(!y),className:"flex items-center gap-2 focus:outline-none group relative","data-profile-btn":!0,children:t.jsxs(Q.div,{layout:!0,className:"relative w-8 h-8 sm:w-10 sm:h-10 rounded-full bg-gradient-to-br from-white/20 to-white/10 flex items-center justify-center text-white font-semibold text-base sm:text-lg shadow-lg hover:shadow-white/10 transition-all duration-300 group-hover:scale-105",whileHover:{scale:1.05},whileTap:{scale:.95},children:[b?.profilePicture?t.jsx("img",{src:b.profilePicture.startsWith("http")?b.profilePicture:`${Xs}${b.profilePicture}`,alt:"User Avatar",className:"w-full h-full object-cover rounded-full"}):t.jsx("span",{className:"relative z-10",children:b?.name?b.name[0].toUpperCase():"U"}),t.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-white/30 to-white/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),t.jsx("div",{className:"absolute inset-0 rounded-full ring-2 ring-white/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),t.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-white/40 to-white/20 opacity-0 group-hover:opacity-100 blur transition-all duration-300"})]})},"profile"):t.jsxs(Q.div,{layout:!0,initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},transition:{type:"spring",stiffness:200,damping:20},className:"flex items-center gap-2 sm:gap-4",children:[t.jsxs(p,{to:"/login",className:"relative px-3 sm:px-4 md:px-5 py-2 sm:py-2 text-white/90 hover:text-white transition-all duration-300 group rounded-full bg-white/5 ring-1 ring-white/10 hover:ring-white/20 shadow-sm hover:shadow-white/10 backdrop-blur-sm overflow-hidden",children:[t.jsx("div",{className:"absolute left-1 top-1/2 -translate-y-1/2 w-8 h-8 rounded-full bg-white/90 opacity-0 group-hover:opacity-100 transition-all duration-300 ease-out transform scale-0 group-hover:scale-[7] origin-center"}),t.jsxs("span",{className:"relative z-10 flex items-center gap-2 font-medium text-sm sm:text-base group-hover:text-black transition-colors duration-200",children:[t.jsxs("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[t.jsx("path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"}),t.jsx("polyline",{points:"10 17 15 12 10 7"}),t.jsx("line",{x1:"15",y1:"12",x2:"3",y2:"12"})]}),"Sign In"]})]}),t.jsxs(p,{to:"/signup",className:"relative px-3 sm:px-4 md:px-6 py-2 sm:py-2.5 text-white font-medium transition-all duration-300 group md:hidden",children:[t.jsx("span",{className:"relative z-10 text-sm sm:text-base",children:"Sign Up"}),t.jsx("span",{className:"absolute inset-0 bg-gradient-to-r from-white/20 to-white/10 rounded-full transition-all duration-300 group-hover:from-white/30 group-hover:to-white/20 group-hover:shadow-lg group-hover:shadow-white/10 group-hover:scale-105"}),t.jsx("span",{className:"absolute inset-0 bg-gradient-to-r from-white/20 to-white/10 rounded-full opacity-0 group-hover:opacity-100 blur transition-all duration-300"}),t.jsx("span",{className:"absolute inset-0 border border-white/20 rounded-full opacity-0 group-hover:opacity-100 transition-all duration-300 group-hover:scale-105"})]})]},"auth-buttons")}),t.jsx(Z,{children:y&&t.jsxs(t.Fragment,{children:[t.jsx(Q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 z-[9998]",onClick:()=>j(!1)}),t.jsxs(Q.div,{ref:U,initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},transition:{type:"spring",stiffness:200,damping:20},className:"absolute right-0 mt-2 w-72 sm:w-80 bg-[#1a1a1a]/95 backdrop-blur-md rounded-xl shadow-2xl border border-white/10 overflow-hidden z-50 sm:right-0 right-4 hidden md:block",children:[t.jsx("div",{className:"p-5 border-b border-white/10 bg-gradient-to-b from-white/5 to-transparent",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-14 h-14 rounded-full bg-gradient-to-br from-white/20 to-white/10 flex items-center justify-center text-white font-semibold text-2xl shadow-lg ring-2 ring-white/10",children:b?.profilePicture?t.jsx("img",{src:b.profilePicture.startsWith("http")?b.profilePicture:`${Xs}${b.profilePicture}`,alt:"User Avatar",className:"w-full h-full object-cover rounded-full"}):t.jsx("span",{children:b?.name?b.name[0].toUpperCase():"U"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-white font-medium text-lg",children:b?.name||"User"}),t.jsx("p",{className:"text-white/60 text-sm mt-0.5",children:b?.email})]})]})}),t.jsxs("div",{className:"py-2",children:[t.jsxs(p,{to:"/profile",className:"flex items-center gap-3 px-5 py-3 text-white/80 hover:text-white hover:bg-white/5 transition-all duration-200 group",onClick:()=>j(!1),children:[t.jsx("div",{className:"w-8 h-8 rounded-lg bg-white/5 flex items-center justify-center group-hover:bg-white/10 transition-colors duration-200",children:t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 transform transition-transform duration-200 group-hover:scale-110",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),t.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),t.jsx("span",{className:"flex-1 font-medium",children:"Profile"})]}),t.jsxs(p,{to:"/watchlist",className:"flex items-center gap-3 px-5 py-3 text-white/80 hover:text-white hover:bg-white/5 transition-all duration-200 group",onClick:()=>j(!1),children:[t.jsx("div",{className:"w-8 h-8 rounded-lg bg-white/5 flex items-center justify-center group-hover:bg-white/10 transition-colors duration-200",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 transform transition-transform duration-200 group-hover:scale-110",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})})}),t.jsx("span",{className:"flex-1 font-medium",children:"My List"})]}),t.jsxs(p,{to:"/donate",className:"flex items-center gap-3 px-5 py-3 text-white/80 hover:text-white hover:bg-white/5 transition-all duration-200 group",onClick:()=>j(!1),children:[t.jsx("div",{className:"w-8 h-8 rounded-lg bg-white/5 flex items-center justify-center group-hover:bg-white/10 transition-colors duration-200",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 transform transition-transform duration-200 group-hover:scale-110",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t.jsx("path",{d:"M12.001 4.529c2.349-2.532 6.213-2.532 8.562 0 2.348 2.531 2.348 6.635 0 9.166l-7.07 7.622a2.1 2.1 0 01-3 0l-7.07-7.622c-2.348-2.531-2.348-6.635 0-9.166 2.349-2.532 6.213-2.532 8.562 0l1.016 1.095 1-1.095z"})})}),t.jsx("span",{className:"flex-1 font-medium",children:"Support"})]}),t.jsx("div",{className:"h-px bg-white/10 my-2"}),t.jsxs("button",{onClick:()=>{v(),j(!1)},className:"flex items-center gap-3 px-5 py-3 text-white/80 hover:text-white hover:bg-white/5 transition-all duration-200 w-full text-left group",children:[t.jsx("div",{className:"w-8 h-8 rounded-lg bg-white/5 flex items-center justify-center group-hover:bg-white/10 transition-colors duration-200",children:t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 transform transition-transform duration-200 group-hover:scale-110",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),t.jsx("polyline",{points:"16 17 21 12 16 7"})]})}),t.jsx("span",{className:"flex-1 font-medium",children:"Logout"})]})]})]})]})})]})})]}),t.jsx("div",{className:"flex items-center gap-2 ml-auto md:hidden",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Q.button,{onClick:()=>se(!0),className:"w-10 h-10 flex items-center justify-center text-white/70 hover:text-white hover:bg-white/5 rounded-full transition-all duration-200","aria-label":"Open search",whileHover:{scale:1.1},whileTap:{scale:.95},children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),t.jsxs("div",{className:"relative",children:[t.jsx(Q.button,{onClick:()=>j(!y),className:"relative z-[10000] w-10 h-10 rounded-full flex items-center justify-center text-white/80 hover:text-white transition-all duration-200 "+(y?"bg-white/20 ring-2 ring-white/30":"bg-white/10 hover:bg-white/15"),"aria-label":y?"Close menu":"Open menu","aria-expanded":y,"data-profile-btn":!0,whileHover:{scale:1.1},whileTap:{scale:.95},children:b?b?.profilePicture?t.jsx("img",{src:b.profilePicture.startsWith("http")?b.profilePicture:`${Xs}${b.profilePicture}`,alt:"User Avatar",className:"w-full h-full object-cover rounded-full"}):t.jsx("span",{className:"text-sm font-medium",children:b?.name?b.name.charAt(0).toUpperCase():b?.email?.charAt(0).toUpperCase()||"U"}):t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 7h16M4 12h16M4 17h16"})})}),t.jsx(Z,{children:y&&t.jsx(Q.div,{initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},transition:{type:"spring",stiffness:300,damping:25},className:"absolute right-0 top-full mt-2 w-52 max-w-[85vw] bg-[#0f1216]/95 backdrop-blur-md rounded-2xl shadow-xl border border-white/10 overflow-hidden z-[9999] md:hidden",onClick:e=>e.stopPropagation(),ref:U,children:t.jsx("div",{className:"py-1",children:b?t.jsxs(t.Fragment,{children:[t.jsxs(p,{to:"/profile",className:"flex items-center gap-2.5 px-3 py-2 text-white/80 hover:text-white hover:bg-white/5 transition-colors duration-150 text-sm",onClick:()=>j(!1),children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",children:[t.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),t.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),t.jsx("span",{className:"font-medium",children:"Profile"})]}),t.jsxs(p,{to:"/watchlist",className:"flex items-center gap-2.5 px-3 py-2 text-white/80 hover:text-white hover:bg-white/5 transition-colors duration-150 text-sm",onClick:()=>j(!1),children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",children:t.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),t.jsx("span",{className:"font-medium",children:"My List"})]}),t.jsxs(p,{to:"/donate",className:"flex items-center gap-2.5 px-3 py-2 text-white/80 hover:text-white hover:bg-white/5 transition-colors duration-150 text-sm",onClick:()=>j(!1),children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",children:t.jsx("path",{d:"M12.001 4.529c2.349-2.532 6.213-2.532 8.562 0 2.348 2.531 2.348 6.635 0 9.166l-7.07 7.622a2.1 2.1 0 01-3 0l-7.07-7.622c-2.348-2.531-2.348-6.635 0-9.166 2.349-2.532 6.213-2.532 8.562 0l1.016 1.095 1-1.095z"})}),t.jsx("span",{className:"font-medium",children:"Support"})]}),t.jsxs("button",{onClick:()=>{v(),j(!1)},className:"w-full flex items-center gap-2.5 px-3 py-2 text-white/80 hover:text-white hover:bg-white/5 transition-colors duration-150 text-sm text-left",children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",children:[t.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),t.jsx("polyline",{points:"16 17 21 12 16 7"})]}),t.jsx("span",{className:"font-medium",children:"Logout"})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs(p,{to:"/login",className:"flex items-center gap-2.5 px-3 py-2 text-white/80 hover:text-white hover:bg-white/5 transition-colors duration-150 text-sm",onClick:()=>j(!1),children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",children:[t.jsx("path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"}),t.jsx("polyline",{points:"10 17 15 12 10 7"}),t.jsx("line",{x1:"15",y1:"12",x2:"3",y2:"12"})]}),t.jsx("span",{className:"font-medium",children:"Sign in"})]}),t.jsxs(p,{to:"/signup",className:"flex items-center gap-2.5 px-3 py-2 text-white/80 hover:text-white hover:bg-white/5 transition-colors duration-150 text-sm",onClick:()=>j(!1),children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",children:t.jsx("path",{d:"M12 4v16m8-8H4"})}),t.jsx("span",{className:"font-medium",children:"Sign up"})]}),t.jsxs(p,{to:"/donate",className:"flex items-center gap-2.5 px-3 py-2 text-white/80 hover:text-white hover:bg-white/5 transition-colors duration-150 text-sm",onClick:()=>j(!1),children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",children:t.jsx("path",{d:"M12.001 4.529c2.349-2.532 6.213-2.532 8.562 0 2.348 2.531 2.348 6.635 0 9.166l-7.07 7.622a2.1 2.1 0 01-3 0l-7.07-7.622c-2.348-2.531-2.348-6.635 0-9.166 2.349-2.532 6.213-2.532 8.562 0l1.016 1.095 1-1.095z"})}),t.jsx("span",{className:"font-medium",children:"Support"})]})]})})})})]})]})}),t.jsx(Z,{mode:"wait",children:te&&t.jsx(Q.div,{ref:ae,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:"easeInOut"},className:"fixed inset-0 z-[90000] md:hidden search-overlay","data-search-element":"true",onClick:e=>{e.target===e.currentTarget&&(se(!1),R(!1),I(!1))},children:t.jsx(Q.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},transition:{duration:.2,ease:"easeOut"},className:"absolute top-20 left-4 right-4 search-results","data-search-element":"true",children:t.jsx(Q.div,{initial:{scale:.98,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.98,opacity:0},transition:{duration:.2,ease:"easeOut"},className:"relative",children:t.jsxs(Q.div,{className:"relative bg-[#1a1d21]/95 backdrop-blur-2xl rounded-2xl border border-white/20 p-4 shadow-2xl shadow-black/50 search-content","data-search-element":"true",onClick:e=>{e.stopPropagation()},whileHover:{scale:1.005},transition:{duration:.15},children:[t.jsxs(Q.div,{initial:{opacity:0,x:-5},animate:{opacity:1,x:0},transition:{duration:.2,ease:"easeOut"},className:"flex items-center gap-3 mb-4",children:[t.jsx(Q.div,{className:"w-10 h-10 rounded-full bg-white/15 flex items-center justify-center",whileHover:{scale:1.02,rotate:2},whileTap:{scale:.98},transition:{duration:.15},children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-white/80",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),t.jsx("span",{className:"text-white/90 font-medium text-lg",children:"Search Movies, TV Shows & Cast"})]}),t.jsxs(Q.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},transition:{duration:.2,ease:"easeOut"},className:"relative",children:[t.jsx("input",{ref:V,type:"text",placeholder:"Search for movies, TV shows, cast members...",value:C,onChange:be,onKeyDown:Ce,onFocus:()=>{k(!0),I(!0),R(!0)},onBlur:e=>{te?(k(!1),I(!0)):setTimeout((()=>{e.relatedTarget&&e.relatedTarget.closest(".search-results-container")||(k(!1),I(!1))}),100)},className:"w-full bg-white/10 border border-white/30 rounded-full px-4 py-[0.5rem] pr-12 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/40 transition-all duration-300 search-input","data-search-element":"true",autoFocus:!0}),C&&t.jsx(Q.div,{className:"absolute right-3 top-0 bottom-0 flex items-center z-10",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.15,ease:"easeOut"},children:t.jsx(Q.div,{onClick:e=>{e.preventDefault(),e.stopPropagation(),S(""),V.current&&V.current.focus()},onMouseDown:e=>{e&&"function"==typeof e.preventDefault&&e.preventDefault(),e&&"function"==typeof e.stopPropagation&&e.stopPropagation()},onTouchStart:e=>{e&&"function"==typeof e.stopPropagation&&e.stopPropagation()},className:"w-7 h-7 rounded-full bg-white/20 flex items-center justify-center hover:bg-white/30 transition-colors duration-200 cursor-pointer select-none search-clear-button","data-search-element":"true",whileHover:{scale:1.02},whileTap:{scale:.98},transition:{duration:.1},children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-white/70",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})})]}),t.jsx(Z,{mode:"sync",children:(E||D)&&t.jsxs(Q.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2,ease:"easeInOut"},className:"mt-4 search-results-container","data-search-element":"true",children:[!C&&P.length>0&&t.jsxs(Q.div,{initial:{opacity:0,y:3},animate:{opacity:1,y:0},exit:{opacity:0,y:3},transition:{duration:.2,ease:"easeOut"},className:"mb-4 search-history","data-search-element":"true",onClick:e=>{e&&"function"==typeof e.stopPropagation&&e.stopPropagation()},children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("h4",{className:"text-white/90 font-medium text-sm",children:"Recent Searches"}),t.jsx("button",{onClick:e=>{e&&(e.preventDefault(),e.stopPropagation()),Se(e)},onMouseDown:e=>{e&&"function"==typeof e.stopPropagation&&e.stopPropagation()},onTouchStart:e=>{e&&"function"==typeof e.stopPropagation&&e.stopPropagation()},className:"text-white/50 hover:text-white/70 text-xs transition-colors search-clear-history","data-search-element":"true",children:"Clear"})]}),t.jsx("div",{className:"flex flex-wrap gap-2",children:P.map(((e,s)=>t.jsxs(Q.button,{onClick:t=>{t&&(t.preventDefault(),t.stopPropagation()),_e(e)},onMouseDown:e=>{e&&"function"==typeof e.stopPropagation&&e.stopPropagation()},onTouchStart:e=>{e&&"function"==typeof e.stopPropagation&&e.stopPropagation()},className:"relative px-3 py-1.5 bg-white/90 rounded-full text-black text-xs transition-all duration-200 ease-out flex items-center gap-2 border border-white/20 search-history-item group overflow-hidden","data-search-element":"true",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.15,delay:.02*s,ease:"easeOut"},whileHover:{scale:1.05},whileTap:{scale:.99},children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e]},s)))})]}),!C&&0===P.length&&t.jsxs(Q.div,{initial:{opacity:0,y:3},animate:{opacity:1,y:0},exit:{opacity:0,y:3},transition:{duration:.2,ease:"easeOut"},className:"text-center py-3",onClick:e=>{e&&"function"==typeof e.stopPropagation&&e.stopPropagation()},children:[t.jsx(Q.div,{className:"w-14 h-14 mx-auto mb-5",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:"easeOut"},children:t.jsx("div",{className:"w-full h-full bg-white/5 rounded-full border border-white/10 flex items-center justify-center",children:t.jsx("svg",{className:"w-7 h-7 text-white/60",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})}),t.jsx(Q.h3,{className:"text-white/80 mb-3 text-base font-medium",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.4,ease:"easeOut"},children:"Start searching"}),t.jsx(Q.div,{className:"text-white/50 text-sm max-w-xs mx-auto leading-relaxed",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.4,ease:"easeOut"},children:"Find movies, TV shows, and cast members"})]}),T&&t.jsx(Q.div,{initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.98},transition:{duration:.2,ease:"easeOut"},className:"flex justify-center items-center py-8",onClick:e=>{e&&"function"==typeof e.stopPropagation&&e.stopPropagation()},children:t.jsx("div",{className:"w-8 h-8 border-4 border-white/20 border-t-white rounded-full animate-spin"})}),C.trim()&&!T&&t.jsx(Q.div,{initial:{opacity:0,y:3},animate:{opacity:1,y:0},exit:{opacity:0,y:3},transition:{duration:.2,ease:"easeOut"},className:"max-h-96 overflow-y-auto overflow-x-hidden search-results-list","data-search-element":"true",onClick:e=>{e&&"function"==typeof e.stopPropagation&&e.stopPropagation()},children:_.length>0?t.jsx("div",{className:"divide-y divide-white/10",role:"listbox",children:_.map(((e,s)=>t.jsxs(Q.button,{"data-index":s,onClick:t=>{t&&(t.preventDefault(),t.stopPropagation()),e.isSuggestion?(S(e.title),fe.search(e.title)):"person"===e.type?(Te(e),se(!1),R(!1),I(!1)):(ve(e),se(!1),R(!1),I(!1))},onMouseDown:e=>{e&&"function"==typeof e.stopPropagation&&e.stopPropagation()},onTouchStart:e=>{e&&"function"==typeof e.stopPropagation&&e.stopPropagation()},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"w-full p-4 px-0 flex items-start gap-4 transition-all duration-200 rounded-xl group/item focus:outline-none relative "+(s===z?"border-l-4 border-white/40 bg-gradient-to-r from-white/15 to-white/5 shadow-lg shadow-black/30":"hover:bg-white/8"),tabIndex:0,"aria-selected":s===z,role:"option",style:{zIndex:s===z?2:1},children:[s===z&&t.jsx(Q.div,{className:"absolute left-0 top-0 bottom-0 w-1.5 bg-white/80 rounded-r-lg",initial:{scaleY:0},animate:{scaleY:1},exit:{scaleY:0},transition:{duration:.18},style:{zIndex:3}}),t.jsx("div",{className:"w-20 h-28 flex-shrink-0 relative group/image overflow-hidden rounded-xl bg-white/8 border border-white/15 shadow-lg",children:t.jsx(ta,{src:e.image||e.poster_path?Pt(e.poster_path||e.image,"w185"):"",alt:"person"===e.type?e.name:e.title,className:"w-full h-full",fallbackIcon:"person"===e.type?"person":"movie"})}),t.jsxs("div",{className:"flex-1 min-w-0 relative z-10",children:[t.jsxs("div",{className:"flex items-start justify-between gap-4",children:[t.jsxs("div",{className:"flex flex-col flex-1 items-start gap-2.5",children:[t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("h3",{className:"text-white font-semibold truncate text-base md:text-lg leading-tight",children:"person"===e.type?e.name:e.title})}),t.jsxs("div",{className:"flex items-center gap-2 text-white/70 text-xs md:text-sm",children:["person"===e.type?t.jsxs(t.Fragment,{children:[t.jsx("span",{children:e.knownForDepartment}),e.popularity>0&&t.jsxs(t.Fragment,{children:[t.jsx("span",{children:"•"}),t.jsxs("span",{className:"inline-flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3 text-yellow-400 inline",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.286 3.967a1 1 0 00.95.69h4.178c.969 0 1.371 1.24.588 1.81l-3.286 2.46a1 1 0 00-.364 1.118l1.287 3.966c.3.922-.755 1.688-1.54 1.118l-3.385-2.46a1 1 0 00-1.175 0l-3.385 2.46c-.784.57-1.838-.196-1.54-1.118l1.287-3.966c.3.922-.755 1.688-1.54 1.118l-3.385-2.46c-.783-.57-.38-1.81.588-1.81h4.178a1 1 0 00.95-.69l1.286-3.967z"})}),Math.round(e.popularity)]})]})]}):t.jsxs(t.Fragment,{children:[t.jsx("span",{children:e.year}),t.jsx("span",{children:"•"}),t.jsx("span",{children:"tv"===e.type?"TV Show":"Movie"})]}),"person"!==e.type&&e.rating>0&&t.jsxs(t.Fragment,{children:[t.jsx("span",{children:"•"}),t.jsxs("span",{className:"inline-flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3 text-yellow-400 inline",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.286 3.967a1 1 0 00.95.69h4.178c.969 0 1.371 1.24.588 1.81l-3.385 2.46a1 1 0 00-.364 1.118l1.287 3.966c.3.922-.755 1.688-1.54 1.118l-3.385-2.46a1 1 0 00-1.175 0l-3.385 2.46c-.784.57-1.838-.196-1.54-1.118l1.287-3.966a1 1 0 00-.364-1.118l-3.385-2.46c-.783-.57-.38-1.81.588-1.81h4.178a1 1 0 00.95-.69l1.286-3.967z"})}),pt(e.rating)]})]})]})]}),t.jsxs("div",{className:"flex items-center gap-1.5 transition-all duration-300",children:[t.jsxs(Q.div,{onClick:t=>{t&&"function"==typeof t.stopPropagation&&t.stopPropagation(),"person"===e.type?Te(e):K&&K(e.id)?X&&X(e.id):Le(t,e)},onMouseDown:e=>{e&&"function"==typeof e.stopPropagation&&e.stopPropagation()},onTouchStart:e=>{e&&"function"==typeof e.stopPropagation&&e.stopPropagation()},className:`relative w-7 h-7 rounded-lg flex items-center justify-center transition-all duration-200 cursor-pointer group/btn\n                                              ${"person"===e.type?"bg-blue-500/20 text-blue-300 hover:bg-blue-500/30 hover:text-blue-200":K&&K(e.id)?"bg-white/20 text-white":"bg-white/10 text-white/70 hover:bg-white/15 hover:text-white"}\n                                            `,title:"person"===e.type?"View profile":K&&K(e.id)?"Remove from watchlist":"Add to watchlist",whileHover:{scale:1.1},whileTap:{scale:.95},children:[t.jsx("div",{className:"relative z-10",children:"person"===e.type?t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),t.jsx("circle",{cx:"12",cy:"7",r:"4"})]}):K&&K(e.id)?t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}):t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})})}),"person"!==e.type&&K&&K(e.id)&&t.jsx(Q.div,{className:"absolute inset-0 rounded-lg bg-white/10",initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.2}})]}),t.jsx(Q.div,{onClick:t=>{t&&"function"==typeof t.stopPropagation&&t.stopPropagation(),navigator.share?"person"===e.type?navigator.share({title:e.name,text:`Check out ${e.name} (${e.knownForDepartment})`,url:window.location.href}):navigator.share({title:e.title,text:`Check out ${e.title} (${e.year})`,url:window.location.href}):"person"===e.type?navigator.clipboard.writeText(`${e.name} (${e.knownForDepartment}) - ${window.location.href}`):navigator.clipboard.writeText(`${e.title} (${e.year}) - ${window.location.href}`)},onMouseDown:e=>{e&&"function"==typeof e.stopPropagation&&e.stopPropagation()},onTouchStart:e=>{e&&"function"==typeof e.stopPropagation&&e.stopPropagation()},className:"relative w-7 h-7 rounded-lg bg-white/10 hover:bg-white/15 flex items-center justify-center transition-all duration-200 text-white/70 hover:text-white cursor-pointer group/share",title:"Share",whileHover:{scale:1.1},whileTap:{scale:.95},children:t.jsx("div",{className:"relative z-10",children:t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t.jsx("path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"}),t.jsx("polyline",{points:"16 6 12 2 8 6"}),t.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"15"})]})})})]})]}),t.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:e.genres?.slice(0,2).map(((e,s)=>t.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-white/10 text-white/80 border border-white/10",children:e},s)))}),"person"===e.type?e.knownFor&&e.knownFor.length>0&&t.jsxs("div",{className:"mt-3 text-xs text-white/60",children:[t.jsx("span",{className:"text-white/70 font-medium",children:"Known for: "}),e.knownFor.map(((s,a)=>t.jsxs("span",{children:[s.title," (",s.year||"N/A",")",a<e.knownFor.length-1?", ":""]},s.id)))]}):e.overview&&t.jsx("div",{className:"mt-3 text-xs text-white/60 line-clamp-2 leading-relaxed",children:e.overview})]})]},e.id)))}):t.jsxs(Q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:"easeOut"},className:"text-center py-12",children:[t.jsx(Q.div,{className:"w-14 h-14 mx-auto mb-5",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.4,ease:"easeOut"},children:t.jsx("div",{className:"w-full h-full bg-white/5 rounded-full border border-white/10 flex items-center justify-center",children:t.jsx("svg",{className:"w-7 h-7 text-white/50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M9.172 16.172a4 4 0 015.656 0M9 12h6m-6-4h6m2 5.291A7.962 7.962 0 0112 15c-2.34 0-4.47-.881-6.08-2.33"})})})}),t.jsx(Q.h3,{className:"text-white/80 mb-3 text-base font-medium",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.4,ease:"easeOut"},children:"No results found"}),t.jsx(Q.div,{className:"text-white/50 mb-5 text-sm max-w-xs mx-auto",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3,duration:.4,ease:"easeOut"},children:"Try different keywords or check your spelling"}),t.jsx(Q.div,{className:"space-y-2 max-w-xs mx-auto",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4,duration:.4,ease:"easeOut"},children:t.jsxs("div",{className:"flex items-center justify-center gap-4 text-xs text-white/40",children:[t.jsx("span",{children:"• Try synonyms"}),t.jsx("span",{children:"• Check spelling"})]})}),3>C.length&&t.jsx(Q.div,{className:"mt-5 text-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5,duration:.4,ease:"easeOut"},children:t.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-2 bg-white/5 rounded-lg border border-white/10",children:[t.jsx("svg",{className:"w-3 h-3 text-white/40",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{className:"text-white/50 text-xs",children:"Use at least 3 characters"})]})})]})})]})})]})})})})})]})}},Symbol.toStringTag,{value:"Module"})),ra=({isLoading:s,error:a,retryCount:r=0,onRetry:i,context:n="content",showNetworkStatus:o=!0,className:l="",hasContent:c=!1})=>{const[d,u]=e.useState(Pe.createLoadingIndicatorState()),[h,m]=e.useState("fast");e.useEffect((()=>Pe.monitorNetworkStatus((e=>{m(e)}))),[]),e.useEffect((()=>{const e=Pe.updateLoadingIndicator(d,r,Pe.retryConfig.maxRetries,h);u(e)}),[r,h]);return!s||a||c?a?((e=>{if(!e)return"";if("string"==typeof e)return e;if(e instanceof Error&&"string"==typeof e.message)return e.message;if("string"==typeof e.message)return e.message;try{return JSON.stringify(e)}catch{return e+""}})(a),t.jsxs(Q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"flex flex-col items-center justify-center py-16 text-center "+l,children:[t.jsx("div",{className:"relative mb-6",children:t.jsx("div",{className:"w-16 h-16 border-2 border-white/20 rounded-full flex items-center justify-center",children:t.jsx("svg",{className:"w-8 h-8 text-white/60",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})})}),t.jsxs("div",{className:"max-w-md mb-8",children:[t.jsxs("h3",{className:"text-xl font-light text-white/90 mb-3 tracking-wide",children:["Unable to Load ",n]}),t.jsx("p",{className:"text-white/60 text-sm leading-relaxed font-light",children:Pe.getErrorMessage(a,n)})]}),o&&d.showNetworkStatus&&t.jsx(Q.div,{className:"mb-6 px-4 py-2 bg-white/5 border border-white/10 rounded-lg",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:t.jsx("p",{className:"text-sm text-white/50 font-light",children:d.networkStatusText})}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-6",children:[d.showRetryButton&&t.jsxs(Q.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:async()=>{if(i)try{await i()}catch(e){}},disabled:!d.canRetry,className:"px-8 py-3 bg-white/10 hover:bg-white/20 disabled:bg-white/5 disabled:text-white/30 text-white font-light rounded-lg transition-all duration-200 flex items-center justify-center space-x-2 border border-white/20 hover:border-white/30",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),t.jsx("span",{children:d.retryButtonText})]}),t.jsxs(Q.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>window.location.reload(),className:"px-8 py-3 bg-white/5 hover:bg-white/10 text-white/80 font-light rounded-lg transition-all duration-200 flex items-center justify-center space-x-2 border border-white/10 hover:border-white/20",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),t.jsx("span",{children:"Refresh Page"})]})]}),r>0&&t.jsxs(Q.p,{className:"text-xs text-white/40 font-light",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:["Attempted ",r," time",1!==r?"s":""," to load ",n]})]})):s&&c?t.jsx(Q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex items-center justify-center py-8 "+l,children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsxs("div",{className:"flex space-x-1",children:[t.jsx(Q.div,{className:"w-2 h-2 bg-white/40 rounded-full",animate:{opacity:[.4,1,.4]},transition:{duration:1.4,repeat:1/0,delay:0}}),t.jsx(Q.div,{className:"w-2 h-2 bg-white/40 rounded-full",animate:{opacity:[.4,1,.4]},transition:{duration:1.4,repeat:1/0,delay:.2}}),t.jsx(Q.div,{className:"w-2 h-2 bg-white/40 rounded-full",animate:{opacity:[.4,1,.4]},transition:{duration:1.4,repeat:1/0,delay:.4}})]}),t.jsx("span",{className:"text-white/50 text-sm font-light",children:"Loading more..."})]})}):null:t.jsxs(Q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex flex-col items-center justify-center py-16 "+l,children:[t.jsxs("div",{className:"relative mb-6",children:[t.jsx("div",{className:"w-16 h-16 border-2 border-white/20 rounded-full animate-spin"}),t.jsx("div",{className:"absolute inset-2 w-12 h-12 border-2 border-transparent border-t-white rounded-full animate-spin",style:{animationDirection:"reverse",animationDuration:"1.5s"}}),t.jsx("div",{className:"absolute inset-6 w-4 h-4 bg-white rounded-full animate-pulse"})]}),t.jsxs("div",{className:"text-center space-y-2",children:[t.jsxs("p",{className:"text-white/80 text-lg font-light tracking-wide",children:["Loading ",n]}),d.showNetworkStatus&&t.jsx("p",{className:"text-white/50 text-sm font-light",children:d.networkStatusText})]}),"fast"!==h&&t.jsx(Q.div,{className:"mt-6 w-32 h-px bg-white/10 overflow-hidden rounded-full",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:t.jsx(Q.div,{className:"h-full bg-white/60 rounded-full",initial:{width:0},animate:{width:"100%"},transition:{duration:3,repeat:1/0,ease:"easeInOut"}})})]})},ia=({className:s=""})=>{const[a,r]=e.useState("fast"),[i,n]=e.useState(!1);e.useEffect((()=>Pe.monitorNetworkStatus((e=>{r(e),n("fast"!==e)}))),[]);const o=Pe.getNetworkStatusBadge(a);return o&&i?t.jsx(Z,{children:t.jsx(Q.div,{initial:{opacity:0,y:-20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.9},transition:{duration:.3,ease:"easeOut"},className:"fixed top-4 right-4 z-50 "+s,children:t.jsx("div",{className:"px-4 py-2 rounded-lg border backdrop-blur-sm "+o.color,children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-pulse"}),t.jsx("span",{className:"text-xs font-light",children:o.text})]})})})}):null},na=({options:s=[],selectedValue:a=null,onSelect:r,placeholder:i="Select option",searchable:n=!1,multiSelect:o=!1,maxHeight:l="60vh",className:c="",disabled:d=!1,icon:u=null,showClear:h=!0,groupBy:m=null,renderOption:p=null,renderSelected:x=null,onSearch:g=null,searchPlaceholder:f="Search...",emptyMessage:w="No options found",loading:b=!1,error:v=null,closeOnSelect:y=!0,virtualized:j=!1,debounceSearch:N=300,highlightMatches:k=!0,sortOptions:C=!1,allowCustomValue:S=!1,maxSelections:_=null,position:L="bottom",align:T="left",portal:M=!1,onOpen:E=null,onClose:I=null,onChange:D=null,filterFunction:R=null,caseSensitive:z=!1,minSearchLength:W=0,showSelectAll:A=!1,keepSearchOnSelect:O=!1,autoFocus:P=!1,validateSelection:F=null,customStyles:B={},badges:$=!1,size:H="medium"})=>{const[V,U]=e.useState(!1),[Y,q]=e.useState(""),[G,J]=e.useState(-1),[X,K]=e.useState({top:0,left:0,width:0}),[ee,te]=e.useState(null),se=e.useRef(null),ae=e.useRef(null),re=e.useRef([]),ie=e.useRef(null),ne=e.useRef(null),oe=e.useId(),le=oe+"-listbox",ce=e.useCallback((e=>null==e?null:"string"==typeof e||"number"==typeof e?e:e.value??e.id??e),[]),de=e.useCallback((e=>null==e?"":"string"==typeof e||"number"==typeof e?e+"":(e.label??e.name??e.title??e.value??e.id??e)+""),[]),ue=e.useCallback(((e,t)=>{const s=de(e),a=z?s:s.toLowerCase(),r=z?t:t.toLowerCase();if(!k)return a.includes(r);let i=0;for(let n=0;n<a.length&&i<r.length;n++)a[n]===r[i]&&i++;return i===r.length}),[z,k,de]),he=e.useMemo((()=>{if(!n||Y.trim().length<W)return s;const e=Y.trim(),t=R||ue,a=s.filter((s=>t(s,e)));return C&&e?a.sort(((t,s)=>{const a=de(t),r=de(s),i=a.toLowerCase().indexOf(e.toLowerCase()),n=r.toLowerCase().indexOf(e.toLowerCase());return 0===i&&0!==n?-1:0===n&&0!==i?1:i!==n?i-n:a.localeCompare(r)})):a}),[s,Y,n,W,R,ue,C,de]),me=e.useMemo((()=>{if(!m)return null;const e={};return he.forEach((t=>{const s="function"==typeof m?m(t):t[m]||"Other";e[s]||(e[s]=[]),e[s].push(t)})),Object.keys(e).sort().reduce(((t,s)=>(t[s]=e[s],t)),{})}),[he,m]),pe=e.useCallback((e=>o&&Array.isArray(a)?a.some((t=>ce(t)===ce(e))):!!a&&ce(a)===ce(e)),[o,a,ce]),xe=e.useCallback((e=>{if(F){const t=F(e);if(!0!==t)return te("string"==typeof t?t:"Invalid selection"),!1}return te(null),!0}),[F]),ge=e.useCallback((e=>{if(!d){if(o){const t=Array.isArray(a)?a:[];if(pe(e)){const s=t.filter((t=>ce(t)!==ce(e)));if(!xe(s))return;r(s),D?.(s,"remove",e)}else{if(_&&t.length>=_)return te(`Maximum ${_} selections allowed`),void setTimeout((()=>te(null)),3e3);const s=[...t,e];if(!xe(s))return;r(s),D?.(s,"add",e),y&&!O?(U(!1),q("")):O||q("")}}else{if(!xe(e))return;r(e),D?.(e,"select",e),y&&(U(!1),O||q(""))}J(-1)}}),[d,o,a,pe,r,D,y,O,xe,_,ce]),fe=e.useCallback((e=>{if(e?.stopPropagation(),d)return;const t=o?[]:null;xe(t)&&(r(t),D?.(t,"clear"),q(""))}),[d,o,r,D,xe]),we=e.useCallback((()=>{if(!o||d)return;const e=he;xe(e)&&(r(e),D?.(e,"select-all"))}),[o,d,he,r,D,xe]),be=e.useCallback((e=>{if(V)switch(e.key){case"ArrowDown":e.preventDefault(),J((e=>e<he.length-1?e+1:0));break;case"ArrowUp":e.preventDefault(),J((e=>e>0?e-1:he.length-1));break;case"Home":e.preventDefault(),J(0);break;case"End":e.preventDefault(),J(he.length-1);break;case"Enter":e.preventDefault(),G>=0&&G<he.length?ge(he[G]):S&&Y.trim()&&ge(Y.trim());break;case"Escape":e.preventDefault(),je();break;case"Tab":je();break;case"a":(e.ctrlKey||e.metaKey)&&o&&A&&(e.preventDefault(),we());break;case"Delete":case"Backspace":if(!Y&&o&&Array.isArray(a)&&a.length>0){e.preventDefault();const t=a.slice(0,-1);if(!xe(t))return;r(t),D?.(t,"remove",a[a.length-1])}}else"Enter"!==e.key&&" "!==e.key&&"ArrowDown"!==e.key||(e.preventDefault(),ye())}),[V,he,G,ge,Y,S,o,a,r,D,A,we,xe]),ve=e.useCallback((e=>{const t=e.target.value;q(t),J(-1),ie.current&&clearTimeout(ie.current),g&&N>0?ie.current=setTimeout((()=>{g(t)}),N):g&&g(t)}),[g,N]),ye=e.useCallback((()=>{d||(U(!0),E?.(),n&&ae.current&&setTimeout((()=>ae.current?.focus()),50))}),[d,n,E]),je=e.useCallback((()=>{U(!1),q(""),J(-1),te(null),I?.()}),[I]),Ne=e.useCallback((()=>{if(!ne.current||!M)return;const e=ne.current.getBoundingClientRect(),t=window.innerHeight;let s=e.bottom+window.scrollY,a=e.left+window.scrollX;if("top"===L)s=e.top+window.scrollY-300;else if("auto"===L){const a=t-e.bottom,r=e.top;300>a&&r>a&&(s=e.top+window.scrollY-300)}"right"===T?a=e.right+window.scrollX-e.width:"center"===T&&(a=e.left+window.scrollX+e.width/2),K({top:s,left:a,width:e.width})}),[M,L,T]);e.useEffect((()=>{const e=e=>{se.current&&!se.current.contains(e.target)&&je()};return V&&(document.addEventListener("mousedown",e),document.addEventListener("touchstart",e)),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}}),[V,je]),e.useEffect((()=>{V&&(n&&ae.current&&ae.current.focus(),Ne())}),[V,n,Ne]),e.useEffect((()=>{P&&ne.current&&ne.current.focus()}),[P]),e.useEffect((()=>{if(G>=0&&re.current[G]){const e=re.current[G],t=e.closest(".enhanced-dropdown-scroll");if(t){const s=e.getBoundingClientRect(),a=t.getBoundingClientRect();s.top<a.top?e.scrollIntoView({block:"start",behavior:"smooth"}):s.bottom>a.bottom&&e.scrollIntoView({block:"end",behavior:"smooth"})}}}),[G]),e.useEffect((()=>{J(-1)}),[he]),e.useEffect((()=>()=>{ie.current&&clearTimeout(ie.current)}),[]);const ke=e.useCallback(((e,s)=>{if(!k||!s.trim())return e;const a=z?s:s.toLowerCase(),r=z?e:e.toLowerCase(),i=[];let n=0,o=r.indexOf(a);for(;-1!==o;)o>n&&i.push({text:e.slice(n,o),highlight:!1}),i.push({text:e.slice(o,o+a.length),highlight:!0}),n=o+a.length,o=r.indexOf(a,n);return n<e.length&&i.push({text:e.slice(n),highlight:!1}),i.map(((e,s)=>e.highlight?t.jsx("mark",{className:"bg-yellow-500/30 text-yellow-200",children:e.text},s):t.jsx("span",{children:e.text},s)))}),[k,z]),Ce=(e,s)=>{if(p)return p(e,s);const a=de(e),r=Y?ke(a,Y):a;return t.jsxs("div",{className:"flex items-center justify-between w-full gap-2",children:[t.jsx("span",{className:"truncate flex-1",children:r}),o&&pe(e)&&t.jsx("svg",{className:"w-4 h-4 text-green-400 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]})},Se={small:{button:"px-3 py-1.5 text-xs",option:"px-3 py-1.5 text-xs",search:"px-2 py-1.5 text-xs"},medium:{button:"px-4 py-2.5 text-sm",option:"px-4 py-2 text-sm",search:"px-3 py-2 text-sm"},large:{button:"px-5 py-3 text-base",option:"px-5 py-3 text-base",search:"px-4 py-2.5 text-base"}},_e=Se[H]||Se.medium;return t.jsxs(t.Fragment,{children:[t.jsx("style",{children:"\n          .enhanced-dropdown-scroll::-webkit-scrollbar {\n            display: none;\n          }\n          .enhanced-dropdown-button {\n            outline: none !important;\n            box-shadow: none !important;\n            -webkit-tap-highlight-color: transparent !important;\n            -webkit-focus-ring-color: transparent !important;\n          }\n          .enhanced-dropdown-button:focus {\n            outline: none !important;\n            box-shadow: none !important;\n          }\n          .enhanced-dropdown-button:active {\n            outline: none !important;\n            box-shadow: none !important;\n          }\n          .enhanced-dropdown-button:focus-visible {\n            outline: none !important;\n            box-shadow: none !important;\n          }\n          .enhanced-dropdown-option {\n            outline: none !important;\n            box-shadow: none !important;\n            -webkit-tap-highlight-color: transparent !important;\n            -webkit-focus-ring-color: transparent !important;\n          }\n          .enhanced-dropdown-option:focus {\n            outline: none !important;\n            box-shadow: none !important;\n          }\n          .enhanced-dropdown-option:active {\n            outline: none !important;\n            box-shadow: none !important;\n          }\n          .enhanced-dropdown-option:focus-visible {\n            outline: none !important;\n            box-shadow: none !important;\n          }\n        "}),t.jsxs("div",{ref:se,className:"relative "+c,style:B.container,children:[t.jsxs(Q.button,{ref:ne,type:"button",onClick:ye,onKeyDown:be,disabled:d,id:oe,"aria-haspopup":"listbox","aria-expanded":V,"aria-labelledby":oe+"-label","aria-controls":le,className:`\n          enhanced-dropdown-button flex items-center gap-2 rounded-full font-medium \n          transition-all duration-300 focus:outline-none focus:ring-0 active:outline-none active:ring-0\n          ${_e.button}\n          ${V?"text-black":"text-gray-400 hover:text-white"} \n          bg-[#1a1a1a]\n          ${d?"opacity-50 cursor-not-allowed":"cursor-pointer"}\n          relative overflow-hidden\n        `,"aria-label":i,children:[t.jsx(Z,{children:V?t.jsx(Q.div,{layoutId:"activeDropdownBg",className:"absolute inset-0 bg-white rounded-full z-0",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},transition:{duration:.2,ease:[.4,0,.2,1]}},"dropdown-bg-open"):t.jsx(Q.div,{className:"absolute inset-0 rounded-full z-0",initial:{backgroundColor:"rgba(255,255,255,0)"},whileHover:{backgroundColor:"rgba(255,255,255,0.13)"},transition:{duration:.2}},"dropdown-bg-hover")}),u&&t.jsx("span",{className:"flex-shrink-0 relative z-10",children:u}),t.jsx("span",{className:"relative z-10",children:(()=>{if(x)return x(a);if(o&&Array.isArray(a)){if(0===a.length)return t.jsx("span",{className:"text-gray-400",children:i});if($&&3>=a.length)return t.jsx("div",{className:"flex items-center gap-1 flex-wrap",children:a.map(((e,s)=>{const i=de(e);return t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-gray-700 rounded-full text-xs",children:[i,t.jsx("button",{onClick:t=>{t.stopPropagation();const i=a.filter(((e,t)=>t!==s));xe(i)&&(r(i),D?.(i,"remove",e))},className:"hover:text-red-400 transition-colors",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},s)}))});if(1===a.length){const e=a[0],s=de(e);return t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"w-2 h-2 bg-black rounded-full"}),s]})}return t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"w-2 h-2 bg-black rounded-full"}),a.length," selected"]})}if(!a)return t.jsx("span",{className:"text-gray-400",children:i});const e=de(a);return t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"w-2 h-2 bg-black rounded-full"}),e]})})()}),t.jsx("svg",{className:"w-4 h-4 transition-transform duration-200 flex-shrink-0 relative z-10 "+(V?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),h&&a&&t.jsx("span",{onClick:e=>{e.stopPropagation(),fe(e)},className:"enhanced-dropdown-button ml-1 p-1 hover:bg-gray-800 rounded-full transition-colors focus:outline-none focus:ring-0 active:outline-none active:ring-0 cursor-pointer","aria-label":"Clear selection",role:"button",tabIndex:0,children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsx(Z,{children:V&&t.jsxs(Q.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2,ease:"easeOut"},className:"absolute z-50 mt-2 w-full min-w-[180px] bg-[#0F0F0F] rounded-3xl shadow-2xl border border-white/5 border-1",style:{maxHeight:l},children:[n&&t.jsx("div",{className:"p-3 border-b border-gray-800",children:t.jsx("input",{ref:ae,type:"text",value:Y,onChange:ve,placeholder:f,className:"w-full px-3 py-2 bg-[#1a1a1a] text-white rounded-2xl text-sm focus:outline-none focus:ring-0 border border-gray-700"})}),o&&Array.isArray(a)&&a.length>0&&t.jsx("div",{className:"p-2 border-b border-gray-800",children:t.jsx("button",{onClick:()=>r([]),className:"enhanced-dropdown-option w-full px-3 py-2 text-left text-sm text-gray-400 hover:text-white hover:bg-gray-800 rounded-md transition-colors focus:outline-none focus:ring-0 active:outline-none active:ring-0",children:"Clear All"})}),t.jsx("div",{className:"max-h-60 overflow-y-auto enhanced-dropdown-scroll",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:b?t.jsxs("div",{className:"px-4 py-8 text-center text-gray-300",children:[t.jsx("div",{className:"inline-block w-6 h-6 border-2 border-gray-600 border-t-white rounded-full animate-spin"}),t.jsx("p",{className:"mt-2 text-sm",children:"Loading..."})]}):v?t.jsx("div",{className:"px-4 py-8 text-center text-red-400",children:t.jsx("p",{className:"text-sm",children:v})}):0===he.length?t.jsx("div",{className:"px-4 py-8 text-center text-gray-300",children:t.jsx("p",{className:"text-sm",children:w})}):m?Object.entries(me).map((([e,s])=>t.jsxs("div",{children:[t.jsx("div",{className:"px-4 py-2 text-xs font-semibold text-gray-400 uppercase tracking-wide sticky top-0 bg-[#0F0F0F]",children:e}),s.map(((e,a)=>{const r=he.indexOf(e);return t.jsx("button",{ref:e=>re.current[r]=e,onClick:()=>ge(e),className:`\n                          enhanced-dropdown-option w-full px-4 py-2 text-left text-sm transition-colors focus:outline-none focus:ring-0 active:outline-none active:ring-0\n                          ${0===a?"rounded-t-3xl":""}\n                          ${a===s.length-1?"rounded-b-3xl":""}\n                          ${pe(e)?"text-white bg-gray-800":"text-gray-300 hover:text-white hover:bg-gray-800"}\n                        `,children:Ce(e,r)},"object"==typeof e?e.id||e.value:e)}))]},e))):he.map(((e,s)=>t.jsx("button",{ref:e=>re.current[s]=e,onClick:()=>ge(e),className:`\n                      enhanced-dropdown-option w-full px-4 py-2 text-left text-sm transition-colors focus:outline-none focus:ring-0 active:outline-none active:ring-0\n                      ${0===s?"rounded-t-3xl":""}\n                      ${s===he.length-1?"rounded-b-3xl":""}\n                      ${pe(e)?"text-white bg-gray-800":"text-gray-300 hover:text-white hover:bg-gray-800"}\n                    `,children:Ce(e,s)},"object"==typeof e?e.id||e.value:e)))})]})})]})]})},oa=({selectedYear:s,onYearSelect:a,minYear:r=1900,maxYear:i=null,showAllYears:n=!0,className:o="",disabled:l=!1})=>{const c=(new Date).getFullYear(),d=i||c,u=e.useMemo((()=>{const e=[];n&&e.push({value:null,label:"All Years",year:null});for(let t=d;t>=r;t--)e.push({value:t,label:t.toString(),year:t});return e}),[r,d,n]);return t.jsx(na,{options:u,selectedValue:s,onSelect:e=>{a(e?.year||null)},placeholder:"Year",searchable:!1,searchPlaceholder:"Search years...",className:o,disabled:l,groupBy:null,renderOption:(e,s)=>t.jsx("div",{className:"flex items-center justify-between",children:t.jsx("span",{children:e.label})}),renderSelected:e=>e?t.jsx("span",{children:e}):t.jsx("span",{children:"Year"}),emptyMessage:"No years found",icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})})},la=({genres:s=[],selectedGenre:a,onGenreSelect:r,multiSelect:i=!1,className:n="",disabled:o=!1})=>{const l=e.useMemo((()=>s&&0!==s.length?[...s].sort(((e,t)=>e.name.localeCompare(t.name))).map((e=>({...e,value:e.id,label:e.name}))):[]),[s]);return t.jsx(na,{options:l,selectedValue:a,onSelect:e=>{if(i){const t=Array.isArray(a)?a:[];if(t.some((t=>("object"==typeof t?t.id:t)===e.id))){const s=t.filter((t=>("object"==typeof t?t.id:t)!==e.id));r(s)}else r([...t,e])}else r(e)},placeholder:"Genre",searchable:!1,searchPlaceholder:"Search genres...",multiSelect:i,className:n,disabled:o,groupBy:null,renderOption:(e,s)=>t.jsx("div",{className:"flex items-center justify-between",children:t.jsx("span",{className:"truncate",children:e.name})}),renderSelected:e=>{if(i&&Array.isArray(e)){if(0===e.length)return t.jsx("span",{children:"Genre"});if(1===e.length){const s=e[0];return t.jsx("span",{children:s.name})}return t.jsxs("span",{children:[e.length," genres"]})}return e?t.jsx("span",{children:e.name}):t.jsx("span",{children:"Genre"})},emptyMessage:"No genres found",icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})})},ca=({achievement:e,showProgress:s=!0,variant:a="default"})=>{const r={FilmIcon:t.jsx(L,{className:"w-6 h-6"}),TvIcon:t.jsx(_,{className:"w-6 h-6"}),TrophyIcon:t.jsx(S,{className:"w-6 h-6"}),CheckCircleIcon:t.jsx(f,{className:"w-6 h-6"}),PlayIcon:t.jsx(C,{className:"w-6 h-6"}),StarIcon:t.jsx(k,{className:"w-6 h-6"}),FireIcon:t.jsx(N,{className:"w-6 h-6"}),FlagIcon:t.jsx(j,{className:"w-6 h-6"}),BoltIcon:t.jsx(y,{className:"w-6 h-6"}),LightBulbIcon:t.jsx(v,{className:"w-6 h-6"}),GlobeAltIcon:t.jsx(b,{className:"w-6 h-6"}),UserIcon:t.jsx(w,{className:"w-6 h-6"})},i={common:"border-gray-400 text-gray-400",rare:"border-blue-400 text-blue-400",epic:"border-purple-400 text-purple-400",legendary:"border-yellow-400 text-yellow-400",special:"border-green-400 text-green-400"},n={common:"bg-gray-400/10",rare:"bg-blue-400/10",epic:"bg-purple-400/10",legendary:"bg-yellow-400/10",special:"bg-green-400/10"},o=(...e)=>e.filter(Boolean).join(" "),{name:l="Untitled Achievement",description:c="",icon:d="StarIcon",rarity:u="common",progress:h=0,maxProgress:m=0,points:p=0,unlocked:x=!1}=e||{},g=u in i?u:"common",T=Number.isFinite(h)?+h:0,M=Number.isFinite(m)?+m:0,E=M>0?((e,t=0,s=100)=>Math.min(s,Math.max(t,e)))(T/M*100,0,100):0,I=!!x||M>0&&T>=M,D=r[d]||r.StarIcon;return t.jsx(Q.div,{className:o({default:"bg-[#1a1d21] border border-white/10 hover:border-white/20",compact:"bg-[#1a1d21] border border-white/10",highlighted:"bg-gradient-to-br from-[#1a1d21] to-[#2a2d31] border border-white/20 shadow-lg"}[a],"rounded-xl p-4 transition-all duration-300 group",I?"opacity-100":"opacity-60"),whileTap:{scale:.98},children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:o("w-12 h-12 rounded-full flex items-center justify-center",I?n[g]:"bg-white/5","border border-white/20 group-hover:border-white/30 transition-colors"),children:t.jsx("div",{className:I?"text-white":"text-white/40",children:D})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("h3",{className:"font-semibold text-sm truncate "+(I?"text-white":"text-white/60"),children:l}),t.jsxs("div",{className:o("px-2 py-1 rounded-full text-xs font-medium",I?n[g]+" "+i[g]:"bg-white/5 text-white/40"),children:[p," pts"]})]}),t.jsx("p",{className:"text-xs mb-3 "+(I?"text-white/70":"text-white/40"),children:c}),s&&t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between text-xs",children:[t.jsx("span",{className:I?"text-white/60":"text-white/40",children:"Progress"}),t.jsxs("span",{className:I?"text-white/80":"text-white/50",children:[T,"/",M||"—"]})]}),t.jsx("div",{className:"w-full bg-white/10 rounded-full h-2 overflow-hidden",children:t.jsx(Q.div,{className:"h-full rounded-full "+(I?"bg-gradient-to-r from-white to-white":"bg-white/20"),initial:{width:0},animate:{width:E+"%"},transition:{duration:.8,ease:"easeOut"}})})]}),t.jsx("div",{className:"mt-3",children:t.jsx("span",{className:o("inline-block px-2 py-1 rounded-full text-xs font-medium capitalize",i[g],"border",I?"opacity-100":"opacity-40"),children:g})})]}),I&&t.jsx(Q.div,{initial:{scale:0},animate:{scale:1},className:"w-6 h-6 rounded-full bg-green-500/20 border border-green-500/30 flex items-center justify-center",children:t.jsx(f,{className:"w-4 h-4 text-green-400"})})]})})},da=({variant:s="full"})=>{const{getAchievements:a,getAchievementStats:r,getRecentlyUnlocked:i,getNextAchievements:n}=ie(),[o,l]=e.useState("all"),[c,d]=e.useState(!0),[u,h]=e.useState("rarity"),m=a(),p=r(),x=i(),g=n(),w=[{id:"all",name:"All",icon:S,color:"text-white"},{id:"watch_time",name:"Watch Time",icon:N,color:"text-orange-400"},{id:"completion",name:"Completion",icon:f,color:"text-green-400"},{id:"streak",name:"Streaks",icon:y,color:"text-blue-400"},{id:"rating",name:"Rating",icon:k,color:"text-yellow-400"},{id:"diversity",name:"Diversity",icon:j,color:"text-purple-400"},{id:"special",name:"Special",icon:S,color:"text-pink-400"}],b={legendary:4,epic:3,rare:2,common:1,special:0},v=m.filter((e=>!("all"!==o&&e.category!==o||!c&&!e.unlocked))).sort(((e,t)=>"rarity"===u?b[t.rarity]-b[e.rarity]:"progress"===u?t.progress/t.maxProgress-e.progress/e.maxProgress:"points"===u?t.points-e.points:0));return"compact"===s?t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx("div",{className:"bg-[#1a1d21] rounded-full p-4 border border-white/10",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-white/10 flex items-center justify-center",children:t.jsx(S,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-2xl font-bold text-white",children:p?.unlocked||0}),t.jsx("p",{className:"text-xs text-white/40",children:"Unlocked"})]})]})}),t.jsx("div",{className:"bg-[#1a1d21] rounded-full p-4 border border-white/10",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-white/10 flex items-center justify-center",children:t.jsx(k,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-2xl font-bold text-white",children:p?.totalPoints||0}),t.jsx("p",{className:"text-xs text-white/40",children:"Points"})]})]})})]}),x.length>0&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-semibold text-white mb-3",children:"Recently Unlocked"}),t.jsx("div",{className:"space-y-3",children:x.slice(0,3).map((e=>t.jsx(ca,{achievement:e,showProgress:!1,variant:"compact"},e.id)))})]})]}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsx("div",{className:"bg-[#1a1d21] rounded-full p-4 border border-white/10",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-white/10 flex items-center justify-center",children:t.jsx(S,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-2xl font-bold text-white",children:p?.unlocked||0}),t.jsx("p",{className:"text-xs text-white/40",children:"Unlocked"})]})]})}),t.jsx("div",{className:"bg-[#1a1d21] rounded-full p-4 border border-white/10",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-white/10 flex items-center justify-center",children:t.jsx(k,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-2xl font-bold text-white",children:p?.totalPoints||0}),t.jsx("p",{className:"text-xs text-white/40",children:"Points"})]})]})}),t.jsx("div",{className:"bg-[#1a1d21] rounded-full p-4 border border-white/10",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-white/10 flex items-center justify-center",children:t.jsx(T,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{children:[t.jsxs("p",{className:"text-2xl font-bold text-white",children:[p?.completionRate||0,"%"]}),t.jsx("p",{className:"text-xs text-white/40",children:"Complete"})]})]})}),t.jsx("div",{className:"bg-[#1a1d21] rounded-full p-4 border border-white/10",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-white/10 flex items-center justify-center",children:t.jsx(N,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-2xl font-bold text-white",children:p?.locked||0}),t.jsx("p",{className:"text-xs text-white/40",children:"Remaining"})]})]})})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(M,{className:"w-4 h-4 text-white/60"}),t.jsx("select",{value:o,onChange:e=>l(e.target.value),className:"bg-[#1a1d21] border border-white/10 rounded-full px-3 py-2 text-sm text-white focus:outline-none focus:border-white/30",children:w.map((e=>t.jsx("option",{value:e.id,children:e.name},e.id)))})]}),t.jsxs("select",{value:u,onChange:e=>h(e.target.value),className:"bg-[#1a1d21] border border-white/10 rounded-full px-3 py-2 text-sm text-white focus:outline-none focus:border-white/30",children:[t.jsx("option",{value:"rarity",children:"Sort by Rarity"}),t.jsx("option",{value:"progress",children:"Sort by Progress"}),t.jsx("option",{value:"points",children:"Sort by Points"})]}),t.jsxs("button",{onClick:()=>d(!c),className:"flex items-center gap-2 bg-[#1a1d21] border border-white/10 rounded-full px-3 py-2 text-sm text-white hover:border-white/30 transition-colors",children:[c?t.jsx(E,{className:"w-4 h-4"}):t.jsx(I,{className:"w-4 h-4"}),c?"Hide Locked":"Show Locked"]})]}),g.length>0&&t.jsxs("div",{className:"bg-[#1a1d21] rounded-2xl p-6 border border-white/10",children:[t.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[t.jsx(j,{className:"w-5 h-5 text-white"}),"Next Achievements"]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:g.map((e=>t.jsx(ca,{achievement:e,variant:"highlighted"},e.id)))})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h3",{className:"text-lg font-semibold text-white",children:"all"===o?"All Achievements":w.find((e=>e.id===o))?.name}),t.jsxs("span",{className:"text-sm text-white/60",children:[v.length," of ",m.length]})]}),t.jsx(Z,{mode:"wait",children:t.jsx(Q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:v.map((e=>t.jsx(ca,{achievement:e},e.id)))},`${o}-${c}-${u}`)}),0===v.length&&t.jsxs("div",{className:"text-center py-12",children:[t.jsx(S,{className:"w-16 h-16 text-white/20 mx-auto mb-4"}),t.jsx("p",{className:"text-white/60",children:"No achievements found with current filters"})]})]})]})},ua=({onSetupComplete:s,onCancel:a})=>{const[r,i]=e.useState("qr"),[n,o]=e.useState(""),[l,c]=e.useState(""),[d,u]=e.useState(""),[h,m]=e.useState([]),[p,x]=e.useState(!1),[g,f]=e.useState(!1),[w,b]=e.useState(!1);e.useEffect((()=>{v()}),[]);const v=async()=>{try{x(!0);const e=await ge.setup2FA();o(e.data.qrCode),c(e.data.secret),m(e.data.backupCodes||[]),D.success("2FA setup ready")}catch(e){D.error(e.message||"Failed to setup 2FA. Please try again.")}finally{x(!1)}},y=()=>{s()};return t.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-2 sm:p-4 z-50",children:t.jsx(Q.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-[#1a1d21] rounded-2xl p-4 sm:p-8 max-w-md w-full max-h-[90vh] overflow-y-auto border border-white/10",children:t.jsxs(Z,{mode:"wait",children:["qr"===r&&t.jsxs(Q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Setup Two-Factor Authentication"}),t.jsx("p",{className:"text-white/60 text-sm",children:"Scan the QR code with your authenticator app to enable 2FA"})]}),p?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("div",{className:"animate-spin rounded-2xl h-12 w-12 border-2 border-white border-t-transparent"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex justify-center",children:t.jsx("div",{className:"bg-white p-3 sm:p-4 rounded-2xl",children:n?t.jsx("img",{src:n,alt:"2FA QR Code",className:"w-40 h-40 sm:w-48 sm:h-48"}):t.jsx("div",{className:"w-40 h-40 sm:w-48 sm:h-48 bg-gray-100 rounded-xl flex items-center justify-center",children:t.jsx(R,{className:"w-12 h-12 sm:w-16 sm:h-16 text-gray-400"})})})}),t.jsxs("div",{className:"bg-[#1a1d21] rounded-2xl p-3 sm:p-4 border border-white/10",children:[t.jsxs("h4",{className:"font-semibold text-white mb-2 sm:mb-3 flex items-center gap-2",children:[t.jsx(R,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"}),"Manual Entry"]}),t.jsx("p",{className:"text-white/60 text-xs sm:text-sm mb-2 sm:mb-3",children:"If you can't scan the QR code, enter this secret manually in your authenticator app:"}),t.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[t.jsx("div",{className:"flex-1 bg-black/30 rounded-full px-3 sm:px-4 py-2 sm:py-3 font-mono text-white text-xs sm:text-sm",children:g?l:"•".repeat(32)}),t.jsx("button",{onClick:()=>f(!g),className:"p-2 sm:p-3 bg-white/10 rounded-full hover:bg-white/20 transition-colors",children:g?t.jsx(I,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"}):t.jsx(E,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"})}),t.jsx("button",{onClick:()=>{navigator.clipboard.writeText(l),D.success("Secret copied to clipboard")},className:"p-2 sm:p-3 bg-white/10 rounded-full hover:bg-white/20 transition-colors",children:t.jsx(z,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"})})]})]}),t.jsxs("div",{className:"bg-blue-500/10 rounded-2xl p-4 border border-blue-500/20",children:[t.jsx("h4",{className:"font-semibold text-blue-400 mb-2",children:"How to setup:"}),t.jsxs("ol",{className:"text-blue-300/80 text-sm space-y-1 list-decimal list-inside",children:[t.jsx("li",{children:"Install an authenticator app (Google Authenticator, Authy, etc.)"}),t.jsx("li",{children:"Scan the QR code or manually enter the secret"}),t.jsx("li",{children:"Enter the 6-digit code from your app to verify"})]})]}),t.jsxs("div",{className:"flex gap-3 pt-4",children:[t.jsx("button",{onClick:()=>a(),className:"flex-1 px-6 py-3 bg-white/10 text-white rounded-full hover:bg-white/20 transition-all duration-200",children:"Cancel"}),t.jsx("button",{onClick:()=>i("verify"),className:"flex-1 px-6 py-3 bg-white text-black rounded-full hover:bg-white/90 transition-all duration-200 font-semibold",children:"Next: Verify Code"})]})]})]}),"verify"===r&&t.jsxs(Q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Verify Your Code"}),t.jsx("p",{className:"text-white/60 text-sm",children:"Enter the 6-digit code from your authenticator app"})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-[#1a1d21] rounded-2xl p-6 border border-white/10",children:[t.jsx("div",{className:"flex justify-center mb-6",children:t.jsx("div",{className:"w-16 h-16 rounded-full bg-white/10 flex items-center justify-center border border-white/20",children:t.jsx(W,{className:"w-8 h-8 text-white"})})}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("label",{className:"block text-white/60 text-sm font-medium text-center",children:"Verification Code"}),t.jsx("input",{type:"text",value:d,onChange:e=>u(e.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"w-full bg-[#1a1d21] border border-white/10 rounded-full px-6 py-4 text-white text-center text-2xl font-mono focus:outline-none focus:border-white/30 focus:bg-[#1a1d21]/80 transition-all duration-200",maxLength:6}),t.jsx("p",{className:"text-white/40 text-xs text-center",children:"Enter the 6-digit code from your authenticator app"})]})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:()=>i("qr"),className:"flex-1 px-6 py-3 bg-white/10 text-white rounded-full hover:bg-white/20 transition-all duration-200",children:"Back"}),t.jsx("button",{onClick:async()=>{if(d&&6===d.length)try{x(!0),await ge.verify2FA(d),D.success("2FA verification successful!"),i("backup")}catch(e){D.error(e.message||"Invalid verification code")}finally{x(!1)}else D.error("Please enter a valid 6-digit code")},disabled:p||6!==d.length,className:"flex-1 px-6 py-3 bg-white text-black rounded-full hover:bg-white/90 transition-all duration-200 font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:p?"Verifying...":"Verify Code"})]})]})]}),"backup"===r&&t.jsxs(Q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Backup Codes"}),t.jsx("p",{className:"text-white/60 text-sm",children:"Save these backup codes in a secure location. You'll need them if you lose access to your authenticator app."})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-yellow-500/10 rounded-2xl p-4 border border-yellow-500/20",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(A,{className:"w-5 h-5 text-yellow-400"}),t.jsx("span",{className:"font-semibold text-yellow-400",children:"Important"})]}),t.jsx("p",{className:"text-yellow-300/80 text-sm",children:"These codes are your backup access method. Store them securely and don't share them with anyone."})]}),t.jsxs("div",{className:"bg-[#1a1d21] rounded-2xl p-6 border border-white/10",children:[t.jsx("div",{className:"grid grid-cols-2 gap-3 mb-4",children:h.map(((e,s)=>t.jsx("div",{className:"bg-[#1a1d21] rounded-full px-4 py-3 font-mono text-white text-center text-sm border border-white/10",children:e},s)))}),t.jsx("div",{className:"flex gap-3",children:t.jsx("button",{onClick:async()=>{try{const e=h.join("\n");await navigator.clipboard.writeText(e),b(!0),D.success("Backup codes copied to clipboard"),setTimeout((()=>b(!1)),2e3)}catch(e){D.error("Failed to copy backup codes")}},className:"flex-1 px-4 py-2 bg-white/10 text-white rounded-full hover:bg-white/20 transition-all duration-200 flex items-center justify-center gap-2",children:w?t.jsxs(t.Fragment,{children:[t.jsx(O,{className:"w-4 h-4"}),"Copied!"]}):t.jsxs(t.Fragment,{children:[t.jsx(z,{className:"w-4 h-4"}),"Copy All Codes"]})})})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:()=>i("verify"),className:"flex-1 px-6 py-3 bg-white/10 text-white rounded-full hover:bg-white/20 transition-all duration-200",children:"Back"}),t.jsx("button",{onClick:y,className:"flex-1 px-6 py-3 bg-white text-black rounded-full hover:bg-white/90 transition-all duration-200 font-semibold",children:"Complete Setup"})]})]})]}),"complete"===r&&t.jsxs(Q.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center space-y-6",children:[t.jsx("div",{className:"w-20 h-20 rounded-full bg-green-500/20 flex items-center justify-center mx-auto border border-green-500/30",children:t.jsx(O,{className:"w-10 h-10 text-green-400"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"2FA Setup Complete!"}),t.jsx("p",{className:"text-white/60 text-sm",children:"Two-factor authentication is now enabled on your account. You'll need to enter a code from your authenticator app when signing in."})]}),t.jsx("button",{onClick:y,className:"px-8 py-3 bg-white text-black rounded-full hover:bg-white/90 transition-all duration-200 font-semibold",children:"Done"})]})]})})})},ha=({onDisable:s,onCancel:a})=>{const[r,i]=e.useState(""),[n,o]=e.useState(!1),[l,c]=e.useState(!1),[d,u]=e.useState("");return t.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:t.jsx(Q.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-[#1a1d21] rounded-2xl p-8 max-w-md w-full border border-white/10",children:t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-16 h-16 rounded-full bg-red-500/20 flex items-center justify-center mx-auto mb-4 border border-red-500/30",children:t.jsx(P,{className:"w-8 h-8 text-red-400"})}),t.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Disable 2FA"}),t.jsx("p",{className:"text-white/60 text-sm",children:"This will remove two-factor authentication from your account, making it less secure."})]}),t.jsxs("div",{className:"bg-red-500/10 rounded-2xl p-4 border border-red-500/20",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(A,{className:"w-5 h-5 text-red-400"}),t.jsx("span",{className:"font-semibold text-red-400",children:"Security Warning"})]}),t.jsx("p",{className:"text-red-300/80 text-sm",children:"Disabling 2FA will make your account more vulnerable to unauthorized access. Only proceed if you're certain."})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-white/60 text-sm font-medium mb-2",children:"Verification Code"}),t.jsx("input",{type:"text",value:r,onChange:e=>i(e.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"w-full bg-[#1a1d21] border border-white/10 rounded-full px-4 py-3 text-white text-center text-lg font-mono focus:outline-none focus:border-white/30 focus:bg-[#1a1d21]/80 transition-all duration-200",maxLength:6}),t.jsx("p",{className:"text-white/40 text-xs mt-1 text-center",children:"Enter the 6-digit code from your authenticator app"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white/60 text-sm font-medium mb-2",children:"Password Confirmation"}),t.jsxs("div",{className:"relative flex-1",children:[t.jsx("input",{type:l?"text":"password",value:d,onChange:e=>u(e.target.value),placeholder:"Enter your password",className:"w-full bg-[#1a1d21] border border-white/10 rounded-full px-4 py-3 text-white focus:outline-none focus:border-white/30 focus:bg-[#1a1d21]/80 transition-all duration-200 pr-12"}),t.jsx("button",{type:"button",onClick:()=>c(!l),className:"absolute right-2 top-1/2 -translate-y-1/2 p-2 bg-transparent rounded-full hover:bg-white/10 transition-colors",tabIndex:-1,children:l?t.jsx(I,{className:"w-5 h-5 text-white"}):t.jsx(E,{className:"w-5 h-5 text-white"})})]}),t.jsx("p",{className:"text-white/40 text-xs mt-1 text-center",children:"Enter your password to confirm this action"})]})]}),t.jsxs("div",{className:"flex gap-3 pt-4",children:[t.jsx("button",{onClick:a,className:"flex-1 px-6 py-3 bg-white/10 text-white rounded-full hover:bg-white/20 transition-all duration-200",children:"Cancel"}),t.jsx("button",{onClick:async()=>{if(r&&6===r.length)if(d)try{o(!0),await ge.disable2FA(r,d),D.success("Two-factor authentication has been disabled"),s()}catch(e){D.error(e.message||"Failed to disable 2FA")}finally{o(!1)}else D.error("Please enter your password to confirm");else D.error("Please enter a valid 6-digit verification code")},disabled:n||6!==r.length||!d,className:"flex-1 px-6 py-3 bg-red-500 text-white rounded-full hover:bg-red-600 transition-all duration-200 font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Disabling...":"Disable 2FA"})]})]})})})},ma=({onClose:s})=>{const[a,r]=e.useState([]),[i,n]=e.useState(!1),[o,l]=e.useState(!1),[c,d]=e.useState(!1),[u,h]=e.useState(!1);e.useEffect((()=>{m()}),[]);const m=async()=>{try{n(!0);const e=await ge.getBackupCodes();r(e.data.backupCodes||[])}catch(e){D.error("Failed to load backup codes")}finally{n(!1)}};return t.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:t.jsx(Q.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-[#1a1d21] rounded-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto border border-white/10",children:t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-16 h-16 rounded-full bg-blue-500/20 flex items-center justify-center mx-auto mb-4 border border-blue-500/30",children:t.jsx(F,{className:"w-8 h-8 text-blue-400"})}),t.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Backup Codes Management"}),t.jsx("p",{className:"text-white/60 text-sm",children:"Manage your backup codes for two-factor authentication"})]}),t.jsxs("div",{className:"bg-yellow-500/10 rounded-2xl p-4 border border-yellow-500/20",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(A,{className:"w-5 h-5 text-yellow-400"}),t.jsx("span",{className:"font-semibold text-yellow-400",children:"Important"})]}),t.jsx("p",{className:"text-yellow-300/80 text-sm",children:"Backup codes are your last resort for accessing your account if you lose your authenticator app. Store them securely and never share them with anyone."})]}),i?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-2 border-white border-t-transparent"})}):t.jsx("div",{className:"space-y-6",children:a.length>0?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"bg-[#1a1d21] rounded-full p-6 border border-white/10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h4",{className:"font-semibold text-white",children:"Your Backup Codes"}),t.jsx("button",{onClick:()=>h(!u),className:"px-4 py-2 bg-white/10 text-white rounded-full hover:bg-white/20 transition-all duration-200 text-sm",children:u?"Hide Codes":"Show Codes"})]}),u&&t.jsxs(Q.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-4",children:[t.jsx("div",{className:"grid grid-cols-2 gap-3",children:a.map(((e,s)=>t.jsx("div",{className:"bg-[#1a1d21] rounded-full px-4 py-3 font-mono text-white text-center text-sm border border-white/10",children:e},s)))}),t.jsxs("div",{className:"flex gap-3 pt-4",children:[t.jsx("button",{onClick:async()=>{try{const e=a.join("\n");await navigator.clipboard.writeText(e),d(!0),D.success("Backup codes copied to clipboard"),setTimeout((()=>d(!1)),2e3)}catch(e){D.error("Failed to copy backup codes")}},className:"flex-1 px-4 py-2 bg-white/10 text-white rounded-full hover:bg-white/20 transition-all duration-200 flex items-center justify-center gap-2",children:c?t.jsxs(t.Fragment,{children:[t.jsx(O,{className:"w-4 h-4"}),"Copied!"]}):t.jsxs(t.Fragment,{children:[t.jsx(z,{className:"w-4 h-4"}),"Copy All Codes"]})}),t.jsx("button",{onClick:()=>{const e=a.join("\n"),t=new Blob([e],{type:"text/plain"}),s=URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download="backup-codes.txt",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s),D.success("Backup codes downloaded")},className:"flex-1 px-4 py-2 bg-white/10 text-white rounded-full hover:bg-white/20 transition-all duration-200",children:"Download"})]})]})]}),t.jsxs("div",{className:"bg-[#1a1d21] rounded-full p-4 border border-white/10",children:[t.jsx("h4",{className:"font-semibold text-white mb-3",children:"Regenerate Codes"}),t.jsx("p",{className:"text-white/60 text-sm mb-4",children:"Generate new backup codes. This will invalidate all existing codes."}),t.jsx("button",{onClick:async()=>{if(window.confirm("This will invalidate all existing backup codes. Are you sure you want to continue?"))try{l(!0);const e=await ge.regenerateBackupCodes();r(e.data.backupCodes||[]),h(!0),D.success("Backup codes regenerated successfully")}catch(e){D.error("Failed to regenerate backup codes")}finally{l(!1)}},disabled:o,className:"w-full px-6 py-3 bg-blue-500 text-white rounded-full hover:bg-blue-600 transition-all duration-200 font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:o?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Regenerating..."]}):t.jsxs(t.Fragment,{children:[t.jsx(B,{className:"w-4 h-4"}),"Regenerate Backup Codes"]})})]})]}):t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"w-16 h-16 rounded-full bg-white/10 flex items-center justify-center mx-auto mb-4",children:t.jsx(F,{className:"w-8 h-8 text-white/40"})}),t.jsx("p",{className:"text-white/40 text-sm",children:"No backup codes found"})]})}),t.jsx("div",{className:"flex justify-center pt-4",children:t.jsx("button",{onClick:s,className:"px-8 py-3 bg-white/10 text-white rounded-full hover:bg-white/20 transition-all duration-200 font-semibold",children:"Close"})})]})})})},pa=e=>{if(!e)return"Just now";const t=new Date(e);if(!pe(t))return"Just now";try{return xe(t,{addSuffix:!0})}catch(s){return"Just now"}},xa=({discussionId:s,replies:r,onReplyAdded:i})=>{const{user:n}=Rt(),o=h(),[l,c]=e.useState(r||[]),[d,u]=e.useState(""),[m,p]=e.useState(!1),[x,g]=e.useState(null),[f,w]=e.useState(!1),[b,v]=e.useState(null);e.useEffect((()=>{c(r||[])}),[r]),e.useEffect((()=>{fe.connect();const e=e=>{e.discussionId===s&&(e.reply.parentReplyId?c((t=>t.map((t=>(t.id||t._id)===e.reply.parentReplyId?{...t,replies:[...t.replies||[],e.reply]}:t.replies?{...t,replies:t.replies.map((t=>(t.id||t._id)===e.reply.parentReplyId?{...t,replies:[...t.replies||[],e.reply]}:t))}:t)))):c((t=>[...t,e.reply])))},t=e=>{e.discussionId===s&&c((t=>{const s=t=>t.map((t=>(t.id||t._id)===e.replyId?{...t,likes:e.likes,isLiked:e.isLiked,likesCount:e.likes.length}:t.replies?{...t,replies:s(t.replies)}:t));return s(t)}))};return fe.addListener("reply:new",e),fe.addListener("reply:liked",t),()=>{fe.removeListener("reply:new",e),fe.removeListener("reply:liked",t)}}),[s]);const y=async e=>{if(e.preventDefault(),d.trim()&&s){p(!0),g(null);try{const e=await Fe.addReply(s,{content:d.trim(),parentReplyId:b?._id});if(b?._id){const t=b.id||b._id;c((s=>s.map((s=>(s.id||s._id)===t?{...s,replies:[...s.replies||[],e]}:s.replies?{...s,replies:s.replies.map((s=>(s.id||s._id)===t?{...s,replies:[...s.replies||[],e]}:s))}:s))))}else c((t=>[...t,e]));u(""),w(!1),v(null),i&&i()}catch(t){g("Failed to add reply. Please try again."),"Authentication required"===t.message&&a.error("Please log in to reply")}finally{p(!1)}}},j=(e,r=0)=>t.jsxs("div",{className:`ml-${4*r} mt-4`,children:[t.jsxs("div",{className:"bg-white/5 rounded-lg p-4",children:[t.jsx("div",{className:"flex items-start justify-between",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("img",{src:e.author?.avatar||e.author?.profilePicture||"/default-avatar.png",alt:(e.author?.username||"Anonymous")+"'s avatar",className:"w-8 h-8 rounded-full"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:e.author?.username||"Anonymous"}),t.jsx("span",{className:"text-white/40 text-sm ml-2",children:pa(e.createdAt)})]})]})}),t.jsx("p",{className:"text-white/80 mt-2",children:e.content}),t.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[t.jsxs("button",{onClick:()=>((e=null)=>{if(!n)return a.error("Please log in to reply"),void o("/login",{state:{from:"/community"}});v(e),w(!0)})(e),className:"text-white/60 hover:text-white text-sm flex items-center gap-1",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})}),"Reply"]}),n&&e.author._id===n.id&&t.jsxs("button",{onClick:()=>(async e=>{if(!n)return a.error("Please log in to delete replies"),void o("/login",{state:{from:"/community/discussion/"+s}});const t=l.find((t=>(t.id||t._id)===e))||l.flatMap((e=>e.replies||[])).find((t=>(t.id||t._id)===e));if(t&&t.author._id===n.id){if(window.confirm("Are you sure you want to delete this reply? This action cannot be undone."))try{await Fe.deleteReply(s,e),a.success("Reply deleted successfully"),c((t=>t.map((t=>{return t.replies?{...t,replies:(s=t.replies,s.filter((t=>(t.id||t._id)!==e)))}:t;var s})).filter((t=>(t.id||t._id)!==e)))),i&&i()}catch(r){403===r.response?.status?a.error("You are not authorized to delete this reply"):404===r.response?.status?a.error("Reply not found"):a.error("Failed to delete reply. Please try again.")}}else a.error("You can only delete your own replies")})(e.id||e._id),className:"text-red-400 hover:text-red-300 text-sm flex items-center gap-1",title:"Delete reply",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]})]}),e.replies?.map((e=>j(e,r+1)))]},e.id||e._id);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("h2",{className:"text-xl font-semibold",children:["Replies (",l.length,")"]}),n?t.jsxs("form",{onSubmit:y,className:"space-y-4",children:[t.jsx("textarea",{value:d,onChange:e=>u(e.target.value),placeholder:"Write your reply...",className:"w-full bg-white/5 border border-white/10 rounded-lg p-4 text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/20",rows:4}),x&&t.jsx("p",{className:"text-red-500 text-sm",children:x}),t.jsx("button",{type:"submit",disabled:m||!d.trim(),className:"px-4 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:m?"Posting...":"Post Reply"})]}):t.jsx("p",{className:"text-white/60",children:"Please log in to reply to this discussion."}),f&&t.jsx("form",{onSubmit:y,className:"mt-6",children:t.jsxs("div",{className:"bg-white/5 rounded-lg p-4",children:[b&&t.jsxs("div",{className:"mb-2 text-sm text-white/60",children:["Replying to ",t.jsx("span",{className:"text-white",children:b.author.username}),t.jsx("button",{type:"button",onClick:()=>v(null),className:"ml-2 text-white/40 hover:text-white",children:"×"})]}),t.jsx("textarea",{value:d,onChange:e=>u(e.target.value),placeholder:"Write your reply...",className:"w-full bg-white/5 border border-white/10 rounded-lg px-4 py-2 text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/20 min-h-[100px]",required:!0}),t.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[t.jsx("button",{type:"button",onClick:()=>{w(!1),v(null),u("")},className:"px-4 py-2 text-white/60 hover:text-white",children:"Cancel"}),t.jsx("button",{type:"submit",disabled:m,className:"px-4 py-2 bg-white text-black rounded-lg hover:bg-white/90 disabled:opacity-50",children:m?"Posting...":"Post Reply"})]})]})}),t.jsx("div",{className:"space-y-4",children:l.map((e=>j(e)))})]})},ga=({discussion:s,onUpdate:r})=>{const{user:i}=Rt(),n=h(),[o,l]=e.useState(s),[c,d]=e.useState(!1),[u,m]=e.useState(null),[x,g]=e.useState(!1),[f,w]=e.useState(s.views||0);return e.useEffect((()=>{l(s),w(s.views||0)}),[s]),e.useEffect((()=>{fe.connect();const e=o.id||o._id;if(!e)return;const t=t=>{t.discussionId===e&&l((e=>({...e,likes:t.likes,isLiked:t.isLiked})))},s=t=>{t._id===e&&(l((e=>({...e,...t}))),t.views&&w(t.views))},a=t=>{t.discussionId===e&&l((e=>{const s=[...e.replies||[]];if(t.reply.parentReplyId){const a=e=>e.map((e=>(e.id||e._id)===t.reply.parentReplyId?{...e,replies:[...e.replies||[],t.reply]}:e.replies?{...e,replies:a(e.replies)}:e));return{...e,replies:a(s)}}return{...e,replies:[...s,t.reply]}}))},r=t=>{t.discussionId===e&&l((e=>{const s=e=>e.map((e=>(e.id||e._id)===t.replyId?{...e,likes:t.likes,isLiked:t.isLiked,likesCount:t.likes.length}:e.replies?{...e,replies:s(e.replies)}:e));return{...e,replies:s(e.replies||[])}}))};return fe.addListener("discussion:liked",t),fe.addListener("discussion:updated",s),fe.addListener("reply:new",a),fe.addListener("reply:liked",r),()=>{fe.removeListener("discussion:liked",t),fe.removeListener("discussion:updated",s),fe.removeListener("reply:new",a),fe.removeListener("reply:liked",r)}}),[o.id,o._id]),t.jsxs(Q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},whileHover:{scale:1.01},className:"bg-white/5 border border-white/10 rounded-lg p-6 hover:bg-white/10 transition-all duration-200",role:"article","aria-labelledby":"discussion-title-"+(o.id||o._id),children:[u&&t.jsx("div",{className:"mb-4 p-2 bg-red-500/20 border border-red-500/30 rounded text-red-400 text-sm",children:u}),t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("img",{src:o.author.avatar||"/default-avatar.png",alt:o.author.username+"'s avatar",className:"w-10 h-10 rounded-full",loading:"lazy"}),t.jsxs("div",{children:[t.jsx(p,{to:"/profile/"+o.author._id,className:"text-white font-medium hover:text-white/80 transition-colors","aria-label":`View ${o.author.username}'s profile`,children:o.author.username}),t.jsx("p",{className:"text-white/40 text-sm",title:new Date(o.createdAt).toLocaleString(),children:xe(new Date(o.createdAt),{addSuffix:!0})})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:async()=>{if(!i)return void m("Please login to like discussions");const e=o.id||o._id;if(e){d(!0),m(null);try{const t=await Fe.likeDiscussion(e);l((e=>({...e,likes:t.likes,isLiked:t.isLiked}))),fe.emitDiscussionLike({discussionId:e,likes:t.likes,isLiked:t.isLiked})}catch(t){m("Failed to like discussion. Please try again.")}finally{d(!1)}}else m("Discussion ID is undefined")},disabled:c,className:"p-2 rounded-lg transition-all duration-200 "+(o.isLiked?"bg-red-500/20 text-red-400 hover:bg-red-500/30":"text-white/60 hover:text-white hover:bg-white/5"),"aria-label":o.isLiked?"Unlike discussion":"Like discussion",children:t.jsx(Q.svg,{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:o.isLiked?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",whileTap:{scale:.9},children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),t.jsx("span",{className:"text-white/60 text-sm","aria-label":o.likes.length+" likes",children:o.likes.length}),t.jsx("button",{onClick:async()=>{const e=o.id||o._id;if(e)try{await navigator.share({title:o.title,text:o.content.substring(0,100)+"...",url:window.location.origin+"/community/discussion/"+e})}catch(t){}},className:"p-2 rounded-lg text-white/60 hover:text-white hover:bg-white/5 transition-all duration-200","aria-label":"Share discussion",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})})}),i&&o.author._id===i.id&&t.jsx("button",{onClick:async()=>{const e=o.id||o._id;if(e){if(!i)return a.error("Please log in to delete discussions"),void n("/login",{state:{from:"/community/discussion/"+e}});if(o.author._id===i.id){if(window.confirm("Are you sure you want to delete this discussion? This action cannot be undone."))try{await Fe.deleteDiscussion(e),a.success("Discussion deleted successfully"),r&&r(null)}catch(t){403===t.response?.status?a.error("You are not authorized to delete this discussion"):404===t.response?.status?a.error("Discussion not found"):a.error("Failed to delete discussion. Please try again.")}}else a.error("You can only delete your own discussions")}else a.error("Discussion ID is undefined")},className:"p-2 rounded-lg text-red-400 hover:text-red-300 hover:bg-red-500/10 transition-all duration-200","aria-label":"Delete discussion",title:"Delete discussion",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),t.jsx(p,{to:"/community/discussion/"+(o.id||o._id),className:"block group",onClick:async e=>{e.preventDefault();const t=o.id||o._id;if(t)try{const e=await Fe.getDiscussion(t);w(e.views),r&&r(e),n("/community/discussion/"+t)}catch(s){n("/community/discussion/"+t)}},children:t.jsx("h3",{id:"discussion-title-"+(o.id||o._id),className:"text-xl font-semibold mb-2 group-hover:text-white/80 transition-colors",children:o.title})}),t.jsx("p",{className:"text-white/60 mb-4 line-clamp-3",children:o.content}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"flex gap-2 flex-wrap",children:o.tags.map((e=>t.jsx("span",{className:"px-2 py-1 bg-white/10 rounded-full text-sm text-white/80 hover:bg-white/20 transition-colors",children:e},e)))}),t.jsxs("div",{className:"flex items-center gap-4 text-sm text-white/40",children:[t.jsxs("span",{"aria-label":f+" views",children:[f," views"]}),t.jsxs("button",{onClick:()=>g(!x),className:"flex items-center gap-1 hover:text-white/60 transition-colors","aria-label":o.replies.length+" replies",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),o.replies.length," replies"]})]})]}),x&&t.jsx(xa,{discussionId:o.id||o._id,replies:o.replies,onReplyAdded:e=>{r&&r(e)}})]})},fa=["Movies","TV Shows","Anime","Documentaries","Reviews","Recommendations","News","General"],wa=({onDiscussionCreated:s})=>{const a=h();Rt();const[r,i]=e.useState(!1),[n,o]=e.useState(""),[l,c]=e.useState(""),[d,u]=e.useState(""),[m,p]=e.useState(""),[x,g]=e.useState(!1),[f,w]=e.useState("");return t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:()=>{localStorage.getItem("accessToken")?i(!0):a("/login",{state:{from:"/community"}})},className:"fixed bottom-8 right-8 bg-white text-black px-6 py-3 rounded-full font-medium shadow-lg hover:bg-white/90 transition-all duration-200 flex items-center gap-2",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),"New Discussion"]}),t.jsx(Z,{children:r&&t.jsx(Q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs(Q.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-[#1a1d21] rounded-lg w-full max-w-2xl p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h2",{className:"text-2xl font-bold text-white",children:"Create Discussion"}),t.jsx("button",{onClick:()=>i(!1),className:"text-white/60 hover:text-white transition-colors",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsxs("form",{onSubmit:async e=>{e.preventDefault(),w(""),g(!0);try{if(!localStorage.getItem("accessToken"))return w("Please log in to create a discussion"),i(!1),void a("/login",{state:{from:"/community"}});if(!m)return w("Please select a category"),void g(!1);const e=d.split(",").map((e=>e.trim())).filter((e=>e.length>0)),t=await Fe.createDiscussion({title:n,content:l,tags:e,category:m});o(""),c(""),u(""),p(""),i(!1),s&&s(t)}catch(t){"Authentication required"===t.message?(w("Please log in to create a discussion"),i(!1),a("/login",{state:{from:"/community"}})):w(t.message||"Error creating discussion")}finally{g(!1)}},className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-white/80 mb-2",children:"Title"}),t.jsx("input",{type:"text",value:n,onChange:e=>o(e.target.value),className:"w-full bg-white/5 border border-white/10 rounded-lg px-4 py-2 text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/20",placeholder:"Enter discussion title",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white/80 mb-2",children:"Category"}),t.jsxs("select",{value:m,onChange:e=>p(e.target.value),className:"w-full bg-white/5 border border-white/10 rounded-lg px-4 py-2 text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/20",required:!0,children:[t.jsx("option",{value:"",children:"Select a category"}),fa.map((e=>t.jsx("option",{value:e,children:e},e)))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white/80 mb-2",children:"Content"}),t.jsx("textarea",{value:l,onChange:e=>c(e.target.value),className:"w-full bg-white/5 border border-white/10 rounded-lg px-4 py-2 text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/20 min-h-[200px]",placeholder:"Write your discussion content...",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white/80 mb-2",children:"Tags (comma-separated)"}),t.jsx("input",{type:"text",value:d,onChange:e=>u(e.target.value),className:"w-full bg-white/5 border border-white/10 rounded-lg px-4 py-2 text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/20",placeholder:"e.g., movies, action, 2024"})]}),f&&t.jsx("div",{className:"text-red-400 text-sm",children:f}),t.jsxs("div",{className:"flex justify-end gap-4",children:[t.jsx("button",{type:"button",onClick:()=>i(!1),className:"px-6 py-2 text-white/60 hover:text-white transition-colors",children:"Cancel"}),t.jsx("button",{type:"submit",disabled:x,className:"px-6 py-2 bg-white text-black rounded-lg font-medium hover:bg-white/90 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:x?"Creating...":"Create Discussion"})]})]})]})})})]})},ba=[{value:"latest",label:"Latest",icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})},{value:"popular",label:"Most Popular",icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})})},{value:"trending",label:"Trending",icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}],va=({sortBy:s,onSortChange:a,selectedCategory:r,onCategoryChange:i,selectedTag:n,onTagChange:o,categories:l,topTags:c,onClearFilters:d})=>{const[u,h]=e.useState(null),m=e.useRef(null),p=e.useRef(null),x=e.useRef(null);e.useEffect((()=>{const e=e=>{m.current&&!m.current.contains(e.target)&&p.current&&!p.current.contains(e.target)&&x.current&&!x.current.contains(e.target)&&h(null)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[]);const g=ba.find((e=>e.value===s))||ba[0];return t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"relative",ref:m,children:[t.jsxs("button",{onClick:()=>h("sort"===u?null:"sort"),className:"flex items-center gap-2 px-3 py-2 bg-[#1a1d24] border border-[#2a2d34] rounded-full hover:bg-[#2a2d34] transition-colors",children:[g.icon,t.jsx("span",{className:"text-sm text-white/90",children:g.label}),t.jsx("svg",{className:"w-4 h-4 transition-transform duration-200 text-white/60 "+("sort"===u?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t.jsx(Z,{children:"sort"===u&&t.jsx(Q.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute z-50 mt-2 w-56 bg-[#1a1d24] border border-[#2a2d34] rounded-lg shadow-lg overflow-hidden",children:t.jsx("div",{className:"py-1",children:ba.map((e=>t.jsxs("button",{onClick:()=>{a(e.value),h(null)},className:"w-full px-4 py-2.5 text-left text-sm hover:bg-[#2a2d34] flex items-center gap-3 "+(s===e.value?"text-white bg-[#2a2d34]":"text-white/70"),children:[e.icon,e.label]},e.value)))})})})]}),t.jsxs("div",{className:"relative",ref:p,children:[t.jsxs("button",{onClick:()=>h("category"===u?null:"category"),className:"flex items-center gap-2 px-3 py-2 bg-[#1a1d24] border border-[#2a2d34] rounded-full hover:bg-[#2a2d34] transition-colors",children:[t.jsx("svg",{className:"w-4 h-4 text-white/90",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),t.jsx("span",{className:"text-sm text-white/90",children:r||"Category"}),t.jsx("svg",{className:"w-4 h-4 transition-transform duration-200 text-white/60 "+("category"===u?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t.jsx(Z,{children:"category"===u&&t.jsx(Q.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute z-50 mt-2 w-56 bg-[#1a1d24] border border-[#2a2d34] rounded-lg shadow-lg overflow-hidden",children:t.jsxs("div",{className:"py-1",children:[t.jsxs("button",{onClick:()=>{i(""),h(null)},className:"w-full px-4 py-2.5 text-left text-sm hover:bg-[#2a2d34] flex items-center gap-3 "+(r?"text-white/70":"text-white bg-[#2a2d34]"),children:[t.jsx("svg",{className:"w-4 h-4 text-white/90",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),"All Categories"]}),l.map((e=>t.jsxs("button",{onClick:()=>{i(e.name),h(null)},className:"w-full px-4 py-2.5 text-left text-sm hover:bg-[#2a2d34] flex items-center justify-between "+(r===e.name?"text-white bg-[#2a2d34]":"text-white/70"),children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("svg",{className:"w-4 h-4 text-white/90",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),e.name]}),t.jsxs("span",{className:"text-white/50 text-xs",children:["(",e.count,")"]})]},e.name)))]})})})]}),t.jsxs("div",{className:"relative",ref:x,children:[t.jsxs("button",{onClick:()=>h("tags"===u?null:"tags"),className:"flex items-center gap-2 px-3 py-2 bg-[#1a1d24] border border-[#2a2d34] rounded-full hover:bg-[#2a2d34] transition-colors",children:[t.jsx("svg",{className:"w-4 h-4 text-white/90",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),t.jsx("span",{className:"text-sm text-white/90",children:n||"Tags"}),t.jsx("svg",{className:"w-4 h-4 transition-transform duration-200 text-white/60 "+("tags"===u?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t.jsx(Z,{children:"tags"===u&&t.jsx(Q.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute z-50 mt-2 w-56 bg-[#1a1d24] border border-[#2a2d34] rounded-lg shadow-lg overflow-hidden",children:t.jsxs("div",{className:"py-1",children:[t.jsxs("button",{onClick:()=>{o(""),h(null)},className:"w-full px-4 py-2.5 text-left text-sm hover:bg-[#2a2d34] flex items-center gap-3 "+(n?"text-white/70":"text-white bg-[#2a2d34]"),children:[t.jsx("svg",{className:"w-4 h-4 text-white/90",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),"All Tags"]}),c.map((e=>t.jsxs("button",{onClick:()=>{o(e.name),h(null)},className:"w-full px-4 py-2.5 text-left text-sm hover:bg-[#2a2d34] flex items-center justify-between "+(n===e.name?"text-white bg-[#2a2d34]":"text-white/70"),children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("svg",{className:"w-4 h-4 text-white/90",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),e.name]}),t.jsxs("span",{className:"text-white/50 text-xs",children:["(",e.count,")"]})]},e.name)))]})})})]}),(r||n)&&t.jsxs("div",{className:"flex items-center gap-2",children:[r&&t.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-[#1a1d24] border border-[#2a2d34] rounded-full",children:[t.jsx("span",{className:"text-sm text-white/70",children:"Category:"}),t.jsx("span",{className:"text-sm text-white/90",children:r}),t.jsx("button",{onClick:()=>i(""),className:"p-1 hover:bg-[#2a2d34] rounded-full transition-colors",children:t.jsx("svg",{className:"w-3 h-3 text-white/70",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),n&&t.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-[#1a1d24] border border-[#2a2d34] rounded-full",children:[t.jsx("span",{className:"text-sm text-white/70",children:"Tag:"}),t.jsx("span",{className:"text-sm text-white/90",children:n}),t.jsx("button",{onClick:()=>o(""),className:"p-1 hover:bg-[#2a2d34] rounded-full transition-colors",children:t.jsx("svg",{className:"w-3 h-3 text-white/70",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsxs("button",{onClick:d,className:"flex items-center gap-1 px-2 py-1 text-sm text-white/70 hover:text-white/90 hover:bg-[#2a2d34] rounded-full transition-colors",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Clear all"]})]})]})},ya=()=>{const e={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.4,ease:"easeOut"}}},s={pulse:{opacity:[.4,.8,.4],transition:{duration:1.5,repeat:1/0,ease:"easeInOut"}}};return t.jsx("div",{className:"min-h-screen bg-[#0f1114] text-white",children:t.jsx("div",{className:"max-w-7xl mx-auto px-2 py-4 sm:px-4 sm:py-8",children:t.jsxs(Q.div,{variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.1}}},initial:"hidden",animate:"visible",className:"space-y-6",children:[t.jsxs(Q.div,{variants:e,className:"flex flex-col space-y-4 mb-8",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx(Q.div,{variants:s,animate:"pulse",className:"h-8 w-32 bg-white/10 rounded-lg"}),t.jsx(Q.div,{variants:s,animate:"pulse",className:"h-10 w-40 bg-white/10 rounded-full"})]}),t.jsxs("div",{className:"flex flex-col lg:flex-row items-start lg:items-center gap-4",children:[t.jsx(Q.div,{variants:s,animate:"pulse",className:"w-full lg:w-1/2",children:t.jsx("div",{className:"h-10 bg-white/10 rounded-full relative",children:t.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 bg-white/20 rounded-full"})})}),t.jsx(Q.div,{variants:s,animate:"pulse",className:"w-full lg:w-auto",children:t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[t.jsx("div",{className:"h-10 w-28 sm:w-32 bg-white/10 rounded-full"}),t.jsx("div",{className:"h-10 w-28 sm:w-32 bg-white/10 rounded-full"}),t.jsx("div",{className:"h-10 w-20 sm:w-24 bg-white/10 rounded-full"})]})}),t.jsxs(Q.div,{variants:s,animate:"pulse",className:"flex space-x-2 w-full lg:w-auto",children:[t.jsx("div",{className:"h-10 w-28 sm:w-32 bg-white/10 rounded-full flex-1 lg:flex-none"}),t.jsx("div",{className:"h-10 w-28 sm:w-32 bg-white/10 rounded-full flex-1 lg:flex-none"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-4 sm:gap-8",children:[t.jsx(Q.div,{variants:e,className:"lg:col-span-3 space-y-4 order-2 lg:order-1",children:[...[,,,,,]].map(((e,a)=>t.jsx(Q.div,{variants:s,animate:"pulse",className:"bg-white/5 border border-white/10 rounded-lg p-4 sm:p-6",children:t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsx("div",{className:"w-10 h-10 bg-white/10 rounded-full flex-shrink-0"}),t.jsxs("div",{className:"flex-1 space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"h-4 w-24 bg-white/10 rounded"}),t.jsx("div",{className:"h-3 w-20 bg-white/10 rounded"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-8 h-8 bg-white/10 rounded-lg"}),t.jsx("div",{className:"w-8 h-8 bg-white/10 rounded-lg"}),t.jsx("div",{className:"w-8 h-8 bg-white/10 rounded-lg"})]})]}),t.jsx("div",{className:"h-6 w-3/4 bg-white/10 rounded"}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"h-4 w-full bg-white/10 rounded"}),t.jsx("div",{className:"h-4 w-2/3 bg-white/10 rounded"}),t.jsx("div",{className:"h-4 w-4/5 bg-white/10 rounded"})]}),t.jsxs("div",{className:"flex items-center justify-between pt-2",children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsx("div",{className:"h-6 w-16 bg-white/10 rounded-full"}),t.jsx("div",{className:"h-6 w-20 bg-white/10 rounded-full"}),t.jsx("div",{className:"h-6 w-14 bg-white/10 rounded-full"})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"h-4 w-16 bg-white/10 rounded"}),t.jsx("div",{className:"h-4 w-20 bg-white/10 rounded"})]})]})]})]})},a)))}),t.jsxs(Q.div,{variants:e,className:"lg:col-span-2 space-y-4 order-1 lg:order-2",children:[t.jsxs(Q.div,{variants:s,animate:"pulse",className:"bg-white/5 border border-white/10 rounded-lg p-3 sm:p-4",children:[t.jsxs("div",{className:"flex justify-between items-center mb-3 sm:mb-4",children:[t.jsx("div",{className:"h-5 sm:h-6 w-32 sm:w-40 bg-white/10 rounded"}),t.jsx("div",{className:"h-5 sm:h-6 w-5 sm:w-6 bg-white/10 rounded"})]}),t.jsx("div",{className:"grid grid-cols-2 gap-3 sm:gap-4",children:[...[,,,,]].map(((e,s)=>t.jsxs("div",{className:"bg-white/5 rounded-lg p-3 sm:p-4",children:[t.jsx("div",{className:"h-3 sm:h-4 w-20 sm:w-24 bg-white/10 rounded mb-1.5 sm:mb-2"}),t.jsx("div",{className:"h-6 sm:h-8 w-12 sm:w-16 bg-white/10 rounded"})]},s)))})]}),t.jsxs(Q.div,{variants:s,animate:"pulse",className:"bg-white/5 border border-white/10 rounded-lg p-3 sm:p-4",children:[t.jsx("div",{className:"h-5 sm:h-6 w-32 sm:w-40 bg-white/10 rounded mb-3 sm:mb-4"}),t.jsx("div",{className:"space-y-2 sm:space-y-3",children:[...[,,,,,]].map(((e,s)=>t.jsxs("div",{className:"flex items-center justify-between p-1.5 sm:p-2",children:[t.jsx("div",{className:"h-3 sm:h-4 w-20 sm:w-24 bg-white/10 rounded"}),t.jsx("div",{className:"h-3 sm:h-4 w-12 sm:w-16 bg-white/10 rounded"})]},s)))})]})]})]})]})})})},ja=({count:e=1})=>{const s={pulse:{opacity:[.4,.8,.4],transition:{duration:1.5,repeat:1/0,ease:"easeInOut"}}},a={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.4,ease:"easeOut"}}};return t.jsx(t.Fragment,{children:[...Array(e)].map(((e,r)=>t.jsx(Q.div,{variants:a,initial:"hidden",animate:"visible",transition:{delay:.1*r},className:"bg-white/5 border border-white/10 rounded-lg p-4 sm:p-6",children:t.jsxs("div",{className:"flex items-start gap-3 sm:gap-4",children:[t.jsx(Q.div,{variants:s,animate:"pulse",className:"w-8 h-8 sm:w-10 sm:h-10 bg-white/10 rounded-full flex-shrink-0"}),t.jsxs("div",{className:"flex-1 space-y-2 sm:space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[t.jsx(Q.div,{variants:s,animate:"pulse",className:"h-3 sm:h-4 w-20 sm:w-24 bg-white/10 rounded"}),t.jsx(Q.div,{variants:s,animate:"pulse",className:"h-2 sm:h-3 w-16 sm:w-20 bg-white/10 rounded"})]}),t.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[t.jsx(Q.div,{variants:s,animate:"pulse",className:"w-6 h-6 sm:w-8 sm:h-8 bg-white/10 rounded-lg"}),t.jsx(Q.div,{variants:s,animate:"pulse",className:"w-6 h-6 sm:w-8 sm:h-8 bg-white/10 rounded-lg"}),t.jsx(Q.div,{variants:s,animate:"pulse",className:"w-6 h-6 sm:w-8 sm:h-8 bg-white/10 rounded-lg"})]})]}),t.jsx(Q.div,{variants:s,animate:"pulse",className:"h-5 sm:h-6 w-3/4 bg-white/10 rounded"}),t.jsxs("div",{className:"space-y-1.5 sm:space-y-2",children:[t.jsx(Q.div,{variants:s,animate:"pulse",className:"h-3 sm:h-4 w-full bg-white/10 rounded"}),t.jsx(Q.div,{variants:s,animate:"pulse",className:"h-3 sm:h-4 w-2/3 bg-white/10 rounded"}),t.jsx(Q.div,{variants:s,animate:"pulse",className:"h-3 sm:h-4 w-4/5 bg-white/10 rounded"})]}),t.jsxs("div",{className:"flex items-center justify-between pt-2",children:[t.jsxs("div",{className:"flex gap-1.5 sm:gap-2",children:[t.jsx(Q.div,{variants:s,animate:"pulse",className:"h-5 sm:h-6 w-12 sm:w-16 bg-white/10 rounded-full"}),t.jsx(Q.div,{variants:s,animate:"pulse",className:"h-5 sm:h-6 w-16 sm:w-20 bg-white/10 rounded-full"}),t.jsx(Q.div,{variants:s,animate:"pulse",className:"h-5 sm:h-6 w-10 sm:w-14 bg-white/10 rounded-full"})]}),t.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[t.jsx(Q.div,{variants:s,animate:"pulse",className:"h-3 sm:h-4 w-12 sm:w-16 bg-white/10 rounded"}),t.jsx(Q.div,{variants:s,animate:"pulse",className:"h-3 sm:h-4 w-16 sm:w-20 bg-white/10 rounded"})]})]})]})]})},r)))})},Na=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const{id:s}=$(),r=h(),{user:i}=Rt(),[n,o]=e.useState(null),[l,c]=e.useState(!0),[d,u]=e.useState(null);e.useEffect((()=>{m(),fe.connect();const e=e=>{e.discussionId===s&&m()},t=e=>{e.discussionId===s&&o((t=>({...t,likes:e.likes,isLiked:e.isLiked})))},a=e=>{e.discussionId===s&&m()};return fe.addListener("reply:new",e),fe.addListener("discussion:liked",t),fe.addListener("reply:liked",a),()=>{fe.removeListener("reply:new",e),fe.removeListener("discussion:liked",t),fe.removeListener("reply:liked",a)}}),[s]);const m=async()=>{try{c(!0);const e=await Fe.getDiscussion(s);o(e),u(null)}catch(e){u("Failed to load discussion. Please try again later.")}finally{c(!1)}};return l?t.jsx("div",{className:"min-h-screen bg-[#0f1114] text-white p-8",children:t.jsxs("div",{className:"animate-pulse space-y-4",children:[t.jsx("div",{className:"h-8 bg-white/10 rounded w-1/4"}),t.jsx("div",{className:"h-32 bg-white/10 rounded"}),t.jsx("div",{className:"h-32 bg-white/10 rounded"})]})}):d?t.jsx("div",{className:"min-h-screen bg-[#0f1114] text-white p-8",children:t.jsx("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-4 text-red-500",children:d})}):n?t.jsx("div",{className:"min-h-screen bg-[#0f1114] text-white p-3 sm:p-8",children:t.jsxs("div",{className:"max-w-4xl mx-auto",children:[t.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-lg p-6 mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold mb-4",children:n.title}),t.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[t.jsx("img",{src:n.author.profilePicture||"/default-avatar.png",alt:n.author.username,className:"w-10 h-10 rounded-full"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:n.author.username}),t.jsx("p",{className:"text-sm text-white/60",children:xe(new Date(n.createdAt),{addSuffix:!0})})]})]}),t.jsx("div",{className:"prose prose-invert max-w-none mb-6",children:n.content}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("button",{onClick:async()=>{if(!i)return a.error("Please log in to like discussions"),void r("/login",{state:{from:"/community/discussion/"+s}});try{const e=await Fe.likeDiscussion(s);o(e),fe.emitDiscussionLike({discussionId:s,likes:e.likes,isLiked:e.isLiked})}catch(e){401===e.response?.status?(a.error("Please log in to like"),r("/login",{state:{from:"/community/discussion/"+s}})):a.error("Failed to update like. Please try again.")}},className:"flex items-center gap-2 px-4 py-2 rounded-lg transition-colors "+(n.isLiked?"bg-red-500/20 text-red-500 hover:bg-red-500/30":"bg-white/5 hover:bg-white/10"),children:[t.jsx("svg",{className:"w-5 h-5",fill:n.isLiked?"currentColor":"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),t.jsx("span",{children:n.likes.length})]}),t.jsxs("div",{className:"text-sm text-white/60",children:[n.views," views"]})]}),i&&n.author._id===i.id&&t.jsxs("button",{onClick:async()=>{if(!i)return a.error("Please log in to delete discussions"),void r("/login",{state:{from:"/community/discussion/"+s}});if(n.author._id===i.id){if(window.confirm("Are you sure you want to delete this discussion? This action cannot be undone."))try{await Fe.deleteDiscussion(s),a.success("Discussion deleted successfully"),r("/community")}catch(e){403===e.response?.status?a.error("You are not authorized to delete this discussion"):404===e.response?.status?a.error("Discussion not found"):a.error("Failed to delete discussion. Please try again.")}}else a.error("You can only delete your own discussions")},className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-red-500/20 text-red-500 hover:bg-red-500/30 transition-colors",title:"Delete discussion",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),t.jsx("span",{children:"Delete"})]})]})]}),t.jsx(xa,{discussionId:s,replies:n.replies,onReplyAdded:m})]})}):t.jsx("div",{className:"min-h-screen bg-[#0f1114] text-white p-8",children:t.jsx("div",{className:"text-center text-white/60",children:"Discussion not found"})})}},Symbol.toStringTag,{value:"Module"})),ka=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const e=Array.from({length:20},((e,t)=>"Item "+(t+1)));return t.jsxs("div",{className:"p-4 space-y-6",children:[t.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Overflow Test Components"}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("h3",{className:"text-lg font-semibold text-white",children:"Basic overflow-x-auto"}),t.jsx("div",{className:"flex gap-3 overflow-x-auto bg-gray-800 p-4 rounded-lg",children:e.map(((e,s)=>t.jsx("div",{className:"flex-shrink-0 bg-blue-500 text-white px-4 py-2 rounded",children:e},s)))})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("h3",{className:"text-lg font-semibold text-white",children:"With horizontal-scroll-container class"}),t.jsx("div",{className:"flex gap-3 overflow-x-auto horizontal-scroll-container bg-gray-800 p-4 rounded-lg",children:e.map(((e,s)=>t.jsx("div",{className:"flex-shrink-0 bg-green-500 text-white px-4 py-2 rounded",children:e},s)))})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("h3",{className:"text-lg font-semibold text-white",children:"Category selector style"}),t.jsx("div",{className:"relative inline-flex rounded-full bg-[#1a1a1a] p-1 overflow-x-auto max-w-full horizontal-scroll-container",children:e.slice(0,10).map(((e,s)=>t.jsx("button",{className:"relative px-4 py-2 rounded-full text-sm font-medium transition-colors duration-300 whitespace-nowrap focus:outline-none text-gray-400 hover:text-white",children:t.jsx("span",{className:"relative z-10",children:e})},s)))})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("h3",{className:"text-lg font-semibold text-white",children:"Movie cards style"}),t.jsx("div",{className:"flex gap-3 sm:gap-4 md:gap-6 overflow-x-auto scrollbar-hide pb-4 px-2 sm:px-4 horizontal-scroll-container",children:e.slice(0,15).map(((e,s)=>t.jsx("div",{className:"flex-shrink-0",children:t.jsx("div",{className:"w-80 h-48 bg-purple-500 rounded-lg flex items-center justify-center text-white font-semibold",children:e})},s)))})]})]})}},Symbol.toStringTag,{value:"Module"})),Ca=Object.freeze(Object.defineProperty({__proto__:null,default:({children:e})=>{const{user:s,loading:a}=Rt(),r=m();return a?t.jsx("div",{className:"min-h-screen bg-[#0f1114] text-white flex items-center justify-center",children:t.jsx("div",{className:"w-5 h-5 border-t-2 border-b-2 border-white rounded-full animate-spin"})}):s?e:t.jsx(H,{to:"/login",state:{from:r},replace:!0})}},Symbol.toStringTag,{value:"Module"})),Sa=s.memo((()=>{const s=m(),[a,r]=e.useState({}),[i,n]=e.useState([]),[o,l]=e.useState({}),c=e.useRef(null),d=e.useRef(!0),u=e.useRef(performance.now()),h=e.useCallback((()=>({userAgent:navigator.userAgent,platform:navigator.platform,hardwareConcurrency:navigator.hardwareConcurrency,deviceMemory:navigator.deviceMemory,maxTouchPoints:navigator.maxTouchPoints,viewport:{width:window.innerWidth,height:window.innerHeight,devicePixelRatio:window.devicePixelRatio},screen:{width:window.screen.width,height:window.screen.height,availWidth:window.screen.availWidth,availHeight:window.screen.availHeight}})),[]),p=e.useCallback((e=>{if(!d.current)return;const t=e.touches[0];n((e=>[...e.slice(-9),{type:"touchstart",x:t.clientX,y:t.clientY,timestamp:Date.now()}]))}),[]),x=e.useCallback((e=>{if(!d.current)return;const t=e.touches[0];n((e=>[...e.slice(-9),{type:"touchmove",x:t.clientX,y:t.clientY,timestamp:Date.now()}]))}),[]),g=e.useCallback((e=>{d.current&&n((e=>[...e.slice(-9),{type:"touchend",timestamp:Date.now()}]))}),[]),f=e.useCallback((()=>{if(!d.current)return;const e=performance.now(),t=e-u.current;l({frameTime:t.toFixed(2),fps:(1e3/t).toFixed(1),memory:performance.memory?{used:Math.round(performance.memory.usedJSHeapSize/1024/1024),total:Math.round(performance.memory.totalJSHeapSize/1024/1024),limit:Math.round(performance.memory.jsHeapSizeLimit/1024/1024)}:null}),u.current=e}),[]);e.useEffect((()=>(r(h()),document.addEventListener("touchstart",p,{passive:!0}),document.addEventListener("touchmove",x,{passive:!0}),document.addEventListener("touchend",g,{passive:!0}),c.current=setInterval(f,1e3),()=>{d.current=!1,document.removeEventListener("touchstart",p),document.removeEventListener("touchmove",x),document.removeEventListener("touchend",g),c.current&&(clearInterval(c.current),c.current=null)})),[h,p,x,g,f]),e.useEffect((()=>()=>{d.current=!1,c.current&&(clearInterval(c.current),c.current=null)}),[]);const w=e.useCallback((()=>{if(d.current)try{const e=new TouchEvent("touchstart",{touches:[{clientX:100,clientY:window.innerHeight-50}]});document.dispatchEvent(e)}catch(e){}}),[]),b=e.useCallback((()=>{d.current&&n([])}),[]),v=e.useCallback((()=>{d.current&&window.location.reload()}),[]);return t.jsx("div",{className:"min-h-screen bg-gray-900 text-white p-4",children:t.jsxs("div",{className:"max-w-4xl mx-auto",children:[t.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Bottom Navbar Test - Mid-Tier Phone Debug"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Device Information"}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{children:[t.jsx("strong",{children:"Platform:"})," ",a.platform]}),t.jsxs("div",{children:[t.jsx("strong",{children:"CPU Cores:"})," ",a.hardwareConcurrency]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Memory:"})," ",a.deviceMemory,"GB"]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Touch Points:"})," ",a.maxTouchPoints]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Pixel Ratio:"})," ",a.viewport?.devicePixelRatio]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Viewport:"})," ",a.viewport?.width," × ",a.viewport?.height]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Screen:"})," ",a.screen?.width," × ",a.screen?.height]})]})]}),t.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Performance"}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{children:[t.jsx("strong",{children:"Frame Time:"})," ",o.frameTime,"ms"]}),t.jsxs("div",{children:[t.jsx("strong",{children:"FPS:"})," ",o.fps]}),o.memory&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("strong",{children:"Memory Used:"})," ",o.memory.used,"MB"]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Memory Total:"})," ",o.memory.total,"MB"]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Memory Limit:"})," ",o.memory.limit,"MB"]})]})]})]}),t.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Touch Events (Last 10)"}),t.jsx("div",{className:"space-y-1 text-xs max-h-40 overflow-y-auto",children:i.map(((e,s)=>t.jsxs("div",{className:"text-gray-300",children:[e.type,": ",e.x,", ",e.y," (",e.timestamp,")"]},s)))})]}),t.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Test Controls"}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("button",{onClick:w,className:"w-full bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded transition-colors",children:"Test Bottom Nav Touch"}),t.jsx("button",{onClick:v,className:"w-full bg-green-600 hover:bg-green-700 px-4 py-2 rounded transition-colors",children:"Reload Page"}),t.jsx("button",{onClick:b,className:"w-full bg-yellow-600 hover:bg-yellow-700 px-4 py-2 rounded transition-colors",children:"Clear Touch Events"})]})]})]}),t.jsxs("div",{className:"mt-6 bg-gray-800 p-4 rounded-lg",children:[t.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Current Route"}),t.jsx("div",{className:"text-lg font-mono",children:s.pathname})]}),t.jsxs("div",{className:"mt-6 bg-blue-900 p-4 rounded-lg",children:[t.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Testing Instructions"}),t.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[t.jsx("li",{children:"Navigate between different routes using the bottom navbar"}),t.jsx("li",{children:"Check if touch events are being registered properly"}),t.jsx("li",{children:"Monitor performance metrics for any lag or stuttering"}),t.jsx("li",{children:"Test on different screen orientations"}),t.jsx("li",{children:"Check if the indicator moves smoothly between nav items"})]})]})]})})})),_a=Object.freeze(Object.defineProperty({__proto__:null,default:Sa},Symbol.toStringTag,{value:"Module"})),La=()=>{["https://111movies.com/movie/tt0111161?t=3600","https://player.videasy.net/movie/tt0111161?time=1800","https://vidjoy.pro/embed/movie/tt0111161?start=900","https://vidfast.pro/movie/tt0111161?position=2700","https://rivestream.net/embed?type=movie&id=tt0111161&t=3600","https://cinemaos.tech/player/tt0111161?time=1800","https://111movies.com/movie/tt0111161?seek=5400","https://111movies.com/movie/tt0111161?timestamp=7200"].forEach((e=>{Be.extractTimestampFromUrl(e)})),[{currentTime:1800,duration:7200,playing:!0},{progress:25,currentTime:1800,duration:7200},{time:3600,duration:7200},{type:"progress",currentTime:5400,duration:7200,progress:75},{type:"timeUpdate",time:900,duration:7200}].forEach(((e,t)=>{Be.parseProgressData(e)})),Be.checkLocalStorageForProgress(),["https://111movies.com/movie/tt0111161","https://player.videasy.net/movie/tt0111161","https://vidjoy.pro/embed/movie/tt0111161","https://vidfast.pro/movie/tt0111161","https://rivestream.net/embed?type=movie&id=tt0111161","https://cinemaos.tech/player/tt0111161"].forEach((e=>{Be.getStreamingServiceFromUrl(e)}));const e="test-listener";let t=[];Be.addListener(e,(e=>{t.push(e)}));const s=["https://111movies.com","https://player.videasy.net","https://vidjoy.pro","https://vidfast.pro","https://rivestream.net","https://cinemaos.tech"];return[{currentTime:1800,duration:7200,playing:!0},{progress:50,currentTime:3600,duration:7200},{time:5400,duration:7200},{type:"progress",currentTime:7200,duration:7200,progress:100}].forEach(((e,t)=>{const a={origin:s[t%s.length],data:e};Be.handleMessage(a)})),setTimeout((()=>{Be.removeListener(e)}),1e3),{serviceStatus:{isListening:Be.isListening,allowedDomains:Be.allowedDomains},receivedMessages:t}},Ta=(e,t=7200)=>{const s={currentTime:e/100*t,duration:t,progress:e,playing:!0},a={origin:"https://111movies.com",data:s};return Be.handleMessage(a),s},Ma=()=>{const[s,a]=e.useState("https://111movies.com/movie/tt0111161"),[r,i]=e.useState(0),[n,o]=e.useState(!1),l=e.useRef(null),c={id:"tt0111161",title:"The Shawshank Redemption",type:"movie",poster_path:"/test-poster.jpg",backdrop_path:"/test-backdrop.jpg"},{startTracking:d,stopTracking:u,getCurrentProgress:h,setProgress:m,isTracking:p,progress:x,duration:g}=ne(c,l,{autoStart:!1,updateInterval:5e3,urlCheckInterval:3e3,minProgressChange:1}),f=h();return t.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[t.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Iframe Progress Tracking Demo"}),t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-6",children:[t.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Test Controls"}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsx("button",{onClick:()=>{La()},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded text-white",children:"Run Progress Tests"}),t.jsx("button",{onClick:()=>{const e=Math.floor(100*Math.random());Ta(e),i(e)},className:"px-4 py-2 bg-green-600 hover:bg-green-700 rounded text-white",children:"Simulate Progress Update"}),t.jsx("button",{onClick:()=>{const e=Math.floor(100*Math.random());m(e),i(e)},className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded text-white",children:"Set Manual Progress"})]})]}),t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-6",children:[t.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Progress Tracking"}),t.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[t.jsx("button",{onClick:()=>{d(),o(!0)},disabled:p,className:"px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 rounded text-white",children:"Start Tracking"}),t.jsx("button",{onClick:()=>{u(),o(!1)},disabled:!p,className:"px-4 py-2 bg-red-600 hover:bg-red-700 disabled:bg-gray-600 rounded text-white",children:"Stop Tracking"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-gray-700 rounded p-3",children:[t.jsx("h3",{className:"font-medium mb-2",children:"Tracking Status"}),t.jsxs("p",{children:["Is Tracking: ",t.jsx("span",{className:p?"text-green-400":"text-red-400",children:p?"Yes":"No"})]}),t.jsxs("p",{children:["Is Playing: ",t.jsx("span",{className:n?"text-green-400":"text-red-400",children:n?"Yes":"No"})]})]}),t.jsxs("div",{className:"bg-gray-700 rounded p-3",children:[t.jsx("h3",{className:"font-medium mb-2",children:"Current Progress"}),t.jsxs("p",{children:["Tracked Progress: ",t.jsxs("span",{className:"text-blue-400",children:[x.toFixed(1),"%"]})]}),t.jsxs("p",{children:["Duration: ",t.jsxs("span",{className:"text-blue-400",children:[g,"s"]})]}),t.jsxs("p",{children:["Manual Progress: ",t.jsxs("span",{className:"text-purple-400",children:[r.toFixed(1),"%"]})]})]})]})]}),t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-6",children:[t.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Progress Visualization"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"Tracked Progress"}),t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-4",children:t.jsx("div",{className:"bg-blue-600 h-4 rounded-full transition-all duration-300",style:{width:x+"%"}})}),t.jsxs("span",{className:"text-sm text-gray-400",children:[x.toFixed(1),"%"]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"Manual Progress"}),t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-4",children:t.jsx("div",{className:"bg-purple-600 h-4 rounded-full transition-all duration-300",style:{width:r+"%"}})}),t.jsxs("span",{className:"text-sm text-gray-400",children:[r.toFixed(1),"%"]})]})]})]}),t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-6",children:[t.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Test Iframe"}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"Test URL"}),t.jsx("input",{type:"text",value:s,onChange:e=>a(e.target.value),className:"w-full p-2 bg-gray-700 rounded border border-gray-600 text-white",placeholder:"Enter streaming URL"})]}),t.jsx("div",{className:"relative aspect-video bg-black rounded overflow-hidden",children:t.jsx("iframe",{ref:l,src:s,className:"w-full h-full",title:"Test iframe",allow:"autoplay; fullscreen; picture-in-picture"})})]}),t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[t.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Debug Information"}),t.jsx("div",{className:"bg-gray-900 rounded p-3 font-mono text-sm overflow-auto",children:t.jsx("pre",{children:JSON.stringify({content:c,trackingStatus:{isTracking:p,isPlaying:n,currentProgress:f},progress:{tracked:x,manual:r,duration:g},iframe:{src:s,ref:l.current?"Available":"Not available"}},null,2)})})]})]})},Ea=()=>{const{startWatchingMovie:s,updateProgress:a,continueWatching:r,hasContinueWatching:i}=At(),[n,o]=e.useState(0),[l,c]=e.useState(!1),d={id:"tt0111161",title:"The Shawshank Redemption",type:"movie",poster_path:"/test-poster.jpg",backdrop_path:"/test-backdrop.jpg"},u=e=>{a(d.id,"movie",null,null,e),o(e)};return t.jsxs("div",{className:"p-6 bg-gray-800 rounded-lg",children:[t.jsx("h2",{className:"text-xl font-bold mb-4 text-white",children:"Progress Tracking Test"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsx("button",{onClick:()=>{s(d),c(!0)},className:"px-4 py-2 bg-green-600 hover:bg-green-700 rounded text-white",children:"Start Watching"}),t.jsx("button",{onClick:()=>{c(!0),s(d),[10,25,50,75,90].forEach(((e,t)=>{setTimeout((()=>{u(e)}),2e3*(t+1))}))},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded text-white",children:"Simulate Watching"}),t.jsx("button",{onClick:()=>u(Math.floor(100*Math.random())),className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded text-white",children:"Random Progress"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-white mb-2",children:["Manual Progress: ",n,"%"]}),t.jsx("input",{type:"range",min:"0",max:"100",value:n,onChange:e=>u(parseInt(e.target.value)),className:"w-full"})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between text-white text-sm mb-1",children:[t.jsx("span",{children:"Current Progress"}),t.jsxs("span",{children:[n,"%"]})]}),t.jsx("div",{className:"w-full bg-gray-600 rounded-full h-4",children:t.jsx("div",{className:"bg-green-500 h-4 rounded-full transition-all duration-300",style:{width:n+"%"}})})]}),t.jsxs("div",{className:"text-white",children:[t.jsxs("p",{children:["Tracking: ",t.jsx("span",{className:l?"text-green-400":"text-red-400",children:l?"Active":"Inactive"})]}),t.jsxs("p",{children:["Has Continue Watching: ",t.jsx("span",{className:i()?"text-green-400":"text-red-400",children:i()?"Yes":"No"})]}),t.jsxs("p",{children:["Items in Continue Watching: ",r.length]})]}),i()&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-white font-semibold mb-2",children:"Continue Watching Items:"}),t.jsx("div",{className:"space-y-2",children:r.map(((e,s)=>t.jsxs("div",{className:"bg-gray-700 p-2 rounded text-white text-sm",children:[t.jsx("p",{children:t.jsx("strong",{children:e.title})}),t.jsxs("p",{children:["Type: ",e.type]}),t.jsxs("p",{children:["Progress: ",e.progress?e.progress.toFixed(1)+"%":"0%"]}),t.jsxs("p",{children:["Last Watched: ",new Date(e.lastWatched).toLocaleString()]})]},s)))})]})]})]})},Ia=Object.freeze(Object.defineProperty({__proto__:null,default:Ea},Symbol.toStringTag,{value:"Module"})),Da=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const{addToContinueWatching:e,removeFromContinueWatching:s,continueWatching:a}=At(),{addToWatchlist:r,removeFromWatchlist:i,watchlist:n}=jt(),{deletedItems:o,undoDelete:l}=gt(),c={id:12345,title:"Test Movie",type:"movie",poster_path:"/test-poster.jpg",backdrop_path:"/test-backdrop.jpg",lastWatched:(new Date).toISOString(),progress:50};return(new Date).toISOString(),t.jsxs("div",{className:"p-6 bg-gray-900 text-white",children:[t.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Undo Functionality Test"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[t.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Continue Watching"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"text-sm",children:[t.jsxs("p",{children:["Current items: ",a.length]}),t.jsxs("p",{children:["Deleted items: ",o.continueWatching.length]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>{e(c)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded",children:"Add Test Movie"}),t.jsx("button",{onClick:()=>{s(c.id,c.type)},className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded",disabled:0===a.length,children:"Remove"}),t.jsx("button",{onClick:()=>{if(o.continueWatching.length>0){const e=o.continueWatching[0];l("continueWatching",e)}},className:"px-4 py-2 bg-green-600 hover:bg-green-700 rounded",disabled:0===o.continueWatching.length,children:"Undo"})]})]})]}),t.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[t.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Watchlist"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"text-sm",children:[t.jsxs("p",{children:["Current items: ",n.length]}),t.jsxs("p",{children:["Deleted items: ",o.watchlist.length]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>{r(c)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded",children:"Add Test Movie"}),t.jsx("button",{onClick:()=>{i(c.id)},className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded",disabled:0===n.length,children:"Remove"}),t.jsx("button",{onClick:()=>{if(o.watchlist.length>0){const e=o.watchlist[0];l("watchlist",e)}},className:"px-4 py-2 bg-green-600 hover:bg-green-700 rounded",disabled:0===o.watchlist.length,children:"Undo"})]})]})]})]}),t.jsxs("div",{className:"mt-6 bg-gray-800 p-4 rounded-lg",children:[t.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Current State"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium mb-2",children:"Continue Watching Items:"}),t.jsx("pre",{className:"text-xs bg-gray-700 p-2 rounded overflow-auto",children:JSON.stringify(a,null,2)})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium mb-2",children:"Watchlist Items:"}),t.jsx("pre",{className:"text-xs bg-gray-700 p-2 rounded overflow-auto",children:JSON.stringify(n,null,2)})]})]})]}),t.jsxs("div",{className:"mt-6 bg-gray-800 p-4 rounded-lg",children:[t.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Deleted Items (Available for Undo)"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium mb-2",children:"Deleted Continue Watching:"}),t.jsx("pre",{className:"text-xs bg-gray-700 p-2 rounded overflow-auto",children:JSON.stringify(o.continueWatching,null,2)})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium mb-2",children:"Deleted Watchlist:"}),t.jsx("pre",{className:"text-xs bg-gray-700 p-2 rounded overflow-auto",children:JSON.stringify(o.watchlist,null,2)})]})]})]})]})}},Symbol.toStringTag,{value:"Module"})),Ra=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const{wishlist:s,isInitialized:a,isSyncing:r,syncError:i,addToWishlist:n,removeFromWishlist:o,clearWishlist:l,syncWithBackend:c,getWishlistStats:d,searchWishlist:u,filterWishlist:h}=(()=>{const t=e.useContext(Lt);if(!t)throw Error("useWishlist must be used within a WishlistProvider");return t})(),[m,p]=e.useState(""),[x,g]=e.useState(""),f=d(),w=u(m),b=h({genre:x||void 0,sortBy:"title"});return t.jsxs("div",{className:"p-6 max-w-4xl mx-auto bg-[#1a1d21] text-white",children:[t.jsx("h1",{className:"text-3xl font-bold mb-6 text-center",children:"🧪 Wishlist Context Test"}),t.jsxs("div",{className:"bg-[#2a2d31] p-4 rounded-lg mb-6",children:[t.jsx("h2",{className:"text-xl font-semibold mb-3",children:"📊 Status"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-400",children:"Initialized:"}),t.jsx("span",{className:"ml-2 "+(a?"text-green-400":"text-red-400"),children:a?"Yes":"No"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-400",children:"Syncing:"}),t.jsx("span",{className:"ml-2 "+(r?"text-yellow-400":"text-green-400"),children:r?"Yes":"No"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-400",children:"Total Items:"}),t.jsx("span",{className:"ml-2 text-blue-400",children:s.length})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-400",children:"Sync Error:"}),t.jsx("span",{className:"ml-2 "+(i?"text-red-400":"text-green-400"),children:i?"Yes":"No"})]})]}),i&&t.jsxs("div",{className:"mt-3 p-2 bg-red-900/20 border border-red-500/30 rounded text-red-300 text-sm",children:["Error: ",i]})]}),t.jsxs("div",{className:"bg-[#2a2d31] p-4 rounded-lg mb-6",children:[t.jsx("h2",{className:"text-xl font-semibold mb-3",children:"📈 Statistics"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-400",children:"Total:"}),t.jsx("span",{className:"ml-2 text-blue-400",children:f.total})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-400",children:"Movies:"}),t.jsx("span",{className:"ml-2 text-green-400",children:f.movies})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-400",children:"TV Shows:"}),t.jsx("span",{className:"ml-2 text-purple-400",children:f.tvShows})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-400",children:"Top Genre:"}),t.jsx("span",{className:"ml-2 text-yellow-400",children:f.topGenres[0]?`${f.topGenres[0][0]} (${f.topGenres[0][1]})`:"None"})]})]})]}),t.jsxs("div",{className:"bg-[#2a2d31] p-4 rounded-lg mb-6",children:[t.jsx("h2",{className:"text-xl font-semibold mb-3",children:"🧪 Test Actions"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium mb-2",children:"Add Test Movies:"}),t.jsx("div",{className:"space-y-2",children:[{id:1,title:"Test Action Movie",poster_path:"/test-poster-1.jpg",overview:"A test action movie",media_type:"movie",genre_ids:[28,12],vote_average:8.5,release_date:"2024-01-01"},{id:2,title:"Test Comedy Movie",poster_path:"/test-poster-2.jpg",overview:"A test comedy movie",media_type:"movie",genre_ids:[35],vote_average:7.8,release_date:"2024-02-01"},{id:3,title:"Test TV Show",poster_path:"/test-poster-3.jpg",overview:"A test TV show",media_type:"tv",genre_ids:[18,10751],vote_average:9,first_air_date:"2024-03-01"}].map((e=>t.jsxs("button",{onClick:()=>(e=>{n(e)})(e),className:"w-full p-2 bg-blue-600 hover:bg-blue-700 rounded text-sm transition-colors",disabled:r,children:["➕ Add: ",e.title]},e.id)))})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium mb-2",children:"Wishlist Actions:"}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("button",{onClick:async()=>{await c()?alert("Manual sync completed successfully!"):alert("Manual sync failed. Check console for details.")},className:"w-full p-2 bg-green-600 hover:bg-green-700 rounded text-sm transition-colors",disabled:r,children:"🔄 Manual Sync"}),t.jsx("button",{onClick:()=>{window.confirm("Are you sure you want to clear the entire wishlist?")&&l()},className:"w-full p-2 bg-red-600 hover:bg-red-700 rounded text-sm transition-colors",disabled:r||0===s.length,children:"🗑️ Clear All"})]})]})]})]}),t.jsxs("div",{className:"bg-[#2a2d31] p-4 rounded-lg mb-6",children:[t.jsx("h2",{className:"text-xl font-semibold mb-3",children:"🔍 Search & Filter"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"Search:"}),t.jsx("input",{type:"text",value:m,onChange:e=>p(e.target.value),placeholder:"Search in wishlist...",className:"w-full p-2 bg-[#1a1d21] border border-gray-600 rounded text-white placeholder-gray-400"}),t.jsxs("div",{className:"mt-2 text-sm text-gray-400",children:["Found: ",w.length," items"]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"Filter by Genre:"}),t.jsxs("select",{value:x,onChange:e=>g(e.target.value),className:"w-full p-2 bg-[#1a1d21] border border-gray-600 rounded text-white",children:[t.jsx("option",{value:"",children:"All Genres"}),t.jsx("option",{value:"Action",children:"Action"}),t.jsx("option",{value:"Comedy",children:"Comedy"}),t.jsx("option",{value:"Drama",children:"Drama"}),t.jsx("option",{value:"Family",children:"Family"})]}),t.jsxs("div",{className:"mt-2 text-sm text-gray-400",children:["Filtered: ",b.length," items"]})]})]})]}),t.jsxs("div",{className:"bg-[#2a2d31] p-4 rounded-lg",children:[t.jsxs("h2",{className:"text-xl font-semibold mb-3",children:["📋 Current Wishlist (",s.length," items)"]}),0===s.length?t.jsx("div",{className:"text-center text-gray-400 py-8",children:"No items in wishlist. Add some test movies above!"}):t.jsx("div",{className:"space-y-3",children:s.map((e=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#1a1d21] rounded border border-gray-600",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"font-medium",children:e.title}),t.jsxs("div",{className:"text-sm text-gray-400",children:[e.media_type||e.type," • ",e.genres?.map((e=>e.name||e)).join(", ")]}),e.overview&&t.jsx("p",{className:"text-sm text-gray-500 mt-1 line-clamp-2",children:e.overview})]}),t.jsx("button",{onClick:()=>{return t=e.id,void o(t);var t},className:"ml-4 p-2 bg-red-600 hover:bg-red-700 rounded text-white transition-colors",disabled:r,children:"🗑️"})]},e.id)))})]}),!1]})}},Symbol.toStringTag,{value:"Module"})),za=(e,t)=>{switch(t.type){case"SET_QUERY":return{...e,query:t.payload,selectedSuggestionIndex:-1};case"SET_FOCUS":return{...e,isFocused:t.payload};case"SHOW_SUGGESTIONS":return{...e,showSuggestionsDropdown:!0,showHistoryDropdown:!1,showTrendingDropdown:!1};case"SHOW_HISTORY":return{...e,showSuggestionsDropdown:!1,showHistoryDropdown:!0,showTrendingDropdown:!1};case"SHOW_TRENDING":return{...e,showSuggestionsDropdown:!1,showHistoryDropdown:!1,showTrendingDropdown:!0};case"HIDE_ALL_DROPDOWNS":return{...e,showSuggestionsDropdown:!1,showHistoryDropdown:!1,showTrendingDropdown:!1,selectedSuggestionIndex:-1};case"SET_SELECTED_INDEX":return{...e,selectedSuggestionIndex:t.payload};case"RESET":return{...e,query:"",showSuggestionsDropdown:!1,showHistoryDropdown:!1,showTrendingDropdown:!1,selectedSuggestionIndex:-1};default:return e}},Wa=({placeholder:s="Search...",onSearch:a,onSearchSubmit:r,onClear:i,onFocus:n,onBlur:o,className:l="",initialValue:c="",searchDelay:d=50,showSuggestions:u=!0,suggestions:h=[],onSuggestionSelect:m,isLoading:p=!1,disabled:x=!1,variant:g="default",size:f="md",theme:w="dark",showClearButton:b=!0,showSearchIcon:v=!0,showLoadingSpinner:y=!0,autoFocus:j=!1,maxSuggestions:N=5,searchHistory:k=[],onHistorySelect:C,clearHistory:S,showHistory:_=!0,showTrendingSearches:L=!1,trendingSearches:T=[],onTrendingSelect:M,minSearchLength:E=1,enableFuzzySearch:I=!0,enableSearchCache:D=!0,cacheTimeout:R=3e5,enableAnalytics:z=!1,onAnalyticsEvent:W,...A})=>{const O=e.useRef(`search-${Date.now()}-${Math.random().toString(36).substr(2,9)}`).current,[P,F]=e.useReducer(za,{query:c,isFocused:!1,showSuggestionsDropdown:!1,selectedSuggestionIndex:-1,showHistoryDropdown:!1,showTrendingDropdown:!1}),B=e.useRef(new Map),$=e.useRef(new Map),H=e.useRef({searchCount:0,lastSearchTime:null,searchDuration:[],popularSearches:new Map}),V=e.useRef({renderCount:0,lastRenderTime:Date.now(),averageRenderTime:0});e.useEffect((()=>{V.current.renderCount++;const e=Date.now(),t=e-V.current.lastRenderTime;V.current.averageRenderTime=(V.current.averageRenderTime*(V.current.renderCount-1)+t)/V.current.renderCount,V.current.lastRenderTime=e}));const U=e.useCallback(((e,t)=>{if(!I)return t.toLowerCase().includes(e.toLowerCase());const s=e.toLowerCase(),a=t.toLowerCase();let r=0,i=0,n=0,o=0;for(;r<s.length&&i<a.length;)s[r]===a[i]?(n+=1+o,o++,r++):o=0,i++;return r===s.length?n:0}),[I]),Y=e.useCallback((()=>h&&0!==h.length?h.map((e=>{if(!e||"object"!=typeof e)return null;const t=e.title||e.name||"";if(!t||"string"!=typeof t||""===t.trim())return null;const s=U(P.query,t);return{...e,matchScore:s}})).filter(Boolean).filter((e=>e.matchScore>0||!P.query.trim())).sort(((e,t)=>t.matchScore-e.matchScore)).slice(0,N).filter(((e,t,s)=>{const a=e.id||e.title||e.name;return s.findIndex((e=>(e.id||e.title||e.name)===a))===t})).filter((e=>{const t=void 0!==e.id&&null!==e.id,s=e.title&&"string"==typeof e.title&&""!==e.title.trim();return t||s})):[]),[h,N,P.query,U]),q=e.useMemo((()=>Y()),[Y]),G=e.useMemo((()=>{const{showSuggestionsDropdown:e,showHistoryDropdown:t,showTrendingDropdown:s}=P;return e||t||s?e&&q.length>0?"suggestions":t&&k.length>0&&_?"history":s&&T.length>0&&L?"trending":null:null}),[P.showSuggestionsDropdown,q.length,P.showHistoryDropdown,k.length,_,P.showTrendingDropdown,T.length,L]),J=e.useMemo((()=>{if(!k||0===k.length)return[];const e=new Set;return k.filter((t=>{if(!t||"string"!=typeof t||""===t.trim())return!1;const s=t.toLowerCase().trim();return!e.has(s)&&(e.add(s),!0)})).slice(0,10)}),[k]),X=e.useMemo((()=>{if(!T||0===T.length)return[];const e=new Set;return T.filter((t=>{if(!t||"string"!=typeof t||""===t.trim())return!1;const s=t.toLowerCase().trim();return!e.has(s)&&(e.add(s),!0)}))}),[T]),K=e.useRef(null),ee=e.useRef(null),te=e.useRef(null),se=e.useRef(null),ae=e.useRef(null),re=e.useRef(null),ie=e.useCallback((e=>{if(!e||e.trim().length<E)return;const t=e.trim();if(D){const e=B.current.get(t),s=$.current.get(t);if(e&&s&&Date.now()-s<R)return}if(ae.current&&ae.current.abort(),ae.current=new AbortController,z){H.current.searchCount++,H.current.lastSearchTime=Date.now();const e=H.current.popularSearches.get(t)||0;H.current.popularSearches.set(t,e+1),W&&W({type:"search",query:t,timestamp:Date.now(),searchCount:H.current.searchCount})}if(a){const e=Date.now();if(a(t),z){const t=Date.now()-e;H.current.searchDuration.push(t)}D&&(B.current.set(t,!0),$.current.set(t,Date.now()))}}),[a,E,D,R,z,W]),ne=e.useCallback(Qe.debounce((e=>{ie(e)}),d),[ie,d]);e.useEffect((()=>()=>{ne&&ne.cancel&&ne.cancel(),ae.current&&ae.current.abort(),re.current&&clearTimeout(re.current),D&&(B.current.clear(),$.current.clear())}),[ne,D]);const oe=e.useCallback((e=>{if(!e||!e.trim())return;const t=e.trim();r&&r(t),z&&W&&W({type:"search_submit",query:t,timestamp:Date.now()})}),[r,z,W]),le=e.useCallback((e=>{try{const t=e.target.value||"";F({type:"SET_QUERY",payload:t}),t.trim()?(F({type:"SHOW_SUGGESTIONS"}),re.current&&clearTimeout(re.current),t.trim().length<E||(ne(t),3>t.trim().length||ie(t.trim()))):(F({type:"HIDE_ALL_DROPDOWNS"}),i&&i()),z&&W&&W({type:"input_change",query:t,length:t.length,timestamp:Date.now()})}catch(t){F({type:"RESET"})}}),[ne,ie,i,E,z,W]),ce=e.useCallback((e=>{try{F({type:"SET_FOCUS",payload:!0}),P.query.trim()?F({type:"SHOW_SUGGESTIONS"}):(F({type:"SHOW_HISTORY"}),L&&X.length>0&&F({type:"SHOW_TRENDING"})),n&&n(e),z&&W&&W({type:"focus",timestamp:Date.now()})}catch(t){F({type:"SET_FOCUS",payload:!0})}}),[n,L,X.length,P.query,z,W]),de=e.useCallback((e=>{re.current&&clearTimeout(re.current),re.current=setTimeout((()=>{try{F({type:"SET_FOCUS",payload:!1}),F({type:"HIDE_ALL_DROPDOWNS"}),o&&o(e),z&&W&&W({type:"blur",timestamp:Date.now()})}catch(t){F({type:"SET_FOCUS",payload:!1}),F({type:"HIDE_ALL_DROPDOWNS"})}}),150)}),[o,z,W]),ue=e.useCallback((e=>{if(e.ctrlKey||e.altKey||e.metaKey)return;const t=q.length+(_?J.length:0)+(L?X.length:0);switch(e.key){case"ArrowDown":e.preventDefault(),F({type:"SET_SELECTED_INDEX",payload:P.selectedSuggestionIndex<t-1?P.selectedSuggestionIndex+1:P.selectedSuggestionIndex});break;case"ArrowUp":e.preventDefault(),F({type:"SET_SELECTED_INDEX",payload:P.selectedSuggestionIndex>0?P.selectedSuggestionIndex-1:-1});break;case"Enter":if(e.preventDefault(),0>P.selectedSuggestionIndex)P.query.trim()&&(ie(P.query.trim()),oe(P.query.trim()),F({type:"HIDE_ALL_DROPDOWNS"}));else{if(P.selectedSuggestionIndex<q.length){const e=q[P.selectedSuggestionIndex];if(e&&m){m(e);const t=e.title||e.name||"";F({type:"SET_QUERY",payload:t}),oe(t)}}else if(P.selectedSuggestionIndex<q.length+J.length){const e=P.selectedSuggestionIndex-q.length,t=J[e];C&&C(t),F({type:"SET_QUERY",payload:t}),oe(t)}else{const e=P.selectedSuggestionIndex-q.length-J.length,t=X[e];M&&M(t),F({type:"SET_QUERY",payload:t}),oe(t)}F({type:"HIDE_ALL_DROPDOWNS"})}break;case"Escape":e.preventDefault(),F({type:"HIDE_ALL_DROPDOWNS"}),K.current?.blur();break;case"Tab":if(q.length>0&&P.query.trim()){e.preventDefault();const t=q[0],s=t.title||t.name||"";F({type:"SET_QUERY",payload:s}),F({type:"SET_SELECTED_INDEX",payload:0})}}z&&W&&W({type:"keyboard_navigation",key:e.key,selectedIndex:P.selectedSuggestionIndex,timestamp:Date.now()})}),[q,J,X,P.selectedSuggestionIndex,P.query,m,C,M,_,L,oe,ie,z,W]),he=e.useCallback((()=>{F({type:"RESET"}),i&&i(),K.current?.focus(),z&&W&&W({type:"clear",timestamp:Date.now()})}),[i,z,W]),me=e.useCallback(((e,t)=>{if(!e||"object"!=typeof e)return;const s=e.title||e.name||"";s&&(m&&m(e),F({type:"SET_QUERY",payload:s}),F({type:"HIDE_ALL_DROPDOWNS"}),oe(s),z&&W&&W({type:"suggestion_click",suggestion:s,index:t,timestamp:Date.now()}))}),[m,oe,z,W]),pe=e.useCallback((e=>{e&&"string"==typeof e&&(C&&C(e),F({type:"SET_QUERY",payload:e}),F({type:"HIDE_ALL_DROPDOWNS"}),oe(e),z&&W&&W({type:"history_click",item:e,timestamp:Date.now()}))}),[C,oe,z,W]),xe=e.useCallback(((e,t)=>{t.stopPropagation(),t.preventDefault();try{"undefined"!=typeof window&&window.searchHistoryService?.removeFromHistory&&window.searchHistoryService.removeFromHistory(e),z&&W&&W({type:"history_remove",item:e,timestamp:Date.now()})}catch(s){}}),[z,W]),ge=e.useCallback((e=>{e&&"string"==typeof e&&(M&&M(e),F({type:"SET_QUERY",payload:e}),F({type:"HIDE_ALL_DROPDOWNS"}),oe(e),z&&W&&W({type:"trending_click",item:e,timestamp:Date.now()}))}),[M,oe,z,W]),fe=e.useMemo((()=>({sm:"h-9 px-3 text-sm",md:"h-12 px-4 text-base",lg:"h-14 px-5 text-lg"})),[]),we=e.useMemo((()=>({dark:{input:"bg-[#2b3036] text-white placeholder-gray-400 border-gray-600 focus:border-white/30",dropdown:"bg-[#1a1a1a] border-gray-700 shadow-xl",item:"text-gray-300 hover:bg-[#2b3036] hover:text-white",selected:"bg-[#2b3036] text-white",highlight:"bg-yellow-400/20 text-yellow-300"},light:{input:"bg-white text-gray-900 placeholder-gray-500 border-gray-300 focus:border-blue-500",dropdown:"bg-white border-gray-200 shadow-lg",item:"text-gray-700 hover:bg-gray-50",selected:"bg-blue-50 text-blue-900",highlight:"bg-yellow-100 text-yellow-800"}})),[]),be=e.useMemo((()=>({default:"rounded-full border",minimal:"rounded-full border-0 bg-transparent",floating:"rounded-full border shadow-lg"})),[]),ve=we[w],ye=fe[f],je=be[g],Ne=e.useCallback(((e,t)=>{if(!t.trim()||!I)return e;const s=[],a=e.toLowerCase(),r=t.toLowerCase();let i=0;for(let n=0;n<r.length;n++){const t=a.indexOf(r[n],i);-1!==t&&(t>i&&s.push({text:e.substring(i,t),highlight:!1}),s.push({text:e[t],highlight:!0}),i=t+1)}return i<e.length&&s.push({text:e.substring(i),highlight:!1}),s}),[I]);return t.jsxs("div",{className:"relative "+l,children:[t.jsx("div",{className:"relative",children:t.jsxs(Q.div,{className:`relative flex items-center ${je} ${ve.input} ${ye} transition-all duration-300 ${x?"opacity-50 cursor-not-allowed":""}`,whileHover:x?{}:{scale:1.01},whileTap:x?{}:{scale:.99},layout:!1,children:[v&&t.jsx(Q.div,{className:"absolute left-4 text-gray-400",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3},children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),t.jsx("input",{ref:K,type:"text",value:P.query||"",onChange:le,onFocus:ce,onBlur:de,onKeyDown:ue,placeholder:s,disabled:x,autoFocus:j,name:"search-input",id:"search-input",className:`w-full bg-transparent outline-none focus:outline-none focus:ring-0 ${v?"pl-10":"pl-4"} pr-12`,...A}),p&&y&&t.jsx(Q.div,{className:"absolute right-3",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},children:t.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-gray-400 border-t-transparent"})}),b&&P.query&&!p&&t.jsx(Q.button,{onClick:he,className:"absolute right-3 p-1 rounded-full hover:bg-gray-200 hover:bg-opacity-20 transition-colors",whileHover:{scale:1.1},whileTap:{scale:.9},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})},"clear-button"),P.isFocused&&t.jsx(Q.div,{className:"absolute inset-0 rounded-xl border-2 border-transparent bg-gradient-to-r from-transparent via-white/10 to-transparent animate-pulse",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2}})]})}),t.jsxs(Z,{mode:"wait",children:["suggestions"===G&&t.jsxs(Q.div,{ref:ee,className:`absolute top-full left-0 right-0 mt-2 ${ve.dropdown} rounded-xl border max-h-64 overflow-y-auto z-50`,initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},layout:!1,children:[q.length>0&&t.jsx("div",{className:"px-4 py-2 border-b border-gray-700 bg-gray-800/30",children:t.jsxs("span",{className:"text-xs font-medium text-gray-400",children:[q.length," suggestion",1!==q.length?"s":""]})}),q.map(((e,s)=>{if(!e||"object"!=typeof e)return null;const a=e.title||e.name||e||"";if(!a||"string"!=typeof a||""===a.trim())return null;const r=e.id||a||"suggestion-"+s,i=a?a.split("").reduce(((e,t)=>(e=(e<<5)-e+t.charCodeAt(0))&e),0):s,n=`suggestion-${r||"unknown"}-${s}-${a?.substring(0,10)||"unknown"}-${i}-${O}`;if(!n||""===n.trim())return null;const o=Ne(a,P.query);return t.jsx(Q.button,{onClick:()=>me(e,s),className:`w-full px-4 py-3 text-left ${ve.item} transition-colors ${P.selectedSuggestionIndex===s?ve.selected:""}`,whileHover:{backgroundColor:"dark"===w?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.05)"},initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:Math.min(.05*s,.3)},layout:!1,children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),t.jsx("span",{className:"flex-1",children:Array.isArray(o)?o.map(((e,s)=>t.jsx("span",{className:e.highlight?ve.highlight:"",children:e.text},s))):a}),e.matchScore>0&&I&&t.jsx("span",{className:"text-xs text-gray-500 ml-2",children:Math.round(10*e.matchScore)/10})]})},n)})).filter(Boolean)]},"suggestions-dropdown"),"history"===G&&t.jsxs(Q.div,{ref:te,className:`absolute top-full left-0 right-0 mt-2 ${ve.dropdown} rounded-xl border max-h-64 overflow-y-auto z-50`,initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},layout:!1,children:[t.jsxs("div",{className:"px-4 py-3 border-b border-gray-700 flex items-center justify-between bg-gray-800/50",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Recent Searches"}),t.jsx(Q.span,{className:"text-xs text-gray-500 bg-gray-700 px-2 py-1 rounded-full",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.2},children:J.length},J.length)]}),S&&t.jsx("button",{onClick:S,className:"text-xs text-gray-400 hover:text-red-400 transition-colors px-2 py-1 rounded hover:bg-red-500/10",title:"Clear all search history",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})},"clear-history-button")]}),0===J.length?t.jsxs(Q.div,{className:"px-4 py-6 text-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:[t.jsx("svg",{className:"w-8 h-8 text-gray-500 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),t.jsx("p",{className:"text-sm text-gray-500",children:"No search history yet"}),t.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Your recent searches will appear here"})]},"empty-history"):J.map(((e,s)=>{if(!e||"string"!=typeof e||""===e.trim())return null;const a=e||"history-"+s,r=e?e.split("").reduce(((e,t)=>(e=(e<<5)-e+t.charCodeAt(0))&e),0):s,i=`history-${a||"unknown"}-${s}-${e?.substring(0,10)||"unknown"}-${r}-${O}`;return i&&""!==i.trim()?t.jsxs(Q.div,{onClick:()=>pe(e),className:`w-full px-4 py-3 text-left ${ve.item} transition-colors group cursor-pointer ${P.selectedSuggestionIndex===q.length+s?ve.selected:""}`,whileHover:{backgroundColor:"dark"===w?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.05)"},initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:Math.min(.05*s,.3)},layout:!1,role:"button",tabIndex:0,children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{className:"flex-1",children:e}),t.jsx("span",{className:"text-xs text-gray-500 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0",children:"Press Enter"})]})}),t.jsxs("div",{className:"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[t.jsx("button",{onClick:t=>xe(e,t),className:"p-1 rounded-full hover:bg-red-500/20 transition-colors",title:"Remove from history",children:t.jsx("svg",{className:"w-3 h-3 text-gray-500 hover:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),t.jsx("svg",{className:"w-4 h-4 text-gray-500 group-hover:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})]},i):null})).filter(Boolean)]},"history-dropdown"),"trending"===G&&t.jsxs(Q.div,{ref:se,className:`absolute top-full left-0 right-0 mt-2 ${ve.dropdown} rounded-xl border max-h-64 overflow-y-auto z-50`,initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},layout:!1,children:[t.jsx("div",{className:"px-4 py-3 border-b border-gray-700 bg-gradient-to-r from-red-900/20 to-orange-900/20",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 text-red-400",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),t.jsx("span",{className:"text-sm font-medium text-red-300",children:"Trending Searches"}),t.jsx(Q.span,{className:"text-xs text-red-400 bg-red-900/30 px-2 py-1 rounded-full",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.2},children:X.length},X.length)]})}),X.map(((e,s)=>{if(!e||"string"!=typeof e||""===e.trim())return null;const a=e||"trending-"+s,r=e?e.split("").reduce(((e,t)=>(e=(e<<5)-e+t.charCodeAt(0))&e),0):s,i=`trending-${a||"unknown"}-${s}-${e?.substring(0,10)||"unknown"}-${r}-${O}`;return i&&""!==i.trim()?t.jsx(Q.button,{onClick:()=>ge(e),className:`w-full px-4 py-3 text-left ${ve.item} transition-colors ${P.selectedSuggestionIndex===q.length+J.length+s?ve.selected:""}`,whileHover:{backgroundColor:"dark"===w?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.05)"},initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:Math.min(.05*s,.3)},layout:!1,children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("svg",{className:"w-4 h-4 text-red-400 flex-shrink-0 animate-pulse",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),t.jsx("span",{className:"flex-1",children:e}),t.jsx("svg",{className:"w-4 h-4 text-gray-500 opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})},i):null})).filter(Boolean)]},"trending-dropdown")]})]})},Aa=Object.freeze(Object.defineProperty({__proto__:null,default:Wa},Symbol.toStringTag,{value:"Module"})),Oa=e.memo((({size:s="md",color:a="primary",text:r="",showText:i=!1,className:n="",variant:o="spinner",timeout:l=0,onTimeout:c=null,showProgress:d=!1,progressiveText:u=!1,adaptive:h=!1,trackAnalytics:m=!1,priority:p="normal",...x})=>{const g=h?(()=>{const[t,s]=e.useState("fast");return e.useEffect((()=>{if(!navigator.connection)return;const e=()=>{const e=navigator.connection.effectiveType;navigator.onLine?s("4g"===e?"fast":"3g"===e?"medium":"slow"):s("offline")};return e(),connection.addEventListener("change",e),window.addEventListener("online",e),window.addEventListener("offline",e),()=>{connection.removeEventListener("change",e),window.removeEventListener("online",e),window.removeEventListener("offline",e)}}),[]),t})():"fast",f=ee(),{isTimedOut:w,elapsedSeconds:b}=((t,s=3e4,a=!0)=>{const[r,i]=e.useState(0),[n,o]=e.useState(!1),l=e.useRef(Date.now()),c=e.useRef(null),d=e.useRef(null);return e.useEffect((()=>{if(a)return l.current=Date.now(),i(0),o(!1),d.current=setInterval((()=>{const e=Date.now()-l.current;i(e)}),1e3),s>0&&(c.current=setTimeout((()=>{o(!0),t&&t()}),s)),()=>{c.current&&clearTimeout(c.current),d.current&&clearInterval(d.current)}}),[a,s,t]),{elapsed:r,isTimedOut:n,elapsedSeconds:Math.floor(r/1e3)}})(c,l,l>0),v=u?((t,s)=>e.useMemo((()=>3>s?t:8>s?"Still loading...":15>s?"Taking longer than expected...":25>s?"Almost there...":"This is taking a while..."),[t,s]))(r,b):r;e.useRef(Date.now()),e.useEffect((()=>{if(!m)return;const e=Date.now();return()=>{const t=Date.now()-e;"undefined"!=typeof window&&window.gtag&&window.gtag("event","loading_time",{event_category:"Performance",event_label:o,value:t,custom_dimension_network:g})}}),[m,o,g]);const y=e.useMemo((()=>{const e={xs:{size:12,stroke:2},sm:{size:16,stroke:2},md:{size:20,stroke:2.5},lg:{size:28,stroke:3},xl:{size:40,stroke:3.5}};return h&&"slow"===g?Object.fromEntries(Object.entries(e).map((([e,t])=>[e,{size:Math.max(.8*t.size,12),stroke:t.stroke}]))):e}),[h,g]),j=e.useCallback((()=>f?1.5:({fast:1,medium:1.2,slow:1.5,offline:2}[g]||1)*({high:.8,normal:1,low:1.3}[p]||1)),[g,p,f]),N=y[s],k={primary:{base:"#3b82f6",gradient:["#3b82f6","#6366f1"]},secondary:{base:"#9ca3af",gradient:["#9ca3af","#6b7280"]},white:{base:"#ffffff",gradient:["#ffffff","#f3f4f6"]},black:{base:"#000000",gradient:["#000000","#1f2937"]},success:{base:"#10b981",gradient:["#10b981","#34d399"]},warning:{base:"#f59e0b",gradient:["#f59e0b","#fbbf24"]},error:{base:"#ef4444",gradient:["#ef4444","#f87171"]}}[a],C=j(),S=()=>{const e="spinner-gradient-"+Math.random().toString(36).substr(2,9);return t.jsxs("svg",{width:N.size,height:N.size,viewBox:"0 0 50 50",role:"status","aria-label":"Loading",className:"overflow-visible",children:[t.jsx("defs",{children:t.jsxs("linearGradient",{id:e,x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:k.gradient[0]}),t.jsx("stop",{offset:"100%",stopColor:k.gradient[1]})]})}),t.jsx(Q.circle,{cx:"25",cy:"25",r:"20",fill:"none",stroke:`url(#${e})`,strokeWidth:N.stroke,strokeLinecap:"round",strokeDasharray:"31.4 31.4",initial:{rotate:0},animate:{rotate:360},transition:{duration:.8*C,repeat:1/0,ease:"linear"}})]})},_=()=>{const e="low"===p?3:"high"===p?5:4;return t.jsx("div",{className:"flex gap-1.5",role:"status","aria-label":"Loading",children:Array.from({length:e},((e,s)=>t.jsx(Q.div,{style:{width:.25*N.size,height:.25*N.size,backgroundColor:k.base},className:"rounded-full",animate:{scale:[1,1.4,1],opacity:[.4,1,.4]},transition:{duration:1.2*C,repeat:1/0,delay:.15*s,ease:"easeInOut"}},s)))})},L=()=>t.jsxs("div",{className:"relative",style:{width:N.size,height:N.size},children:[t.jsx(Q.div,{style:{width:N.size,height:N.size,backgroundColor:k.base},className:"absolute inset-0 rounded-full",animate:{scale:[1,1.2,1],opacity:[.6,1,.6]},transition:{duration:1.5*C,repeat:1/0,ease:"easeInOut"},role:"status","aria-label":"Loading"}),t.jsx(Q.div,{style:{width:N.size,height:N.size,borderColor:k.base,borderWidth:N.stroke},className:"absolute inset-0 rounded-full border",animate:{scale:[1,1.5,1.8],opacity:[.8,.4,0]},transition:{duration:1.5*C,repeat:1/0,ease:"easeOut"}})]}),T=()=>{const e=.15*N.size;return t.jsx("div",{className:"flex gap-1 items-end",role:"status","aria-label":"Loading",children:Array.from({length:5},((s,a)=>t.jsx(Q.div,{style:{width:e,backgroundColor:k.base,height:N.size},className:"rounded-full origin-bottom",animate:{scaleY:[.4,1,.4],opacity:[.5,1,.5]},transition:{duration:1*C,repeat:1/0,delay:.1*a,ease:"easeInOut"}},a)))})},M=()=>{const e="ring-gradient-"+Math.random().toString(36).substr(2,9);return t.jsxs("svg",{width:N.size,height:N.size,viewBox:"0 0 50 50",role:"status","aria-label":"Loading",children:[t.jsx("defs",{children:t.jsxs("linearGradient",{id:e,x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:k.gradient[0],stopOpacity:"0.2"}),t.jsx("stop",{offset:"100%",stopColor:k.gradient[1],stopOpacity:"1"})]})}),t.jsx("circle",{cx:"25",cy:"25",r:"20",fill:"none",stroke:k.base,strokeWidth:N.stroke,opacity:"0.2"}),t.jsx(Q.circle,{cx:"25",cy:"25",r:"20",fill:"none",stroke:`url(#${e})`,strokeWidth:N.stroke,strokeLinecap:"round",strokeDasharray:"90 150",initial:{rotate:0},animate:{rotate:360},transition:{duration:1.2*C,repeat:1/0,ease:"linear"}})]})},E=()=>t.jsxs("div",{className:"relative",style:{width:N.size,height:N.size},role:"status","aria-label":"Loading",children:[t.jsx(Q.div,{className:"absolute inset-0",animate:{rotate:360},transition:{duration:2*C,repeat:1/0,ease:"linear"},children:t.jsx("div",{style:{width:.2*N.size,height:.2*N.size,backgroundColor:k.base},className:"absolute top-0 left-1/2 -translate-x-1/2 rounded-full"})}),t.jsx(Q.div,{className:"absolute inset-0",animate:{rotate:-360},transition:{duration:1.5*C,repeat:1/0,ease:"linear"},children:t.jsx("div",{style:{width:.15*N.size,height:.15*N.size,backgroundColor:k.base,opacity:.6},className:"absolute bottom-0 left-1/2 -translate-x-1/2 rounded-full"})})]}),I=()=>t.jsx("div",{className:"flex items-center gap-0.5",role:"status","aria-label":"Loading",children:Array.from({length:8},((e,s)=>t.jsx(Q.div,{style:{width:.1*N.size,height:N.size,backgroundColor:k.base},className:"rounded-full",animate:{scaleY:[.3,1,.3],opacity:[.3,1,.3]},transition:{duration:1.2*C,repeat:1/0,delay:.08*s,ease:"easeInOut"}},s)))}),D=()=>{const e="morph-gradient-"+Math.random().toString(36).substr(2,9);return t.jsxs("svg",{width:N.size,height:N.size,viewBox:"0 0 50 50",role:"status","aria-label":"Loading",children:[t.jsx("defs",{children:t.jsxs("linearGradient",{id:e,children:[t.jsx(Q.stop,{offset:"0%",stopColor:k.gradient[0],animate:{stopColor:k.gradient},transition:{duration:2*C,repeat:1/0,repeatType:"reverse"}}),t.jsx(Q.stop,{offset:"100%",stopColor:k.gradient[1],animate:{stopColor:k.gradient.slice().reverse()},transition:{duration:2*C,repeat:1/0,repeatType:"reverse"}})]})}),t.jsx(Q.path,{d:"M25,5 Q35,15 35,25 Q35,35 25,45 Q15,35 15,25 Q15,15 25,5 Z",fill:`url(#${e})`,animate:{d:["M25,5 Q35,15 35,25 Q35,35 25,45 Q15,35 15,25 Q15,15 25,5 Z","M25,10 Q40,20 40,25 Q40,30 25,40 Q10,30 10,25 Q10,20 25,10 Z","M25,5 Q35,15 35,25 Q35,35 25,45 Q15,35 15,25 Q15,15 25,5 Z"]},transition:{duration:2*C,repeat:1/0,ease:"easeInOut"}})]})};return t.jsx("div",{className:"flex flex-col items-center justify-center "+n,role:"alert","aria-busy":"true","aria-live":"polite",...x,children:t.jsx(Z,{mode:"wait",children:w?t.jsxs(Q.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"text-center",children:[t.jsx("div",{className:"text-yellow-400 mb-2",children:t.jsxs("svg",{width:N.size,height:N.size,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t.jsx("circle",{cx:"12",cy:"12",r:"10"}),t.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),t.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]})}),t.jsx("p",{className:"text-sm text-gray-400",children:"Taking longer than expected"})]},"timeout"):t.jsxs(Q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex flex-col items-center",children:[t.jsx("div",{className:"flex items-center justify-center",children:(()=>{const e={dots:_,pulse:L,bars:T,ring:M,orbit:E,wave:I,gradient:D,spinner:S}[o]||S;return t.jsx(e,{})})()}),i&&(v||r)&&t.jsxs(Q.div,{className:"mt-3 text-center",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},children:[t.jsx("p",{className:"text-sm text-gray-400 font-medium tracking-wide",children:v||r}),d&&b>2&&t.jsxs(Q.p,{className:"text-xs text-gray-500 mt-1",initial:{opacity:0},animate:{opacity:1},children:[b,"s elapsed"]}),h&&"fast"!==g&&t.jsx(Q.p,{className:"text-xs text-gray-500 mt-1",initial:{opacity:0},animate:{opacity:1},children:"offline"===g?"⚠️ Offline":`📶 ${g} connection`})]})]},"loading")})})})),Pa=e.memo((({text:s="Loading…",size:a="lg",variant:r="ring",showProgress:i=!0,progressiveText:n=!0,adaptive:o=!0,timeout:l=3e4,className:c="",backdrop:d=!0,blurIntensity:u="md"})=>{const[h,m]=e.useState(!1);return e.useEffect((()=>(m(!0),document.body.style.overflow="hidden",()=>{document.body.style.overflow="unset"})),[]),t.jsx(Z,{children:h&&t.jsx(Q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:`\n            fixed inset-0 z-50 flex items-center justify-center\n            ${d?"bg-neutral-950/80 "+{sm:"backdrop-blur-sm",md:"backdrop-blur-md",lg:"backdrop-blur-lg"}[u]:"bg-neutral-950"}\n            ${c}\n          `,children:t.jsx(Q.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.1,type:"spring",stiffness:200,damping:20},children:t.jsx(Oa,{size:a,variant:r,text:s,showText:!0,color:"white",showProgress:i,progressiveText:n,adaptive:o,timeout:l,priority:"high",trackAnalytics:!0})})})})})),Fa=e.memo((({text:s="Loading…",size:a="md",variant:r="dots",showProgress:i=!1,adaptive:n=!0,timeout:o=15e3,className:l="",lazy:c=!0,minHeight:d="200px"})=>{const[u,h]=e.useState(!c),m=e.useRef(null);return e.useEffect((()=>{if(!c||!m.current)return;const e=new IntersectionObserver((([e])=>{e.isIntersecting&&h(!0)}),{threshold:.1,rootMargin:"50px"});return e.observe(m.current),()=>{m.current&&e.unobserve(m.current)}}),[c]),t.jsx("div",{ref:m,className:"flex items-center justify-center "+l,style:{minHeight:d},children:t.jsx(Z,{children:u&&t.jsx(Q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:t.jsx(Oa,{size:a,variant:r,text:s,showText:!!s,color:"primary",showProgress:i,adaptive:n,timeout:o,priority:"normal"})})})})})),Ba=e.memo((({className:s="",count:a=1,variant:r="media",animate:i=!0,shimmer:n=!0})=>{const o=e.useMemo((()=>Array.from({length:a},((e,t)=>t))),[a]),l=n?"relative overflow-hidden before:absolute before:inset-0 before:-translate-x-full before:animate-[shimmer_2s_infinite] before:bg-gradient-to-r before:from-transparent before:via-white/10 before:to-transparent":"",c={media:{Component:({index:e})=>t.jsxs(Q.div,{className:"bg-neutral-900 rounded-lg overflow-hidden",initial:!!i&&{opacity:0,y:20},animate:!!i&&{opacity:1,y:0},transition:!!i&&{delay:.05*e,duration:.4},children:[t.jsx("div",{className:"aspect-[2/3] bg-neutral-800 "+l}),t.jsxs("div",{className:"p-3 space-y-2",children:[t.jsx("div",{className:"h-4 bg-neutral-800 rounded w-3/4 "+l}),t.jsx("div",{className:"h-3 bg-neutral-800 rounded w-1/2 "+l}),t.jsxs("div",{className:"flex gap-1.5 pt-1",children:[t.jsx("div",{className:"h-5 bg-neutral-800 rounded-full w-12 "+l}),t.jsx("div",{className:"h-5 bg-neutral-800 rounded-full w-16 "+l})]})]})]}),gridClass:"grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6"},list:{Component:({index:e})=>t.jsxs(Q.div,{className:"bg-neutral-900 rounded-lg p-4 flex gap-4",initial:!!i&&{opacity:0,x:-20},animate:!!i&&{opacity:1,x:0},transition:!!i&&{delay:.05*e,duration:.3},children:[t.jsx("div",{className:"w-16 h-16 bg-neutral-800 rounded-lg flex-shrink-0 "+l}),t.jsxs("div",{className:"flex-1 space-y-2",children:[t.jsx("div",{className:"h-4 bg-neutral-800 rounded w-3/4 "+l}),t.jsx("div",{className:"h-3 bg-neutral-800 rounded w-1/2 "+l}),t.jsx("div",{className:"h-3 bg-neutral-800 rounded w-2/3 "+l})]})]}),gridClass:"grid-cols-1"},grid:{Component:({index:e})=>t.jsxs(Q.div,{className:"bg-neutral-900 rounded-lg overflow-hidden",initial:!!i&&{opacity:0,scale:.9},animate:!!i&&{opacity:1,scale:1},transition:!!i&&{delay:.05*e,type:"spring",stiffness:200,damping:20},children:[t.jsx("div",{className:"aspect-square bg-neutral-800 "+l}),t.jsxs("div",{className:"p-3 space-y-2",children:[t.jsx("div",{className:"h-3 bg-neutral-800 rounded w-4/5 "+l}),t.jsx("div",{className:"h-3 bg-neutral-800 rounded w-2/3 "+l})]})]}),gridClass:"grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5"}},{Component:d,gridClass:u}=c[r]||c.media;return t.jsx("div",{className:`grid ${u} gap-4 ${s}`,children:o.map((e=>t.jsx(d,{index:e},e)))})})),$a=e.memo((({className:e="",variant:s="text",lines:a=1,width:r="full",height:i="auto",animate:n=!0,shimmer:o=!0,rounded:l="default",...c})=>{const d={full:"w-full","3/4":"w-3/4","1/2":"w-1/2","1/3":"w-1/3","1/4":"w-1/4",custom:""},u="bg-neutral-800 "+{none:"rounded-none",sm:"rounded-sm",default:"rounded",md:"rounded-md",lg:"rounded-lg",full:"rounded-full"}[l],h=n?"animate-pulse":"",m=o&&!n?"relative overflow-hidden before:absolute before:inset-0 before:-translate-x-full before:animate-[shimmer_2s_infinite] before:bg-gradient-to-r before:from-transparent before:via-white/10 before:to-transparent":"",p={text:t.jsx("div",{className:"space-y-2",children:Array.from({length:a},((e,s)=>t.jsx(Q.div,{className:`\n              h-4 ${u} ${h} ${m}\n              ${s===a-1?"w-3/4":d.full}\n            `,initial:!!n&&{opacity:0,x:-10},animate:!!n&&{opacity:1,x:0},transition:!!n&&{delay:.05*s}},s)))}),avatar:t.jsx(Q.div,{className:`w-12 h-12 ${u} ${h} ${m} rounded-full`,initial:!!n&&{opacity:0,scale:.8},animate:!!n&&{opacity:1,scale:1}}),button:t.jsx(Q.div,{className:`h-10 ${u} ${h} ${m} rounded-lg ${d.full} max-w-[120px]`,initial:!!n&&{opacity:0,y:10},animate:!!n&&{opacity:1,y:0}}),card:t.jsxs(Q.div,{className:"bg-neutral-900 rounded-lg p-4 space-y-3 "+h,initial:!!n&&{opacity:0,y:20},animate:!!n&&{opacity:1,y:0},children:[t.jsx("div",{className:`h-4 ${u} ${m} w-3/4`}),t.jsx("div",{className:`h-3 ${u} ${m} w-1/2`}),t.jsx("div",{className:`h-3 ${u} ${m} w-2/3`}),t.jsxs("div",{className:"flex gap-2 pt-2",children:[t.jsx("div",{className:`h-8 w-8 ${u} ${m} rounded-full`}),t.jsxs("div",{className:"flex-1 space-y-2",children:[t.jsx("div",{className:`h-3 ${u} ${m} ${d.full}`}),t.jsx("div",{className:`h-2 ${u} ${m} w-3/4`})]})]})]}),image:t.jsx(Q.div,{className:`aspect-video ${u} ${h} ${m}`,initial:!!n&&{opacity:0},animate:!!n&&{opacity:1}}),custom:t.jsx("div",{className:`${u} ${h} ${m} ${d[r]}`,style:{height:i}})};return t.jsx("div",{className:e,...c,children:p[s]||p.text})})),Ha=e.memo((({progress:e=0,showPercentage:s=!0,color:a="primary",size:r="md",animate:i=!0,className:n=""})=>t.jsxs("div",{className:"w-full "+n,children:[t.jsx("div",{className:`w-full ${{sm:"h-1",md:"h-2",lg:"h-3"}[r]} bg-neutral-800 rounded-full overflow-hidden`,children:t.jsx(Q.div,{className:`h-full ${{primary:"bg-blue-500",success:"bg-green-500",warning:"bg-yellow-500",error:"bg-red-500"}[a]} rounded-full`,initial:{width:0},animate:{width:Math.min(100,Math.max(0,e))+"%"},transition:i?{duration:.5,ease:"easeOut"}:{duration:0}})}),s&&t.jsxs(Q.p,{className:"text-xs text-gray-400 mt-1 text-center",initial:{opacity:0},animate:{opacity:1},children:[Math.round(e),"%"]})]}))),Va=e.memo((({isLoading:s,children:a,fallback:r=t.jsx(Oa,{}),delay:i=300,minDuration:n=500,className:o=""})=>{const[l,c]=e.useState(!1),[d,u]=e.useState(!s),h=e.useRef(null);return e.useEffect((()=>{let e,t;if(s)e=setTimeout((()=>{c(!0),h.current=Date.now()}),i),u(!1);else if(h.current){const e=Date.now()-h.current;t=setTimeout((()=>{c(!1),u(!0),h.current=null}),Math.max(0,n-e))}else c(!1),u(!0);return()=>{e&&clearTimeout(e),t&&clearTimeout(t)}}),[s,i,n]),t.jsx("div",{className:o,children:t.jsxs(Z,{mode:"wait",children:[l&&t.jsx(Q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:r},"loader"),d&&t.jsx(Q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},children:a},"content")]})})}));if(Oa.displayName="EnhancedLoadingSpinner",Pa.displayName="PageLoader",Fa.displayName="SectionLoader",Ba.displayName="CardLoader",$a.displayName="Skeleton",Ha.displayName="ProgressLoader",Va.displayName="SuspenseLoader","undefined"!=typeof document){const e="enhanced-spinner-styles";if(!document.getElementById(e)){const t=document.createElement("style");t.id=e,t.textContent="\n      @keyframes shimmer {\n        0% { transform: translateX(-100%); }\n        100% { transform: translateX(100%); }\n      }\n    ",document.head.appendChild(t)}}const Ua=({showDetails:s=!1,className:a="",onNetworkChange:r})=>{const[i,n]=e.useState("checking"),[o,l]=e.useState("unknown"),[c,d]=e.useState(0),[u,h]=e.useState(0),[m,p]=e.useState("unknown"),[x,g]=e.useState(null);e.useEffect((()=>{let e=!0;const t=async()=>{e&&await f()};t();const s=setInterval((()=>{e&&"visible"===document.visibilityState&&t()}),6e4);return window.addEventListener("online",b),window.addEventListener("offline",v),"connection"in navigator&&navigator.connection.addEventListener("change",y),()=>{e=!1,clearInterval(s),window.removeEventListener("online",b),window.removeEventListener("offline",v),"connection"in navigator&&navigator.connection.removeEventListener("change",y)}}),[]);const f=async()=>{try{const e=await $e.checkHealth();"online"===e.status?(w(e.responseTime||0),n("online")):429===e.httpStatus?n("slow"):n("error"),g(new Date)}catch(e){"AbortError"===e.name?n("slow"):navigator.onLine?n("error"):n("offline"),g(new Date)}},w=e=>{if("connection"in navigator){const e=navigator.connection;l(e.effectiveType||"unknown"),d(e.downlink||0),h(e.rtt||0),p(e.effectiveType||"unknown")}},b=()=>{n("online"),r?.("online")},v=()=>{n("offline"),r?.("offline")},y=()=>{w()},j=()=>{switch(i){case"online":return"#10b981";case"slow":return"#f59e0b";case"error":return"#ef4444";case"offline":default:return"#6b7280";case"checking":return"#3b82f6"}};return t.jsxs("div",{className:"network-status-indicator "+a,children:[t.jsxs("div",{className:"status-main",style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",backgroundColor:"rgba(255, 255, 255, 0.1)",borderRadius:"8px",backdropFilter:"blur(10px)",border:`1px solid ${j()}40`,cursor:"pointer",transition:"all 0.3s ease"},onClick:()=>{n("checking"),f()},title:"Click to retry connection test",children:[t.jsx("span",{style:{fontSize:"16px"},children:(()=>{switch(i){case"online":return"🟢";case"slow":return"🟡";case"error":return"🔴";case"offline":return"⚫";case"checking":return"🔄";default:return"❓"}})()}),t.jsx("span",{style:{color:j(),fontWeight:"600",fontSize:"14px"},children:(()=>{switch(i){case"online":return"Online";case"slow":return"Slow Connection";case"error":return"Connection Error";case"offline":return"Offline";case"checking":return"Checking...";default:return"Unknown"}})()}),"checking"===i&&t.jsx("div",{style:{width:"16px",height:"16px",border:"2px solid transparent",borderTop:"2px solid "+j(),borderRadius:"50%",animation:"spin 1s linear infinite"}})]}),s&&t.jsxs("div",{className:"network-details",style:{marginTop:"12px",padding:"12px",backgroundColor:"rgba(255, 255, 255, 0.05)",borderRadius:"8px",fontSize:"12px",lineHeight:"1.4"},children:[t.jsx("div",{style:{marginBottom:"8px",fontWeight:"600"},children:"Network Details"}),t.jsxs("div",{style:{display:"grid",gap:"4px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{children:"Connection:"}),t.jsx("span",{style:{color:"#60a5fa"},children:o})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{children:"Quality:"}),t.jsx("span",{style:{color:"#34d399"},children:"4g"===m?"Excellent":"3g"===m?"Good":"2g"===m?"Poor":"slow-2g"===m?"Very Poor":"Unknown"})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{children:"Speed:"}),t.jsxs("span",{style:{color:"#fbbf24"},children:[10>c?5>c?2>c?1>c?"❓":"🐌":"📶":"⚡":"🚀"," ",c.toFixed(1)," Mbps"]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{children:"Latency:"}),t.jsxs("span",{style:{color:"#a78bfa"},children:[u,"ms"]})]}),x&&t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{children:"Last Check:"}),t.jsx("span",{style:{color:"#9ca3af"},children:x.toLocaleTimeString()})]})]}),"slow"===i&&t.jsx("div",{style:{marginTop:"8px",padding:"8px",backgroundColor:"rgba(245, 158, 11, 0.1)",borderRadius:"4px",fontSize:"11px",color:"#fbbf24"},children:"💡 Tip: Try refreshing the page or check your connection"}),"offline"===i&&t.jsx("div",{style:{marginTop:"8px",padding:"8px",backgroundColor:"rgba(239, 68, 68, 0.1)",borderRadius:"4px",fontSize:"11px",color:"#f87171"},children:"📱 Check your Wi-Fi or mobile data connection"})]}),t.jsx("style",{children:"\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n        \n        .network-status-indicator {\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n        }\n        \n        .status-main:hover {\n          transform: translateY(-1px);\n          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n        }\n      "})]})};Ua.propTypes={showDetails:le.bool,className:le.string,onNetworkChange:le.func};const Ya=Object.freeze(Object.defineProperty({__proto__:null,default:Ua},Symbol.toStringTag,{value:"Module"})),qa=Object.freeze(Object.defineProperty({__proto__:null,default:({isVisible:s=!1,onClose:a})=>{const[r,i]=e.useState(null),[n,o]=e.useState(null),[l,c]=e.useState(!1);e.useEffect((()=>{if(!s)return;let e=!0;const t=()=>{if(!e)return;const t=He.getComprehensiveReport();i(t),o(t)};t();const a=setInterval(t,2e3);return()=>{e=!1,clearInterval(a)}}),[s]),e.useEffect((()=>{s&&He.startMonitoring()}),[s]);const d=e.useCallback((()=>r&&r.performanceScore||0),[r]),u=(e,t,s="lower")=>null==e?"text-gray-400":("lower"===s?e>t:t>e)?"text-red-400":"text-green-400",h=(e,t="ms",s=0)=>null==e?"N/A":"ms"===t?Math.round(e)+"ms":"s"===t?(e/1e3).toFixed(s)+"s":"percent"===t?Math.round(e)+"%":""+e.toFixed(s);return s?t.jsx(Z,{children:t.jsx(Q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"fixed bottom-4 right-4 z-50",children:t.jsxs("div",{className:"bg-gray-900/95 backdrop-blur-md border border-white/10 rounded-lg shadow-2xl max-w-sm",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-white/10",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),t.jsx("h3",{className:"text-white font-semibold",children:"Performance"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>c(!l),className:"p-1 text-white/60 hover:text-white transition-colors",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})}),t.jsx("button",{onClick:a,className:"p-1 text-white/60 hover:text-white transition-colors",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("span",{className:"text-white/80 text-sm",children:"Overall Score"}),t.jsxs("span",{className:"text-lg font-bold "+(m=d(),90>m?70>m?"text-red-400":"text-yellow-400":"text-green-400"),children:[d(),"/100"]})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-white/60 text-xs",children:"FCP"}),t.jsx("span",{className:"text-xs font-mono "+u(r?.coreWebVitals?.fcp||null,1500),children:h(r?.coreWebVitals?.fcp)})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-white/60 text-xs",children:"LCP"}),t.jsx("span",{className:"text-xs font-mono "+u(r?.coreWebVitals?.lcp||null,2500),children:h(r?.coreWebVitals?.lcp)})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-white/60 text-xs",children:"FID"}),t.jsx("span",{className:"text-xs font-mono "+u(r?.coreWebVitals?.fid||null,100),children:h(r?.coreWebVitals?.fid)})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-white/60 text-xs",children:"CLS"}),t.jsx("span",{className:"text-xs font-mono "+u(r?.coreWebVitals?.cls||null,.1),children:r?.coreWebVitals?.cls?r.coreWebVitals.cls.toFixed(3):"N/A"})]})]}),t.jsx(Z,{children:l&&t.jsxs(Q.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-4 pt-4 border-t border-white/10",children:[t.jsxs("div",{className:"space-y-3 mb-4",children:[t.jsx("h4",{className:"text-white/80 text-xs font-semibold",children:"Homepage Performance"}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-white/60 text-xs",children:"Initial Load"}),t.jsx("span",{className:"text-xs font-mono "+u(r?.homepage?.initialLoadTime||null,5e3),children:h(r?.homepage?.initialLoadTime)})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-white/60 text-xs",children:"Critical Content"}),t.jsx("span",{className:"text-xs font-mono "+u(r?.homepage?.criticalContentLoadTime||null,3e3),children:h(r?.homepage?.criticalContentLoadTime)})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-white/60 text-xs",children:"Sections Loaded"}),t.jsx("span",{className:"text-xs font-mono text-white/80",children:r?.homepage?.totalSectionsLoaded||0})]})]}),t.jsxs("div",{className:"space-y-3 mb-4",children:[t.jsx("h4",{className:"text-white/80 text-xs font-semibold",children:"Optimization"}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-white/60 text-xs",children:"Image Load Time"}),t.jsx("span",{className:"text-xs font-mono "+u(r?.homepage?.averageImageLoadTime||null,1e3),children:h(r?.homepage?.averageImageLoadTime)})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-white/60 text-xs",children:"API Call Time"}),t.jsx("span",{className:"text-xs font-mono "+u(r?.homepage?.averageApiCallTime||null,500),children:h(r?.homepage?.averageApiCallTime)})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-white/60 text-xs",children:"Cache Hit Rate"}),t.jsx("span",{className:"text-xs font-mono "+u(r?.homepage?.cacheHitRate||null,.8,"higher"),children:h(100*r?.homepage?.cacheHitRate,"percent")})]})]}),r?.recommendations&&r.recommendations.length>0&&t.jsxs("div",{className:"space-y-2",children:[t.jsx("h4",{className:"text-white/80 text-xs font-semibold",children:"Recommendations"}),t.jsx("div",{className:"space-y-1",children:r.recommendations.slice(0,3).map(((e,s)=>t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("svg",{className:"w-3 h-3 text-yellow-400 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),t.jsx("span",{className:"text-white/60 text-xs leading-relaxed",children:e})]},s)))})]})]})})]})]})})}):null;var m}},Symbol.toStringTag,{value:"Module"})),Ga=({cacheStats:e,apiStats:s})=>{const a=e=>{if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Cache Statistics"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e?.size||0}),t.jsx("div",{className:"text-sm text-blue-800",children:"Total Entries"})]}),t.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-green-600",children:a(1048576*e?.memoryUsageMB||0)}),t.jsx("div",{className:"text-sm text-green-800",children:"Memory Usage"})]}),t.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-purple-600",children:e?.hitRate||"0%"}),t.jsx("div",{className:"text-sm text-purple-800",children:"Hit Rate"})]}),t.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-orange-600",children:(r=e?.efficiency/100||0,(100*r).toFixed(1)+"%")}),t.jsx("div",{className:"text-sm text-orange-800",children:"Efficiency"})]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"API Statistics"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-indigo-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:s?.total||0}),t.jsx("div",{className:"text-sm text-indigo-800",children:"Total Requests"})]}),t.jsxs("div",{className:"bg-teal-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-teal-600",children:s?.cached||0}),t.jsx("div",{className:"text-sm text-teal-800",children:"Cached Requests"})]}),t.jsxs("div",{className:"bg-pink-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-pink-600",children:s?.network||0}),t.jsx("div",{className:"text-sm text-pink-800",children:"Network Requests"})]}),t.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-red-600",children:s?.errors||0}),t.jsx("div",{className:"text-sm text-red-800",children:"Errors"})]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Cache Details"}),t.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("strong",{children:"Hits:"})," ",e?.hits||0]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Misses:"})," ",e?.misses||0]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Sets:"})," ",e?.sets||0]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Deletes:"})," ",e?.deletes||0]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Average Entry Size:"})," ",a(1024*e?.averageEntrySize||0)]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Rate Limit Tokens:"})," ",s?.rateLimitTokens||0]})]})})]})]});var r},Ja=({cacheStats:e,apiStats:s})=>t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Performance Metrics"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[t.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Cache Performance"}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Hit Rate:"}),t.jsx("span",{className:"font-medium",children:e?.hitRate||"0%"})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Efficiency:"}),t.jsxs("span",{className:"font-medium",children:[(e?.efficiency||0).toFixed(1),"%"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Memory Usage:"}),t.jsxs("span",{className:"font-medium",children:[(e?.memoryUsageMB||0).toFixed(2)," MB"]})]})]})]}),t.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[t.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"API Performance"}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Average Response Time:"}),t.jsxs("span",{className:"font-medium",children:[(s?.averageResponseTime||0).toFixed(2),"ms"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Cache Hit Rate:"}),t.jsxs("span",{className:"font-medium",children:[s?.total>0?(s.cached/s.total*100).toFixed(1):0,"%"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Error Rate:"}),t.jsxs("span",{className:"font-medium",children:[s?.total>0?(s.errors/s.total*100).toFixed(1):0,"%"]})]})]})]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Performance Trends"}),t.jsx("div",{className:"bg-white border rounded-lg p-4",children:t.jsxs("div",{className:"text-center text-gray-500 py-8",children:[t.jsx("div",{className:"text-4xl mb-2",children:"📊"}),t.jsx("p",{children:"Performance charts will be implemented here"}),t.jsx("p",{className:"text-sm",children:"Real-time monitoring of cache and API performance"})]})})]})]}),Xa=({cacheStats:e,apiStats:s})=>t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"User Behavior Analytics"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[t.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e?.accessPatterns||0}),t.jsx("div",{className:"text-sm text-gray-600",children:"Access Patterns"})]}),t.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[t.jsx("div",{className:"text-2xl font-bold text-green-600",children:e?.mlPredictions||0}),t.jsx("div",{className:"text-sm text-gray-600",children:"ML Predictions"})]}),t.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[t.jsx("div",{className:"text-2xl font-bold text-purple-600",children:e?.analyticsEntries||0}),t.jsx("div",{className:"text-sm text-gray-600",children:"Analytics Entries"})]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Cache Analytics"}),t.jsx("div",{className:"bg-white border rounded-lg p-4",children:t.jsxs("div",{className:"text-center text-gray-500 py-8",children:[t.jsx("div",{className:"text-4xl mb-2",children:"📈"}),t.jsx("p",{children:"Detailed analytics will be implemented here"}),t.jsx("p",{className:"text-sm",children:"Access patterns, user behavior, and ML insights"})]})})]})]}),Ka=()=>{const[s,a]=e.useState({cacheEnabled:!0,compressionEnabled:!0,prefetchEnabled:!0,mlEnabled:!0,analyticsEnabled:!0}),r=(e,t)=>{a((s=>({...s,[e]:t})))};return t.jsxs("div",{className:"space-y-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Cache Settings"}),t.jsx("div",{className:"bg-white border rounded-lg p-4",children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-900",children:"Enable Caching"}),t.jsx("div",{className:"text-sm text-gray-500",children:"Enable the enhanced caching system"})]}),t.jsx("input",{type:"checkbox",checked:s.cacheEnabled,onChange:e=>r("cacheEnabled",e.target.checked),className:"rounded"})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-900",children:"Enable Compression"}),t.jsx("div",{className:"text-sm text-gray-500",children:"Compress cached data to save memory"})]}),t.jsx("input",{type:"checkbox",checked:s.compressionEnabled,onChange:e=>r("compressionEnabled",e.target.checked),className:"rounded"})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-900",children:"Enable Prefetching"}),t.jsx("div",{className:"text-sm text-gray-500",children:"Automatically prefetch related content"})]}),t.jsx("input",{type:"checkbox",checked:s.prefetchEnabled,onChange:e=>r("prefetchEnabled",e.target.checked),className:"rounded"})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-900",children:"Enable ML Predictions"}),t.jsx("div",{className:"text-sm text-gray-500",children:"Use machine learning for intelligent caching"})]}),t.jsx("input",{type:"checkbox",checked:s.mlEnabled,onChange:e=>r("mlEnabled",e.target.checked),className:"rounded"})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-900",children:"Enable Analytics"}),t.jsx("div",{className:"text-sm text-gray-500",children:"Track cache performance and user behavior"})]}),t.jsx("input",{type:"checkbox",checked:s.analyticsEnabled,onChange:e=>r("analyticsEnabled",e.target.checked),className:"rounded"})]})]})}),t.jsx("div",{className:"flex justify-end",children:t.jsx("button",{className:"bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600 transition-colors",children:"Save Settings"})})]})},Qa=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const[s,a]=e.useState(null),[r,i]=e.useState(null),[n,o]=e.useState(!0),[l,c]=e.useState("overview"),[d,u]=e.useState(5e3),[h,m]=e.useState(!0),p=e.useCallback((async()=>{try{if(Ve&&Ve.isReady()){const e=await Ve.getStats();a(e)}else a(Ve?.getFallbackStats?.()||null);if(Ue&&"function"==typeof Ue.getStats){const e=await Ue.getStats();i(e)}else i(null)}catch(e){a(null),i(null)}finally{o(!1)}}),[]);return e.useEffect((()=>{if(p(),h){const e=setInterval(p,d);return()=>clearInterval(e)}}),[p,h,d]),n?t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Loading cache statistics..."})]})}):s||r?t.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:t.jsxs("div",{className:"max-w-7xl mx-auto",children:[t.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Cache Management Dashboard"}),t.jsx("p",{className:"text-gray-600 mt-2",children:"Monitor and control the enhanced caching system"})]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("input",{type:"checkbox",id:"autoRefresh",checked:h,onChange:e=>m(e.target.checked),className:"rounded"}),t.jsx("label",{htmlFor:"autoRefresh",className:"text-sm text-gray-600",children:"Auto-refresh"})]}),t.jsxs("select",{value:d,onChange:e=>u(+e.target.value),className:"border rounded px-3 py-1 text-sm",disabled:!h,children:[t.jsx("option",{value:2e3,children:"2s"}),t.jsx("option",{value:5e3,children:"5s"}),t.jsx("option",{value:1e4,children:"10s"}),t.jsx("option",{value:3e4,children:"30s"})]}),t.jsx("button",{onClick:p,className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-colors",children:"Refresh"})]})]})}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[t.jsxs("button",{onClick:async()=>{try{await Ye.warmup(),await p(),alert("Cache warmup initiated!")}catch(e){alert("Failed to warmup cache. Please try again.")}},className:"bg-green-500 text-white p-4 rounded-lg hover:bg-green-600 transition-colors",children:[t.jsx("div",{className:"text-lg font-semibold",children:"Warmup Cache"}),t.jsx("div",{className:"text-sm opacity-90",children:"Preload critical data"})]}),t.jsxs("button",{onClick:async()=>{const e=["/api/trending","/api/popular","/api/top-rated","/api/upcoming"];try{await Ue.preload(e,{priority:"high"}),await p(),alert("Data preload completed!")}catch(t){alert("Failed to preload data. Please try again.")}},className:"bg-purple-500 text-white p-4 rounded-lg hover:bg-purple-600 transition-colors",children:[t.jsx("div",{className:"text-lg font-semibold",children:"Preload Data"}),t.jsx("div",{className:"text-sm opacity-90",children:"Load trending content"})]}),t.jsxs("button",{onClick:()=>(async()=>{try{const e=await Ve.invalidate({namespace:"api"});await p(),alert(`Invalidated ${e} cache entries!`)}catch(e){alert("Failed to invalidate cache. Please try again.")}})(),className:"bg-orange-500 text-white p-4 rounded-lg hover:bg-orange-600 transition-colors",children:[t.jsx("div",{className:"text-lg font-semibold",children:"Invalidate API"}),t.jsx("div",{className:"text-sm opacity-90",children:"Clear API cache"})]}),t.jsxs("button",{onClick:async()=>{if(window.confirm("Are you sure you want to clear all caches? This will remove all cached data."))try{await Promise.all([Ve.clear(),Ue.clearCache()]),await p(),alert("All caches cleared successfully!")}catch(e){alert("Failed to clear cache. Please try again.")}},className:"bg-red-500 text-white p-4 rounded-lg hover:bg-red-600 transition-colors",children:[t.jsx("div",{className:"text-lg font-semibold",children:"Clear All"}),t.jsx("div",{className:"text-sm opacity-90",children:"Remove all cached data"})]})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow-sm mb-6",children:[t.jsx("div",{className:"border-b border-gray-200",children:t.jsx("nav",{className:"flex space-x-8 px-6",children:[{id:"overview",label:"Overview",icon:"📊"},{id:"performance",label:"Performance",icon:"⚡"},{id:"analytics",label:"Analytics",icon:"📈"},{id:"settings",label:"Settings",icon:"⚙️"}].map((e=>t.jsxs("button",{onClick:()=>c(e.id),className:"py-4 px-1 border-b-2 font-medium text-sm "+(l===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[t.jsx("span",{className:"mr-2",children:e.icon}),e.label]},e.id)))})}),t.jsxs("div",{className:"p-6",children:["overview"===l&&t.jsx(Ga,{cacheStats:s,apiStats:r}),"performance"===l&&t.jsx(Ja,{cacheStats:s,apiStats:r}),"analytics"===l&&t.jsx(Xa,{cacheStats:s,apiStats:r}),"settings"===l&&t.jsx(Ka,{})]})]})]})}):t.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:t.jsx("div",{className:"max-w-7xl mx-auto",children:t.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:t.jsxs("div",{className:"text-center",children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Cache Management Dashboard"}),t.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:[t.jsx("div",{className:"flex items-center justify-center mb-4",children:t.jsx("svg",{className:"w-8 h-8 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),t.jsx("h3",{className:"text-lg font-semibold text-yellow-800 mb-2",children:"Cache Service Not Available"}),t.jsx("p",{className:"text-yellow-700 mb-4",children:"The enhanced cache service is not currently available. This might be due to:"}),t.jsxs("ul",{className:"text-yellow-700 text-left max-w-md mx-auto space-y-1",children:[t.jsx("li",{children:"• Service still initializing"}),t.jsx("li",{children:"• Browser compatibility issues"}),t.jsx("li",{children:"• IndexedDB not available"})]}),t.jsx("button",{onClick:p,className:"mt-4 bg-yellow-600 text-white px-6 py-2 rounded hover:bg-yellow-700 transition-colors",children:"Retry"})]})]})})})})}},Symbol.toStringTag,{value:"Module"})),Za=[{to:"/",label:"Home",icon:t.jsx(G,{className:"w-6 h-6"})},{to:"/movies",label:"Movies",icon:t.jsx(L,{className:"w-6 h-6"})},{to:"/series",label:"Series",icon:t.jsx(_,{className:"w-6 h-6"})},{to:"/watchlist",label:"Wishlist",icon:t.jsx(J,{className:"w-6 h-6"})}],er=s.memo((()=>{const s=m(),{fullPageLoader:a}=ht(),r=e.useRef(null),i=e.useRef(new Map),n=e.useRef(null),o=e.useRef(null),l=e.useRef({x:0,scale:1}),c=e.useRef(null),d=e.useRef(null),u=e.useRef(new Map),h=e.useRef(!1),p=e.useRef(!0),x=e.useRef(null),f=e.useCallback(((e,t)=>{try{if("requestIdleCallback"in window){const s=window.requestIdleCallback(e,t);return x.current=s,s}}catch(a){}const s=setTimeout(e,200);return x.current=s,s}),[]),w=e.useCallback((()=>{try{"cancelIdleCallback"in window&&x.current?window.cancelIdleCallback(x.current):x.current&&clearTimeout(x.current)}catch(e){}x.current=null}),[]),b=e.useRef(new Set),v=e.useCallback((e=>(b.current.add(e),e)),[]),y=e.useCallback((()=>{b.current.forEach((e=>clearTimeout(e))),b.current.clear()}),[]),j=e.useRef(null),N=e.useCallback((e=>{try{c.current&&Jt(c.current)}catch(t){}return c.current=Gt((()=>{try{e()}catch(t){}})),c.current}),[]),[k,C]=e.useState(!1),[S,_]=e.useState(!1),[L,T]=e.useState(0),M=(()=>{const t="undefined"!=typeof window,[s,a]=e.useState(t?window.innerWidth:1200);return e.useEffect((()=>{if(!t)return;let e=null;const s=()=>{e||(e=requestAnimationFrame((()=>{a(window.innerWidth),e=null})))};return window.addEventListener("resize",s,{passive:!0}),()=>{window.removeEventListener("resize",s),e&&cancelAnimationFrame(e)}}),[t]),s})();e.useMemo((()=>{if("undefined"==typeof window)return!0;try{return window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches}catch(e){return!1}}),[]);const E=e.useMemo((()=>s.pathname.startsWith("/manga/chapter/")),[s.pathname]),I=a||E,D="__menu__",R=e.useMemo((()=>s.pathname.startsWith("/manga")||s.pathname.startsWith("/community")),[s.pathname]),z=e.useMemo((()=>{const e=s.pathname.match(/^\/reset-password\/.+/);return["/login","/signup","/forgot-password","/profile"].includes(s.pathname)||e}),[s.pathname]),W=e.useMemo((()=>{if(R)return D;const e=Za.find((e=>s.pathname===e.to||"/"!==e.to&&s.pathname.startsWith(e.to)));return e?.to??"/"}),[s.pathname,R]),A=te(),{getBackgroundTransition:O}=oe(W),P=e.useCallback((()=>{if(h.current)return;if(!W||!r.current||!n.current)return;if(z)return;const e=i.current.get(W);if(e)try{let s=u.current.get(W);if(!s){const t=e.getBoundingClientRect(),a=r.current.getBoundingClientRect();if(!a||0===t.width||0===t.height)return;s={x:Math.max(0,t.left-a.left),width:Math.max(60,t.width)},u.current.set(W,s)}const a=s.x,i=Math.max(60,s.width)/60,o=48;l.current={x:a,scale:i};try{A.start({x:a,scaleX:i,transition:O()})}catch(t){if(n.current){const e=n.current;e.style.transform=`translate3d(${a}px, 0, 0) scaleX(${i})`,e.style.height=o+"px"}}}catch(s){if(l.current={x:0,scale:1},n.current){const e=n.current;e.style.transform="translate3d(0px, 0, 0) scaleX(1)",e.style.height="48px"}}}),[W,z]),F=e.useCallback((()=>{N((()=>{try{const e=r.current?.getBoundingClientRect();if(!e)return;i.current.forEach(((t,s)=>{try{if(!t)return;const a=t.getBoundingClientRect();u.current.set(s,{x:Math.max(0,a.left-e.left),width:a.width})}catch(a){}}))}catch(e){}}))}),[]),B=e.useCallback(((e,t)=>{e?(i.current.set(t,e),t===W&&v(setTimeout((()=>P()),0)),T((e=>e+1))):!e&&i.current.has(t)&&(i.current.delete(t),T((e=>e+1)))}),[W,P]);e.useEffect((()=>{P();const e=v(setTimeout((()=>P()),0)),t=v(setTimeout((()=>P()),60));return()=>{clearTimeout(e),clearTimeout(t)}}),[R,P]),e.useEffect((()=>{try{c.current&&Jt(c.current)}catch(t){}P(),N((()=>P()));const e=v(setTimeout((()=>{P()}),50));return()=>{try{c.current&&Jt(c.current)}catch(t){}c.current=null,clearTimeout(e)}}),[P]),e.useEffect((()=>{let e=!0;const t=()=>{e&&(h.current=document.hidden,document.hidden||v(setTimeout((()=>{e&&P()}),100)))};return document.addEventListener("visibilitychange",t,{passive:!0}),"ResizeObserver"in window&&r.current&&(d.current=new ResizeObserver((t=>{e&&(P(),N((()=>{e&&P()}))),F()})),d.current.observe(r.current)),()=>{e=!1,document.removeEventListener("visibilitychange",t),d.current&&(d.current.disconnect(),d.current=null);try{c.current&&Jt(c.current)}catch(s){}c.current=null}}),[P]),e.useEffect((()=>{F();const e=v(setTimeout((()=>F()),50));return()=>clearTimeout(e)}),[L,M,F]),e.useEffect((()=>{if(!p.current)return;let e=!0;P();const t=v(setTimeout((()=>{e&&(P(),N((()=>{e&&P()})))}),100)),s=v(setTimeout((()=>{e&&i.current.size>0&&P()}),200));return()=>{e=!1,clearTimeout(t),clearTimeout(s)}}),[P]),e.useEffect((()=>{try{const{x:e=0,scale:t=1}=l.current||{};A.set({x:e,scaleX:t})}catch(e){}}),[]),e.useEffect((()=>{if(p.current)return;let e=!0;P(),f((()=>{if(e)try{F(),P(),N((()=>{e&&P()}))}catch(t){}}));const t=v(setTimeout((()=>{e&&P()}),50)),s=v(setTimeout((()=>{e&&i.current.size>0&&P()}),100));return()=>{e=!1,clearTimeout(t),w(),clearTimeout(s)}}),[W,P]),e.useEffect((()=>()=>{try{y()}catch(e){}try{c.current&&Jt(c.current)}catch(e){}c.current=null;try{w()}catch(e){}try{A.stop()}catch(e){}d.current&&(d.current.disconnect(),d.current=null),h.current=!1,p.current=!0}),[]),e.useEffect((()=>{W&&!z&&v(setTimeout((()=>P()),0))}),[L,W,z,P]),e.useEffect((()=>{P(),N((()=>P()));const e=v(setTimeout((()=>P()),60));return()=>clearTimeout(e)}),[M,P]);const $=ae()?{hidden:{y:0,opacity:1},visible:{y:0,opacity:1,transition:es}}:((e={})=>({hidden:{y:50,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",stiffness:200,damping:25,mass:1,delay:e.delay??.05}}}))({delay:.05}),H=e.useCallback((()=>{C(!0),p.current=!1,P(),v(setTimeout((()=>{P(),N((()=>P()))}),50)),v(setTimeout((()=>{i.current.size>0&&P()}),100))}),[P]),G=e.useCallback((()=>{if(P(),c.current)try{Jt(c.current)}catch(e){}c.current=Gt((()=>P())),v(setTimeout((()=>{i.current.size>0&&P()}),50))}),[P]),J=e.useCallback((e=>{const t=Array.from(i.current.keys())[e],s=i.current.get(t);s&&"function"==typeof s.focus&&s.focus()}),[]),X=e.useCallback((e=>{const t=Array.from(i.current.keys());if(!t||0===t.length)return;const s=document.activeElement,a=t.findIndex((e=>i.current.get(e)===s));if("ArrowRight"===e.key){e.preventDefault();const s=(a+1)%t.length;J(s)}else if("ArrowLeft"===e.key){e.preventDefault();const s=(a-1+t.length)%t.length;J(s)}else"Home"===e.key?(e.preventDefault(),J(0)):"End"===e.key&&(e.preventDefault(),J(t.length-1))}),[J]),K=e.useCallback((()=>{_(!1);try{const e=j.current;e&&"function"==typeof e.focus&&document.contains(e)&&e.focus()}catch(e){}}),[]);return e.useEffect((()=>{if(!S)return void(document.body.style.overflow="");const e=document.body.style.overflow;document.body.style.overflow="hidden";const t=setTimeout((()=>{try{const e=o.current?.querySelectorAll('a, button, [tabindex]:not([tabindex="-1"])')||[];e.length>0&&e[0].focus()}catch(e){}}),50);return()=>{clearTimeout(t),document.body.style.overflow=e}}),[S]),I?null:t.jsx(Z,{children:t.jsxs(Q.nav,{className:"fixed bottom-0 left-0 right-0 z-50 md:hidden",onKeyDown:X,style:{paddingBottom:"env(safe-area-inset-bottom, 0px)",WebkitOverflowScrolling:"touch",touchAction:"manipulation"},"aria-label":"Bottom navigation",variants:$,initial:p.current?"hidden":"visible",animate:"visible",onAnimationComplete:H,children:[t.jsx("div",{className:"mx-auto max-w-7xl p-1",children:t.jsxs("div",{ref:e=>{r.current=e},className:"relative bg-[#1a1d21]/95 border border-white/10 rounded-2xl shadow-2xl bottom-nav-optimized animate-optimized",style:{contain:"layout paint",WebkitTransform:"translateZ(0)",transform:"translateZ(0)"},children:[t.jsxs("ul",{className:"flex items-center justify-between p-1",children:[Za.map(((e,a)=>{const r=s.pathname===e.to||"/"!==e.to&&s.pathname.startsWith(e.to);return t.jsx(Q.li,{ref:t=>B(t,e.to),className:"flex-1 flex items-center justify-center",style:{minHeight:"48px"},initial:p.current?{opacity:0,y:10}:{opacity:1,y:0},animate:{opacity:1,y:0},transition:{duration:.2,delay:p.current?.1+.05*a:0,ease:"easeOut"},children:t.jsxs(V,{to:e.to,className:"relative overflow-hidden flex flex-col items-center justify-center gap-0.5 h-12 px-2 rounded-xl transition-all duration-150 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-white/30 "+(r?"text-black":"text-white/70 hover:text-white active:text-white/90"),"aria-current":r?"page":void 0,onPointerDown:()=>{G()},onClick:()=>{G()},style:{WebkitTapHighlightColor:"transparent",touchAction:"manipulation"},children:[t.jsx("span",{className:"relative z-10",children:e.icon}),t.jsx("span",{className:"text-[11px] leading-none relative z-10 font-medium",children:e.label}),r&&t.jsx("span",{className:"sr-only","aria-hidden":!1,children:"Current page"})]})},e.to)})),t.jsx(Q.li,{ref:e=>B(e,D),className:"flex-1 flex items-center justify-center",style:{minHeight:"48px"},initial:p.current?{opacity:0,y:10}:{opacity:1,y:0},animate:{opacity:1,y:0},transition:{duration:.2,delay:p.current?.1+.05*Za.length:0,ease:"easeOut"},children:t.jsxs("button",{type:"button","aria-label":"Open menu","aria-haspopup":"dialog","aria-expanded":S,"aria-controls":"bottom-sheet-menu",onClick:e=>{j.current=e.currentTarget,_((e=>!e))},onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),j.current=e.currentTarget,_((e=>!e)))},className:"relative overflow-hidden flex flex-col items-center justify-center gap-0.5 h-12 px-2 rounded-xl transition-all duration-150 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-white/30 "+(R?"text-black":"text-white/70 hover:text-white active:text-white/90"),style:{WebkitTapHighlightColor:"transparent",touchAction:"manipulation"},children:[t.jsx("span",{className:"relative z-10",children:t.jsx(U,{className:"w-6 h-6"})}),t.jsx("span",{className:"text-[11px] leading-none relative z-10 font-medium",children:"Menu"})]})},"more-menu")]}),!z&&t.jsx(Q.div,{ref:e=>{n.current=e},className:"absolute rounded-lg bg-white pointer-events-none shadow-lg",style:{top:4,left:0,width:"60px",height:"48px",backfaceVisibility:"hidden",minWidth:"60px",minHeight:"48px",willChange:"transform",transformOrigin:"left center"},animate:A,initial:!1,"aria-hidden":"true","data-debug":`x:${l.current.x},scale:${l.current.scale}`})]})}),t.jsx(Z,{children:S&&t.jsxs(t.Fragment,{children:[t.jsx(Q.div,{className:"fixed inset-0 z-[60] bg-black/60 backdrop-blur-md",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},onClick:K},"menu-overlay"),t.jsx(Q.div,{id:"bottom-sheet-menu",role:"dialog","aria-modal":"true","aria-label":"More navigation options",className:"absolute left-0 right-0 z-[70] bottom-[calc(100%+8px)]",initial:{y:24,opacity:0},animate:{y:0,opacity:1},exit:{y:24,opacity:0},transition:{type:"spring",stiffness:260,damping:28},ref:o,children:t.jsx("div",{className:"mx-auto max-w-7xl p-1",style:{paddingBottom:"env(safe-area-inset-bottom, 0px)"},children:t.jsx(Y,{active:S,focusTrapOptions:{initialFocus:()=>o.current?.querySelector('a, button, [tabindex]:not([tabindex="-1"])')||o.current,escapeDeactivates:!0,clickOutsideDeactivates:!0,returnFocusOnDeactivate:!0,onDeactivate:()=>{try{const e=j.current;e&&"function"==typeof e.focus&&document.contains(e)&&e.focus()}catch(e){}}},children:t.jsx("div",{className:"bg-[#1a1d21]/95 border border-white/10 rounded-2xl shadow-2xl overflow-hidden",children:t.jsx("div",{className:"p-3",children:t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs(V,{to:"/manga",onClick:()=>_(!1),className:"group flex items-center gap-2 px-3 py-3 rounded-xl bg-white/5 hover:bg-white/10 active:bg-white/15 text-white transition-colors",children:[t.jsx(g,{className:"w-5 h-5 text-white/80 group-hover:text-white"}),t.jsx("span",{className:"text-sm font-medium",children:"Manga"})]}),t.jsxs(V,{to:"/community",onClick:()=>_(!1),className:"group flex items-center gap-2 px-3 py-3 rounded-xl bg-white/5 hover:bg-white/10 active:bg-white/15 text-white transition-colors",children:[t.jsx(q,{className:"w-5 h-5 text-white/80 group-hover:text-white"}),t.jsx("span",{className:"text-sm font-medium",children:"Community"})]})]})})})})})},"menu-sheet")]})})]},"bottom-nav")})})),tr=Object.freeze(Object.defineProperty({__proto__:null,default:er},Symbol.toStringTag,{value:"Module"})),sr=({content:s,currentService:a,onServiceChange:r,className:i="",onServiceLoad:n=null,disabled:o=!1})=>{const[l,c]=e.useState([]),[d,u]=e.useState(!1),[h,m]=e.useState(!1),[p,x]=e.useTransition(),[g,f]=e.useState(null),[w,b]=e.useState(""),v=e.useRef(null),y=e.useRef(null),[j,N]=e.useState(-1),k=e.useMemo((()=>l.find((e=>e.key===a))||l[0]),[l,a]),C=e.useRef(null),S=e.useCallback((e=>{if(e.key===a)return void u(!1);const t=a;f(t),m(!0),b(""),C.current&&clearTimeout(C.current),C.current=setTimeout((()=>{x((async()=>{try{"function"==typeof r&&await r(e),"function"==typeof n&&n(e),u(!1)}catch(s){if(b("Failed to change service. Please try again."),t){const e=l.find((e=>e.key===t));if(e&&"function"==typeof r)try{await r(e)}catch(a){}}}finally{m(!1)}}))}),200)}),[a,r,n,g,l]),_=e.useCallback((()=>{h||u(!d)}),[d,h]),L=e.useCallback((e=>{"Escape"===e.key&&(u(!1),y.current?.focus()),d||"ArrowDown"!==e.key&&"Enter"!==e.key&&" "!==e.key||(u(!0),N(0),e.preventDefault()),d&&("ArrowDown"===e.key&&(N((e=>Math.min(e+1,l.length-1))),e.preventDefault()),"ArrowUp"===e.key&&(N((e=>Math.max(e-1,0))),e.preventDefault()),"Tab"===e.key&&u(!1),"Enter"!==e.key||0>j||(S(l[j]),e.preventDefault()))}),[d,l,j,S]);e.useEffect((()=>()=>{C.current&&(clearTimeout(C.current),C.current=null)}),[]);const T=e.useCallback((async()=>{if(s){m(!0);try{const e=qe(s);if(c(e),!a&&e.length>0){const t=e.find((e=>e.key===ke))||e[0];r(t)}}catch(e){}finally{m(!1)}}}),[s,a,r]);e.useEffect((()=>{T()}),[T]);const M=e.useCallback((e=>{v.current&&!v.current.contains(e.target)&&u(!1)}),[]);return e.useEffect((()=>(document.addEventListener("mousedown",M),()=>document.removeEventListener("mousedown",M))),[M]),e.useEffect((()=>{if(d&&j>=0){const e=document.getElementById("streaming-service-item-"+j);e?.focus()}}),[d,j]),0===l.length||o?null:t.jsxs("div",{className:"relative "+i,ref:v,children:[t.jsxs(Q.button,{ref:y,layout:!0,transition:{type:"spring",stiffness:400,damping:30},onClick:_,onKeyDown:L,disabled:h||p,"aria-haspopup":"listbox","aria-expanded":d,"aria-controls":"streaming-service-dropdown",className:`flex items-center gap-2 px-3 py-2 bg-black/60 hover:bg-black/80 backdrop-blur-sm rounded-full text-white text-sm font-medium transition-all duration-200 border border-white/20 hover:border-white/40 ${h?"opacity-50 cursor-not-allowed":""} ${o?"opacity-30 cursor-not-allowed":""}`,title:k?.description||"",children:[(h||p)&&t.jsx(Q.div,{animate:{rotate:360},transition:{duration:.5,repeat:1/0,ease:"linear"},className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full","aria-label":"Loading",role:"status"}),t.jsx(Q.span,{layout:!0,className:"truncate",children:h?"Loading...":k?.name||"Server"}),!h&&k?.description&&t.jsxs("span",{className:"text-xs text-white/60 ml-1",title:k.description,children:["(",k.description,")"]}),t.jsx(Q.svg,{className:"w-4 h-4 text-white/70 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:d?180:0},transition:{duration:.2},children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),w&&t.jsx("div",{className:"text-red-400 text-xs mt-1",role:"alert",children:w}),t.jsx(Z,{children:d&&t.jsx(Q.div,{id:"streaming-service-dropdown",role:"listbox","aria-activedescendant":0>j?void 0:"streaming-service-item-"+j,initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2,ease:"easeOut"},className:"absolute top-full left-0 mt-2 bg-black/90 backdrop-blur-md border border-white/20 rounded-2xl shadow-xl overflow-hidden min-w-32 max-h-60 overflow-y-auto",style:{zIndex:1e3},children:t.jsx("div",{className:"py-1",children:l.map(((e,s)=>t.jsx(ar,{service:e,index:s,currentService:a,focusedIndex:j,isLoading:h,handleServiceSelect:S,setFocusedIndex:N,isFirst:0===s,isLast:s===l.length-1},e.key)))})})})]})},ar=e.memo((function({service:e,index:s,currentService:a,focusedIndex:r,isLoading:i,handleServiceSelect:n,setFocusedIndex:o,isFirst:l,isLast:c}){return t.jsx(Q.button,{id:"streaming-service-item-"+s,role:"option","aria-selected":e.key===a,tabIndex:r===s?0:-1,onClick:()=>n(e),onFocus:()=>o(s),disabled:i,whileHover:{backgroundColor:"rgba(255, 255, 255, 0.1)"},whileTap:{scale:.98},className:`w-full px-3 py-2 text-sm text-left transition-colors duration-150 ${e.key===a?"bg-white/20 text-white":"text-white/80 hover:text-white"} ${l?"rounded-t-lg":""} ${c?"rounded-b-lg":""} ${i?"cursor-not-allowed opacity-50":""}`,title:e.description||"",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{children:e.name}),e.description&&t.jsx("span",{className:"text-xs text-white/60",title:e.description,children:e.description})]}),e.key===a&&t.jsx(Q.div,{initial:{scale:0},animate:{scale:1},className:"w-1.5 h-1.5 bg-white rounded-full"})]}),e.key===a&&t.jsx(Q.svg,{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",initial:{scale:0},animate:{scale:1},transition:{delay:.1},children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]})})}));sr.propTypes={content:le.any,currentService:le.string,onServiceChange:le.func.isRequired,className:le.string,onServiceLoad:le.func,disabled:le.bool};const rr={priority:"high",group:"movie-overlays",accessibility:!0,stacking:!0,debug:!1},ir={priority:"critical",group:"streaming",accessibility:!0,stacking:!0,debug:!1},nr={priority:"high",group:"modals",accessibility:!0,stacking:!0,debug:!1},or=(e,t={})=>{const{onFocus:s=null,onBlur:a=null,onEscape:r=null,onClose:i=null,debug:n=!1}=t;return{onFocus:e=>{s&&s(e)},onBlur:e=>{a&&a(e)},onEscape:e=>{r&&r(e),i&&i()}}},lr=({streamingUrl:s=null,title:a="",isOpen:r=!1,onClose:i,onError:n=null,content:o=null,currentService:l=null,onServiceChange:c=null})=>{const d=e.useRef(!0),[u,h]=e.useState({isLoading:!0,hasError:!1,currentProgress:0,totalDuration:0,isPlaying:!1,lastProgressUpdate:0,isOffline:"undefined"!=typeof navigator&&!navigator.onLine}),{hasError:m,currentProgress:p,totalDuration:x,isPlaying:g,isOffline:f}=u,w=e.useCallback((e=>{d.current&&h((t=>{if(!Object.keys(e).some((s=>t[s]!==e[s])))return t;try{void 0!==e.currentProgress&&(ge.current=e.currentProgress),void 0!==e.totalDuration&&(oe.current=e.totalDuration),void 0!==e.lastProgressUpdate&&(fe.current=e.lastProgressUpdate),void 0!==e.isPlaying&&(q.current=e.isPlaying),void 0!==e.isOffline&&(le.current=e.isOffline),void 0!==e.isLoading&&(ce.current=e.isLoading)}catch(s){}return{...t,...e}}))}),[]),b=e.useCallback((e=>w({isLoading:e})),[w]),v=e.useCallback((e=>w({hasError:e})),[w]),y=e.useCallback((e=>w({currentProgress:e})),[w]);e.useCallback((e=>w({totalDuration:e})),[w]);const j=e.useCallback((e=>w({isPlaying:e})),[w]);e.useCallback((e=>w({lastProgressUpdate:e})),[w]);const N=e.useCallback((e=>w({isOffline:e})),[w]),k=e.useMemo((()=>"streaming-player-"+(o?.id||"default")),[o?.id]),C=e.useMemo((()=>({...ir,...or(0,{onClose:i}),priority:"critical",group:"streaming-players",animationType:"fullscreen",analytics:!0,statePersistence:!0,theme:"streaming-player"})),[k,i]),{container:S,createPortal:_,isReady:L,trackInteraction:T,savePortalState:M,loadPortalState:E,coordinateAnimation:I,analytics:D}=re(k,C),R=e.useRef(null),z=e.useRef(null),W=e.useRef(null),A=e.useRef(null),O=e.useRef(0),P=e.useRef(0),F=e.useRef(null),B=e.useRef(!1),$=e.useRef(0),H=e.useRef(0),V=e.useRef(null),U=e.useRef(null),Y=e.useRef(null),q=e.useRef(!1),G=e.useRef(null),J=e.useRef(null),X=e.useRef(!0),K=e.useRef("good"),ee=e.useRef(0),te=e.useRef("healthy"),se=e.useRef(0),ae=e.useRef(0),ie=e.useRef(null),ne=e.useRef(!1),oe=e.useRef(0),le=e.useRef(u.isOffline),ce=e.useRef(u.isLoading),de=e.useRef(null);e.useEffect((()=>{if("undefined"!=typeof Worker){try{const e="/src/workers/progressWorker.js";ie.current=new Worker(e,{type:"module"}),ie.current.addEventListener("message",(e=>{const{type:t,data:s}=e.data;switch(t){case"WORKER_READY":ne.current=!0;break;case"PROGRESS_RESULT":case"PERFORMANCE_RESULT":case"QUALITY_RESULT":break;case"BUFFER_PREDICTION":s.prediction!==te.current&&(te.current=s.prediction)}})),ie.current.addEventListener("error",(e=>{ne.current=!1}))}catch(e){}return()=>{ie.current&&(ie.current.terminate(),ie.current=null,ne.current=!1)}}}),[]);const{startWatchingMovie:ue,startWatchingEpisode:he,updateProgress:me}=At(),pe=e.useRef(null),xe=e.useRef(l),ge=e.useRef(0),fe=e.useRef(0),we=e.useRef(!1);e.useEffect((()=>(o&&(pe.current=o),()=>{pe.current=null})),[o?.id]),e.useEffect((()=>{xe.current=l}),[l]);const be=e.useCallback((()=>{const e=Date.now();if(3e4>e-ee.current)return;if(ee.current=e,"undefined"==typeof navigator||!navigator.connection)return;const t=navigator.connection,s=t.downlink,a=t.rtt,r=t.effectiveType;let i="good";return"slow-2g"===r||"2g"===r||1>s||a>500?i="poor":("3g"===r||5>s||a>200)&&(i="moderate"),K.current=i,i}),[]),ve=e.useCallback((()=>{const e=Date.now();if(1e4>e-ae.current)return;ae.current=e;const t=se.current;let s="healthy";return t>5?s="critical":t>2&&(s="warning"),te.current=s,1e4>e%6e4&&(se.current=Math.floor(se.current/2)),s}),[]);e.useEffect((()=>(d.current=!0,()=>{d.current=!1,z.current&&(clearInterval(z.current),z.current=null),A.current&&(clearInterval(A.current),A.current=null),F.current&&(clearInterval(F.current),F.current=null),V.current&&(clearTimeout(V.current),V.current=null)})),[]),e.useEffect((()=>{if(d.current)if(r){w({isLoading:!0,hasError:!1,currentProgress:0,totalDuration:0,isPlaying:!1,lastProgressUpdate:0});const e=pe.current;if(T&&e&&T("player_opened",{contentId:e.id,title:e.title||e.name,service:xe.current}),I&&I("fullscreen"),E){const e=E();e&&e.progress&&y(e.progress)}}else{const e=pe.current;Ce(),Ne(),T&&e&&T("player_closed",{contentId:e.id,finalProgress:p,totalDuration:x}),M&&e&&M({progress:p,totalDuration:x,isPlaying:g,lastWatched:Date.now(),contentId:e.id})}}),[r]),e.useEffect((()=>{if(!d.current)return;const e=pe.current;r&&e&&!we.current?(we.current=!0,je()):r||(we.current=!1)}),[r]);const ye=e.useCallback(((e,t,s)=>{const a=Date.now(),r=Math.abs(e-ge.current)>2,i=a-fe.current>6e4;if(r||i){if(ge.current=e,fe.current=a,U.current){try{Jt(U.current)}catch(n){}U.current=null}"undefined"!=typeof document&&document.hidden||!q.current?d.current&&w({currentProgress:e,totalDuration:t,lastProgressUpdate:a}):U.current=Gt((()=>{d.current&&w({currentProgress:e,totalDuration:t,lastProgressUpdate:a})})),U.current||setTimeout((()=>{d.current&&w({currentProgress:e,totalDuration:t,lastProgressUpdate:a})}),50);const i=pe.current;if(i&&(V.current||(V.current=setTimeout((()=>{try{if("movie"===i.type)me(i.id,"movie",null,null,e);else if("tv"===i.type){if(!i.season||!i.episode)return;me(i.id,"tv",i.season,i.episode,e)}}catch(t){}V.current=null}),1e3)),"undefined"!=typeof requestIdleCallback)){if(G.current)try{cancelIdleCallback(G.current)}catch(n){}G.current=requestIdleCallback((()=>{if(be(),ne.current&&ie.current&&(ie.current.postMessage({type:"CALCULATE_PROGRESS",data:{currentTime:s,duration:t,timestamp:Date.now()}}),ie.current.postMessage({type:"ANALYZE_PERFORMANCE",data:{eventType:r?"progress":"update",eventData:{progress:e,duration:t,currentTime:s}}}),"undefined"!=typeof navigator&&navigator.connection)){const e=navigator.connection;ie.current.postMessage({type:"CALCULATE_QUALITY",data:{downlink:e.downlink||0,rtt:e.rtt||0,effectiveType:e.effectiveType||"4g",saveData:e.saveData||!1}})}if(D&&r)try{D.trackEvent("progress_update",{contentId:i.id,progress:e.toFixed(1),connectionQuality:K.current,isVisible:X.current,bufferHealth:te.current})}catch(a){}}),{timeout:3e3})}}}),[]),je=e.useCallback((()=>{const e=pe.current;if(!e)return;fe.current=Date.now(),"movie"===e.type?ue(e):"tv"===e.type&&e.season&&e.episode&&he(e,e.season,e.episode);const t=e=>{const t=e.origin||"";if(["111movies.com","player.videasy.net","vidjoy.pro","vidfast.pro","rivestream.net","cinemaos.tech"].some((e=>t.includes(e))))try{const t=e.data;if(t&&"object"==typeof t){let e=null;if("timeupdate"===t.event&&t.data){e=t.data;const s=Date.now();if(P.current++,5e3>=s-O.current)return;P.current,O.current=s}else void 0===t.currentTime&&void 0===t.progress||(e=t);if(e)if(void 0!==e.currentTime&&void 0!==e.duration){const t=e.currentTime/e.duration*100;ye(t,e.duration,e.currentTime)}else if(void 0!==e.progress)ye(e.progress,e.duration||0,e.currentTime||0);else if(void 0!==e.time){const t=e.duration?e.time/e.duration*100:0;ye(t,e.duration||0,e.time)}void 0!==t.playing&&(j(t.playing),q.current=!!t.playing)}}catch(s){}};W.current&&window.removeEventListener("message",W.current),W.current=t,window.addEventListener("message",t);const s=()=>{if(R.current)try{const e=R.current.src;if(!e)return;const t=new URL(e),s=["t","time","start","position","seek","timestamp"];for(const a of s){const e=t.searchParams.get(a);if(e){const t=parseFloat(e);if(!isNaN(t)&&t>0){const e=7200;ye(Math.min(t/e*100,100),e,t);break}}}}catch(e){}};A.current&&(clearInterval(A.current),A.current=null),s(),A.current=setInterval(s,15e3);try{const e=Object.keys(localStorage).filter((e=>e.includes("progress")||e.includes("time")||e.includes("position")||e.includes("watch")||e.includes("video")));for(const t of e){let e=null;try{if(e=localStorage.getItem(t),e){const t=JSON.parse(e);if(t&&(t.currentTime||t.time||t.position)){const e=t.currentTime||t.time||t.position,s=t.duration||7200;ye(Math.min(e/s*100,100),s,e);break}}}catch(a){const t=parseFloat(e);if(!isNaN(t)&&t>0){const e=7200;ye(Math.min(t/e*100,100),e,t);break}}}}catch(r){}z.current&&(clearInterval(z.current),z.current=null),z.current=setInterval((()=>{if(("undefined"==typeof document||!document.hidden)&&q.current&&R.current)try{R.current.contentWindow?.postMessage({type:"GET_PROGRESS",action:"getProgress"},"*")}catch(r){}}),12e4)}),[]),Ne=e.useCallback((()=>{z.current&&(clearInterval(z.current),z.current=null),A.current&&(clearInterval(A.current),A.current=null),F.current&&(clearInterval(F.current),F.current=null),W.current&&(window.removeEventListener("message",W.current),W.current=null),O.current=0,P.current=0,B.current=!1,$.current=0}),[]),ke=e.useCallback((()=>{F.current&&(clearInterval(F.current),F.current=null),F.current=setInterval((()=>{const e=Date.now()-(fe.current||0),t="undefined"!=typeof document&&document.hidden;if(ve(),!t&&!le.current&&r&&!ce.current&&e>12e5){se.current+=1;const e=Date.now();if(3e5>e-H.current)return;if($.current>=2)return;if(B.current)return;if(H.current=e,$.current+=1,!R.current||!s)return;try{const e=oe.current&&ge.current?ge.current/100*oe.current:0;let t=s;try{if(!s||"string"!=typeof s)return;const a=new URL(s);!Number.isNaN(e)&&e>0&&86400>e&&(a.searchParams.set("t",Math.floor(e)),a.searchParams.set("start",Math.floor(e)),a.searchParams.set("time",Math.floor(e))),a.searchParams.set("embed","1"),t=a.toString()}catch(a){t=s}B.current=!0,R.current.src=t,setTimeout((()=>{B.current=!1}),5e3)}catch(i){B.current=!1}}}),3e5)}),[]);e.useCallback(((e,t)=>{try{if(!e||"string"!=typeof e)return e;const s=new URL(e);return!Number.isNaN(t)&&t>0&&86400>t&&(s.searchParams.set("t",Math.floor(t)),s.searchParams.set("start",Math.floor(t)),s.searchParams.set("time",Math.floor(t))),s.searchParams.set("embed","1"),s.toString()}catch(s){return e}}),[]);const Ce=e.useCallback((()=>{try{pe.current,ge.current,oe.current}catch(e){}}),[]),Se=e.useCallback((()=>{b(!1),B.current=!1,$.current=0,de.current&&(clearTimeout(de.current),de.current=null),fe.current=Date.now(),de.current=setTimeout((()=>{const e=pe.current;r&&e&&je(),de.current=null}),1e3)}),[r]),_e=e.useCallback((()=>{b(!1),v(!0),n&&n("Failed to load streaming content")}),[n]),Le=e.useCallback((()=>{const e=pe.current;if(T&&e)try{T("close_button_clicked",{contentId:e.id,progress:ge.current||0,totalDuration:oe.current||0,method:"close_button"})}catch(t){}Ce(),Ne(),b(!0),v(!1),i()}),[i,T,Ce,Ne]);e.useCallback((e=>{"Escape"===e.key&&r&&Le()}),[r,Le]),e.useEffect((()=>{if(r){const t=e=>{"Escape"===e.key&&r&&Le()},s=()=>{N(!1),le.current=!1,be()},a=()=>{N(!0),le.current=!0,K.current="poor"},i=()=>{if("undefined"!=typeof document)if(document.hidden)z.current&&(clearInterval(z.current),z.current=null),A.current&&(clearInterval(A.current),A.current=null);else if(z.current||(z.current=setInterval((()=>{if(R.current)try{R.current.contentWindow?.postMessage({type:"GET_PROGRESS",action:"getProgress"},"*")}catch(e){}}),6e4)),!A.current){const e=()=>{if(R.current)try{const e=R.current.src;if(!e)return;const t=new URL(e),s=["t","time","start","position","seek","timestamp"];for(const a of s){const e=t.searchParams.get(a);if(e){const t=parseFloat(e);if(!isNaN(t)&&t>0){const e=7200;ye(Math.min(t/e*100,100),e,t);break}}}}catch(e){}};e(),A.current=setInterval(e,12e4)}},n=()=>{try{pe.current}catch(e){}};document.addEventListener("keydown",t),document.body.style.overflow="hidden";try{Ge()}catch(e){}if("undefined"!=typeof window&&window.performance)try{const e=new PerformanceObserver((e=>{for(const t of e.getEntries())"measure"===t.entryType&&t.name.includes("streaming")}));e.observe({entryTypes:["measure"]}),Y.current=e}catch(e){}if(window.addEventListener("online",s,{passive:!0}),window.addEventListener("offline",a,{passive:!0}),document.addEventListener("visibilitychange",i,{passive:!0}),window.addEventListener("beforeunload",n),"undefined"!=typeof IntersectionObserver&&R.current){J.current=new IntersectionObserver((e=>{e.forEach((e=>{if(X.current=e.isIntersecting,!e.isIntersecting&&U.current){try{Jt(U.current)}catch(t){}U.current=null}}))}),{threshold:[0,.25,.5,.75,1],rootMargin:"0px"});const e=R.current.parentElement;e&&J.current.observe(e)}const o=setInterval((()=>{r&&!le.current&&be()}),3e4);return ke(),()=>{if(document.removeEventListener("keydown",t),document.body.style.overflow="",window.removeEventListener("online",s,{passive:!0}),window.removeEventListener("offline",a,{passive:!0}),document.removeEventListener("visibilitychange",i,{passive:!0}),window.removeEventListener("beforeunload",n),Ne(),J.current)try{J.current.disconnect(),J.current=null}catch(e){}o&&clearInterval(o);try{Y.current&&"function"==typeof Y.current.disconnect&&(Y.current.disconnect(),Y.current=null)}catch(e){}}}return()=>{document.body.style.overflow="",Ne()}}),[r]),e.useEffect((()=>()=>{if(z.current&&(clearInterval(z.current),z.current=null),A.current&&(clearInterval(A.current),A.current=null),F.current&&(clearInterval(F.current),F.current=null),W.current&&(window.removeEventListener("message",W.current),W.current=null),O.current=0,P.current=0,B.current=!1,$.current=0,H.current=0,V.current&&(clearTimeout(V.current),V.current=null),U.current){try{Jt(U.current)}catch(e){}U.current=null}if(G.current&&"undefined"!=typeof cancelIdleCallback){try{cancelIdleCallback(G.current)}catch(e){}G.current=null}de.current&&(clearTimeout(de.current),de.current=null)}),[]);const Te=e.useCallback((e=>{e.target.classList.contains("streaming-player-overlay")&&Le()}),[Le]),Me=e.useMemo((()=>{if(!s)return null;try{const e=new URL(s);if(e.searchParams.set("embed","1"),"undefined"!=typeof navigator&&navigator.connection){const t=navigator.connection,s=t.effectiveType;"4g"===s?(e.searchParams.set("quality","auto"),e.searchParams.set("maxQuality","1080p")):"3g"===s?(e.searchParams.set("quality","720p"),e.searchParams.set("maxQuality","720p")):"2g"!==s&&"slow-2g"!==s||(e.searchParams.set("quality","480p"),e.searchParams.set("maxQuality","480p")),t.saveData&&(e.searchParams.set("quality","360p"),e.searchParams.set("saveData","1"))}return e.searchParams.set("hwaccel","1"),e.searchParams.set("preload","auto"),e.toString()}catch(e){return s+"?embed=1&hwaccel=1"}}),[s]),[Ee,Ie]=e.useState(null),De=e.useRef(null);return e.useEffect((()=>(r&&Me?(De.current&&(clearTimeout(De.current),De.current=null),De.current=setTimeout((()=>{Ie(Me)}),200)):(De.current&&(clearTimeout(De.current),De.current=null),De.current=setTimeout((()=>{Ie(null),De.current=null}),500),De.current&&(clearTimeout(De.current),De.current=null)),()=>{De.current&&(clearTimeout(De.current),De.current=null)})),[r,Me]),"undefined"!=typeof window&&L&&S?_(t.jsx(Z,{children:r&&t.jsx(Q.div,{className:"streaming-player-overlay fixed inset-0 bg-black/95 flex items-center justify-center p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeInOut"},onClick:Te,style:{zIndex:1,pointerEvents:"auto",transform:"translateZ(0)",willChange:"opacity",backfaceVisibility:"hidden",contain:"layout style paint"},children:t.jsxs(Q.div,{className:"relative w-full max-w-7xl h-[90vh] bg-black rounded-2xl shadow-2xl overflow-hidden",initial:{scale:.95,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:20},transition:{duration:.3,ease:"easeOut"},onClick:e=>e.stopPropagation(),style:{zIndex:2,pointerEvents:"auto",transform:"translateZ(0)",willChange:"transform, opacity",backfaceVisibility:"hidden",contain:"layout style paint",isolation:"isolate"},children:[t.jsx("button",{onClick:Le,className:"absolute top-4 right-4 p-2 bg-black/50 hover:bg-black/70 rounded-full transition-colors duration-200","aria-label":"Close streaming player",style:{zIndex:10},children:t.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),t.jsx("div",{className:"absolute top-4 left-4 flex items-center justify-start",style:{zIndex:10},children:t.jsx(sr,{content:o,currentService:l,onServiceChange:c,className:"flex-shrink-0"})}),t.jsxs("div",{className:"relative w-full h-full",style:{transform:"translateZ(0)",willChange:"transform",backfaceVisibility:"hidden",contain:"layout style paint"},children:[m&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-red-500/20 flex items-center justify-center",children:t.jsx("svg",{className:"w-8 h-8 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),t.jsx("h3",{className:"text-white text-lg font-semibold mb-2",children:"Streaming Unavailable"}),t.jsx("p",{className:"text-white/60 text-sm mb-4",children:"This content is not available for streaming at the moment."}),t.jsx("button",{onClick:Le,className:"px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg transition-colors text-white text-sm",children:"Close"})]})}),Me&&!m&&t.jsxs("div",{className:"relative w-full h-full",style:{transform:"translateZ(0)",willChange:"transform",backfaceVisibility:"hidden",contain:"strict",isolation:"isolate"},children:[f&&t.jsx("div",{className:"absolute inset-0 z-[999999] flex items-center justify-center bg-black/60",children:t.jsxs("div",{className:"text-center text-white",children:[t.jsx("p",{className:"mb-3",children:"You are offline. Playback will resume when connection returns."}),t.jsx("button",{onClick:()=>{const e=Date.now();if(e-H.current>=45e3&&3>$.current&&!B.current&&(H.current=e,$.current+=1,R.current&&s))try{const e=x&&p?p/100*x:0;let a=s;try{if(!s||"string"!=typeof s)return;const t=new URL(s);!Number.isNaN(e)&&e>0&&86400>e&&(t.searchParams.set("t",Math.floor(e)),t.searchParams.set("start",Math.floor(e)),t.searchParams.set("time",Math.floor(e))),t.searchParams.set("embed","1"),a=t.toString()}catch(t){a=s}B.current=!0,R.current.src=a,setTimeout((()=>{B.current=!1}),5e3)}catch(a){B.current=!1}},className:"px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg transition-colors text-white text-sm",children:"Try Reconnect Now"})]})}),t.jsx("iframe",{ref:R,src:Ee,className:"w-full h-full border-0",allow:"autoplay; fullscreen; picture-in-picture; encrypted-media; gyroscope; accelerometer",allowFullScreen:!0,loading:"eager",importance:"high",onLoad:Se,onError:_e,title:"Streaming "+(a||"content"),style:{backgroundColor:"black",minHeight:"100%",minWidth:"100%",transform:"translateZ(0)",willChange:"transform, opacity",backfaceVisibility:"hidden",WebkitTransform:"translateZ(0)",WebkitBackfaceVisibility:"hidden",contain:"layout style paint",isolation:"isolate",transformStyle:"preserve-3d",WebkitFontSmoothing:"subpixel-antialiased",contentVisibility:"auto"}})]})]})]})})})):null};lr.propTypes={streamingUrl:le.string,title:le.string,isOpen:le.bool,onClose:le.func.isRequired,onError:le.func,content:le.object,currentService:le.string,onServiceChange:le.func};const cr=s.memo(lr,((e,t)=>e.isOpen===t.isOpen&&e.streamingUrl===t.streamingUrl&&e.title===t.title&&e.currentService===t.currentService&&e.content?.id===t.content?.id&&e.content?.season===t.content?.season&&e.content?.episode===t.content?.episode)),dr=Object.freeze(Object.defineProperty({__proto__:null,default:cr},Symbol.toStringTag,{value:"Module"})),ur=s.memo((({onClick:s,hasMore:a,isLoading:r,totalItems:i,displayedItems:n,loadingText:o="Loading more...",buttonText:l="Load More",itemName:c="items",className:d="",showProgress:u=!0,showCount:h=!0,disabled:m=!1,size:p="medium",variant:x="default",loadingStrategy:g="click",autoLoadThreshold:f=.5,enableRetry:w=!0,maxRetries:b=3,trackAnalytics:v=!1,showSkeleton:y=!1,estimatedItemHeight:j=200,itemsPerLoad:N=10,enableHaptic:k=!0,showNetworkStatus:C=!1,adaptiveLoading:S=!0,..._})=>{const[L,T]=e.useState(!1),[M,E]=e.useState(!1),[I,D]=e.useState(null),R=S?(()=>{const[t,s]=e.useState("fast");return e.useEffect((()=>{if("undefined"==typeof navigator||!navigator.connection)return;const e=navigator.connection,t=()=>{if(navigator.onLine){const t=e.effectiveType;s("4g"===t?"fast":"3g"===t?"medium":"2g"===t||"slow-2g"===t?"slow":"fast")}else s("offline")};return t(),e.addEventListener("change",t),window.addEventListener("online",t),window.addEventListener("offline",t),()=>{e.removeEventListener("change",t),window.removeEventListener("online",t),window.removeEventListener("offline",t)}}),[]),t})():"fast",{retryCount:z,error:W,setError:A,retry:O,reset:P,canRetry:F}=((t=3)=>{const[s,a]=e.useState(0),[r,i]=e.useState(null),n=e.useCallback((()=>t>s&&(a((e=>e+1)),i(null),!0)),[s,t]),o=e.useCallback((()=>{a(0),i(null)}),[]);return{retryCount:s,error:r,setError:i,retry:n,reset:o,canRetry:t>s}})(b),B=e.useMemo((()=>("auto"===g||"hybrid"===g)&&a&&!r&&!W),[g,a,r,W]),$=((t,s=!1,a={})=>{const r=e.useRef(null);return e.useEffect((()=>{if(!s||!r.current)return;const e=new IntersectionObserver((([e])=>{e.isIntersecting&&t()}),{threshold:.1,rootMargin:"100px",...a});return e.observe(r.current),()=>{r.current&&e.unobserve(r.current)}}),[s,t,a]),r})(e.useCallback((()=>{B&&s&&setTimeout((()=>{r||s()}),300)}),[B,s,r]),B,{threshold:f});e.useEffect((()=>{if(r)D(Date.now());else if(I&&v){const e=Date.now()-I;"undefined"!=typeof window&&window.gtag&&window.gtag("event","load_more_time",{event_category:"Performance",event_label:c,value:e,network_speed:R,retry_count:z}),D(null)}}),[r,I,v,c,R,z]),e.useEffect((()=>{r||W||P()}),[r,W,P]);const H=e.useMemo((()=>0===i?0:Math.min(100,n/i*100)),[n,i]),V=e.useMemo((()=>Math.max(0,i-n)),[i,n]),U=e.useMemo((()=>S?Math.max(1,Math.floor(N*({fast:1,medium:.7,slow:.5,offline:0}[R]||1))):N),[S,N,R]),Y=e.useMemo((()=>{switch(p){case"small":return{button:"px-4 py-2 text-sm",icon:"w-4 h-4",badge:"px-1.5 py-0.5 text-xs",progress:"h-1.5"};case"large":return{button:"px-8 py-4 text-base",icon:"w-6 h-6",badge:"px-3 py-1.5 text-sm",progress:"h-3"};default:return{button:"px-6 py-3 text-sm",icon:"w-5 h-5",badge:"px-2 py-1 text-xs",progress:"h-2"}}}),[p]),q=e.useMemo((()=>{switch(x){case"primary":return{button:"bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-500 hover:to-blue-400 text-white border-blue-400/30 hover:border-blue-400/50 shadow-blue-500/20",progress:"bg-gradient-to-r from-blue-500 to-blue-600",badge:"bg-blue-400/30 text-white border-blue-400/50",skeleton:"bg-blue-500/10"};case"secondary":return{button:"bg-gradient-to-r from-gray-700 to-gray-600 hover:from-gray-600 hover:to-gray-500 text-white border-gray-500/30 hover:border-gray-500/50 shadow-gray-500/20",progress:"bg-gradient-to-r from-gray-500 to-gray-600",badge:"bg-gray-400/30 text-white border-gray-400/50",skeleton:"bg-gray-500/10"};case"minimal":return{button:"bg-transparent hover:bg-white/5 text-white/80 border-white/10 hover:border-white/20 shadow-none",progress:"bg-white/30",badge:"bg-white/10 text-white/70 border-white/20",skeleton:"bg-white/5"};case"gradient":return{button:"bg-gradient-to-r from-purple-600 via-pink-600 to-red-600 hover:from-purple-500 hover:via-pink-500 hover:to-red-500 text-white border-transparent shadow-purple-500/30",progress:"bg-gradient-to-r from-purple-500 via-pink-500 to-red-500",badge:"bg-white/20 text-white border-white/30",skeleton:"bg-gradient-to-r from-purple-500/10 via-pink-500/10 to-red-500/10"};default:return{button:"bg-gradient-to-r from-white/10 to-white/5 hover:from-white/15 hover:to-white/10 text-white/90 border-white/20 hover:border-white/30 shadow-white/5",progress:"bg-gradient-to-r from-blue-500 to-blue-600",badge:"bg-blue-500/20 text-blue-400 border-blue-500/30",skeleton:"bg-white/5"}}}),[x]),G=e.useMemo((()=>({initial:{scale:1,y:0},hover:{scale:1.02,y:-2,transition:{type:"spring",stiffness:400,damping:25}},pressed:{scale:.98,y:0,transition:{type:"spring",stiffness:400,damping:25}},error:{x:[-10,10,-10,10,0],transition:{duration:.4}}})),[!1]),J=e.useMemo((()=>({initial:{y:0,rotate:0},hover:{y:[0,2,0],rotate:0,transition:{duration:1.5,repeat:1/0,ease:"easeInOut"}},loading:{rotate:360,transition:{duration:1,repeat:1/0,ease:"linear"}}})),[]),X=e.useMemo((()=>({initial:{width:0},animate:{width:H+"%",transition:{duration:.5,ease:"easeOut"}}})),[H]),K=e.useCallback((async e=>{if(e?.preventDefault(),e?.stopPropagation(),!r&&!m&&a&&s){k&&window.navigator?.vibrate&&window.navigator.vibrate(10);try{await s(),P()}catch(t){A(t)}}}),[r,m,a,s,k,P,A]),ee=e.useCallback((()=>{F&&(O(),K())}),[F,O,K]),te=e.useCallback((()=>{m||r||T(!0)}),[m,r]),se=e.useCallback((()=>{T(!1),E(!1)}),[]),ae=e.useCallback((()=>{m||r||E(!0)}),[m,r]),re=e.useCallback((()=>{E(!1)}),[]),ie=e.useCallback((e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),K(e))}),[K]);return a?W&&w?t.jsx(Q.div,{className:"flex flex-col items-center gap-3 "+d,initial:{opacity:0,y:20},animate:{opacity:1,y:0,...G.error},children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-red-400 mb-2",children:t.jsx("svg",{className:"w-12 h-12 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),t.jsxs("p",{className:"text-sm text-white/80 mb-1",children:["Failed to load more ",c]}),t.jsx("p",{className:"text-xs text-white/50 mb-3",children:F?`Retry ${z}/${b}`:"Max retries reached"}),F&&t.jsx(Q.button,{onClick:ee,className:`${Y.button} ${q.button} rounded-xl font-medium`,whileHover:{scale:1.05},whileTap:{scale:.95},children:"Try Again"})]})}):t.jsx("div",{ref:$,children:t.jsxs(Q.div,{className:"flex flex-col items-center gap-3 "+d,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[t.jsx(Z,{children:y&&r&&t.jsx(Q.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"w-full mb-4",children:t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:Array.from({length:Math.min(U,5)},((e,s)=>t.jsx(Q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*s},className:"rounded-lg overflow-hidden "+q.skeleton,style:{height:j},children:t.jsx("div",{className:"w-full h-full animate-pulse bg-gradient-to-br from-white/5 to-white/10"})},s)))})})}),u&&i>0&&t.jsxs(Q.div,{className:"w-full max-w-xs",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{delay:.1},children:[t.jsxs("div",{className:"flex items-center justify-between text-xs text-white/60 mb-2",children:[t.jsx("span",{className:"font-medium",children:"Progress"}),t.jsxs("span",{className:"font-mono",children:[n," / ",i," ",c]})]}),t.jsxs("div",{className:`w-full ${Y.progress} bg-white/10 rounded-full overflow-hidden relative`,children:[t.jsx(Q.div,{className:"h-full rounded-full "+q.progress,variants:X,initial:"initial",animate:"animate"}),r&&t.jsx(Q.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent",animate:{x:["-100%","100%"]},transition:{duration:1.5,repeat:1/0,ease:"linear"}})]}),t.jsxs("div",{className:"flex items-center justify-between text-xs text-white/40 mt-1",children:[t.jsxs("span",{children:[Math.round(H),"%"]}),t.jsxs("span",{children:[V," remaining"]})]})]}),"auto"!==g&&t.jsxs(Q.button,{onClick:K,onMouseEnter:te,onMouseLeave:se,onMouseDown:ae,onMouseUp:re,onKeyDown:ie,disabled:r||m||"offline"===R,className:`\n              relative flex items-center gap-3 ${Y.button}\n              ${q.button}\n              disabled:opacity-50 disabled:cursor-not-allowed\n              rounded-full font-medium transition-all duration-200\n              shadow-lg backdrop-blur-sm border\n              ${r?"cursor-wait":"cursor-pointer"}\n              focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:ring-offset-2 focus:ring-offset-neutral-900\n            `,variants:G,initial:"initial",animate:M?"pressed":L?"hover":"initial",whileHover:m||r?void 0:"hover",whileTap:m||r?void 0:"pressed","aria-label":r?o:`${l} - ${V} more ${c}`,role:"button",tabIndex:0,..._,children:[t.jsx(Q.div,{variants:J,initial:"initial",animate:r?"loading":L?"hover":"initial",className:"flex-shrink-0 -ml-2",children:r?t.jsx("svg",{className:Y.icon+" scale-90",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}):t.jsx("svg",{className:Y.icon+" transition-transform duration-200 scale-90",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})}),t.jsx("span",{className:"font-medium flex-1 text-center",children:r?o:l}),t.jsx(Z,{children:h&&!r&&V>0&&t.jsxs(Q.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},transition:{delay:.1,type:"spring",stiffness:300},className:`${Y.badge} ${q.badge} h-9 w-9 -my-1 flex items-center justify-center font-bold -mr-4 rounded-full border flex-shrink-0`,children:["+",Math.min(U,V)]})}),t.jsx(Z,{children:M&&t.jsx(Q.div,{className:"absolute inset-0 rounded-xl bg-white/10",initial:{scale:0,opacity:.5},animate:{scale:2,opacity:0},exit:{opacity:0},transition:{duration:.6}})})]}),t.jsx(Z,{children:C&&"fast"!==R&&t.jsx(Q.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"flex items-center gap-2 text-xs px-3 py-1.5 rounded-full bg-white/5 border border-white/10",children:"offline"===R?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),t.jsx("span",{className:"text-red-400",children:"Offline"})]}):t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"w-2 h-2 bg-yellow-500 rounded-full animate-pulse"}),t.jsxs("span",{className:"text-yellow-400",children:[R," connection"]}),t.jsxs("span",{className:"text-white/50",children:["• Loading ",U," at a time"]})]})})}),t.jsx(Z,{children:r&&t.jsxs(Q.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"flex items-center gap-2 text-xs text-white/50",children:[t.jsx(Q.div,{className:"w-2 h-2 bg-blue-500 rounded-full",animate:{scale:[1,1.2,1],opacity:[.5,1,.5]},transition:{duration:1.5,repeat:1/0}}),t.jsxs("span",{children:["Fetching ",U," more ",c,"..."]}),z>0&&t.jsxs("span",{className:"text-yellow-400",children:["• Retry ",z]})]})}),"auto"===g&&!r&&t.jsx(Q.div,{initial:{opacity:0},animate:{opacity:.5},className:"text-xs text-white/40 text-center",children:"Auto-loading enabled • Scroll for more"})]})}):null}));ur.displayName="EnhancedLoadMoreButton";const hr=Object.freeze(Object.defineProperty({__proto__:null,default:ur},Symbol.toStringTag,{value:"Module"})),mr=s.memo(s.forwardRef((({episodes:s,selectedEpisode:a,onEpisodeSelect:r,containerHeight:i=300,itemHeight:n=50,onLoadMore:o,hasMore:l},c)=>{const[d,u]=e.useState(0),h=e.useRef(null),m=Math.ceil(i/n),p=Math.max(0,Math.floor(d/n)),x=Math.min(p+m+1,s.length),g=s.slice(p,x),f=e.useCallback((e=>{u(e.target.scrollTop)}),[]);return e.useImperativeHandle(c,(()=>({scrollToEpisode:e=>{const t=s.findIndex((t=>t.episode_number===e));-1!==t&&h.current&&(h.current.scrollTop=t*n,u(h.current.scrollTop||0))},getScrollTop:()=>h.current?h.current.scrollTop:0})),[s,n]),t.jsxs("div",{ref:h,className:"overflow-y-auto",style:{height:i,transition:"opacity 160ms ease, transform 160ms ease"},onScroll:f,children:[t.jsx("div",{style:{height:s.length*n,position:"relative"},children:g.map(((e,i)=>{const o=p+i,l=s[o];return t.jsx("div",{style:{position:"absolute",top:o*n,height:n,width:"100%"},children:t.jsx("button",{onClick:()=>r(l),className:"w-full px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 text-left "+(a===l.episode_number?"bg-red-600 text-white shadow-lg":"bg-white/10 text-white/80 hover:bg-white/20"),children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("span",{children:["Episode ",l.episode_number]}),l.name&&t.jsx("span",{className:"text-xs opacity-70 truncate ml-2",children:l.name})]})})},l.id||o)}))}),l&&s.length>0&&t.jsx("div",{className:"flex justify-center mt-4",children:t.jsx(ur,{onClick:o,hasMore:l,isLoading:!1,totalItems:s.length,displayedItems:s.length,loadingText:"Loading more episodes...",buttonText:"Load More Episodes",itemName:"episodes",variant:"minimal",size:"small",showProgress:!1})})]})}))),pr=Object.freeze(Object.defineProperty({__proto__:null,default:({show:s,isOpen:a,onClose:r,onEpisodeSelect:i,seasons:n=[],currentSeason:o=null,onSeasonChange:l=null})=>{const{startWatchingEpisode:c}=At(),[d,u]=e.useState(1),[h,m]=e.useState(1),[p,x]=e.useState([]),[g,f]=e.useState(!1),[w,b]=e.useState(""),[v,y]=e.useState("grid"),[j,N]=e.useState(!1),[k,C]=e.useState(10),[S,_]=e.useState(0),[L,T]=e.useState(!1),[M,E]=e.useState(null),[I,D]=e.useState(0),R=e.useRef(!0),z="tv-episode-selector-"+(s?.id||"default"),{container:W,createPortal:A,isReady:O}=re(z,{...nr,...or(0,{onClose:r})}),P=e.useRef(null);e.useEffect((()=>{a&&(u(o?.season_number||1),m(1),b(""),C(10))}),[a,o?.season_number]);const F=e.useCallback((async e=>{if(s?.id&&e&&R.current){f(!0);try{const t=(await Ie(s.id,e)).episodes||[];if(!R.current)return;x(t),_(t.length),C(10)}catch(t){if(!R.current)return;x([]),_(0)}finally{R.current&&f(!1)}}}),[s?.id]);e.useEffect((()=>{a&&d&&F(d)}),[a,d,F]),e.useEffect((()=>(R.current=!0,()=>{R.current=!1,P.current&&clearTimeout(P.current)})),[]);const B=e.useMemo((()=>{if(!w.trim())return p;const e=w.toLowerCase();return p.filter((t=>t.name?.toLowerCase().includes(e)||t.overview?.toLowerCase().includes(e)||t.episode_number.toString().includes(e)))}),[p,w]),$=e.useMemo((()=>B.slice(0,k)),[B,k]),H=e.useMemo((()=>k<B.length),[k,B.length]),V=e.useCallback((()=>{r()}),[r]),U=e.useCallback((e=>{"Escape"===e.key&&a&&V()}),[a,V]);e.useEffect((()=>(a&&(document.addEventListener("keydown",U),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",U),document.body.style.overflow=""})),[a,U]);const Y=e.useCallback((e=>{e.target.classList.contains("tv-episode-selector-overlay")&&V()}),[V]),q=e.useCallback((e=>{u(e.season_number||e),m(1),b(""),C(10),l&&l(e)}),[l]),G=e.useCallback((e=>{m(e.episode_number),c(s,d,e.episode_number,e);const t={showId:s?.id,season:d,episode:e.episode_number,episodeInfo:e,showInfo:s};i(d,e.episode_number,t),V()}),[d,c,s,i,V]),J=e.useCallback((async()=>{if(L||!H||!R.current)return;const e=Date.now();if(e-I>=500){P.current&&clearTimeout(P.current),T(!0),E(null),D(e);try{if(await new Promise((e=>{P.current=setTimeout(e,300)})),!R.current)return;const e=Math.min(k+10,B.length);C(e),e>=B.length&&p.length}catch(t){if(!R.current)return;E("Failed to load more episodes. Please try again."),setTimeout((()=>{R.current&&E(null)}),3e3)}finally{R.current&&T(!1)}}}),[L,H,k,B.length,p.length,S,I]);e.useCallback((async()=>{if(s?.id&&d&&R.current)try{const e=(await Ie(s.id,d)).episodes||[];R.current&&(x(e),_(e.length))}catch(e){}}),[s?.id,d]);const X=e.useCallback((e=>{const t=e.target.value;b(t),C(10)}),[]),K=e.useRef(null),ee=e.useRef(null),te=e.useRef(null),se=e.useCallback((e=>{if(e!==v&&!j){N(!0);try{if("list"===e){const t=K.current,s=Math.floor((t?.scrollTop||0)/80),a=$[s]?.episode_number;return y(e),void setTimeout((()=>{te.current&&a&&te.current.scrollToEpisode(a),N(!1)}),180)}if("grid"===e){const e=te.current?.getScrollTop?.()||0;ee.current&&(ee.current._savedScrollTop=e)}y(e),setTimeout((()=>N(!1)),120)}catch(t){y(e),N(!1)}}}),[v,j,$]),ae=e.useMemo((()=>n.length>0?n:Array.from({length:s?.number_of_seasons||10},((e,t)=>({season_number:t+1,name:"Season "+(t+1),episode_count:s?.seasons?.[t]?.episode_count||20})))),[n,s]);return"undefined"!=typeof window&&O&&W?A(t.jsx(Z,{children:a&&t.jsx(Q.div,{className:"tv-episode-selector-overlay fixed inset-0 bg-black/80 flex items-center justify-center z-[9999999999] p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeInOut"},onClick:Y,children:t.jsxs(Q.div,{className:"relative w-full max-w-4xl bg-gradient-to-br from-[#1a1d24] to-[#121417] rounded-2xl shadow-2xl overflow-hidden",initial:{scale:.95,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:20},transition:{duration:.3,ease:"easeOut"},onClick:e=>e.stopPropagation(),children:[t.jsxs("div",{className:"p-6 border-b border-white/10",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h2",{className:"text-white text-xl font-semibold",children:"Select Episode"}),t.jsx("button",{onClick:V,className:"p-2 bg-white/10 hover:bg-white/20 rounded-full transition-colors duration-200","aria-label":"Close episode selector",children:t.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s&&t.jsx("p",{className:"text-white/60 text-sm mt-2",children:s.title||s.name})]}),t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"lg:col-span-1",children:[t.jsx("label",{className:"block text-white/80 text-sm font-medium mb-3",children:"Season"}),t.jsx("div",{className:"grid grid-cols-3 gap-2 max-h-64 overflow-y-auto",children:ae.map((e=>t.jsx("button",{onClick:()=>q(e),className:"px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 "+(d===e.season_number?"bg-red-600 text-white shadow-lg":"bg-white/10 text-white/80 hover:bg-white/20"),children:t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{children:["Season ",e.season_number]}),e.episode_count&&t.jsxs("div",{className:"text-xs opacity-70",children:[e.episode_count," episodes"]})]})},e.season_number)))})]}),t.jsxs("div",{className:"lg:col-span-2",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("label",{className:"block text-white/80 text-sm font-medium",children:["Episodes (",B.length," total, showing ",$.length,")"]}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsxs("div",{className:"flex bg-white/10 rounded-lg p-1",children:[t.jsx("button",{onClick:()=>se("grid"),disabled:j,className:`px-3 py-1 rounded text-xs font-medium transition-all duration-200 ${"grid"===v?"bg-red-600 text-white":"text-white/80 hover:bg-white/20"} ${j?"opacity-50 cursor-not-allowed":""}`,children:"Grid"}),t.jsx("button",{onClick:()=>se("list"),disabled:j,className:`px-3 py-1 rounded text-xs font-medium transition-all duration-200 ${"list"===v?"bg-red-600 text-white":"text-white/80 hover:bg-white/20"} ${j?"opacity-50 cursor-not-allowed":""}`,children:"List"})]})})]}),t.jsx("div",{className:"mb-4",children:t.jsx("input",{type:"text",placeholder:"Search episodes...",value:w,onChange:X,className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:border-red-500 transition-colors"})}),g?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"text-white/60",children:"Loading episodes..."})}):0===B.length?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"text-white/60",children:w?"No episodes found matching your search.":"No episodes available."})}):t.jsx("div",{children:t.jsxs(Z,{mode:"wait",children:["grid"===v&&t.jsxs(Q.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},exit:{opacity:0,y:-6},transition:{duration:.18},className:"relative",children:[t.jsx("div",{ref:K,className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2 max-h-96 overflow-y-auto",children:$.map(((e,s)=>t.jsxs("div",{className:"relative",children:[t.jsx("button",{onClick:()=>G(e),className:"w-full p-3 rounded-lg text-sm font-medium transition-all duration-200 text-left "+(h===e.episode_number?"bg-red-600 text-white shadow-lg":"bg-white/10 text-white/80 hover:bg-white/20"),children:t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"font-semibold",children:["Episode ",e.episode_number]}),e.name&&t.jsx("div",{className:"text-xs opacity-70 truncate mt-1",children:e.name}),e.runtime&&t.jsxs("div",{className:"text-xs opacity-50 mt-1",children:[Math.floor(e.runtime/60),"m"]})]})}),H&&9===s&&t.jsx(Q.div,{className:"absolute -bottom-8 left-1/2 transform -translate-x-1/2 z-10",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},children:t.jsx(Q.button,{onClick:J,className:"flex items-center justify-center w-8 h-8 bg-white/20 hover:bg-white/30 rounded-full transition-colors duration-200 shadow-lg",whileHover:{scale:1.1},whileTap:{scale:.9},children:t.jsx(Q.svg,{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{y:[0,2,0]},transition:{duration:1.5,repeat:1/0},children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7-7-7"})})})})]},e.id)))}),H&&t.jsx("div",{className:"flex justify-center mt-6",children:t.jsx(ur,{onClick:J,hasMore:H,isLoading:L,totalItems:B.length,displayedItems:k,loadingText:"Loading more episodes...",buttonText:"Load More Episodes",itemName:"episodes",variant:"primary"})}),M&&t.jsx(Q.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-4 text-center",children:t.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),M]})})]},"grid"),"list"===v&&t.jsx(Q.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},exit:{opacity:0,y:-6},transition:{duration:.18},className:"max-h-96",children:t.jsx(mr,{ref:te,episodes:$,selectedEpisode:h,onEpisodeSelect:G,containerHeight:384,itemHeight:60,onLoadMore:J,hasMore:H})},"list")]})})]})]}),t.jsxs("div",{className:"flex gap-3 pt-6 border-t border-white/10",children:[t.jsx("button",{onClick:V,className:"flex-1 px-4 py-3 bg-white/10 hover:bg-white/20 rounded-lg transition-colors text-white font-medium",children:"Cancel"}),t.jsxs("button",{onClick:()=>{const e=p.find((e=>e.episode_number===h));e&&G(e)},className:"flex-1 px-4 py-3 bg-gradient-to-r from-red-600 to-red-500 hover:from-red-500 hover:to-red-400 rounded-lg transition-all duration-200 text-white font-semibold shadow-lg hover:shadow-red-500/25",children:["Watch Episode ",h]})]})]})]})})})):null}},Symbol.toStringTag,{value:"Module"})),xr={cachedData:new WeakMap,failedImageUrls:new Set,cleanup:()=>{try{Je.clearCache&&Je.clearCache(),Je.clearAllSimilarContentCache&&Je.clearAllSimilarContentCache(),xr.cachedData=new WeakMap,xr.failedImageUrls.clear();const e=ys.getStats();e&&e.current}catch(e){}},monitor:()=>{const e=ys.getStats();e&&e.current>1e3&&xr.cleanup()},componentCleanup:()=>{try{Je.clearAllSimilarContentCache&&Je.clearAllSimilarContentCache(),xr.cachedData=new WeakMap,xr.failedImageUrls.clear()}catch(e){}}},gr=({children:e,motionProps:s={},className:a="",style:r={},as:i="div",...n})=>{if("undefined"==typeof window||!window.matchMedia||!window.matchMedia("(prefers-reduced-motion: reduce)").matches)return t.jsx(Q.div,{className:a,style:r,...s,...n,children:e});const o=i;return t.jsx(o,{className:a,style:r,...n,children:e})};s.memo((({count:e=8,isMobile:s=!1})=>t.jsx("div",{className:"grid gap-4 "+(s?"grid-cols-2 sm:grid-cols-3":"grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6"),children:[...Array(e)].map(((e,s)=>t.jsxs("div",{className:"bg-gray-800/50 rounded-lg overflow-hidden animate-pulse","aria-hidden":"true",children:[t.jsx("div",{className:"aspect-[2/3] bg-gray-700/50"}),t.jsxs("div",{className:"p-3 space-y-2",children:[t.jsx("div",{className:"h-4 bg-gray-700/50 rounded w-3/4"}),t.jsx("div",{className:"h-3 bg-gray-700/50 rounded w-1/2"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"h-3 w-3 bg-gray-700/50 rounded-full"}),t.jsx("div",{className:"h-3 bg-gray-700/50 rounded w-1/3"})]})]})]},s)))}))).propTypes={count:le.number,isMobile:le.bool};const fr=s.memo((({options:s,value:a,onChange:r,placeholder:i="Select option",className:n=""})=>{const[o,l]=e.useState(!1),c=e.useRef(null),d=e.useRef(!0);e.useEffect((()=>(d.current=!0,()=>{d.current=!1})),[]);const u=e.useCallback((e=>{d.current&&c.current&&!c.current.contains(e.target)&&l(!1)}),[]);e.useEffect((()=>{if(o)return document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}}),[o,u]);const h=s.find((e=>e.value===a))||s[0],m=e.useCallback((e=>{if("Enter"===e.key||" "===e.key)e.preventDefault(),l(!o);else if("Escape"===e.key&&o)e.preventDefault(),l(!1);else if("ArrowDown"===e.key&&o){e.preventDefault();const t=(s.findIndex((e=>e.value===a))+1)%s.length;r(s[t].value)}else if("ArrowUp"===e.key&&o){e.preventDefault();const t=s.findIndex((e=>e.value===a)),i=0===t?s.length-1:t-1;r(s[i].value)}}),[o,s,a,r]);return t.jsxs("div",{ref:c,className:"relative "+n,children:[t.jsxs("button",{onClick:()=>l(!o),onKeyDown:m,"aria-haspopup":"listbox","aria-expanded":o,"aria-label":`${i}: ${h?.label}`,className:"flex items-center justify-between w-full px-3 py-1.5 text-sm text-white bg-transparent border-b border-white/15 hover:border-white/30 focus:outline-none focus:border-primary/80 transition-all duration-200 min-w-[120px]",children:[t.jsx("span",{className:"truncate",children:h?.label||i}),t.jsx(Q.svg,{className:"w-4 h-4 text-white/60 ml-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:o?180:0},transition:{duration:.2},children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t.jsx(Z,{children:o&&t.jsx(Q.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2,ease:"easeOut"},role:"listbox","aria-label":i,className:"absolute top-full left-0 right-0 mt-1 bg-[#1a1a1a]/95 backdrop-blur-md border border-white/10 rounded-lg shadow-xl z-50 overflow-hidden",children:t.jsx("div",{className:"max-h-48 overflow-y-auto",children:s.map(((e,i)=>t.jsx("button",{onClick:()=>{r(e.value),l(!1)},role:"option","aria-selected":e.value===a,className:`w-full px-3 py-2 text-sm text-left hover:bg-white/10 transition-colors duration-150 focus:outline-none focus:bg-white/15 ${e.value===a?"bg-primary/20 text-primary":"text-white/80"} ${0===i?"rounded-t-lg":""} ${i===s.length-1?"rounded-b-lg":""}`,children:e.label},e.value)))})})})]})})),wr=s.memo((({item:s,onClick:a=null,isMobile:r=!1,showRelevanceScore:i=!1,disableAnimations:n=!1})=>{const o=e.useRef(!0),l=e.useRef(null),c=e.useRef(null),[d,u]=e.useState(!1),[h,m]=e.useState(!1),[p,x]=e.useState(!1);"undefined"!=typeof window&&window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches,e.useEffect((()=>(o.current=!0,()=>{if(o.current=!1,l.current)try{l.current.src="",l.current.onload=null,l.current.onerror=null,l.current=null}catch(e){}c.current=null})),[]),e.useEffect((()=>{s.poster_path&&"string"==typeof s.poster_path&&(c.current=Pt(s.poster_path,"w500"))}),[s.poster_path]);const g=e.useMemo((()=>s.title||s.name||"Untitled"),[s.title,s.name]),f=e.useMemo((()=>s.year?s.year:s.release_date?new Date(s.release_date).getFullYear():s.first_air_date?new Date(s.first_air_date).getFullYear():"N/A"),[s.year,s.release_date,s.first_air_date]),w=e.useMemo((()=>s.similarityScore?.8>s.similarityScore?.6>s.similarityScore?.4>s.similarityScore?"text-red-400":"text-orange-400":"text-yellow-400":"text-green-400":"text-gray-400"),[s.similarityScore]),b=e.useMemo((()=>s.similarityScore?.8>s.similarityScore?.6>s.similarityScore?.4>s.similarityScore?"Decent Match":"Good Match":"Great Match":"Perfect Match":""),[s.similarityScore]),v=e.useMemo((()=>{if(!n)return{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},hover:{scale:r?1.02:1.01},tap:{scale:.98}}}),[r,n]),y=e.useCallback((async()=>{if(o.current&&a)try{x(!0);const e=a(s);e&&"function"==typeof e.then&&await e}finally{o.current&&x(!1)}}),[a,s]),j=e.useCallback((e=>{if(o.current&&e.target){if(e.target.src&&e.target.src.includes("image.tmdb.org")&&xr.failedImageUrls.add(e.target.src),e.target.src.includes("localhost"))return void(c.current&&(e.target.src=c.current));if(e.target.src.includes("image.tmdb.org")&&!e.target.dataset.fallbackTried&&c.current)return e.target.dataset.fallbackTried="true",void(e.target.src=c.current);m(!0),u(!1),e.target.style.display="none";const t=e.target.parentNode.querySelector(".image-fallback");t&&(t.style.display="flex",t.classList.remove("hidden"))}}),[s.poster_path,g]),N=e.useCallback((e=>{if(o.current&&e.target){u(!0),m(!1);const t=e.target.parentNode.querySelector(".image-fallback");t&&(t.style.display="none",t.classList.add("hidden"))}}),[s.poster_path,g]);return t.jsx(Q.div,{className:"group cursor-pointer relative",onClick:y,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),y())},role:"button",tabIndex:0,"aria-label":`${g}, released ${f}${s.vote_average?", rated "+pt(s.vote_average):""}`,variants:v,initial:v?"initial":void 0,animate:v?"animate":void 0,exit:v?"exit":void 0,whileHover:v?"hover":void 0,whileTap:v?"tap":void 0,transition:v?{type:"spring",stiffness:220,damping:24,duration:.2}:void 0,children:t.jsxs("div",{className:"aspect-[2/3] rounded-xl overflow-hidden bg-gradient-to-br from-gray-800 to-gray-900 relative shadow-lg border border-white/5 hover:border-white/10 transition-all duration-300",children:[s.poster_path&&"string"==typeof s.poster_path&&s.poster_path.startsWith("/")?t.jsx("img",{ref:l,src:Pt(s.poster_path,"w500"),alt:g,className:"w-full h-full object-cover transition-transform duration-200 group-hover:scale-104",loading:"lazy",decoding:"async",fetchpriority:"low",sizes:r?"50vw":"20vw",style:{willChange:"auto",backfaceVisibility:"hidden",contain:"layout style paint"},onError:j,onLoad:N},`${s.id}-${s.poster_path}`):null,t.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400 bg-gradient-to-br from-gray-700 to-gray-800 image-fallback "+(s.poster_path&&"string"==typeof s.poster_path&&s.poster_path.startsWith("/")&&d&&!h?"hidden":""),children:t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),i&&s.similarityScore&&t.jsxs("div",{className:"absolute top-2 left-2 px-2 py-1 rounded-full text-xs font-semibold bg-black/80 backdrop-blur-sm border border-white/20 "+w,children:[Math.round(100*s.similarityScore),"%"]}),s.vote_average&&t.jsx("div",{className:"absolute top-2 right-2 px-2 py-1 rounded-full text-xs font-semibold bg-black/80 backdrop-blur-sm text-white border border-white/20",children:t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3 text-yellow-400",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})}),pt(s.vote_average)]})}),!r&&t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/90 via-black/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col justify-end p-3",children:t.jsxs("div",{className:"transform transition-transform duration-300 group-hover:-translate-y-2",children:[t.jsx("h4",{className:"font-semibold text-white text-sm truncate",children:g}),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-white/70 mt-1",children:[t.jsx("span",{children:f}),s.genres&&s.genres.length>0&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"w-1 h-1 rounded-full bg-white/50"}),t.jsx("span",{className:"truncate",children:s.genres[0]?.name||s.genres[0]})]})]}),i&&s.similarityScore&&t.jsx("div",{className:"text-xs mt-1 "+w,children:b})]})}),r&&t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col justify-end p-2",children:t.jsxs("div",{className:"text-center",children:[t.jsx("h4",{className:"font-semibold text-white text-xs truncate mb-1",children:g}),t.jsxs("div",{className:"flex items-center justify-center gap-1 text-xs text-white/70",children:[t.jsx("span",{children:f}),s.vote_average&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"w-1 h-1 rounded-full bg-white/50"}),t.jsxs("span",{className:"flex items-center gap-0.5",children:[t.jsx("svg",{className:"w-3 h-3 text-yellow-400",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})}),pt(s.vote_average)]})]})]})]})}),p?t.jsx(Qt,{visible:!0}):t.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:t.jsx(Q.div,{className:(r?"w-10 h-10":"w-12 h-12")+" bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center border border-white/30",whileHover:{scale:1.04},transition:{duration:.18},children:t.jsx("svg",{className:(r?"w-5 h-5":"w-6 h-6")+" text-white",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M8 5v14l11-7z"})})})})]})})})),br=s.memo((({filters:s,onFilterChange:a,isMobile:r=!1})=>{const[i,n]=e.useState(!1),o=e.useMemo((()=>[{value:0,label:"All"},{value:.3,label:"Somewhat Similar"},{value:.5,label:"Similar"},{value:.7,label:"Very Similar"},{value:.8,label:"Highly Similar"}]),[]),l=e.useMemo((()=>[{value:"relevance",label:"Most Relevant"},{value:"rating",label:"Highest Rated"},{value:"year",label:"Newest First"},{value:"popularity",label:"Most Popular"},{value:"title",label:"Alphabetical"}]),[]),c=e.useMemo((()=>[{value:0,label:"All Years"},{value:2024,label:"2024"},{value:2023,label:"2023"},{value:2022,label:"2022"},{value:2021,label:"2021"},{value:2020,label:"2020"},{value:2019,label:"2019"},{value:2018,label:"2018"}]),[]),d=e.useMemo((()=>({initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0}})),[]),u=e.useCallback(((e,t)=>{a(e,t)}),[a]),h=e.useCallback((()=>{a("minRelevance",0),a("sortBy","relevance"),a("showRelevanceScore",!1),a("year",0)}),[a]),m=e.useCallback((()=>{a("showRelevanceScore",!s.showRelevanceScore)}),[a,s.showRelevanceScore]),p=e.useCallback((()=>{n((e=>!e))}),[]);return r?t.jsxs("div",{className:"mb-4",children:[t.jsxs("button",{onClick:p,className:"w-full flex items-center justify-between px-4 py-3 bg-white/10 border border-white/20 rounded-full text-white/90 hover:bg-white/15 transition-all duration-200",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.207A1 1 0 013 6.5V4z"})}),t.jsx("span",{className:"text-sm font-medium",children:"Filters & Sort"})]}),t.jsx(Q.svg,{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:i?180:0},transition:{duration:.2},children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t.jsx(Z,{children:i&&t.jsxs(Q.div,{variants:d,initial:"initial",animate:"animate",exit:"exit",transition:{duration:.2},className:"mt-3 space-y-3",children:[t.jsxs("div",{className:"bg-white/5 rounded-lg p-3",children:[t.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Relevance"}),t.jsx(fr,{options:o,value:s.minRelevance,onChange:e=>u("minRelevance",e),placeholder:"Select relevance",className:"w-full"})]}),t.jsxs("div",{className:"bg-white/5 rounded-lg p-3",children:[t.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Sort by"}),t.jsx(fr,{options:l,value:s.sortBy,onChange:e=>u("sortBy",e),placeholder:"Select sort",className:"w-full"})]}),t.jsxs("div",{className:"bg-white/5 rounded-lg p-3",children:[t.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Year"}),t.jsx(fr,{options:c,value:s.year,onChange:e=>u("year",e),placeholder:"Select year",className:"w-full"})]}),t.jsx("div",{className:"bg-white/5 rounded-lg p-3",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("label",{className:"text-sm font-medium text-white/80",children:"Show relevance scores"}),t.jsx("button",{onClick:m,className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors duration-200 "+(s.showRelevanceScore?"bg-primary":"bg-white/20"),children:t.jsx("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform duration-200 "+(s.showRelevanceScore?"translate-x-6":"translate-x-1")})})]})}),t.jsxs("div",{className:"flex gap-2 pt-2",children:[t.jsx("button",{onClick:h,className:"flex-1 px-3 py-2 text-xs font-medium text-white/70 bg-white/5 border border-white/10 rounded-full hover:bg-white/10 transition-colors",children:"Reset"}),t.jsx("button",{onClick:()=>n(!1),className:"flex-1 px-3 py-2 text-xs font-medium text-white bg-primary/5 border border-primary/10 rounded-full hover:bg-primary/30 transition-colors",children:"Apply"})]})]})})]}):t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("label",{className:"text-sm text-white/60 font-medium",children:"Relevance"}),t.jsx(fr,{options:o,value:s.minRelevance,onChange:e=>u("minRelevance",e),placeholder:"Select relevance"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("label",{className:"text-sm text-white/60 font-medium",children:"Sort"}),t.jsx(fr,{options:l,value:s.sortBy,onChange:e=>u("sortBy",e),placeholder:"Select sort"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("label",{className:"text-sm text-white/60 font-medium",children:"Year"}),t.jsx(fr,{options:c,value:s.year,onChange:e=>u("year",e),placeholder:"Select year"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("label",{className:"text-sm text-white/60 font-medium",children:"Scores"}),t.jsx("button",{type:"button","aria-pressed":s.showRelevanceScore,onClick:m,className:"relative w-10 h-5 rounded-full transition-colors duration-200 "+(s.showRelevanceScore?"bg-primary/80":"bg-white/20"),tabIndex:0,children:t.jsx("span",{className:"absolute top-0 left-0 h-5 w-5 rounded-full bg-white shadow transition-transform duration-200 "+(s.showRelevanceScore?"translate-x-5":"translate-x-0")})})]})]})})),vr=s.memo((({contentId:s,contentType:a="movie",onItemClick:r=null,isMobile:i=!1,maxItems:n=16,showFilters:o=!0,showTitle:l=!0,showPagination:c=!1,showLoadMore:d=!0,className:u=""})=>{const[h,m]=e.useState([]),[p,x]=e.useState(!0),[g,f]=e.useState(null),[w,b]=e.useState(8),[v,y]=e.useState(!0),[j,N]=e.useState(1),[k,C]=e.useState(!1),S="undefined"!=typeof window&&window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches,[_,L]=e.useTransition(),[T,M]=e.useState({minRelevance:0,sortBy:"relevance",showRelevanceScore:!1,year:0}),E=e.useDeferredValue(T),I=e.useRef(null),D=e.useRef(!0),R=e.useRef(new Set),z=e.useRef(null),W=e.useRef(0);e.useEffect((()=>(D.current=!0,()=>{D.current=!1,z.current&&(clearTimeout(z.current),z.current=null),B.current&&(clearTimeout(B.current),B.current=null),I.current&&(I.current.abort(),I.current=null),R.current.clear()})),[]);const A=e.useCallback((async(e=1,t=!1)=>{const r=++W.current;if(!s||!D.current)return;const i=`${s}-${a}-${e}`;if(!R.current.has(i)){I.current&&(I.current.abort(),I.current=null),I.current=new AbortController,R.current.add(i),1===e?x(!0):C(!0),f(null);try{const i=await Je.getSimilarContent(s,a,{limit:50,minScore:.3,forceRefresh:!1,page:e,infiniteLoading:e>1,signal:I.current?I.current.signal:void 0});if(!D.current||r!==W.current)return;if(I.current?.signal.aborted)return;if(i&&Array.isArray(i)){if(t)m((e=>{const t=[...e,...i];return(Je.removeDuplicates?Je.removeDuplicates(t,{strategy:"smart",keepBestScore:!0,preserveOrder:!1}):t.filter(((e,t,s)=>t===s.findIndex((t=>t.id===e.id))))).slice(0,n)}));else{const e=Je.removeDuplicates?Je.removeDuplicates(i,{strategy:"smart",keepBestScore:!0,preserveOrder:!1}):i;m(e.slice(0,n))}y(i.length>=10)}else m([]),y(!1)}catch(o){if("AbortError"===o.name||o.message?.includes("aborted"))return;if(!D.current||r!==W.current)return;f("Failed to load similar content"),y(!1)}finally{R.current.delete(i),D.current&&r===W.current&&(x(!1),C(!1))}}}),[s,a,n]),O=e.useMemo((()=>{if(!h.length)return[];let e=h.filter((e=>!(E.minRelevance&&(!e.similarityScore||e.similarityScore<E.minRelevance))&&(0>=E.year||(e.year||(e.release_date?new Date(e.release_date).getFullYear():e.first_air_date?new Date(e.first_air_date).getFullYear():0))===E.year)));if(e.length>1)switch(E.sortBy){case"rating":e.sort(((e,t)=>(t.vote_average||0)-(e.vote_average||0)));break;case"year":e.sort(((e,t)=>{const s=e.year||new Date(e.release_date||e.first_air_date).getFullYear();return(t.year||new Date(t.release_date||t.first_air_date).getFullYear())-s}));break;case"popularity":e.sort(((e,t)=>(t.popularity||0)-(e.popularity||0)));break;case"title":e.sort(((e,t)=>{const s=(e.title||e.name||"").toLowerCase(),a=(t.title||t.name||"").toLowerCase();return s.localeCompare(a)}));break;default:e.sort(((e,t)=>(t.similarityScore||0)-(e.similarityScore||0)))}return e}),[h,E]),P=e.useMemo((()=>{const e=Math.min(w,12);return O.slice(0,e)}),[O,w]),F=e.useCallback(((e,t)=>{I.current&&(I.current.abort(),I.current=null),B.current&&(clearTimeout(B.current),B.current=null),z.current&&(clearTimeout(z.current),z.current=null),R.current.clear(),L((()=>{M((s=>({...s,[e]:t}))),b(8),N(1)}))}),[]),B=e.useRef(null),$=e.useCallback((async()=>{document.hidden||v&&!p&&!k&&D.current&&(B.current&&(clearTimeout(B.current),B.current=null),B.current=setTimeout((async()=>{if(!D.current)return void(B.current=null);const e=j+1;N(e);try{if(s&&a){const r=`${s}-${a}-${e}`;if(!R.current.has(r)){I.current&&I.current.abort(),I.current=new AbortController,R.current.add(r),C(!0);try{const t=await Je.getSimilarContent(s,a,{limit:50,minScore:.3,forceRefresh:!1,page:e,infiniteLoading:!0,signal:I.current.signal});if(!D.current||I.current.signal.aborted)return;t&&Array.isArray(t)?(m((e=>{const s=[...e,...t];return(Je.removeDuplicates?Je.removeDuplicates(s,{strategy:"smart",keepBestScore:!0,preserveOrder:!1}):s.filter(((e,t,s)=>t===s.findIndex((t=>t.id===e.id))))).slice(0,n)})),y(t.length>=10)):y(!1)}catch(t){if("AbortError"===t.name||t.message?.includes("aborted"))return;D.current&&N((e=>e-1))}finally{R.current.delete(r),D.current&&C(!1)}}}D.current&&b((e=>Math.min(e+6,n)))}catch(t){D.current&&N((e=>e-1))}finally{B.current&&(B.current=null)}}),300))}),[v,p,k,j,s,a,n]),H=e.useCallback((e=>{r&&r(e)}),[r]),V=e.useMemo((()=>({initial:{opacity:0,y:3},animate:{opacity:1,y:0},exit:{opacity:0,y:-3}})),[]),U=e.useMemo((()=>({initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}})),[]),Y=e.useMemo((()=>({initial:{opacity:0,y:3},animate:{opacity:1,y:0},exit:{opacity:0,y:-3}})),[]);return e.useMemo((()=>({initial:{opacity:0},animate:{opacity:1,transition:{staggerChildren:.01,delayChildren:.02}}})),[]),e.useMemo((()=>({initial:{opacity:0,y:3},animate:{opacity:1,y:0,transition:{type:"spring",stiffness:150,damping:25,duration:.15}}})),[]),e.useEffect((()=>{if(R.current.clear(),m([]),b(8),N(1),y(!0),f(null),s&&D.current){const e=++W.current;if(window.similarContentCache){const e=window.similarContentCache.get(`${s}-${a}`);if(e&&e.prefetched&&e.data)return m(e.data),b(Math.min(e.data.length,12)),x(!1),f(null),void window.similarContentCache.delete(`${s}-${a}`)}z.current=setTimeout((()=>{if(D.current&&e===W.current){const t=`${s}-${a}-1`;R.current.has(t)||(I.current&&I.current.abort(),I.current=new AbortController,R.current.add(t),x(!0),f(null),Je.getSimilarContent(s,a,{limit:50,minScore:.3,forceRefresh:!1,page:1,infiniteLoading:!1,signal:I.current.signal}).then((t=>{if(D.current&&e===W.current&&!I.current.signal.aborted)if(t&&Array.isArray(t)){const e=Je.removeDuplicates?Je.removeDuplicates(t,{strategy:"smart",keepBestScore:!0,preserveOrder:!1}):t;m(e.slice(0,n)),y(t.length>=10)}else m([]),y(!1)})).catch((t=>{"AbortError"===t.name||t.message?.includes("aborted")||D.current&&e===W.current&&f("Failed to load similar content")})).finally((()=>{D.current&&e===W.current&&x(!1),R.current.delete(t)})))}}),100)}return()=>{z.current&&(clearTimeout(z.current),z.current=null),B.current&&(clearTimeout(B.current),B.current=null),I.current&&(I.current.abort(),I.current=null),R.current.clear(),D.current&&(m([]),x(!1),C(!1),f(null))}}),[s,a,n]),e.useEffect((()=>{y(w<O.length||v&&h.length>0)}),[O.length,w,v,h.length]),e.useEffect((()=>{}),[]),e.useEffect((()=>{window.similarContentCache||(window.similarContentCache=new Map),window.similarContentCache.size>20&&Array.from(window.similarContentCache.entries()).slice(0,10).forEach((([e,t])=>{t&&t.data&&(t.data=null),window.similarContentCache.delete(e)}));const e=ys.registerCleanupCallback((()=>{D.current&&xr.cleanup()}),"EnhancedSimilarContent");return()=>{if(e(),xr.componentCleanup(),xr.failedImageUrls.clear(),window.similarContentCache&&s&&a){const e=`${s}-${a}`;window.similarContentCache.has(e)&&window.similarContentCache.delete(e)}z.current&&(clearTimeout(z.current),z.current=null),B.current&&(clearTimeout(B.current),B.current=null),I.current&&(I.current.abort(),I.current=null),R.current.clear(),D.current&&(m([]),x(!1),C(!1),f(null))}}),[s,a]),e.useEffect((()=>{const e=()=>{document.hidden&&(I.current&&(I.current.abort(),I.current=null),B.current&&(clearTimeout(B.current),B.current=null),z.current&&(clearTimeout(z.current),z.current=null))};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}}),[]),p?t.jsxs(Q.div,{className:""+u,variants:V,initial:V?"initial":void 0,animate:V?"animate":void 0,exit:V?"exit":void 0,transition:{duration:.5},children:[l&&t.jsxs(Q.div,{className:"mb-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:[t.jsxs("div",{className:"hidden lg:flex items-center justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-5 h-5 bg-gradient-to-br from-primary/30 to-primary/20 rounded animate-skeleton-shimmer"}),t.jsx("div",{className:"h-8 w-48 bg-gradient-to-br from-white/20 to-white/10 rounded animate-skeleton-shimmer"})]}),t.jsx("div",{className:"h-4 w-32 bg-gradient-to-br from-white/10 to-white/5 rounded animate-skeleton-shimmer"})]}),t.jsxs("div",{className:"lg:hidden",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("div",{className:"w-5 h-5 bg-gradient-to-br from-primary/30 to-primary/20 rounded animate-skeleton-shimmer"}),t.jsx("div",{className:"h-6 w-40 bg-gradient-to-br from-white/20 to-white/10 rounded animate-skeleton-shimmer"})]}),t.jsx("div",{className:"h-4 w-48 bg-gradient-to-br from-white/10 to-white/5 rounded animate-skeleton-shimmer mb-4"})]})]}),o&&i&&t.jsx("div",{className:"mb-4",children:t.jsx("div",{className:"w-full h-12 bg-gradient-to-br from-white/10 to-white/5 rounded-lg border border-white/20 animate-skeleton-shimmer"})}),t.jsx(Q.div,{className:"grid gap-4 "+(i?"grid-cols-2 gap-3":"grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-8 3xl:grid-cols-10 gap-4"),variants:U,initial:"initial",animate:"animate",children:Array.from({length:i?6:12}).map(((e,s)=>t.jsx(Q.div,{variants:Y,transition:{duration:.15,delay:Math.min(.02*s,.2),type:"spring",stiffness:150,damping:25},className:"group cursor-pointer relative",children:t.jsxs("div",{className:"aspect-[2/3] rounded-xl overflow-hidden bg-gradient-to-br from-gray-800/80 to-gray-900/80 relative shadow-lg border border-white/10",children:[t.jsx("div",{className:"w-full h-full relative overflow-hidden",children:t.jsx("div",{className:"w-full h-full bg-gradient-to-br from-gray-700 via-gray-600 to-gray-700 animate-skeleton-shimmer"})}),t.jsx("div",{className:"absolute top-2 left-2",children:t.jsx("div",{className:"w-8 h-5 bg-gradient-to-br from-black/60 to-black/40 rounded-full animate-skeleton-shimmer"})}),t.jsx("div",{className:"absolute top-2 right-2",children:t.jsx("div",{className:"w-12 h-5 bg-gradient-to-br from-black/60 to-black/40 rounded-full animate-skeleton-shimmer"})}),!i&&t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/90 via-black/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col justify-end p-3",children:t.jsxs("div",{className:"transform transition-transform duration-300 group-hover:-translate-y-2",children:[t.jsx("div",{className:"h-4 w-3/4 bg-gradient-to-br from-white/20 to-white/10 rounded animate-skeleton-shimmer mb-2"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"h-3 w-8 bg-gradient-to-br from-white/15 to-white/8 rounded animate-skeleton-shimmer"}),t.jsx("div",{className:"w-1 h-1 rounded-full bg-white/30"}),t.jsx("div",{className:"h-3 w-16 bg-gradient-to-br from-white/15 to-white/8 rounded animate-skeleton-shimmer"})]})]})}),i&&t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col justify-end p-2",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"h-3 w-3/4 bg-gradient-to-br from-white/20 to-white/10 rounded animate-skeleton-shimmer mb-1 mx-auto"}),t.jsxs("div",{className:"flex items-center justify-center gap-1",children:[t.jsx("div",{className:"h-3 w-6 bg-gradient-to-br from-white/15 to-white/8 rounded animate-skeleton-shimmer"}),t.jsx("div",{className:"w-1 h-1 rounded-full bg-white/30"}),t.jsx("div",{className:"h-3 w-8 bg-gradient-to-br from-white/15 to-white/8 rounded animate-skeleton-shimmer"})]})]})}),t.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-white/20 to-white/10 rounded-full animate-skeleton-shimmer border border-white/30"})})]})},s)))}),t.jsx(Q.div,{className:"mt-6 text-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.4},children:t.jsxs("div",{className:"flex items-center justify-center gap-3 text-white/60",children:[t.jsx("svg",{className:"w-5 h-5 text-primary animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),t.jsx("span",{className:"text-sm font-medium",children:"Analyzing content patterns..."})]})})]}):g?t.jsxs("div",{className:""+u,role:"alert","aria-live":"assertive",children:[l&&t.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Similar Content"}),t.jsxs("div",{className:"text-center text-gray-400 py-8",children:[t.jsx("svg",{className:"w-12 h-12 mx-auto mb-4 text-white/20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),t.jsx("p",{className:"mb-2",children:g}),t.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Please try again or refresh the page."}),t.jsx("button",{onClick:()=>A(1,!1),className:"mt-4 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/80 transition-colors focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 focus:ring-offset-gray-900","aria-label":"Retry loading similar content",children:"Try Again"})]})]}):0===O.length?t.jsxs(Q.div,{className:""+u,variants:V,initial:V?"initial":void 0,animate:V?"animate":void 0,exit:V?"exit":void 0,transition:{duration:.5},children:[l&&t.jsxs(Q.div,{className:"mb-6",initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.5,delay:.2},children:[t.jsxs("div",{className:"hidden lg:flex items-center justify-between mb-2",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"text-xl sm:text-2xl font-bold text-white flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Similar ","tv"===a?"Shows":"Movies"]}),t.jsxs("p",{className:"text-white/60 text-xs sm:text-sm mt-1",children:["Discover more ","tv"===a?"shows":"movies"," you might enjoy"]})]}),o&&!i&&t.jsx("div",{className:"flex items-center gap-4",children:t.jsx(br,{filters:T,onFilterChange:F,isMobile:!1})})]}),t.jsxs("div",{className:"lg:hidden",children:[t.jsxs("h2",{className:"text-xl sm:text-2xl font-bold text-white mb-2 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Similar ","tv"===a?"Shows":"Movies"]}),t.jsxs("p",{className:"text-white/60 text-xs sm:text-sm mb-4",children:["Discover more ","tv"===a?"shows":"movies"," you might enjoy"]})]})]}),o&&i&&t.jsx(br,{filters:T,onFilterChange:F,isMobile:!0}),t.jsx(Q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},className:"text-center text-white/40",children:t.jsxs("div",{className:"bg-gradient-to-br from-white/5 to-white/2 rounded-2xl p-8 border border-white/10",children:[t.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-white/20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),t.jsx("h3",{className:"text-lg font-semibold text-white/60 mb-2",children:"No AI Recommendations Found"}),t.jsx("p",{className:"text-white/40 text-sm",children:"Our AI couldn't find any recommendations at the moment."})]})})]}):t.jsxs(Q.div,{className:""+u,variants:V,initial:V?"initial":void 0,animate:V?"animate":void 0,exit:V?"exit":void 0,transition:{duration:.5},children:[l&&t.jsxs(Q.div,{className:"mb-6",initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.5,delay:.2},children:[t.jsxs("div",{className:"hidden lg:flex items-center justify-between mb-2",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"text-xl sm:text-2xl font-bold text-white flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"AI Recommendations"]}),t.jsx("p",{className:"text-white/60 text-xs sm:text-sm mt-1",children:"AI-powered recommendations"})]}),o&&!i&&t.jsx("div",{className:"flex items-center gap-4",children:t.jsx(br,{filters:T,onFilterChange:F,isMobile:!1})})]}),t.jsxs("div",{className:"lg:hidden",children:[t.jsxs("h2",{className:"text-xl sm:text-2xl font-bold text-white mb-2 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"AI Recommendations"]}),t.jsx("p",{className:"text-white/60 text-xs sm:text-sm mb-4",children:"AI-powered recommendations"})]})]}),o&&i&&t.jsx(br,{filters:T,onFilterChange:F,isMobile:!0}),t.jsx(Q.div,{className:"grid gap-4 "+(i?"grid-cols-2 gap-3":"grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-8 3xl:grid-cols-10 gap-4"),variants:U,initial:"initial",animate:"animate",children:P.map(((e,s)=>t.jsx(gr,{motionProps:S?{}:{initial:"initial",animate:"animate",variants:Y,transition:{duration:.12}},className:"group cursor-pointer relative",style:{contain:"layout paint",willChange:"transform"},children:t.jsx(wr,{item:e,onClick:H,isMobile:i,showRelevanceScore:T.showRelevanceScore,disableAnimations:S})},e.id)))}),d&&v&&t.jsx(Q.div,{className:"mt-6 text-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},children:t.jsx("button",{onClick:$,disabled:p||k,className:"px-6 py-3 text-sm font-medium text-white/80 bg-white/10 rounded-full hover:bg-white/20 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:k?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Loading more..."]}):"Load More AI Recommendations"})})]})})),yr=s.memo(vr,((e,t)=>e.contentId===t.contentId&&e.contentType===t.contentType&&e.onItemClick===t.onItemClick&&e.isMobile===t.isMobile&&e.maxItems===t.maxItems&&e.showFilters===t.showFilters&&e.showTitle===t.showTitle&&e.showPagination===t.showPagination&&e.showLoadMore===t.showLoadMore&&e.className===t.className));vr.propTypes={contentId:le.oneOfType([le.string,le.number]).isRequired,contentType:le.oneOf(["movie","tv"]),onItemClick:le.func,isMobile:le.bool,maxItems:le.number,showFilters:le.bool,showTitle:le.bool,showPagination:le.bool,showLoadMore:le.bool,className:le.string},fr.propTypes={options:le.arrayOf(le.shape({value:le.any.isRequired,label:le.string.isRequired})).isRequired,value:le.any.isRequired,onChange:le.func.isRequired,placeholder:le.string,className:le.string},wr.propTypes={item:le.shape({id:le.oneOfType([le.string,le.number]).isRequired,title:le.string,name:le.string,poster_path:le.string,year:le.oneOfType([le.string,le.number]),release_date:le.string,first_air_date:le.string,similarityScore:le.number,vote_average:le.number}).isRequired,onClick:le.func,isMobile:le.bool,showRelevanceScore:le.bool,disableAnimations:le.bool};const jr=Object.freeze(Object.defineProperty({__proto__:null,default:yr},Symbol.toStringTag,{value:"Module"})),Nr=Object.freeze(Object.defineProperty({__proto__:null,default:({show:s,onClose:a,onDismiss:r,onDetection:i})=>{const[n,o]=e.useState(s),[l,c]=e.useState(!1),[d,u]=e.useState(null),h=e.useRef(!1);e.useEffect((()=>{if(window&&"ontouchstart"in window&&"number"==typeof window.navigator.maxTouchPoints&&0===window.navigator.maxTouchPoints||window.navigator.webdriver||/HeadlessChrome/.test(window.navigator.userAgent||"")||window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches)return o(!1),void u(null);!h.current&&s&&(h.current=!0,function({onDetection:e}){let t=!1;const s=document.createElement("div");s.className="pub_300x250 adsbox ad-banner ad_banner ad-placement doubleclick adunit sponsor",s.style.cssText="width: 1px; height: 1px; position: absolute; left: -9999px; pointer-events: none;",document.body.appendChild(s);const a=document.createElement("script");a.type="text/javascript",a.async=!0,a.onerror=()=>{t=!0,i(),e(!0)},a.onload=()=>{setTimeout((()=>{t||!s||null!==s.offsetParent&&0!==s.offsetHeight&&"none"!==getComputedStyle(s).display?t||(i(),e(!1)):(t=!0,i(),e(!0))}),50)},a.src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?fakeparam="+Math.random(),document.body.appendChild(a);const r=document.createElement("img");function i(){[s,a,r].forEach((e=>{e&&e.parentNode&&e.parentNode.removeChild(e)}))}r.src="https://ads.example.com/ad.jpg?"+Math.random(),r.style.display="none",r.onerror=()=>{t=!0,i(),e(!0)},document.body.appendChild(r)}({onDetection:e=>{u(e),"function"==typeof i&&i(e)}}))}),[s,i]),e.useEffect((()=>{if(s&&(!0===d||!1===d)){c(!0),o(!0);try{localStorage.setItem("adBlockerToastShown","true")}catch(e){}const t=setTimeout((()=>{m()}),7e3);return()=>clearTimeout(t)}s||m()}),[s,d]);const m=()=>{c(!1),setTimeout((()=>{o(!1),a&&a(),r&&r()}),300)};return n?t.jsxs("div",{style:{position:"fixed",top:32,right:28,zIndex:1e3,maxWidth:320,width:"100%",background:"#181818",color:"#fff",borderRadius:10,boxShadow:"0 2px 16px rgba(0,0,0,0.18)",padding:18,border:"1px solid #232323",fontFamily:"inherit",fontSize:14,display:"flex",flexDirection:"column",gap:12,transform:l?"translateX(0) scale(1)":"translateX(100%) scale(0.95)",opacity:l?1:0,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[t.jsx("svg",{width:22,height:22,fill:"none",stroke:"#fff",strokeWidth:2,style:{marginRight:10,background:"#232323",borderRadius:5,padding:2,minWidth:22,minHeight:22,display:"block"},viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),t.jsx("span",{style:{fontWeight:600,fontSize:15,color:"#fff"},children:"Ad-Free Streaming"}),t.jsx("button",{onClick:()=>{try{localStorage.setItem("adBlockerToastShown","true")}catch(e){}m()},style:{marginLeft:"auto",background:"none",border:"none",color:"#888",cursor:"pointer",fontSize:18,lineHeight:1,padding:0},"aria-label":"Dismiss",tabIndex:0,children:"×"})]}),t.jsxs("div",{style:{color:"#ccc",fontSize:13,lineHeight:1.5},children:["For a cleaner experience, consider installing ",t.jsx("span",{style:{color:"#fff",fontWeight:500},children:"uBlock Origin"}),"."]}),t.jsxs("div",{style:{display:"flex",gap:8},children:[t.jsxs("a",{href:"https://chromewebstore.google.com/detail/ublock-origin-lite/ddkjiahejlhfcafbddmgiahcphecmpfh",target:"_blank",rel:"noopener noreferrer",style:{flex:1,background:"#fff",color:"#181818",border:"none",borderRadius:100,padding:"7px 0",fontWeight:600,fontSize:13,textAlign:"center",textDecoration:"none",transition:"background 0.15s, color 0.15s",display:"flex",alignItems:"center",justifyContent:"center",gap:6},children:[t.jsx("svg",{width:14,height:14,fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"Lite"]}),t.jsx("a",{href:"https://chrome.google.com/webstore/detail/ublock-origin/cjpalhdlnbpafiamejdnhcphjbkeiagm",target:"_blank",rel:"noopener noreferrer",style:{flex:1,background:"#181818",color:"#fff",border:"1px solid #333",borderRadius:100,padding:"7px 0",fontWeight:600,fontSize:13,textAlign:"center",textDecoration:"none",transition:"background 0.15s, color 0.15s, border-color 0.15s"},children:"uBlock Origin"})]}),t.jsx("div",{style:{textAlign:"center",color:"#888",fontSize:11.5},children:t.jsx("a",{href:"https://github.com/gorhill/uBlock",target:"_blank",rel:"noopener noreferrer",style:{color:"#bbb",textDecoration:"underline",fontWeight:400,transition:"color 0.15s"},children:"Learn more"})})]}):null}},Symbol.toStringTag,{value:"Module"})),kr=e.memo((({enabled:a=!1})=>{const[r,i]=e.useState({fps:0,memory:0,renderCount:0,apiCalls:0,cacheHitRate:0}),[n,o]=e.useState(!1);e.useEffect((()=>{if(!a)return;let e,t=0,s=performance.now();const r=()=>{t++;const a=performance.now();s+1e3>a||(i((e=>({...e,fps:Math.round(1e3*t/(a-s))}))),t=0,s=a),e=requestAnimationFrame(r)};return e=requestAnimationFrame(r),()=>{e&&cancelAnimationFrame(e)}}),[a]),e.useEffect((()=>{if(!a||!performance.memory)return;const e=setInterval((()=>{const e=performance.memory.usedJSHeapSize/1048576;i((t=>({...t,memory:e.toFixed(2)})))}),2e3);return()=>clearInterval(e)}),[a]);const l=s.useRef(0);e.useEffect((()=>{a&&(l.current+=1,i((e=>({...e,renderCount:l.current}))))}),[a]);const c=e.useCallback((()=>{o((e=>!e))}),[]);return a?t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:c,className:"fixed bottom-4 right-4 z-50 bg-blue-600 hover:bg-blue-700 text-white p-2 rounded-full shadow-lg transition-all",title:"Toggle Performance Monitor",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),n&&t.jsxs("div",{className:"fixed bottom-20 right-4 z-50 bg-black/90 backdrop-blur-sm text-white p-4 rounded-lg shadow-xl font-mono text-sm min-w-[250px]",children:[t.jsxs("div",{className:"flex justify-between items-center mb-3 border-b border-white/20 pb-2",children:[t.jsx("h3",{className:"font-bold text-blue-400",children:"Performance"}),t.jsx("button",{onClick:c,className:"text-white/60 hover:text-white transition-colors",children:"✕"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Cr,{label:"FPS",value:r.fps,suffix:"",good:r.fps>=55,warning:r.fps>=30&&55>r.fps}),performance.memory&&t.jsx(Cr,{label:"Memory",value:r.memory,suffix:"MB",good:100>r.memory,warning:r.memory>=100&&200>r.memory}),t.jsx(Cr,{label:"Renders",value:r.renderCount,suffix:""})]}),t.jsx("div",{className:"mt-3 pt-3 border-t border-white/20",children:t.jsx("p",{className:"text-xs text-white/60",children:"Press Shift+P to toggle"})})]})]}):null})),Cr=e.memo((({label:e,value:s,suffix:a,good:r,warning:i})=>t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"text-white/70",children:[e,":"]}),t.jsxs("span",{className:"font-bold "+(r?"text-green-400":i?"text-yellow-400":"text-red-400"),children:[s,a]})]})));kr.displayName="PerformanceMonitor",Cr.displayName="MetricRow";const Sr=Object.freeze(Object.defineProperty({__proto__:null,default:kr},Symbol.toStringTag,{value:"Module"}));class _r extends e.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null,retryCount:0}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){const{onError:s}=this.props;this.setState({error:e,errorInfo:t}),s&&s(e,t),this.trackError(e,t)}trackError=(e,t)=>{try{e.message,e.stack,t.componentStack,(new Date).toISOString(),window.location.href,navigator.userAgent}catch(s){}};handleRetry=()=>{const{maxRetries:e=3}=this.props,{retryCount:t}=this.state;e>t&&this.setState({hasError:!1,error:null,errorInfo:null,retryCount:t+1})};handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null,retryCount:0})};render(){const{hasError:e,error:s,errorInfo:a,retryCount:r}=this.state,{children:i,fallback:n,showDetails:o=!1,maxRetries:l=3}=this.props;return e?n?"function"==typeof n?n({error:s,errorInfo:a,retry:this.handleRetry,reset:this.handleReset}):n:t.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 to-black flex items-center justify-center p-4",children:t.jsx("div",{className:"max-w-2xl w-full",children:t.jsxs("div",{className:"bg-gray-800/50 backdrop-blur-sm rounded-2xl shadow-2xl p-8 border border-gray-700",children:[t.jsx("div",{className:"flex justify-center mb-6",children:t.jsx("div",{className:"w-20 h-20 rounded-full bg-red-500/20 flex items-center justify-center",children:t.jsx("svg",{className:"w-12 h-12 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})})}),t.jsx("h1",{className:"text-3xl font-bold text-white text-center mb-4",children:"Oops! Something went wrong"}),t.jsx("p",{className:"text-gray-400 text-center mb-6",children:"We encountered an unexpected error. Don't worry, your data is safe."}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-6",children:[l>r&&t.jsxs("button",{onClick:this.handleRetry,className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200 flex items-center justify-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Try Again (",r+1,"/",l,")"]}),t.jsxs("button",{onClick:()=>window.location.href="/",className:"px-6 py-3 bg-gray-700 hover:bg-gray-600 text-white font-medium rounded-lg transition-colors duration-200 flex items-center justify-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),"Go Home"]})]}),r>=l&&t.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 mb-6",children:t.jsx("p",{className:"text-yellow-500 text-sm text-center",children:"Maximum retry attempts reached. Please refresh the page or contact support."})}),o&&s&&t.jsxs("details",{className:"mt-6",children:[t.jsx("summary",{className:"cursor-pointer text-gray-400 hover:text-white transition-colors mb-3 font-medium",children:"Technical Details"}),t.jsxs("div",{className:"bg-black/50 rounded-lg p-4 overflow-auto max-h-64",children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("h3",{className:"text-red-400 font-mono text-sm mb-2",children:"Error:"}),t.jsx("pre",{className:"text-gray-300 text-xs font-mono whitespace-pre-wrap",children:s.toString()})]}),s.stack&&t.jsxs("div",{className:"mb-4",children:[t.jsx("h3",{className:"text-red-400 font-mono text-sm mb-2",children:"Stack Trace:"}),t.jsx("pre",{className:"text-gray-300 text-xs font-mono whitespace-pre-wrap",children:s.stack})]}),a?.componentStack&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-red-400 font-mono text-sm mb-2",children:"Component Stack:"}),t.jsx("pre",{className:"text-gray-300 text-xs font-mono whitespace-pre-wrap",children:a.componentStack})]})]})]}),t.jsx("div",{className:"mt-6 pt-6 border-t border-gray-700",children:t.jsxs("p",{className:"text-gray-500 text-sm text-center",children:["If this problem persists, please"," ",t.jsx("a",{href:"mailto:support@streamr.com",className:"text-blue-400 hover:text-blue-300 underline",children:"contact support"})]})})]})})}):i}}_r.propTypes={children:le.node.isRequired,fallback:le.oneOfType([le.node,le.func]),onError:le.func,showDetails:le.bool,maxRetries:le.number};const Lr=Object.freeze(Object.defineProperty({__proto__:null,default:_r},Symbol.toStringTag,{value:"Module"})),Tr=Object.freeze(Object.defineProperty({__proto__:null,default:({collection:s,onClose:a,onMovieSelect:r})=>{const[i,n]=e.useState(null),[o,l]=e.useState(!0),[c,d]=e.useState(null),[u,h]=e.useState(null),[m,p]=e.useState(null),{addToWatchlist:x,removeFromWatchlist:g,isInWatchlist:f}=jt(),w=e.useRef(null),b=e.useRef(null),v="collection-details-"+(s?.id||"default"),{container:y,createPortal:j,isReady:N}=re(v,{...rr,...or(0,{onClose:a})});e.useEffect((()=>{let e=!1;return(async()=>{if(!s?.id)return n(null),l(!1),void d(null);l(!0),d(null);try{const t=await Xe(s.id);e||n(t||null)}catch(t){e||d(t?.message||t+"")}finally{e||l(!1)}})(),()=>{e=!0}}),[s?.id]);const k=e.useCallback((async e=>{if(e&&e.id&&!m){p(e.id),h(e);try{if(r){const t=r(e);t&&"function"==typeof t.then&&await t}}catch(t){}finally{p(null)}}}),[r]);e.useCallback((e=>{f(e.id)?g(e.id):x(e)}),[x,g,f]);const C=e.useCallback((e=>{e.target===e.currentTarget&&a()}),[a]),S=e.useCallback((e=>{"Escape"===e.key&&a()}),[a]);e.useEffect((()=>(document.addEventListener("keydown",S),b.current=document.body.style.overflow,document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",S),document.body.style.overflow=b.current||""})),[S]);const _=e.useMemo((()=>Array.isArray(i?.parts)?i.parts:[]),[i]),L=e.useMemo((()=>i?.backdrop_path?$t({backdrop_path:i.backdrop_path},"w1280").src:null),[i?.backdrop_path]);return e.useMemo((()=>"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent("<?xml version='1.0' encoding='UTF-8'?><svg xmlns='http://www.w3.org/2000/svg' width='500' height='750' viewBox='0 0 500 750'><rect width='500' height='750' fill='#0b0b0b'/><text x='50%' y='55%' fill='#444' font-family='Arial' font-size='22' text-anchor='middle'>No Image</text></svg>")),[]),e.useMemo((()=>{try{const e=(i?.parts||[]).map((e=>e.release_date)).filter(Boolean).map((e=>new Date(e).getFullYear())).filter(Boolean).sort(((e,t)=>e-t));if(0===e.length)return null;const t=e[0],s=e[e.length-1];return t===s?t+"":`${t}–${s}`}catch(e){return null}}),[i]),s&&"undefined"!=typeof window&&N&&y?(e.useEffect((()=>{if(N&&w.current){const e=setTimeout((()=>w.current?.focus()),50);return()=>clearTimeout(e)}}),[N]),j(t.jsx(Z,{children:t.jsx(Q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 flex items-center justify-center bg-black/95",onClick:C,style:{zIndex:1,pointerEvents:"auto"},children:t.jsxs(Q.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{duration:.3,ease:"easeOut"},className:"relative w-full max-w-6xl h-auto max-h-[calc(100vh-1rem)] sm:max-h-[95vh] mx-4 bg-black/90 rounded-2xl shadow-2xl flex flex-col border border-white/10 overflow-y-auto",style:{zIndex:2,pointerEvents:"auto"},children:[t.jsxs("div",{className:"relative",children:[L&&t.jsxs("div",{className:"relative h-96 md:h-[30rem] lg:h-[36rem] overflow-hidden",children:[t.jsx("img",{src:L,alt:i?.name||s.name,className:"w-full h-full object-cover"}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-black/50 to-transparent"})]}),t.jsx("button",{ref:w,onClick:a,"aria-label":`Close ${i?.name||s.name} details`,className:"absolute top-4 right-4 p-2 bg-black/80 hover:bg-white/10 rounded-full transition-colors border border-white/20 focus:outline-none focus:ring-2 focus:ring-blue-400",style:{zIndex:10},children:t.jsx(X,{className:"w-6 h-6 text-white"})}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-black/80 via-black/40 to-transparent rounded-b-2xl",children:t.jsx("div",{className:"flex flex-col md:flex-row md:items-end md:justify-between gap-4",children:t.jsxs("div",{children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-2",children:[t.jsxs("h1",{className:"text-3xl md:text-4xl font-extrabold text-white flex items-center gap-3",children:[t.jsxs("span",{className:"flex items-center gap-2",children:[i?.name||s.name,i?.original_name&&i.original_name!==i?.name&&t.jsxs("span",{className:"text-white/60 text-lg font-normal italic ml-1",children:["(",i.original_name,")"]})]}),i?.parts?.length>1&&t.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded bg-blue-600/80 text-xs font-semibold text-white ml-2",children:[t.jsxs("svg",{className:"w-4 h-4 mr-1 text-white/80",fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",children:[t.jsx("rect",{x:"3",y:"7",width:"18",height:"10",rx:"2",fill:"currentColor",className:"text-blue-500"}),t.jsx("path",{d:"M7 7V5a2 2 0 012-2h6a2 2 0 012 2v2",stroke:"currentColor",strokeWidth:2})]}),"Series"]}),i?.homepage&&t.jsxs("a",{href:i.homepage,target:"_blank",rel:"noopener noreferrer",className:"ml-2 inline-flex items-center px-2 py-0.5 rounded bg-white/10 hover:bg-white/20 text-xs font-semibold text-blue-200 transition",title:"Official Homepage",children:[t.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 5v14m7-7H5"})}),"Website"]})]}),i?.tagline&&t.jsxs("span",{className:"block text-blue-200 text-base font-medium italic mt-1 sm:mt-0 sm:ml-4 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-blue-300 opacity-80",fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24","aria-hidden":"true",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 17a4 4 0 01-4-4V7a4 4 0 014-4h2a4 4 0 014 4v6a4 4 0 01-4 4H7zm10 0a4 4 0 01-4-4V7a4 4 0 014-4h2a4 4 0 014 4v6a4 4 0 01-4 4h-2z"})}),t.jsxs("span",{children:[t.jsx("span",{className:"sr-only",children:"Tagline:"}),"“",i.tagline,"”"]})]})]}),i?.overview&&t.jsxs("div",{className:"mb-2 max-w-3xl",children:[t.jsxs("p",{className:"text-white/60 text-md leading-relaxed line-clamp-4 relative group transition-all duration-200",children:[i.overview,i.overview.length>320&&t.jsx("span",{className:"absolute right-0 bottom-0 bg-gradient-to-l from-black/80 via-black/10 to-transparent pl-6 pr-2 py-1 text-blue-200 text-sm font-semibold cursor-pointer group-hover:underline transition",children:"...more"})]}),i?.trivia&&t.jsxs("div",{className:"mt-2 bg-blue-900/30 rounded px-3 py-2 flex items-start gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-blue-300 mt-0.5",fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 16h-1v-4h-1m1-4h.01M12 20a8 8 0 100-16 8 8 0 000 16z"})}),t.jsxs("span",{className:"text-blue-200 text-base",children:[t.jsx("span",{className:"font-semibold",children:"Trivia:"})," ",i.trivia]})]})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-4 mt-2",children:[t.jsxs("span",{className:"text-white/70 flex items-center gap-1",children:[t.jsx("svg",{className:"w-4 h-4 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),_.length," ",1===_.length?"movie":"movies"]}),i?.release_date&&t.jsxs("span",{className:"text-white/60 flex items-center gap-1",children:[t.jsx("svg",{className:"w-4 h-4 text-blue-300",fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),new Date(i.release_date).getFullYear()]}),i?.parts?.length>0&&t.jsxs("span",{className:"text-white/60 flex items-center gap-1",children:[t.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 7h18M3 12h18M3 17h18"})}),i.parts.map((e=>e.release_date)).filter(Boolean).length>1?`${i.parts.map((e=>e.release_date)).filter(Boolean).map((e=>new Date(e).getFullYear())).sort(((e,t)=>e-t)).slice(0,1)}–${i.parts.map((e=>e.release_date)).filter(Boolean).map((e=>new Date(e).getFullYear())).sort(((e,t)=>e-t)).slice(-1)}`:""]})]})]})})})]}),t.jsx("div",{className:"flex-1 p-6 min-h-[70vh]",children:o?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("div",{className:"w-8 h-8 border-2 border-gray-600 border-t-white rounded-full animate-spin"})}):c?t.jsxs("div",{className:"text-center py-12",children:[t.jsx("p",{className:"text-red-400 mb-4",children:"Error loading collection details"}),t.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"Retry"})]}):t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"Movies in Collection"}),t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 2xl:grid-cols-4 gap-4",children:_.map(((e,s)=>t.jsx(Q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.05*s},className:"group relative cursor-pointer",onClick:()=>k(e),children:t.jsxs("div",{className:"relative aspect-[2/3] rounded-lg overflow-hidden bg-black shadow-lg transition-all duration-300 group-hover:shadow-xl group-hover:scale-105 border border-white/10",children:[t.jsx("img",{src:Bt(e,"w500").src,alt:e.title,className:"w-full h-full object-cover",onError:t=>{t.target.src="data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(`\n                              <svg width="500" height="750" viewBox="0 0 500 750" fill="none" xmlns="http://www.w3.org/2000/svg">\n                                <rect width="500" height="750" fill="#1a1a1a"/>\n                                <path d="M250 300C277.614 300 300 277.614 300 250C300 222.386 277.614 200 250 200C222.386 200 200 222.386 200 250C200 277.614 222.386 300 250 300Z" fill="#333333"/>\n                                <path d="M350 450C350 483.137 323.137 510 290 510H210C176.863 510 150 483.137 150 450V350C150 316.863 176.863 290 210 290H290C323.137 290 350 316.863 350 350V450Z" fill="#333333"/>\n                                <path d="M250 400C250 400 230 370 210 370C190 370 170 400 170 400" stroke="#666666" stroke-width="4" stroke-linecap="round"/>\n                                <text x="250" y="550" font-family="Arial" font-size="24" fill="#666666" text-anchor="middle">No Image Available</text>\n                                <text x="250" y="580" font-family="Arial" font-size="16" fill="#666666" text-anchor="middle">${e.title}</text>\n                              </svg>\n                            `)}}),m===e.id&&t.jsx(Qt,{visible:!0}),t.jsx(Q.div,{initial:{opacity:0},whileHover:{opacity:1},transition:{duration:.1},className:"absolute inset-0 bg-gradient-to-t from-black via-black/60 to-transparent flex items-end p-3",children:t.jsxs(Q.div,{className:"text-white",children:[t.jsx("h4",{className:"font-medium text-sm truncate",children:e.title}),t.jsxs("p",{className:"text-xs text-white/70 flex items-center gap-1",children:[e.release_date?.split("-")[0]||e.year||"N/A"," •",t.jsxs("span",{className:"flex items-center",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 text-yellow-400 mr-1",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})}),e.vote_average?.toFixed(1)||e.rating||"N/A"]})]})]})})]})},e.id)))}),0===_.length&&t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-white/60",children:"No movies found in this collection"})})]})})]})})}))):null}},Symbol.toStringTag,{value:"Module"})),Mr=[{value:"episode_number",label:"Episode Number",icon:"#️⃣"},{value:"air_date",label:"Air Date",icon:"📅"},{value:"vote_average",label:"Rating",icon:"⭐"},{value:"runtime",label:"Runtime",icon:"⏱️"},{value:"name",label:"Title",icon:"📝"}],Er="SET_LOADING",Ir="SET_ERROR",Dr="SET_SEASONS",Rr="SET_CURRENT_SEASON",zr="SET_FILTERED_EPISODES",Wr="SET_SEARCH_TERM",Ar="SET_SORT",Or="SET_STATS",Pr="TOGGLE_SHOW_ALL",Fr="INCREMENT_RETRY",Br="SET_VIEW_MODE",$r="SET_FILTERS",Hr="BATCH_UPDATE",Vr={episodes:[],seasons:[],currentSeason:null,loading:!0,loadingEpisodes:!1,error:null,searchTerm:"",filteredEpisodes:[],showAllEpisodes:!1,seasonStats:null,sortBy:"episode_number",sortOrder:"asc",episodeCache:new Map,retryCount:0,viewMode:"grid",filters:{minRating:0,hasOverview:!1,hasGuestStars:!1,runtimeMin:0,runtimeMax:1/0}},Ur=(e,t)=>{switch(t.type){case Er:return{...e,loading:t.payload};case Ir:return{...e,error:t.payload,loading:!1};case"SET_EPISODES":return{...e,episodes:t.payload,filteredEpisodes:t.payload,loading:!1,loadingEpisodes:!1};case Dr:return{...e,seasons:t.payload};case Rr:return{...e,currentSeason:t.payload};case zr:return{...e,filteredEpisodes:t.payload};case Wr:return{...e,searchTerm:t.payload};case Ar:return{...e,sortBy:t.payload.sortBy,sortOrder:t.payload.sortOrder};case Or:return{...e,seasonStats:t.payload};case Pr:return{...e,showAllEpisodes:!e.showAllEpisodes};case Fr:return{...e,retryCount:e.retryCount+1};case"RESET_RETRY":return{...e,retryCount:0};case"UPDATE_CACHE":return{...e,episodeCache:t.payload};case"CLEAR_CACHE":return{...e,episodeCache:new Map};case Br:return{...e,viewMode:t.payload};case $r:return{...e,filters:{...e.filters,...t.payload}};case Hr:return{...e,...t.payload};default:return e}},Yr={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.03,delayChildren:.05,when:"beforeChildren"}},exit:{opacity:0,transition:{staggerChildren:.02,staggerDirection:-1}}},qr={hidden:{opacity:0,y:20,scale:.95,filter:"blur(4px)"},visible:{opacity:1,y:0,scale:1,filter:"blur(0px)",transition:{type:"spring",stiffness:350,damping:25,mass:.5}},hover:{y:-5,scale:1.02,boxShadow:"0 10px 30px rgba(0, 0, 0, 0.3)",transition:{type:"spring",stiffness:400,damping:20}},tap:{scale:.98},exit:{opacity:0,scale:.9,filter:"blur(4px)",transition:{duration:.2}}},Gr=({tvId:s,seasonNumber:a=null,onEpisodeSelect:r=null,onSeasonChange:i=null,initialSeason:n=null,showSearch:o=!0,showStats:l=!0,maxEpisodesPerPage:c=20,className:d="",enableVirtualScroll:u=!0,enablePrefetch:h=!0,enableAdvancedFilters:m=!1})=>{const[p,x]=e.useReducer(Ur,Vr),[g,f]=e.useTransition(),w=(t=>{const[s,a]=e.useState(t);return e.useEffect((()=>{const e=setTimeout((()=>{a(t)}),300);return()=>clearTimeout(e)}),[t,300]),s})(p.searchTerm),b=e.useDeferredValue(p.filteredEpisodes),v=((t=50)=>{const s=e.useRef(new Map),a=e.useCallback(((e,a)=>{const r=s.current;if(r.size>=t){const e=r.keys().next().value;r.delete(e)}r.set(e,{data:a,timestamp:Date.now()})}),[t]);return{get:e.useCallback(((e,t=3e5)=>{const a=s.current,r=a.get(e);return r?Date.now()-r.timestamp>t?(a.delete(e),null):(a.delete(e),a.set(e,r),r.data):null}),[]),set:a,clear:e.useCallback((()=>{s.current.clear()}),[]),has:e.useCallback((e=>s.current.has(e)),[]),cache:s.current}})(),y=e.useRef(null),j=e.useRef(null),N=e.useRef(null),k=e.useRef(null),C=se(),S=e.useRef(null),{ref:_,inView:L}=K({threshold:.1,triggerOnce:!1,rootMargin:"100px"}),T=e.useCallback(((e,t,s)=>e.filter((e=>{if(s){const t=s.toLowerCase();if(!(e.name?.toLowerCase().includes(t)||e.overview?.toLowerCase().includes(t)||e.episode_number?.toString().includes(s)))return!1}if(t.minRating>0&&(e.vote_average||0)<t.minRating)return!1;if(t.hasOverview&&!e.overview)return!1;if(t.hasGuestStars&&(!e.guest_stars||0===e.guest_stars.length))return!1;const a=e.runtime||0;return a>=t.runtimeMin&&a<=t.runtimeMax}))),[]),M=e.useCallback(((e,t,s)=>[...e].sort(((e,a)=>{let r,i;switch(t){case"episode_number":r=e.episode_number||0,i=a.episode_number||0;break;case"air_date":r=new Date(e.air_date||0).getTime(),i=new Date(a.air_date||0).getTime();break;case"vote_average":r=e.vote_average||0,i=a.vote_average||0;break;case"runtime":r=e.runtime||0,i=a.runtime||0;break;case"name":return r=e.name||"",i=a.name||"","asc"===s?r.localeCompare(i):i.localeCompare(r);default:r=e[t]||0,i=a[t]||0}return"asc"===s?r-i:i-r}))),[]),E=e.useCallback((async e=>{if(!h||!p.seasons.length)return;const t=p.seasons.findIndex((t=>t.season_number===e));if(-1===t)return;const a=[p.seasons[t-1],p.seasons[t+1]].filter(Boolean);k.current=setTimeout((()=>{a.forEach((async e=>{const t=`episodes_${s}_${e.season_number}`;if(!v.has(t))try{const a=await Ke.getSeason(s,e.season_number);v.set(t,a.episodes||[])}catch(a){}}))}),2e3)}),[h,p.seasons,s,v]),I=e.useCallback((async(e,t=0)=>{if(s&&null!=e){x({type:Hr,payload:{loadingEpisodes:!0,error:null,showAllEpisodes:!1}});try{const t=`episodes_${s}_${e}`,r=v.get(t);if(r){const t=T(r,p.filters,""),a=M(t,p.sortBy,p.sortOrder);return x({type:Hr,payload:{episodes:r,filteredEpisodes:a,loadingEpisodes:!1}}),l&&Ke.getSeasonStats(s,e).then((e=>x({type:Or,payload:e}))).catch((e=>{})),void E(e)}j.current&&j.current.abort(),j.current=new AbortController;const i=(await Ke.getSeason(s,e,{signal:j.current.signal})).episodes||[];v.set(t,i);const n=T(i,p.filters,""),o=M(n,p.sortBy,p.sortOrder);if(x({type:Hr,payload:{episodes:i,filteredEpisodes:o,loadingEpisodes:!1,retryCount:0}}),l)try{const t=await Ke.getSeasonStats(s,e);x({type:Or,payload:t})}catch(a){}E(e)}catch(r){if("AbortError"===r.name)return;3>t?setTimeout((()=>{x({type:Fr}),I(e,t+1)}),1e3*Math.pow(2,t)):x({type:Ir,payload:"Failed to load episodes. Please try again."})}}}),[s,l,v,T,M,p.filters,p.sortBy,p.sortOrder,E]);e.useEffect((()=>{if(s)return(async()=>{x({type:Er,payload:!0});try{const e=await Ke.getAllSeasons(s);x({type:Dr,payload:e});let t=n;!t&&e.length>0&&(t=e.find((e=>!e.is_special&&e.season_number>0))||e[e.length-1]),t&&(x({type:Rr,payload:t}),await I(t.season_number)),x({type:Er,payload:!1})}catch(e){x({type:Ir,payload:"Failed to load episodes"})}})(),()=>{j.current&&j.current.abort(),k.current&&clearTimeout(k.current)}}),[s,n,I]),e.useEffect((()=>{p.episodes.length&&f((()=>{const e=T(p.episodes,p.filters,w),t=M(e,p.sortBy,p.sortOrder);x({type:zr,payload:t})}))}),[w,p.episodes,p.filters,p.sortBy,p.sortOrder,T,M]),e.useEffect((()=>{const e=e=>{if("/"===e.key&&o&&!e.target.matches("input, textarea")&&(e.preventDefault(),y.current?.focus()),"Escape"===e.key&&p.searchTerm&&(e.preventDefault(),x({type:Wr,payload:""}),y.current?.blur()),!e.target.matches("input, textarea, select")){if("ArrowLeft"===e.key&&p.currentSeason){e.preventDefault();const t=p.seasons.findIndex((e=>e.season_number===p.currentSeason.season_number));t>0&&S.current?.(p.seasons[t-1])}if("ArrowRight"===e.key&&p.currentSeason){e.preventDefault();const t=p.seasons.findIndex((e=>e.season_number===p.currentSeason.season_number));t<p.seasons.length-1&&S.current?.(p.seasons[t+1])}}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[p.searchTerm,p.currentSeason,p.seasons,o]),e.useEffect((()=>{L&&!p.showAllEpisodes&&b.length>c&&x({type:Pr})}),[L,p.showAllEpisodes,b.length,c]);const D=e.useCallback((async e=>{x({type:Hr,payload:{currentSeason:e,searchTerm:"",showAllEpisodes:!1}}),await C.start({opacity:0,y:20}),await I(e.season_number),await C.start({opacity:1,y:0}),i?.(e)}),[I,i,C]);e.useEffect((()=>{S.current=D}),[D]);const R=e.useCallback((e=>{r?.(e,p.currentSeason)}),[r,p.currentSeason]),z=e.useCallback((e=>{x({type:Wr,payload:e})}),[]),W=e.useCallback(((e,t=p.sortOrder)=>{x({type:Ar,payload:{sortBy:e,sortOrder:t}}),f((()=>{const s=M(p.filteredEpisodes,e,t);x({type:zr,payload:s})}))}),[p.sortOrder,p.filteredEpisodes,M]),A=e.useCallback((e=>{x({type:$r,payload:e})}),[]),O=e.useCallback((e=>{x({type:Br,payload:e})}),[]),P=e.useCallback((()=>{3>p.retryCount&&p.currentSeason&&(x({type:Fr}),I(p.currentSeason.season_number))}),[p.retryCount,p.currentSeason,I]),F=e.useMemo((()=>b.length?p.showAllEpisodes?b:b.slice(0,c):[]),[b,p.showAllEpisodes,c]),B=e.useMemo((()=>b.length>c),[b.length,c]),$=e.useMemo((()=>p.filteredEpisodes.length?{total:p.filteredEpisodes.length,avgRating:p.filteredEpisodes.reduce(((e,t)=>e+(t.vote_average||0)),0)/p.filteredEpisodes.length,totalRuntime:p.filteredEpisodes.reduce(((e,t)=>e+(t.runtime||0)),0),withOverview:p.filteredEpisodes.filter((e=>e.overview)).length,withGuestStars:p.filteredEpisodes.filter((e=>e.guest_stars?.length>0)).length}:null),[p.filteredEpisodes]),H=e.memo((({episode:e,index:s,viewMode:a,onEpisodeClick:r,currentSeasonNumber:i})=>{const n="compact"===a?"flex items-center gap-2 p-2":"flex gap-3 p-3";return t.jsxs(Q.div,{variants:qr,initial:"hidden",animate:"visible",whileHover:"hover",whileTap:"tap",exit:"exit",layout:!0,className:"bg-gray-800 rounded-lg overflow-hidden cursor-pointer group relative",onClick:()=>r?.(e),role:"button",tabIndex:0,"aria-label":`Episode ${e.episode_number}: ${e.name}`,onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),r?.(e))},children:[e.vote_average>=8&&t.jsx("div",{className:"absolute top-2 right-2 bg-yellow-500 text-black text-xs font-bold px-2 py-1 rounded-full z-10",children:"⭐ Top Rated"}),t.jsxs("div",{className:n,children:[t.jsxs("div",{className:"flex-shrink-0 relative "+("compact"===a?"w-20 h-12":"w-32 h-20"),children:[e.still_path?t.jsx("img",{src:e.still_path,alt:e.name,className:"w-full h-full object-cover rounded",loading:"lazy",decoding:"async"}):t.jsx("div",{className:"w-full h-full bg-gray-700 flex items-center justify-center rounded",children:t.jsx("span",{className:"text-gray-400 text-xs",children:"📺"})}),t.jsxs("div",{className:"absolute top-1 left-1 bg-black/80 text-white text-xs px-1.5 py-0.5 rounded backdrop-blur-sm",children:["E",e.episode_number]}),e.watch_progress>0&&t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gray-600",children:t.jsx("div",{className:"h-full bg-blue-500 transition-all",style:{width:e.watch_progress+"%"}})})]}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-start justify-between mb-1",children:[t.jsx("h4",{className:"font-medium text-sm text-white group-hover:text-blue-400 transition-colors truncate pr-2",children:e.name}),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400 flex-shrink-0",children:[e.formatted_runtime&&t.jsxs("span",{className:"flex items-center gap-1",children:["⏱️ ",e.formatted_runtime]}),e.vote_average>0&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),t.jsx("span",{children:e.vote_average.toFixed(1)})]})]})]}),"compact"!==a&&e.overview&&t.jsx("p",{className:"text-xs text-gray-300 line-clamp-2 mb-2",children:e.overview}),t.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[t.jsx("span",{children:e.formatted_air_date||e.air_date}),e.guest_stars?.length>0&&t.jsxs("span",{className:"text-blue-400 flex items-center gap-1",children:["👥 ",e.guest_stars.length," guest",1!==e.guest_stars.length?"s":""]})]})]})]}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none",children:t.jsx("div",{className:"absolute bottom-2 right-2 flex gap-2 pointer-events-auto",children:t.jsx("button",{className:"bg-blue-600 hover:bg-blue-700 text-white p-1.5 rounded-full transition-colors",onClick:t=>{t.stopPropagation(),r?.(e)},"aria-label":"Play episode",children:"▶️"})})})]})}),((e,t)=>e.episode.id===t.episode.id&&e.viewMode===t.viewMode&&e.episode.watch_progress===t.episode.watch_progress&&e.currentSeasonNumber===t.currentSeasonNumber&&e.onEpisodeClick===t.onEpisodeClick)),V=e.memo((()=>t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:"📺 Seasons"}),p.currentSeason&&t.jsxs("span",{className:"text-sm text-gray-400",children:[p.currentSeason.episode_count," episodes"]})]}),t.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-thin scrollbar-thumb-gray-600 scrollbar-track-gray-800",role:"tablist","aria-label":"Season selection",children:t.jsx(Z,{mode:"popLayout",children:p.seasons.map(((e,s)=>t.jsxs(Q.button,{onClick:()=>D(e),role:"tab","aria-selected":p.currentSeason?.season_number===e.season_number,"aria-label":`${e.name}, ${e.episode_count} episodes`,initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{delay:.02*s},whileHover:{scale:1.05},whileTap:{scale:.95},className:"flex-shrink-0 px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 relative "+(p.currentSeason?.season_number===e.season_number?"bg-gradient-to-r from-blue-600 to-blue-500 text-white shadow-lg shadow-blue-500/50":"bg-gray-700 text-gray-300 hover:bg-gray-600 hover:text-white"),children:[e.name,e.is_latest&&t.jsx("span",{className:"ml-1 text-xs text-yellow-400 animate-pulse","aria-label":"Latest season",children:"✨"}),p.currentSeason?.season_number===e.season_number&&t.jsx(Q.div,{layoutId:"activeSeasonIndicator",className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white",transition:{type:"spring",stiffness:500,damping:30}})]},e.season_number)))})})]}))),U=e.memo((()=>t.jsxs("div",{className:"mb-6 space-y-4",children:[o&&t.jsxs("div",{className:"relative group",children:[t.jsx("div",{className:"absolute inset-y-0 left-3 flex items-center pointer-events-none",children:t.jsx("span",{className:"text-gray-400 text-lg",children:"🔍"})}),t.jsx("input",{ref:y,type:"text",placeholder:"Search episodes... (Press / to focus)",value:p.searchTerm,onChange:e=>z(e.target.value),"aria-label":"Search episodes",className:"w-full pl-10 pr-10 py-3 bg-gray-800 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-all"}),p.searchTerm&&t.jsx("button",{onClick:()=>z(""),"aria-label":"Clear search",className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white transition-colors p-1 hover:bg-gray-700 rounded",children:"✕"}),g&&t.jsx("div",{className:"absolute right-10 top-1/2 transform -translate-y-1/2",children:t.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-blue-500 border-t-transparent rounded-full"})})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2 bg-gray-800 rounded-lg px-3 py-2 border border-gray-600",children:[t.jsx("span",{className:"text-xs text-gray-400",children:"Sort:"}),t.jsx("select",{value:p.sortBy,onChange:e=>W(e.target.value,p.sortOrder),"aria-label":"Sort episodes by",className:"bg-transparent text-sm text-white focus:outline-none cursor-pointer",children:Mr.map((e=>t.jsxs("option",{value:e.value,children:[e.icon," ",e.label]},e.value)))}),t.jsx("button",{onClick:()=>W(p.sortBy,"asc"===p.sortOrder?"desc":"asc"),"aria-label":"Sort "+("asc"===p.sortOrder?"descending":"ascending"),className:"px-2 py-1 hover:bg-gray-700 rounded text-sm text-white transition-colors",children:"asc"===p.sortOrder?"↑":"↓"})]}),t.jsx("div",{className:"flex items-center gap-1 bg-gray-800 rounded-lg p-1 border border-gray-600",children:["list","grid","compact"].map((e=>t.jsxs("button",{onClick:()=>O(e),"aria-label":e+" view",className:"px-3 py-1 rounded text-xs font-medium transition-all "+(p.viewMode===e?"bg-blue-600 text-white":"text-gray-400 hover:text-white hover:bg-gray-700"),children:["list"===e&&"☰","grid"===e&&"⊞","compact"===e&&"▤"]},e)))}),t.jsxs("div",{className:"ml-auto text-sm text-gray-400",children:[p.filteredEpisodes.length," episode",1!==p.filteredEpisodes.length?"s":"",p.searchTerm&&" found"]})]}),m&&t.jsxs(Q.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"bg-gray-800 rounded-lg p-4 border border-gray-600 space-y-3",children:[t.jsx("h4",{className:"text-sm font-medium text-white mb-2",children:"Filters"}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Min Rating"}),t.jsx("input",{type:"range",min:"0",max:"10",step:"0.5",value:p.filters.minRating,onChange:e=>A({minRating:parseFloat(e.target.value)}),className:"w-full"}),t.jsx("span",{className:"text-xs text-white",children:p.filters.minRating})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-300 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:p.filters.hasOverview,onChange:e=>A({hasOverview:e.target.checked}),className:"rounded"}),"Has Description"]}),t.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-300 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:p.filters.hasGuestStars,onChange:e=>A({hasGuestStars:e.target.checked}),className:"rounded"}),"Has Guest Stars"]})]})]})]})]}))),Y=e.memo((()=>{if(!l||!p.seasonStats)return null;const e=p.seasonStats;return t.jsxs(Q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"mb-6 p-4 bg-gradient-to-br from-gray-800 to-gray-900 rounded-lg border border-gray-700 shadow-xl",role:"region","aria-label":"Season statistics",children:[t.jsx("h4",{className:"text-sm font-medium text-white mb-4 flex items-center gap-2",children:"📊 Season Statistics"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs(Q.div,{className:"text-center",whileHover:{scale:1.05},transition:{type:"spring",stiffness:300},children:[t.jsx("div",{className:"text-gray-400 text-xs mb-1",children:"Total Episodes"}),t.jsx("div",{className:"text-white font-bold text-2xl",children:e.total_episodes})]}),t.jsxs(Q.div,{className:"text-center",whileHover:{scale:1.05},transition:{type:"spring",stiffness:300},children:[t.jsx("div",{className:"text-gray-400 text-xs mb-1",children:"Average Rating"}),t.jsxs("div",{className:"text-yellow-400 font-bold text-2xl flex items-center justify-center gap-1",children:["⭐ ",e.average_rating>0?e.average_rating.toFixed(1):"N/A"]})]}),t.jsxs(Q.div,{className:"text-center",whileHover:{scale:1.05},transition:{type:"spring",stiffness:300},children:[t.jsx("div",{className:"text-gray-400 text-xs mb-1",children:"Total Runtime"}),t.jsxs("div",{className:"text-white font-bold text-xl",children:[Math.floor(e.total_runtime/60),"h ",e.total_runtime%60,"m"]})]}),t.jsxs(Q.div,{className:"text-center",whileHover:{scale:1.05},transition:{type:"spring",stiffness:300},children:[t.jsx("div",{className:"text-gray-400 text-xs mb-1",children:"Avg Runtime"}),t.jsxs("div",{className:"text-white font-bold text-xl",children:[Math.floor(e.average_runtime),"m"]})]})]}),$&&t.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-700 grid grid-cols-2 gap-2 text-xs",children:[t.jsxs("div",{className:"text-gray-400",children:["With Overview: ",t.jsx("span",{className:"text-white font-medium",children:$.withOverview})]}),t.jsxs("div",{className:"text-gray-400",children:["With Guests: ",t.jsx("span",{className:"text-white font-medium",children:$.withGuestStars})]})]})]})})),q=()=>t.jsx("div",{className:"flex justify-center items-center py-8",children:t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-500 border-t-transparent"}),t.jsx("div",{className:"absolute inset-0 animate-ping rounded-full h-12 w-12 border-4 border-blue-500 opacity-20"})]})}),G=()=>t.jsx("div",{className:"space-y-3",children:[...[,,,,,]].map(((e,s)=>t.jsx(Q.div,{className:"bg-gray-800 rounded-lg overflow-hidden",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*s},children:t.jsxs("div",{className:"flex gap-3 p-3",children:[t.jsx("div",{className:"w-32 h-20 bg-gray-700 flex-shrink-0 rounded animate-pulse"}),t.jsxs("div",{className:"flex-1 space-y-2",children:[t.jsx("div",{className:"h-4 bg-gray-700 rounded w-3/4 animate-pulse"}),t.jsx("div",{className:"h-3 bg-gray-700 rounded w-full animate-pulse"}),t.jsx("div",{className:"h-3 bg-gray-700 rounded w-5/6 animate-pulse"}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("div",{className:"h-3 bg-gray-700 rounded w-20 animate-pulse"}),t.jsx("div",{className:"h-3 bg-gray-700 rounded w-16 animate-pulse"})]})]})]})},s)))}),J=()=>t.jsxs(Q.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center py-12 px-4",role:"alert","aria-live":"polite",children:[t.jsx(Q.div,{className:"text-red-400 mb-4 text-6xl",animate:{rotate:[0,-10,10,-10,0]},transition:{duration:.5},children:"⚠️"}),t.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"Oops! Something went wrong"}),t.jsx("p",{className:"text-gray-400 mb-1",children:p.error}),p.retryCount>0&&3>p.retryCount&&t.jsxs("p",{className:"text-gray-500 text-sm mb-4",children:["Retry attempt ",p.retryCount," of ",3]}),t.jsx(Q.button,{onClick:P,disabled:p.retryCount>=3,whileHover:{scale:3>p.retryCount?1.05:1},whileTap:{scale:3>p.retryCount?.95:1},className:"mt-4 px-6 py-3 rounded-lg font-medium transition-all "+(3>p.retryCount?"bg-gradient-to-r from-blue-600 to-blue-500 text-white hover:shadow-lg hover:shadow-blue-500/50":"bg-gray-600 text-gray-400 cursor-not-allowed"),children:3>p.retryCount?"🔄 Retry":"❌ Max retries reached"})]}),X=()=>t.jsxs(Q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-12 px-4",role:"status","aria-live":"polite",children:[t.jsx(Q.div,{className:"text-gray-400 mb-4 text-6xl",animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},children:p.searchTerm?"🔍":"📺"}),t.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:p.searchTerm?"No episodes found":"No episodes available"}),t.jsx("p",{className:"text-gray-400 mb-6",children:p.searchTerm?`No episodes match "${p.searchTerm}". Try a different search term.`:"No episodes available for this season."}),p.searchTerm&&t.jsx(Q.button,{onClick:()=>z(""),whileHover:{scale:1.05},whileTap:{scale:.95},className:"px-6 py-3 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-all font-medium",children:"Clear Search"})]});return p.loading?t.jsx("div",{className:"space-y-6 "+d,children:t.jsx(G,{})}):p.error&&!p.episodes.length?t.jsx(J,{}):t.jsxs("div",{className:"space-y-6 "+d,ref:N,children:[t.jsx(V,{}),t.jsx(U,{}),t.jsx(Y,{}),p.searchTerm&&F.length>0&&t.jsxs(Q.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-blue-500/10 border border-blue-500/30 rounded-lg px-4 py-2 text-sm text-blue-400",children:["Found ",F.length," episode",1!==F.length?"s":"",' matching "',p.searchTerm,'"']}),t.jsx(Z,{mode:"wait",children:F.length>0?t.jsxs(Q.div,{variants:Yr,initial:"hidden",animate:"visible",exit:"exit",className:"space-y-3 "+("grid"===p.viewMode?"grid grid-cols-1 md:grid-cols-2 gap-4":""),role:"list","aria-label":"Episodes list",children:[t.jsx(Z,{mode:"popLayout",children:F.map(((e,s)=>t.jsx("div",{role:"listitem",children:t.jsx(H,{episode:e,index:s,viewMode:p.viewMode,onEpisodeClick:R,currentSeasonNumber:p.currentSeason?.season_number})},e.id)))}),B&&!p.showAllEpisodes&&t.jsx("div",{ref:_,className:"h-10","aria-hidden":"true"}),B&&!p.showAllEpisodes&&t.jsx(Q.button,{initial:{opacity:0},animate:{opacity:1},whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>x({type:Pr}),className:"w-full py-4 bg-gradient-to-r from-gray-800 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-600 transition-all focus:outline-none focus:ring-2 focus:ring-blue-500 font-medium shadow-lg","aria-label":`Show all ${b.length} episodes`,children:t.jsxs("span",{className:"flex items-center justify-center gap-2",children:["Show All Episodes (",b.length,")",t.jsx("span",{className:"text-xl",children:"▼"})]})})]},"episodes-list"):t.jsx(Q.div,{children:t.jsx(X,{})},"empty-state")}),p.loadingEpisodes&&t.jsx(q,{}),F.length>10&&t.jsx(Q.button,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},exit:{opacity:0,scale:0},whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>N.current?.scrollIntoView({behavior:"smooth"}),className:"fixed bottom-8 right-8 p-4 bg-blue-600 text-white rounded-full shadow-2xl hover:bg-blue-700 transition-colors z-50","aria-label":"Scroll to top",children:t.jsx("span",{className:"text-2xl",children:"↑"})})]})};Gr.propTypes={tvId:le.oneOfType([le.string,le.number]).isRequired,seasonNumber:le.number,onEpisodeSelect:le.func,onSeasonChange:le.func,initialSeason:le.shape({season_number:le.number,name:le.string,episode_count:le.number,is_special:le.bool,is_latest:le.bool}),showSearch:le.bool,showStats:le.bool,maxEpisodesPerPage:le.number,className:le.string,enableVirtualScroll:le.bool,enablePrefetch:le.bool,enableAdvancedFilters:le.bool},Gr.defaultProps={seasonNumber:null,onEpisodeSelect:null,onSeasonChange:null,initialSeason:null,showSearch:!0,showStats:!0,maxEpisodesPerPage:20,className:"",enableVirtualScroll:!0,enablePrefetch:!0,enableAdvancedFilters:!1};const Jr=e.memo(Gr),Xr=Object.freeze(Object.defineProperty({__proto__:null,default:Jr},Symbol.toStringTag,{value:"Module"}));export{Ot as $,da as A,ma as B,us as C,va as D,ss as E,La as F,la as G,Ta as H,Ma as I,Wa as J,Oa as K,at as L,ot as M,ia as N,ft as O,rs as P,Ct as Q,vs as R,St as S,Us as T,ut as U,ts as V,wt as W,Nt as X,oa as Y,Mt as Z,et as _,jt as a,Dt as a0,Ut as a1,it as a2,rt as a3,nt as a4,os as a5,ws as a6,Vs as a7,aa as a8,Na as a9,ka as aa,Ca as ab,_a as ac,Ia as ad,Da as ae,Ra as af,Aa as ag,Ya as ah,qa as ai,Qa as aj,tr as ak,Nr as al,Sr as am,Lr as an,Tr as ao,Xr as ap,ht as b,Jt as c,Bt as d,st as e,Ys as f,$t as g,qs as h,Gs as i,fs as j,Qt as k,ra as l,ys as m,Pt as n,pt as o,Rt as p,ua as q,ha as r,Gt as s,mt as t,At as u,ya as v,wa as w,ja as x,ga as y,Ea as z};
